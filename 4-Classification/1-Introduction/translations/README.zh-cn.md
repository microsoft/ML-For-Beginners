# å¯¹åˆ†ç±»æ–¹æ³•çš„ä»‹ç»

åœ¨è¿™å››èŠ‚è¯¾ç¨‹ä¸­ï¼Œä½ å°†ä¼šå­¦ä¹ æœºå™¨å­¦ä¹ ä¸­ä¸€ä¸ªåŸºæœ¬çš„é‡ç‚¹ - _åˆ†ç±»_ã€‚ æˆ‘ä»¬ä¼šåœ¨å…³äºäºšæ´²å’Œå°åº¦çš„ç¥å¥‡çš„ç¾é£Ÿçš„æ•°æ®é›†ä¸Šå°è¯•ä½¿ç”¨å¤šç§åˆ†ç±»ç®—æ³•ã€‚å¸Œæœ›ä½ æœ‰ç‚¹é¥¿äº†ã€‚

![ä¸€ä¸ªæ¡ƒå­ï¼](../images/pinch.png)

> åœ¨å­¦ä¹ çš„è¯¾ç¨‹ä¸­èµå¹æ³›äºšåœ°åŒºçš„ç¾é£Ÿå§ï¼ å›¾ç‰‡ç”± [Jen Looper](https://twitter.com/jenlooper) æä¾›

åˆ†ç±»ç®—æ³•æ˜¯[ç›‘ç£å­¦ä¹ ](https://wikipedia.org/wiki/Supervised_learning)çš„ä¸€ç§ã€‚å®ƒä¸å›å½’ç®—æ³•åœ¨å¾ˆå¤šæ–¹é¢éƒ½æœ‰ç›¸åŒä¹‹å¤„ã€‚å¦‚æœæœºå™¨å­¦ä¹ æ‰€æœ‰çš„ç›®æ ‡éƒ½æ˜¯ä½¿ç”¨æ•°æ®é›†æ¥é¢„æµ‹æ•°å€¼æˆ–ç‰©å“çš„åå­—ï¼Œé‚£ä¹ˆåˆ†ç±»ç®—æ³•é€šå¸¸å¯ä»¥åˆ†ä¸ºä¸¤ç±» _äºŒå…ƒåˆ†ç±»_ å’Œ _å¤šå…ƒåˆ†ç±»_ã€‚

[![å¯¹åˆ†ç±»ç®—æ³•çš„ä»‹ç»](https://img.youtube.com/vi/eg8DJYwdMyg/0.jpg)](https://youtu.be/eg8DJYwdMyg "å¯¹åˆ†ç±»ç®—æ³•çš„ä»‹ç»")

> ğŸ¥ ç‚¹å‡»ä¸Šæ–¹çš„å›¾ç‰‡å¯ä»¥è·³è½¬åˆ°ä¸€ä¸ªè§†é¢‘-MIT çš„ John å¯¹åˆ†ç±»ç®—æ³•çš„ä»‹ç»

è¯·è®°ä½ï¼š

- **çº¿æ€§å›å½’**  å¸®åŠ©ä½ é¢„æµ‹å˜é‡ä¹‹é—´çš„å…³ç³»å¹¶å¯¹ä¸€ä¸ªæ–°çš„æ•°æ®ç‚¹ä¼šè½åœ¨å“ªæ¡çº¿ä¸Šåšå‡ºç²¾ç¡®çš„é¢„æµ‹ã€‚å› æ­¤ï¼Œä½ å¯ä»¥é¢„æµ‹ _å—ç“œåœ¨ä¹æœˆçš„ä»·æ ¼å’Œåæœˆçš„ä»·æ ¼_ã€‚
- **é€»è¾‘å›å½’**  å¸®åŠ©ä½ å‘ç°â€œäºŒå…ƒèŒƒç•´â€ï¼šå³åœ¨å½“å‰è¿™ä¸ªä»·æ ¼ï¼Œ _è¿™ä¸ªå—ç“œæ˜¯ä¸æ˜¯æ©™è‰²_ï¼Ÿ

åˆ†ç±»æ–¹æ³•é‡‡ç”¨å¤šç§ç®—æ³•æ¥ç¡®å®šå…¶ä»–å¯ä»¥ç”¨æ¥ç¡®å®šä¸€ä¸ªæ•°æ®ç‚¹çš„æ ‡ç­¾æˆ–ç±»åˆ«çš„æ–¹æ³•ã€‚è®©æˆ‘ä»¬æ¥ç ”ç©¶ä¸€ä¸‹è¿™ä¸ªæ•°æ®é›†ï¼Œçœ‹çœ‹æˆ‘ä»¬èƒ½å¦é€šè¿‡è§‚å¯Ÿèœè‚´çš„åŸæ–™æ¥ç¡®å®šå®ƒçš„æºå¤´ã€‚

## [è¯¾ç¨‹å‰çš„å°é—®é¢˜](https://white-water-09ec41f0f.azurestaticapps.net/quiz/19/)

åˆ†ç±»æ˜¯æœºå™¨å­¦ä¹ ç ”ç©¶è€…å’Œæ•°æ®ç§‘å­¦å®¶ä½¿ç”¨çš„ä¸€ç§åŸºæœ¬æ–¹æ³•ã€‚ä»åŸºæœ¬çš„äºŒå…ƒåˆ†ç±»ï¼ˆè¿™æ˜¯ä¸æ˜¯ä¸€ä»½åƒåœ¾é‚®ä»¶ï¼Ÿï¼‰åˆ°å¤æ‚çš„å›¾ç‰‡åˆ†ç±»å’Œä½¿ç”¨è®¡ç®—æœºè§†è§‰çš„åˆ†å‰²æŠ€æœ¯ï¼Œå®ƒéƒ½æ˜¯å°†æ•°æ®åˆ†ç±»å¹¶æå‡ºç›¸å…³é—®é¢˜çš„æœ‰æ•ˆå·¥å…·ã€‚

![äºŒå…ƒåˆ†ç±» vs å¤šå…ƒåˆ†ç±»](../images/binary-multiclass.png)

> éœ€è¦åˆ†ç±»ç®—æ³•è§£å†³çš„äºŒå…ƒåˆ†ç±»å’Œå¤šå…ƒåˆ†ç±»é—®é¢˜çš„å¯¹æ¯”. ä¿¡æ¯å›¾ç”± [Jen Looper](https://twitter.com/jenlooper) æä¾›

åœ¨å¼€å§‹æ¸…æ´—æ•°æ®ã€æ•°æ®å¯è§†åŒ–å’Œè°ƒæ•´æ•°æ®ä»¥é€‚åº”æœºå™¨å­¦ä¹ çš„ä»»åŠ¡å‰ï¼Œè®©æˆ‘ä»¬æ¥äº†è§£ä¸€ä¸‹å¤šç§å¯ç”¨æ¥æ•°æ®åˆ†ç±»çš„æœºå™¨å­¦ä¹ æ–¹æ³•ã€‚

æ´¾ç”Ÿè‡ª[ç»Ÿè®¡æ•°å­¦](https://wikipedia.org/wiki/Statistical_classification)ï¼Œåˆ†ç±»ç®—æ³•ä½¿ç”¨ç»å…¸çš„æœºå™¨å­¦ä¹ çš„ä¸€äº›ç‰¹å¾ï¼Œæ¯”å¦‚é€šè¿‡'å¸çƒŸè€…'ã€'ä½“é‡'å’Œ'å¹´é¾„'æ¥æ¨æ–­ _ç½¹æ‚£æŸç§ç–¾ç—…çš„å¯èƒ½æ€§_ã€‚ä½œä¸ºä¸€ä¸ªä¸ä½ åˆšåˆšå®è·µè¿‡çš„å›å½’ç®—æ³•å¾ˆç›¸ä¼¼çš„ç›‘ç£å­¦ä¹ ç®—æ³•ï¼Œä½ çš„æ•°æ®æ˜¯è¢«æ ‡è®°è¿‡çš„å¹¶ä¸”ç®—æ³•é€šè¿‡é‡‡é›†è¿™äº›æ ‡ç­¾æ¥è¿›è¡Œåˆ†ç±»å’Œé¢„æµ‹å¹¶è¿›è¡Œè¾“å‡ºã€‚

âœ… èŠ±ä¸€ç‚¹æ—¶é—´æ¥æƒ³è±¡ä¸€ä¸‹ä¸€ä¸ªå…³äºèœè‚´çš„æ•°æ®é›†ã€‚ä¸€ä¸ªå¤šå…ƒåˆ†ç±»çš„æ¨¡å‹åº”è¯¥èƒ½å›ç­”ä»€ä¹ˆé—®é¢˜ï¼Ÿä¸€ä¸ªäºŒå…ƒåˆ†ç±»çš„æ¨¡å‹åˆåº”è¯¥èƒ½å›ç­”ä»€ä¹ˆï¼Ÿå¦‚æœä½ æƒ³ç¡®å®šä¸€ä¸ªç»™å®šçš„èœè‚´æ˜¯å¦ä¼šç”¨åˆ°è‘«èŠ¦å·´ï¼ˆä¸€ç§æ¤ç‰©ï¼Œç§å­ç”¨æ¥è°ƒå‘³ï¼‰è¯¥æ€ä¹ˆåšï¼Ÿå¦‚æœä½ æƒ³çŸ¥é“ç»™ä½ ä¸€ä¸ªè£…æ»¡äº†å…«è§’èŒ´é¦™ã€èŠ±æ¤°èœå’Œè¾£æ ¹çš„è´­ç‰©è¢‹ä½ èƒ½å¦åšå‡ºä¸€é“ä»£è¡¨æ€§çš„å°åº¦èœåˆè¯¥æ€ä¹ˆåšï¼Ÿ

[![Crazy mystery baskets](https://img.youtube.com/vi/GuTeDbaNoEU/0.jpg)](https://youtu.be/GuTeDbaNoEU "ç–¯ç‹‚çš„ç¥ç§˜ç¯®å­")

> ğŸ¥ ç‚¹å‡»å›¾åƒè§‚çœ‹è§†é¢‘ã€‚æ•´ä¸ª'Chopped'èŠ‚ç›®çš„å‰æéƒ½æ˜¯å»ºç«‹åœ¨ç¥ç§˜çš„ç¯®å­ä¸Šï¼Œåœ¨è¿™ä¸ªèŠ‚ç›®ä¸­å¨å¸ˆå¿…é¡»åˆ©ç”¨éšæœºç»™å®šçš„é£Ÿæåšèœã€‚å¯è§ä¸€ä¸ªæœºå™¨å­¦ä¹ æ¨¡å‹èƒ½èµ·åˆ°ä¸å°çš„ä½œç”¨

## åˆè§-åˆ†ç±»å™¨

æˆ‘ä»¬å…³äºè¿™ä¸ªèœè‚´æ•°æ®é›†æƒ³è¦æå‡ºçš„é—®é¢˜å…¶å®æ˜¯ä¸€ä¸ª **å¤šå…ƒé—®é¢˜**ï¼Œå› ä¸ºæˆ‘ä»¬æœ‰å¾ˆå¤šæ½œåœ¨çš„å…·æœ‰ä»£è¡¨æ€§çš„èœè‚´ã€‚ç»™å®šä¸€ç³»åˆ—é£Ÿææ•°æ®ï¼Œæ•°æ®èƒ½å¤Ÿç¬¦åˆè¿™äº›ç±»åˆ«ä¸­çš„å“ªä¸€ç±»ï¼Ÿ

Scikit-learn é¡¹ç›®æä¾›å¤šç§å¯¹æ•°æ®è¿›è¡Œåˆ†ç±»çš„ç®—æ³•ï¼Œä½ éœ€è¦æ ¹æ®é—®é¢˜çš„å…·ä½“ç±»å‹æ¥è¿›è¡Œé€‰æ‹©ã€‚åœ¨ä¸‹ä¸¤èŠ‚è¯¾ç¨‹ä¸­ä½ ä¼šå­¦åˆ°è¿™äº›ç®—æ³•ä¸­çš„å‡ ä¸ªã€‚

## ç»ƒä¹  - æ¸…æ´—å¹¶å¹³è¡¡ä½ çš„æ•°æ®

åœ¨ä½ å¼€å§‹è¿›è¡Œè¿™ä¸ªé¡¹ç›®å‰çš„ç¬¬ä¸€ä¸ªä¸Šæ‰‹çš„ä»»åŠ¡å°±æ˜¯æ¸…æ´—å’Œ **å¹³è¡¡**ä½ çš„æ•°æ®æ¥å¾—åˆ°æ›´å¥½çš„ç»“æœã€‚ä»å½“å‰ç›®å½•çš„æ ¹ç›®å½•ä¸­çš„ _nodebook.ipynb_ å¼€å§‹ã€‚

ç¬¬ä¸€ä¸ªéœ€è¦å®‰è£…çš„ä¸œè¥¿æ˜¯ [imblearn](https://imbalanced-learn.org/stable/) è¿™æ˜¯ä¸€ä¸ª Scikit-learn é¡¹ç›®ä¸­çš„ä¸€ä¸ªåŒ…ï¼Œå®ƒå¯ä»¥è®©ä½ æ›´å¥½çš„å¹³è¡¡æ•°æ® (å…³äºè¿™ä¸ªä»»åŠ¡ä½ å¾ˆå¿«ä½ å°±ä¼šå­¦åˆ°æ›´å¤š)ã€‚

1. å®‰è£… `imblearn`, è¿è¡Œå‘½ä»¤ `pip install`:

    ```python
    pip install imblearn
    ```

1. ä¸ºäº†å¯¼å…¥å’Œå¯è§†åŒ–æ•°æ®ä½ éœ€è¦å¯¼å…¥ä¸‹é¢çš„è¿™äº›åŒ…, ä½ è¿˜éœ€è¦ä» `imblearn` å¯¼å…¥ `SMOTE`

    ```python
    import pandas as pd
    import matplotlib.pyplot as plt
    import matplotlib as mpl
    import numpy as np
    from imblearn.over_sampling import SMOTE
    ```

    ç°åœ¨ä½ å·²ç»å‡†å¤‡å¥½å¯¼å…¥æ•°æ®äº†ã€‚

1. ä¸‹ä¸€é¡¹ä»»åŠ¡æ˜¯å¯¼å…¥æ•°æ®:

    ```python
    df  = pd.read_csv('../data/cuisines.csv')
    ```

   ä½¿ç”¨å‡½æ•° `read_csv()` ä¼šè¯»å– csv æ–‡ä»¶çš„å†…å®¹ _cusines.csv_ å¹¶å°†å†…å®¹æ”¾ç½®åœ¨ å˜é‡ `df` ä¸­ã€‚
   
1. æ£€æŸ¥æ•°æ®çš„å½¢çŠ¶æ˜¯å¦æ­£ç¡®:

    ```python
    df.head()
    ```

   å‰äº”è¡Œè¾“å‡ºåº”è¯¥æ˜¯è¿™æ ·çš„:

    ```output
    |     | Unnamed: 0 | cuisine | almond | angelica | anise | anise_seed | apple | apple_brandy | apricot | armagnac | ... | whiskey | white_bread | white_wine | whole_grain_wheat_flour | wine | wood | yam | yeast | yogurt | zucchini |
    | --- | ---------- | ------- | ------ | -------- | ----- | ---------- | ----- | ------------ | ------- | -------- | --- | ------- | ----------- | ---------- | ----------------------- | ---- | ---- | --- | ----- | ------ | -------- |
    | 0   | 65         | indian  | 0      | 0        | 0     | 0          | 0     | 0            | 0       | 0        | ... | 0       | 0           | 0          | 0                       | 0    | 0    | 0   | 0     | 0      | 0        |
    | 1   | 66         | indian  | 1      | 0        | 0     | 0          | 0     | 0            | 0       | 0        | ... | 0       | 0           | 0          | 0                       | 0    | 0    | 0   | 0     | 0      | 0        |
    | 2   | 67         | indian  | 0      | 0        | 0     | 0          | 0     | 0            | 0       | 0        | ... | 0       | 0           | 0          | 0                       | 0    | 0    | 0   | 0     | 0      | 0        |
    | 3   | 68         | indian  | 0      | 0        | 0     | 0          | 0     | 0            | 0       | 0        | ... | 0       | 0           | 0          | 0                       | 0    | 0    | 0   | 0     | 0      | 0        |
    | 4   | 69         | indian  | 0      | 0        | 0     | 0          | 0     | 0            | 0       | 0        | ... | 0       | 0           | 0          | 0                       | 0    | 0    | 0   | 0     | 1      | 0        |
    ```

1. è°ƒç”¨å‡½æ•° `info()` å¯ä»¥è·å¾—æœ‰å…³è¿™ä¸ªæ•°æ®é›†çš„ä¿¡æ¯:

    ```python
    df.info()
    ```

    ä½ çš„è¾“å‡ºåº”è¯¥åƒè¿™æ ·ï¼š

    ```output
    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 2448 entries, 0 to 2447
    Columns: 385 entries, Unnamed: 0 to zucchini
    dtypes: int64(384), object(1)
    memory usage: 7.2+ MB
    ```

## ç»ƒä¹  - äº†è§£è¿™äº›èœè‚´

ç°åœ¨ä»»åŠ¡å˜å¾—æ›´æœ‰è¶£äº†ï¼Œè®©æˆ‘ä»¬æ¥æ¢ç´¢å¦‚ä½•å°†æ•°æ®åˆ†é…ç»™å„ä¸ªèœè‚´

1. è°ƒç”¨å‡½æ•° `barh()` å¯ä»¥ç»˜åˆ¶å‡ºæ•°æ®çš„æ¡å½¢å›¾:

    ```python
    df.cuisine.value_counts().plot.barh()
    ```

    ![èœè‚´æ•°æ®åˆ†é…](../images/cuisine-dist.png)

    è¿™é‡Œæœ‰æœ‰é™çš„ä¸€äº›èœè‚´ï¼Œä½†æ˜¯æ•°æ®çš„åˆ†é…æ˜¯ä¸å¹³å‡çš„ã€‚ä½†æ˜¯ä½ å¯ä»¥ä¿®æ­£è¿™ä¸€ç°è±¡ï¼åœ¨è¿™æ ·åšä¹‹å‰å†ç¨å¾®æ¢ç´¢ä¸€ä¸‹ã€‚

1. æ‰¾å‡ºå¯¹äºæ¯ä¸ªèœè‚´æœ‰å¤šå°‘æ•°æ®æ˜¯æœ‰æ•ˆçš„å¹¶å°†å…¶æ‰“å°å‡ºæ¥:

    ```python
    thai_df = df[(df.cuisine == "thai")]
    japanese_df = df[(df.cuisine == "japanese")]
    chinese_df = df[(df.cuisine == "chinese")]
    indian_df = df[(df.cuisine == "indian")]
    korean_df = df[(df.cuisine == "korean")]
    
    print(f'thai df: {thai_df.shape}')
    print(f'japanese df: {japanese_df.shape}')
    print(f'chinese df: {chinese_df.shape}')
    print(f'indian df: {indian_df.shape}')
    print(f'korean df: {korean_df.shape}')
    ```

    è¾“å‡ºåº”è¯¥æ˜¯è¿™æ ·çš„ :

    ```output
    thai df: (289, 385)
    japanese df: (320, 385)
    chinese df: (442, 385)
    indian df: (598, 385)
    korean df: (799, 385)
    ```
## æ¢ç´¢æœ‰å…³é£Ÿæçš„å†…å®¹

ç°åœ¨ä½ å¯ä»¥åœ¨æ•°æ®ä¸­æ¢ç´¢çš„æ›´æ·±ä¸€ç‚¹å¹¶äº†è§£æ¯é“èœè‚´çš„ä»£è¡¨æ€§é£Ÿæã€‚ä½ éœ€è¦å°†åå¤å‡ºç°çš„ã€å®¹æ˜“é€ æˆæ··æ·†çš„æ•°æ®æ¸…ç†å‡ºå»ï¼Œé‚£ä¹ˆè®©æˆ‘ä»¬æ¥å­¦ä¹ è§£å†³è¿™ä¸ªé—®é¢˜ã€‚

1. åœ¨ Python ä¸­åˆ›å»ºä¸€ä¸ªå‡½æ•° `create_ingredient_df()` æ¥åˆ›å»ºä¸€ä¸ªé£Ÿæçš„æ•°æ®å¸§ã€‚è¿™ä¸ªå‡½æ•°ä¼šå»æ‰æ•°æ®ä¸­æ— ç”¨çš„åˆ—å¹¶æŒ‰é£Ÿæçš„æ•°é‡è¿›è¡Œåˆ†ç±»ã€‚

    ```python
    def create_ingredient_df(df):
        ingredient_df = df.T.drop(['cuisine','Unnamed: 0']).sum(axis=1).to_frame('value')
        ingredient_df = ingredient_df[(ingredient_df.T != 0).any()]
        ingredient_df = ingredient_df.sort_values(by='value', ascending=False,
        inplace=False)
        return ingredient_df
    ```
ç°åœ¨ä½ å¯ä»¥ä½¿ç”¨è¿™ä¸ªå‡½æ•°æ¥å¾—åˆ°ç†æƒ³çš„æ¯é“èœè‚´æœ€é‡è¦çš„ 10 ç§é£Ÿæã€‚

1. è°ƒç”¨å‡½æ•° `create_ingredient_df()` ç„¶åé€šè¿‡å‡½æ•° `barh()` æ¥ç»˜åˆ¶å›¾åƒ:

    ```python
    thai_ingredient_df = create_ingredient_df(thai_df)
    thai_ingredient_df.head(10).plot.barh()
    ```

    ![thai](../images/thai.png)

1. å¯¹æ—¥æœ¬çš„æ•°æ®è¿›è¡Œç›¸åŒçš„æ“ä½œ:

    ```python
    japanese_ingredient_df = create_ingredient_df(japanese_df)
    japanese_ingredient_df.head(10).plot.barh()
    ```

    ![æ—¥æœ¬](../images/japanese.png)

1. ç°åœ¨å¤„ç†ä¸­å›½çš„æ•°æ®:

    ```python
    chinese_ingredient_df = create_ingredient_df(chinese_df)
    chinese_ingredient_df.head(10).plot.barh()
    ```

    ![ä¸­å›½](../images/chinese.png)

1. ç»˜åˆ¶å°åº¦é£Ÿæçš„æ•°æ®:

    ```python
    indian_ingredient_df = create_ingredient_df(indian_df)
    indian_ingredient_df.head(10).plot.barh()
    ```

    ![å°åº¦](../images/indian.png)

1. æœ€åï¼Œç»˜åˆ¶éŸ©å›½çš„é£Ÿæçš„æ•°æ®:

    ```python
    korean_ingredient_df = create_ingredient_df(korean_df)
    korean_ingredient_df.head(10).plot.barh()
    ```

    ![éŸ©å›½](../images/korean.png)

1. ç°åœ¨ï¼Œå»é™¤åœ¨ä¸åŒçš„èœè‚´é—´æœ€æ™®éçš„å®¹æ˜“é€ æˆæ··ä¹±çš„é£Ÿæï¼Œè°ƒç”¨å‡½æ•° `drop()`: 

   å¤§å®¶éƒ½å–œæ¬¢ç±³é¥­ã€å¤§è’œå’Œç”Ÿå§œ

    ```python
    feature_df= df.drop(['cuisine','Unnamed: 0','rice','garlic','ginger'], axis=1)
    labels_df = df.cuisine #.unique()
    feature_df.head()
    ```

## å¹³è¡¡æ•°æ®é›†

ç°åœ¨ä½ å·²ç»æ¸…ç†è¿‡æ•°æ®é›†äº†, ä½¿ç”¨ [SMOTE](https://imbalanced-learn.org/dev/references/generated/imblearn.over_sampling.SMOTE.html) - "Synthetic Minority Over-sampling Technique" - æ¥å¹³è¡¡æ•°æ®é›†ã€‚

1. è°ƒç”¨å‡½æ•° `fit_resample()`, æ­¤æ–¹æ³•é€šè¿‡æ’å…¥æ•°æ®æ¥ç”Ÿæˆæ–°çš„æ ·æœ¬

    ```python
    oversample = SMOTE()
    transformed_feature_df, transformed_label_df = oversample.fit_resample(feature_df, labels_df)
    ```

    é€šè¿‡å¯¹æ•°æ®é›†çš„å¹³è¡¡ï¼Œå½“ä½ å¯¹æ•°æ®è¿›è¡Œåˆ†ç±»æ—¶èƒ½å¤Ÿå¾—åˆ°æ›´å¥½çš„ç»“æœã€‚ç°åœ¨è€ƒè™‘ä¸€ä¸ªäºŒå…ƒåˆ†ç±»çš„é—®é¢˜ï¼Œå¦‚æœä½ çš„æ•°æ®é›†ä¸­çš„å¤§éƒ¨åˆ†æ•°æ®éƒ½å±äºå…¶ä¸­ä¸€ä¸ªç±»åˆ«ï¼Œé‚£ä¹ˆæœºå™¨å­¦ä¹ çš„æ¨¡å‹å°±ä¼šå› ä¸ºåœ¨é‚£ä¸ªç±»åˆ«çš„æ•°æ®æ›´å¤šè€Œåˆ¤æ–­é‚£ä¸ªç±»åˆ«æ›´ä¸ºå¸¸è§ã€‚å¹³è¡¡æ•°æ®èƒ½å¤Ÿå»é™¤ä¸å…¬å¹³çš„æ•°æ®ç‚¹ã€‚

1. ç°åœ¨ä½ å¯ä»¥æŸ¥çœ‹æ¯ä¸ªé£Ÿæçš„æ ‡ç­¾æ•°é‡:

    ```python
    print(f'new label count: {transformed_label_df.value_counts()}')
    print(f'old label count: {df.cuisine.value_counts()}')
    ```

    è¾“å‡ºåº”è¯¥æ˜¯è¿™æ ·çš„ :

    ```output
    new label count: korean      799
    chinese     799
    indian      799
    japanese    799
    thai        799
    Name: cuisine, dtype: int64
    old label count: korean      799
    indian      598
    chinese     442
    japanese    320
    thai        289
    Name: cuisine, dtype: int64
    ```

    ç°åœ¨è¿™ä¸ªæ•°æ®é›†ä¸ä»…å¹²å‡€ã€å¹³è¡¡è€Œä¸”è¿˜å¾ˆâ€œç¾å‘³â€ ! 

1. æœ€åä¸€æ­¥æ˜¯ä¿å­˜ä½ å¤„ç†è¿‡åçš„å¹³è¡¡çš„æ•°æ®ï¼ˆåŒ…æ‹¬æ ‡ç­¾å’Œç‰¹å¾ï¼‰ï¼Œå°†å…¶ä¿å­˜ä¸ºä¸€ä¸ªå¯ä»¥è¢«è¾“å‡ºåˆ°æ–‡ä»¶ä¸­çš„æ•°æ®å¸§ã€‚

    ```python
    transformed_df = pd.concat([transformed_label_df,transformed_feature_df],axis=1, join='outer')
    ```

1. ä½ å¯ä»¥é€šè¿‡è°ƒç”¨å‡½æ•° `transformed_df.head()` å’Œ `transformed_df.info()` å†æ£€æŸ¥ä¸€ä¸‹ä½ çš„æ•°æ®ã€‚ æ¥ä¸‹æ¥è¦å°†æ•°æ®ä¿å­˜ä»¥ä¾›åœ¨æœªæ¥çš„è¯¾ç¨‹ä¸­ä½¿ç”¨:

    ```python
    transformed_df.head()
    transformed_df.info()
    transformed_df.to_csv("../data/cleaned_cuisines.csv")
    ```

    è¿™ä¸ªå…¨æ–°çš„ CSV æ–‡ä»¶å¯ä»¥åœ¨æ•°æ®æ ¹ç›®å½•ä¸­è¢«æ‰¾åˆ°ã€‚

---

## ğŸš€å°ç»ƒä¹ 

æœ¬é¡¹ç›®çš„å…¨éƒ¨è¯¾ç¨‹å«æœ‰å¾ˆå¤šæœ‰è¶£çš„æ•°æ®é›†ã€‚ æ¢ç´¢ä¸€ä¸‹ `data` æ–‡ä»¶å¤¹ï¼Œçœ‹çœ‹è¿™é‡Œé¢æœ‰æ²¡æœ‰é€‚åˆäºŒå…ƒåˆ†ç±»ã€å¤šå…ƒåˆ†ç±»ç®—æ³•çš„æ•°æ®é›†ï¼Œå†æƒ³ä¸€ä¸‹ä½ å¯¹è¿™äº›æ•°æ®é›†æœ‰æ²¡æœ‰ä»€ä¹ˆæƒ³é—®çš„é—®é¢˜ã€‚

## [è¯¾åç»ƒä¹ ](https://white-water-09ec41f0f.azurestaticapps.net/quiz/20/)

## å›é¡¾ & è‡ªå­¦

æ¢ç´¢ä¸€ä¸‹ SMOTE çš„ API æ–‡æ¡£ã€‚æ€è€ƒä¸€ä¸‹å®ƒæœ€é€‚åˆäºä»€ä¹ˆæ ·çš„æƒ…å†µã€å®ƒèƒ½å¤Ÿè§£å†³ä»€ä¹ˆæ ·çš„é—®é¢˜ã€‚

## è¯¾åä½œä¸š 

[æ¢ç´¢ä¸€ä¸‹åˆ†ç±»æ–¹æ³•](./assignment.zh-cn.md)
