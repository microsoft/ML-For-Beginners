# –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ —Ä–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Scikit-learn: —Ä–µ–≥—Ä–µ—Å—Å–∏—è —á–µ—Ç—ã—Ä—å–º—è —Å–ø–æ—Å–æ–±–∞–º–∏

![–ò–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫–∞ –ª–∏–Ω–µ–π–Ω–æ–π –∏ –ø–æ–ª–∏–Ω–æ–º–∏–∞–ª—å–Ω–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏](../../../../translated_images/linear-polynomial.5523c7cb6576ccab0fecbd0e3505986eb2d191d9378e785f82befcf3a578a6e7.ru.png)
> –ò–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫–∞ –æ—Ç [Dasani Madipalli](https://twitter.com/dasani_decoded)
## [–í–∏–∫—Ç–æ—Ä–∏–Ω–∞ –ø–µ—Ä–µ–¥ –ª–µ–∫—Ü–∏–µ–π](https://gray-sand-07a10f403.1.azurestaticapps.net/quiz/13/)

> ### [–≠—Ç–æ—Ç —É—Ä–æ–∫ –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ R!](../../../../2-Regression/3-Linear/solution/R/lesson_3.html)
### –í–≤–µ–¥–µ–Ω–∏–µ 

–î–æ —Å–∏—Ö –ø–æ—Ä –≤—ã –∏–∑—É—á–∞–ª–∏, —á—Ç–æ —Ç–∞–∫–æ–µ —Ä–µ–≥—Ä–µ—Å—Å–∏—è, –Ω–∞ –ø—Ä–∏–º–µ—Ä–µ –¥–∞–Ω–Ω—ã—Ö –æ —Ü–µ–Ω–∞—Ö –Ω–∞ —Ç—ã–∫–≤—ã, –∫–æ—Ç–æ—Ä—ã–µ –º—ã –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–∞ –ø—Ä–æ—Ç—è–∂–µ–Ω–∏–∏ –≤—Å–µ–≥–æ —ç—Ç–æ–≥–æ —É—Ä–æ–∫–∞. –í—ã —Ç–∞–∫–∂–µ –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞–ª–∏ –¥–∞–Ω–Ω—ã–µ —Å –ø–æ–º–æ—â—å—é Matplotlib.

–¢–µ–ø–µ—Ä—å –≤—ã –≥–æ—Ç–æ–≤—ã —É–≥–ª—É–±–∏—Ç—å—Å—è –≤ —Ä–µ–≥—Ä–µ—Å—Å–∏—é –¥–ª—è –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è. –•–æ—Ç—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–Ω—è—Ç—å –¥–∞–Ω–Ω—ã–µ, –∏—Å—Ç–∏–Ω–Ω–∞—è —Å–∏–ª–∞ –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ _–æ–±—É—á–µ–Ω–∏–∏ –º–æ–¥–µ–ª–µ–π_. –ú–æ–¥–µ–ª–∏ –æ–±—É—á–∞—é—Ç—Å—è –Ω–∞ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö, —á—Ç–æ–±—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞—Ö–≤–∞—Ç—ã–≤–∞—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –≤ –¥–∞–Ω–Ω—ã—Ö, –∏ –ø–æ–∑–≤–æ–ª—è—é—Ç –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –¥–ª—è –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–¥–µ–ª—å –Ω–µ –≤–∏–¥–µ–ª–∞ —Ä–∞–Ω–µ–µ.

–í —ç—Ç–æ–º —É—Ä–æ–∫–µ –≤—ã —É–∑–Ω–∞–µ—Ç–µ –±–æ–ª—å—à–µ –æ –¥–≤—É—Ö —Ç–∏–ø–∞—Ö —Ä–µ–≥—Ä–µ—Å—Å–∏–∏: _–±–∞–∑–æ–≤–æ–π –ª–∏–Ω–µ–π–Ω–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏_ –∏ _–ø–æ–ª–∏–Ω–æ–º–∏–∞–ª—å–Ω–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏_, –∞ —Ç–∞–∫–∂–µ –æ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –æ—Å–Ω–æ–≤–∞—Ö —ç—Ç–∏—Ö —Ç–µ—Ö–Ω–∏–∫. –≠—Ç–∏ –º–æ–¥–µ–ª–∏ –ø–æ–∑–≤–æ–ª—è—Ç –Ω–∞–º –ø—Ä–µ–¥—Å–∫–∞–∑–∞—Ç—å —Ü–µ–Ω—ã –Ω–∞ —Ç—ã–∫–≤—ã –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.

[![–ú–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ –¥–ª—è –Ω–∞—á–∏–Ω–∞—é—â–∏—Ö - –ü–æ–Ω–∏–º–∞–Ω–∏–µ –ª–∏–Ω–µ–π–Ω–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏](https://img.youtube.com/vi/CRxFT8oTDMg/0.jpg)](https://youtu.be/CRxFT8oTDMg "–ú–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ –¥–ª—è –Ω–∞—á–∏–Ω–∞—é—â–∏—Ö - –ü–æ–Ω–∏–º–∞–Ω–∏–µ –ª–∏–Ω–µ–π–Ω–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏")

> üé• –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤—ã—à–µ, —á—Ç–æ–±—ã –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∫–æ—Ä–æ—Ç–∫–æ–µ –≤–∏–¥–µ–æ –æ –ª–∏–Ω–µ–π–Ω–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏.

> –ù–∞ –ø—Ä–æ—Ç—è–∂–µ–Ω–∏–∏ —ç—Ç–æ–≥–æ —É—á–µ–±–Ω–æ–≥–æ –∫—É—Ä—Å–∞ –º—ã –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ–º –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –∑–Ω–∞–Ω–∏—è –º–∞—Ç–µ–º–∞—Ç–∏–∫–∏ –∏ —Å—Ç—Ä–µ–º–∏–º—Å—è —Å–¥–µ–ª–∞—Ç—å –µ–≥–æ –¥–æ—Å—Ç—É–ø–Ω—ã–º –¥–ª—è —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –∏–∑ –¥—Ä—É–≥–∏—Ö –æ–±–ª–∞—Å—Ç–µ–π, –ø–æ—ç—Ç–æ–º—É –æ–±—Ä–∞—â–∞–π—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ –∑–∞–º–µ—Ç–∫–∏, üßÆ –≤—ã–¥–µ–ª–µ–Ω–∏—è, –¥–∏–∞–≥—Ä–∞–º–º—ã –∏ –¥—Ä—É–≥–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è –æ–±—É—á–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–º–æ–≥—É—Ç –≤ –ø–æ–Ω–∏–º–∞–Ω–∏–∏.

### –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

–í—ã —É–∂–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∑–Ω–∞–∫–æ–º—ã —Å–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π –¥–∞–Ω–Ω—ã—Ö –æ —Ç—ã–∫–≤–∞—Ö, –∫–æ—Ç–æ—Ä—É—é –º—ã —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–µ–º. –í—ã –º–æ–∂–µ—Ç–µ –Ω–∞–π—Ç–∏ –µ–µ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–π –∏ –æ—á–∏—â–µ–Ω–Ω–æ–π –≤ —Ñ–∞–π–ª–µ _notebook.ipynb_ —ç—Ç–æ–≥–æ —É—Ä–æ–∫–∞. –í —Ñ–∞–π–ª–µ —Ü–µ–Ω–∞ –Ω–∞ —Ç—ã–∫–≤—ã –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∑–∞ –±—É—à–µ–ª—å –≤ –Ω–æ–≤–æ–º –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–µ. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—ã –º–æ–∂–µ—Ç–µ –∑–∞–ø—É—Å–∫–∞—Ç—å —ç—Ç–∏ –±–ª–æ–∫–Ω–æ—Ç—ã –≤ —è–¥—Ä–∞—Ö –≤ Visual Studio Code.

### –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞

–ù–∞–ø–æ–º–∏–Ω–∞–µ–º, —á—Ç–æ –≤—ã –∑–∞–≥—Ä—É–∂–∞–µ—Ç–µ —ç—Ç–∏ –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –∑–∞–¥–∞–≤–∞—Ç—å –≤–æ–ø—Ä–æ—Å—ã. 

- –ö–æ–≥–¥–∞ –ª—É—á—à–µ –≤—Å–µ–≥–æ –ø–æ–∫—É–ø–∞—Ç—å —Ç—ã–∫–≤—ã? 
- –ö–∞–∫—É—é —Ü–µ–Ω—É —è –º–æ–≥—É –æ–∂–∏–¥–∞—Ç—å –∑–∞ —è—â–∏–∫ –º–∏–Ω–∏–∞—Ç—é—Ä–Ω—ã—Ö —Ç—ã–∫–≤?
- –î–æ–ª–∂–µ–Ω –ª–∏ —è –ø–æ–∫—É–ø–∞—Ç—å –∏—Ö –≤ –ø–æ–ª—É–±—É—à–µ–ª—å–Ω—ã—Ö –∫–æ—Ä–∑–∏–Ω–∞—Ö –∏–ª–∏ –≤ –∫–æ—Ä–æ–±–∫–∞—Ö –ø–æ 1 1/9 –±—É—à–µ–ª—è?
–î–∞–≤–∞–π—Ç–µ –ø—Ä–æ–¥–æ–ª–∂–∏–º —É–≥–ª—É–±–ª—è—Ç—å—Å—è –≤ —ç—Ç–∏ –¥–∞–Ω–Ω—ã–µ.

–ù–∞ –ø—Ä–µ–¥—ã–¥—É—â–µ–º —É—Ä–æ–∫–µ –≤—ã —Å–æ–∑–¥–∞–ª–∏ –¥–∞—Ç–∞—Ñ—Ä–µ–π–º Pandas –∏ –∑–∞–ø–æ–ª–Ω–∏–ª–∏ –µ–≥–æ —á–∞—Å—Ç—å—é –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–≥–æ –Ω–∞–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö, —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–≤ —Ü–µ–Ω—ã –ø–æ –±—É—à–µ–ª—é. –û–¥–Ω–∞–∫–æ, –¥–µ–ª–∞—è —ç—Ç–æ, –≤—ã —Å–º–æ–≥–ª–∏ —Å–æ–±—Ä–∞—Ç—å —Ç–æ–ª—å–∫–æ –æ–∫–æ–ª–æ 400 —Ç–æ—á–µ–∫ –¥–∞–Ω–Ω—ã—Ö –∏ —Ç–æ–ª—å–∫–æ –∑–∞ –æ—Å–µ–Ω–Ω–∏–µ –º–µ—Å—è—Ü—ã. 

–ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –Ω–∞ –¥–∞–Ω–Ω—ã–µ, –∫–æ—Ç–æ—Ä—ã–µ –º—ã –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ –∑–∞–≥—Ä—É–∑–∏–ª–∏ –≤ —Å–æ–ø—Ä–æ–≤–æ–∂–¥–∞—é—â–µ–º –±–ª–æ–∫–Ω–æ—Ç–µ —ç—Ç–æ–≥–æ —É—Ä–æ–∫–∞. –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã, –∏ –Ω–∞—á–∞–ª—å–Ω—ã–π —Ä–∞—Å—Å–µ—è–Ω–Ω—ã–π –≥—Ä–∞—Ñ–∏–∫ –ø–æ—Å—Ç—Ä–æ–µ–Ω, —á—Ç–æ–±—ã –ø–æ–∫–∞–∑–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–æ –º–µ—Å—è—Ü–∞–º. –í–æ–∑–º–æ–∂–Ω–æ, –º—ã —Å–º–æ–∂–µ–º –ø–æ–ª—É—á–∏—Ç—å –Ω–µ–º–Ω–æ–≥–æ –±–æ–ª—å—à–µ –¥–µ—Ç–∞–ª–µ–π –æ –ø—Ä–∏—Ä–æ–¥–µ –¥–∞–Ω–Ω—ã—Ö, –æ—á–∏—Å—Ç–∏–≤ –∏—Ö –±–æ–ª–µ–µ —Ç—â–∞—Ç–µ–ª—å–Ω–æ.

## –õ–∏–Ω–µ–π–Ω–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω–∞—è –ª–∏–Ω–∏—è

–ö–∞–∫ –≤—ã —É–∑–Ω–∞–ª–∏ –Ω–∞ –£—Ä–æ–∫–µ 1, —Ü–µ–ª—å –ª–∏–Ω–µ–π–Ω–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ —Å–æ—Å—Ç–æ–∏—Ç –≤ —Ç–æ–º, —á—Ç–æ–±—ã –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –ª–∏–Ω–∏—é –¥–ª—è:

- **–ü–æ–∫–∞–∑–∞—Ç—å –≤–∑–∞–∏–º–æ—Å–≤—è–∑–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö**. –ü–æ–∫–∞–∑–∞—Ç—å –≤–∑–∞–∏–º–æ—Å–≤—è–∑—å –º–µ–∂–¥—É –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏
- **–°–¥–µ–ª–∞—Ç—å –ø—Ä–æ–≥–Ω–æ–∑—ã**. –°–¥–µ–ª–∞—Ç—å —Ç–æ—á–Ω—ã–µ –ø—Ä–æ–≥–Ω–æ–∑—ã –æ —Ç–æ–º, –≥–¥–µ –Ω–æ–≤–∞—è —Ç–æ—á–∫–∞ –¥–∞–Ω–Ω—ã—Ö –æ–∫–∞–∂–µ—Ç—Å—è –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ —ç—Ç–æ–π –ª–∏–Ω–∏–∏. 
 
–î–ª—è **–º–µ—Ç–æ–¥–∞ –Ω–∞–∏–º–µ–Ω—å—à–∏—Ö –∫–≤–∞–¥—Ä–∞—Ç–æ–≤** —Ç–∏–ø–∏—á–Ω–æ –ø—Ä–æ–≤–æ–¥–∏—Ç—å —Ç–∞–∫—É—é –ª–∏–Ω–∏—é. –¢–µ—Ä–º–∏–Ω ¬´–Ω–∞–∏–º–µ–Ω—å—à–∏–µ –∫–≤–∞–¥—Ä–∞—Ç—ã¬ª –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –≤—Å–µ —Ç–æ—á–∫–∏ –¥–∞–Ω–Ω—ã—Ö, –æ–∫—Ä—É–∂–∞—é—â–∏–µ —Ä–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω—É—é –ª–∏–Ω–∏—é, –≤–æ–∑–≤–æ–¥—è—Ç—Å—è –≤ –∫–≤–∞–¥—Ä–∞—Ç, –∞ –∑–∞—Ç–µ–º —Å–∫–ª–∞–¥—ã–≤–∞—é—Ç—Å—è. –í –∏–¥–µ–∞–ª–µ —ç—Ç–∞ –∫–æ–Ω–µ—á–Ω–∞—è —Å—É–º–º–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –∫–∞–∫ –º–æ–∂–Ω–æ –º–µ–Ω—å—à–µ, –ø–æ—Ç–æ–º—É —á—Ç–æ –º—ã —Ö–æ—Ç–∏–º –ø–æ–ª—É—á–∏—Ç—å –Ω–∏–∑–∫–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—à–∏–±–æ–∫, –∏–ª–∏ `least-squares`. 

–ú—ã —ç—Ç–æ –¥–µ–ª–∞–µ–º, –ø–æ—Å–∫–æ–ª—å–∫—É —Ö–æ—Ç–∏–º —Å–º–æ–¥–µ–ª–∏—Ä–æ–≤–∞—Ç—å –ª–∏–Ω–∏—é, –∫–æ—Ç–æ—Ä–∞—è –∏–º–µ–µ—Ç –Ω–∞–∏–º–µ–Ω—å—à–µ–µ –æ–±—â–µ–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –æ—Ç –≤—Å–µ—Ö –Ω–∞—à–∏—Ö —Ç–æ—á–µ–∫ –¥–∞–Ω–Ω—ã—Ö. –ú—ã —Ç–∞–∫–∂–µ –≤–æ–∑–≤–æ–¥–∏–º –≤ –∫–≤–∞–¥—Ä–∞—Ç —Ç–µ—Ä–º–∏–Ω—ã –ø–µ—Ä–µ–¥ –∏—Ö —Å–ª–æ–∂–µ–Ω–∏–µ–º, —Ç–∞–∫ –∫–∞–∫ –Ω–∞—Å –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç –∏—Ö –≤–µ–ª–∏—á–∏–Ω–∞, –∞ –Ω–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ.

> **üßÆ –ü–æ–∫–∞–∂–∏—Ç–µ –º–Ω–µ –º–∞—Ç–µ–º–∞—Ç–∏–∫—É** 
> 
> –≠—Ç–∞ –ª–∏–Ω–∏—è, –Ω–∞–∑—ã–≤–∞–µ–º–∞—è _–ª–∏–Ω–∏–µ–π –Ω–∞–∏–ª—É—á—à–µ–≥–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è_, –º–æ–∂–µ—Ç –±—ã—Ç—å –≤—ã—Ä–∞–∂–µ–Ω–∞ [–ø–æ —É—Ä–∞–≤–Ω–µ–Ω–∏—é](https://en.wikipedia.org/wiki/Simple_linear_regression): 
> 
> ```
> Y = a + bX
> ```
>
> `X` is the 'explanatory variable'. `Y` is the 'dependent variable'. The slope of the line is `b` and `a` is the y-intercept, which refers to the value of `Y` when `X = 0`. 
>
>![calculate the slope](../../../../translated_images/slope.f3c9d5910ddbfcf9096eb5564254ba22c9a32d7acd7694cab905d29ad8261db3.ru.png)
>
> First, calculate the slope `b`. Infographic by [Jen Looper](https://twitter.com/jenlooper)
>
> In other words, and referring to our pumpkin data's original question: "predict the price of a pumpkin per bushel by month", `X` would refer to the price and `Y` would refer to the month of sale. 
>
>![complete the equation](../../../../translated_images/calculation.a209813050a1ddb141cdc4bc56f3af31e67157ed499e16a2ecf9837542704c94.ru.png)
>
> Calculate the value of Y. If you're paying around $4, it must be April! Infographic by [Jen Looper](https://twitter.com/jenlooper)
>
> The math that calculates the line must demonstrate the slope of the line, which is also dependent on the intercept, or where `Y` is situated when `X = 0`.
>
> You can observe the method of calculation for these values on the [Math is Fun](https://www.mathsisfun.com/data/least-squares-regression.html) web site. Also visit [this Least-squares calculator](https://www.mathsisfun.com/data/least-squares-calculator.html) to watch how the numbers' values impact the line.

## Correlation

One more term to understand is the **Correlation Coefficient** between given X and Y variables. Using a scatterplot, you can quickly visualize this coefficient. A plot with datapoints scattered in a neat line have high correlation, but a plot with datapoints scattered everywhere between X and Y have a low correlation.

A good linear regression model will be one that has a high (nearer to 1 than 0) Correlation Coefficient using the Least-Squares Regression method with a line of regression.

‚úÖ Run the notebook accompanying this lesson and look at the Month to Price scatterplot. Does the data associating Month to Price for pumpkin sales seem to have high or low correlation, according to your visual interpretation of the scatterplot? Does that change if you use more fine-grained measure instead of `Month`, eg. *day of the year* (i.e. number of days since the beginning of the year)?

In the code below, we will assume that we have cleaned up the data, and obtained a data frame called `new_pumpkins`, similar to the following:

ID | Month | DayOfYear | Variety | City | Package | Low Price | High Price | Price
---|-------|-----------|---------|------|---------|-----------|------------|-------
70 | 9 | 267 | PIE TYPE | BALTIMORE | 1 1/9 bushel cartons | 15.0 | 15.0 | 13.636364
71 | 9 | 267 | PIE TYPE | BALTIMORE | 1 1/9 bushel cartons | 18.0 | 18.0 | 16.363636
72 | 10 | 274 | PIE TYPE | BALTIMORE | 1 1/9 bushel cartons | 18.0 | 18.0 | 16.363636
73 | 10 | 274 | PIE TYPE | BALTIMORE | 1 1/9 bushel cartons | 17.0 | 17.0 | 15.454545
74 | 10 | 281 | PIE TYPE | BALTIMORE | 1 1/9 bushel cartons | 15.0 | 15.0 | 13.636364

> The code to clean the data is available in [`notebook.ipynb`](../../../../2-Regression/3-Linear/notebook.ipynb). We have performed the same cleaning steps as in the previous lesson, and have calculated `DayOfYear` —Å—Ç–æ–ª–±—Ü–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Å–ª–µ–¥—É—é—â–µ–≥–æ –≤—ã—Ä–∞–∂–µ–Ω–∏—è: 

```python
day_of_year = pd.to_datetime(pumpkins['Date']).apply(lambda dt: (dt-datetime(dt.year,1,1)).days)
```

–¢–µ–ø–µ—Ä—å, –∫–æ–≥–¥–∞ –≤—ã –ø–æ–Ω–∏–º–∞–µ—Ç–µ –º–∞—Ç–µ–º–∞—Ç–∏–∫—É, —Å—Ç–æ—è—â—É—é –∑–∞ –ª–∏–Ω–µ–π–Ω–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–µ–π, –¥–∞–≤–∞–π—Ç–µ —Å–æ–∑–¥–∞–¥–∏–º —Ä–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω—É—é –º–æ–¥–µ–ª—å, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å, —Å–º–æ–∂–µ–º –ª–∏ –º—ã –ø—Ä–µ–¥—Å–∫–∞–∑–∞—Ç—å, –∫–∞–∫–æ–π –ø–∞–∫–µ—Ç —Ç—ã–∫–≤ –±—É–¥–µ—Ç –∏–º–µ—Ç—å –ª—É—á—à–∏–µ —Ü–µ–Ω—ã. –ö—Ç–æ-—Ç–æ, –ø–æ–∫—É–ø–∞—é—â–∏–π —Ç—ã–∫–≤—ã –¥–ª—è –ø—Ä–∞–∑–¥–Ω–∏—á–Ω–æ–π —Ç—ã–∫–≤–µ–Ω–Ω–æ–π –ø–ª–∞–Ω—Ç–∞—Ü–∏–∏, –º–æ–∂–µ—Ç –∑–∞—Ö–æ—Ç–µ—Ç—å –∏–º–µ—Ç—å —ç—Ç—É –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é, —á—Ç–æ–±—ã –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å–≤–æ–∏ –ø–æ–∫—É–ø–∫–∏ –ø–∞–∫–µ—Ç–æ–≤ —Ç—ã–∫–≤ –¥–ª—è –ø–ª–∞–Ω—Ç–∞—Ü–∏–∏.

## –ü–æ–∏—Å–∫ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏

[![–ú–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ –¥–ª—è –Ω–∞—á–∏–Ω–∞—é—â–∏—Ö - –ü–æ–∏—Å–∫ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏: –ö–ª—é—á –∫ –ª–∏–Ω–µ–π–Ω–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏](https://img.youtube.com/vi/uoRq-lW2eQo/0.jpg)](https://youtu.be/uoRq-lW2eQo "–ú–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ –¥–ª—è –Ω–∞—á–∏–Ω–∞—é—â–∏—Ö - –ü–æ–∏—Å–∫ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏: –ö–ª—é—á –∫ –ª–∏–Ω–µ–π–Ω–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏")

> üé• –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤—ã—à–µ, —á—Ç–æ–±—ã –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∫–æ—Ä–æ—Ç–∫–æ–µ –≤–∏–¥–µ–æ –æ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏.

–ù–∞ –ø—Ä–µ–¥—ã–¥—É—â–µ–º —É—Ä–æ–∫–µ –≤—ã, –≤–µ—Ä–æ—è—Ç–Ω–æ, –≤–∏–¥–µ–ª–∏, —á—Ç–æ —Å—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞ –∑–∞ —Ä–∞–∑–Ω—ã–µ –º–µ—Å—è—Ü—ã –≤—ã–≥–ª—è–¥–∏—Ç —Ç–∞–∫:

<img alt="–°—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞ –ø–æ –º–µ—Å—è—Ü–∞–º" src="../2-Data/images/barchart.png" width="50%"/>

–≠—Ç–æ –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç, —á—Ç–æ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –∫–∞–∫–∞—è-—Ç–æ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è, –∏ –º—ã –º–æ–∂–µ–º –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –æ–±—É—á–∏—Ç—å –º–æ–¥–µ–ª—å –ª–∏–Ω–µ–π–Ω–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏, —á—Ç–æ–±—ã –ø—Ä–µ–¥—Å–∫–∞–∑–∞—Ç—å –≤–∑–∞–∏–º–æ—Å–≤—è–∑—å –º–µ–∂–¥—É `Month` and `Price`, or between `DayOfYear` and `Price`. Here is the scatter plot that shows the latter relationship:

<img alt="Scatter plot of Price vs. Day of Year" src="images/scatter-dayofyear.png" width="50%" /> 

Let's see if there is a correlation using the `corr` —Ñ—É–Ω–∫—Ü–∏–µ–π:

```python
print(new_pumpkins['Month'].corr(new_pumpkins['Price']))
print(new_pumpkins['DayOfYear'].corr(new_pumpkins['Price']))
```

–ü–æ—Ö–æ–∂–µ, —á—Ç–æ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è –¥–æ–≤–æ–ª—å–Ω–æ –º–∞–ª–∞, -0.15, —Å –ø–æ–º–æ—â—å—é —Ñ—É–Ω–∫—Ü–∏–∏ `Month` and -0.17 by the `DayOfMonth`, but there could be another important relationship. It looks like there are different clusters of prices corresponding to different pumpkin varieties. To confirm this hypothesis, let's plot each pumpkin category using a different color. By passing an `ax` parameter to the `scatter`, –º—ã –º–æ–∂–µ–º –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –≤—Å–µ —Ç–æ—á–∫–∏ –Ω–∞ –æ–¥–Ω–æ–º –≥—Ä–∞—Ñ–∏–∫–µ:

```python
ax=None
colors = ['red','blue','green','yellow']
for i,var in enumerate(new_pumpkins['Variety'].unique()):
    df = new_pumpkins[new_pumpkins['Variety']==var]
    ax = df.plot.scatter('DayOfYear','Price',ax=ax,c=colors[i],label=var)
```

<img alt="–î–∏–∞–≥—Ä–∞–º–º–∞ —Ä–∞—Å—Å–µ—è–Ω–∏—è —Ü–µ–Ω –ø–æ –¥–Ω—è–º –≥–æ–¥–∞" src="images/scatter-dayofyear-color.png" width="50%" /> 

–ù–∞—à–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç, —á—Ç–æ —Å–æ—Ä—Ç –∏–º–µ–µ—Ç –±–æ–ª—å—à–µ–µ –≤–ª–∏—è–Ω–∏–µ –Ω–∞ –æ–±—â—É—é —Ü–µ–Ω—É, —á–µ–º —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∞—è –¥–∞—Ç–∞ –ø—Ä–æ–¥–∞–∂–∏. –ú—ã –º–æ–∂–µ–º —É–≤–∏–¥–µ—Ç—å —ç—Ç–æ –Ω–∞ —Å—Ç–æ–ª–±—á–∞—Ç–æ–π –¥–∏–∞–≥—Ä–∞–º–º–µ:

```python
new_pumpkins.groupby('Variety')['Price'].mean().plot(kind='bar')
```

<img alt="–°—Ç–æ–ª–±—á–∞—Ç–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞ —Ü–µ–Ω—ã –ø–æ —Å–æ—Ä—Ç–∞–º" src="images/price-by-variety.png" width="50%" /> 

–î–∞–≤–∞–π—Ç–µ –Ω–∞ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç —Å–æ—Å—Ä–µ–¥–æ—Ç–æ—á–∏–º—Å—è —Ç–æ–ª—å–∫–æ –Ω–∞ –æ–¥–Ω–æ–π —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–µ —Ç—ã–∫–≤—ã, '–ø–∏—Ä–æ–≥–æ–≤–æ–π', –∏ –ø–æ—Å–º–æ—Ç—Ä–∏–º, –∫–∞–∫–æ–µ –≤–ª–∏—è–Ω–∏–µ –¥–∞—Ç–∞ –æ–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ —Ü–µ–Ω—É:

```python
pie_pumpkins = new_pumpkins[new_pumpkins['Variety']=='PIE TYPE']
pie_pumpkins.plot.scatter('DayOfYear','Price') 
```
<img alt="–î–∏–∞–≥—Ä–∞–º–º–∞ —Ä–∞—Å—Å–µ—è–Ω–∏—è —Ü–µ–Ω –ø–æ –¥–Ω—è–º –≥–æ–¥–∞" src="images/pie-pumpkins-scatter.png" width="50%" /> 

–ï—Å–ª–∏ –º—ã —Ç–µ–ø–µ—Ä—å —Ä–∞—Å—Å—á–∏—Ç–∞–µ–º –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—é –º–µ–∂–¥—É `Price` and `DayOfYear` using `corr` function, we will get something like `-0.27` - —ç—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –æ–±—É—á–µ–Ω–∏–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞—Ç–µ–ª—å–Ω–æ–π –º–æ–¥–µ–ª–∏ –∏–º–µ–µ—Ç —Å–º—ã—Å–ª.

> –ü—Ä–µ–∂–¥–µ —á–µ–º –æ–±—É—á–∞—Ç—å –º–æ–¥–µ–ª—å –ª–∏–Ω–µ–π–Ω–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏, –≤–∞–∂–Ω–æ —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –Ω–∞—à–∏ –¥–∞–Ω–Ω—ã–µ —á–∏—Å—Ç—ã–µ. –õ–∏–Ω–µ–π–Ω–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏—è –ø–ª–æ—Ö–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏, –ø–æ—ç—Ç–æ–º—É –∏–º–µ–µ—Ç —Å–º—ã—Å–ª –∏–∑–±–∞–≤–∏—Ç—å—Å—è –æ—Ç –≤—Å–µ—Ö –ø—É—Å—Ç—ã—Ö —è—á–µ–µ–∫:

```python
pie_pumpkins.dropna(inplace=True)
pie_pumpkins.info()
```

–î—Ä—É–≥–æ–π –ø–æ–¥—Ö–æ–¥ —Å–æ—Å—Ç–æ–∏—Ç –≤ —Ç–æ–º, —á—Ç–æ–±—ã –∑–∞–ø–æ–ª–Ω–∏—Ç—å —ç—Ç–∏ –ø—É—Å—Ç—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è —Å—Ä–µ–¥–Ω–∏–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ –∏–∑ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–≥–æ —Å—Ç–æ–ª–±—Ü–∞.

## –ü—Ä–æ—Å—Ç–∞—è –ª–∏–Ω–µ–π–Ω–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏—è

[![–ú–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ –¥–ª—è –Ω–∞—á–∏–Ω–∞—é—â–∏—Ö - –õ–∏–Ω–µ–π–Ω–∞—è –∏ –ø–æ–ª–∏–Ω–æ–º–∏–∞–ª—å–Ω–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Scikit-learn](https://img.youtube.com/vi/e4c_UP2fSjg/0.jpg)](https://youtu.be/e4c_UP2fSjg "–ú–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ –¥–ª—è –Ω–∞—á–∏–Ω–∞—é—â–∏—Ö - –õ–∏–Ω–µ–π–Ω–∞—è –∏ –ø–æ–ª–∏–Ω–æ–º–∏–∞–ª—å–Ω–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Scikit-learn")

> üé• –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤—ã—à–µ, —á—Ç–æ–±—ã –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∫–æ—Ä–æ—Ç–∫–æ–µ –≤–∏–¥–µ–æ –æ –ª–∏–Ω–µ–π–Ω–æ–π –∏ –ø–æ–ª–∏–Ω–æ–º–∏–∞–ª—å–Ω–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏.

–î–ª—è –æ–±—É—á–µ–Ω–∏—è –Ω–∞—à–µ–π –º–æ–¥–µ–ª–∏ –ª–∏–Ω–µ–π–Ω–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ –º—ã –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫—É **Scikit-learn**.

```python
from sklearn.linear_model import LinearRegression
from sklearn.metrics import mean_squared_error
from sklearn.model_selection import train_test_split
```

–ú—ã –Ω–∞—á–∏–Ω–∞–µ–º —Å —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π (–ø—Ä–∏–∑–Ω–∞–∫–æ–≤) –∏ –æ–∂–∏–¥–∞–µ–º–æ–≥–æ –≤—ã–≤–æ–¥–∞ (–º–µ—Ç–∫–∏) –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω—ã–µ –º–∞—Å—Å–∏–≤—ã numpy:

```python
X = pie_pumpkins['DayOfYear'].to_numpy().reshape(-1,1)
y = pie_pumpkins['Price']
```

> –û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –Ω–∞–º –ø—Ä–∏—à–ª–æ—Å—å –≤—ã–ø–æ–ª–Ω–∏—Ç—å `reshape` –Ω–∞ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, —á—Ç–æ–±—ã –ø–∞–∫–µ—Ç –ª–∏–Ω–µ–π–Ω–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –µ–≥–æ –ø–æ–Ω—è–ª. –õ–∏–Ω–µ–π–Ω–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏—è –æ–∂–∏–¥–∞–µ—Ç 2D-–º–∞—Å—Å–∏–≤ –≤ –∫–∞—á–µ—Å—Ç–≤–µ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, –≥–¥–µ –∫–∞–∂–¥–∞—è —Å—Ç—Ä–æ–∫–∞ –º–∞—Å—Å–∏–≤–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –≤–µ–∫—Ç–æ—Ä—É –≤—Ö–æ–¥–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤. –í –Ω–∞—à–µ–º —Å–ª—É—á–∞–µ, –ø–æ—Å–∫–æ–ª—å–∫—É —É –Ω–∞—Å —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω –≤—Ö–æ–¥ - –Ω–∞–º –Ω—É–∂–µ–Ω –º–∞—Å—Å–∏–≤ —Å —Ñ–æ—Ä–º–æ–π N√ó1, –≥–¥–µ N - —ç—Ç–æ —Ä–∞–∑–º–µ—Ä –Ω–∞–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö.

–ó–∞—Ç–µ–º –Ω–∞–º –Ω—É–∂–Ω–æ —Ä–∞–∑–¥–µ–ª–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –Ω–∞ –æ–±—É—á–∞—é—â–∏–µ –∏ —Ç–µ—Å—Ç–æ–≤—ã–µ –Ω–∞–±–æ—Ä—ã –¥–∞–Ω–Ω—ã—Ö, —á—Ç–æ–±—ã –º—ã –º–æ–≥–ª–∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞—à—É –º–æ–¥–µ–ª—å –ø–æ—Å–ª–µ –æ–±—É—á–µ–Ω–∏—è:

```python
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=0)
```

–ù–∞–∫–æ–Ω–µ—Ü, –æ–±—É—á–µ–Ω–∏–µ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–æ–π –º–æ–¥–µ–ª–∏ –ª–∏–Ω–µ–π–Ω–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ –∑–∞–Ω–∏–º–∞–µ—Ç –≤—Å–µ–≥–æ –¥–≤–µ —Å—Ç—Ä–æ–∫–∏ –∫–æ–¥–∞. –ú—ã –æ–ø—Ä–µ–¥–µ–ª—è–µ–º –º–µ—Ç–æ–¥ `LinearRegression` object, and fit it to our data using the `fit`:

```python
lin_reg = LinearRegression()
lin_reg.fit(X_train,y_train)
```

`LinearRegression` object after `fit`-ting contains all the coefficients of the regression, which can be accessed using `.coef_` property. In our case, there is just one coefficient, which should be around `-0.017`. It means that prices seem to drop a bit with time, but not too much, around 2 cents per day. We can also access the intersection point of the regression with Y-axis using `lin_reg.intercept_` - it will be around `21` –≤ –Ω–∞—à–µ–º —Å–ª—É—á–∞–µ, —É–∫–∞–∑—ã–≤–∞—è –Ω–∞ —Ü–µ–Ω—É –≤ –Ω–∞—á–∞–ª–µ –≥–æ–¥–∞.

–ß—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å, –Ω–∞—Å–∫–æ–ª—å–∫–æ —Ç–æ—á–Ω–∞ –Ω–∞—à–∞ –º–æ–¥–µ–ª—å, –º—ã –º–æ–∂–µ–º –ø—Ä–µ–¥—Å–∫–∞–∑–∞—Ç—å —Ü–µ–Ω—ã –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–º –Ω–∞–±–æ—Ä–µ –¥–∞–Ω–Ω—ã—Ö, –∞ –∑–∞—Ç–µ–º –∏–∑–º–µ—Ä–∏—Ç—å, –Ω–∞—Å–∫–æ–ª—å–∫–æ –±–ª–∏–∑–∫–∏ –Ω–∞—à–∏ –ø—Ä–æ–≥–Ω–æ–∑—ã –∫ –æ–∂–∏–¥–∞–µ–º—ã–º –∑–Ω–∞—á–µ–Ω–∏—è–º. –≠—Ç–æ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å —Å –ø–æ–º–æ—â—å—é –º–µ—Ç—Ä–∏–∫–∏ —Å—Ä–µ–¥–Ω–µ–∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω–æ–π –æ—à–∏–±–∫–∏ (MSE), –∫–æ—Ç–æ—Ä–∞—è —è–≤–ª—è–µ—Ç—Å—è —Å—Ä–µ–¥–Ω–∏–º –≤—Å–µ—Ö –∫–≤–∞–¥—Ä–∞—Ç–æ–≤ —Ä–∞–∑–Ω–æ—Å—Ç–µ–π –º–µ–∂–¥—É –æ–∂–∏–¥–∞–µ–º—ã–º –∏ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏–µ–º.

```python
pred = lin_reg.predict(X_test)

mse = np.sqrt(mean_squared_error(y_test,pred))
print(f'Mean error: {mse:3.3} ({mse/np.mean(pred)*100:3.3}%)')
```

–ù–∞—à–∞ –æ—à–∏–±–∫–∞, –ø–æ—Ö–æ–∂–µ, —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç –æ–∫–æ–ª–æ 2 –ø—É–Ω–∫—Ç–æ–≤, —á—Ç–æ —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç ~17%. –ù–µ –æ—á–µ–Ω—å —Ö–æ—Ä–æ—à–æ. –î—Ä—É–≥–∏–º –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–º –∫–∞—á–µ—Å—Ç–≤–∞ –º–æ–¥–µ–ª–∏ —è–≤–ª—è–µ—Ç—Å—è **–∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –¥–µ—Ç–µ—Ä–º–∏–Ω–∞—Ü–∏–∏**, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:

```python
score = lin_reg.score(X_train,y_train)
print('Model determination: ', score)
```
–ï—Å–ª–∏ –∑–Ω–∞—á–µ–Ω–∏–µ —Ä–∞–≤–Ω–æ 0, —ç—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –º–æ–¥–µ–ª—å –Ω–µ —É—á–∏—Ç—ã–≤–∞–µ—Ç –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏ –¥–µ–π—Å—Ç–≤—É–µ—Ç –∫–∞–∫ *—Ö—É–¥—à–∏–π –ª–∏–Ω–µ–π–Ω—ã–π –ø—Ä–µ–¥—Å–∫–∞–∑–∞—Ç–µ–ª—å*, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–æ—Å—Ç–æ —è–≤–ª—è–µ—Ç—Å—è —Å—Ä–µ–¥–Ω–∏–º –∑–Ω–∞—á–µ–Ω–∏–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞. –ó–Ω–∞—á–µ–Ω–∏–µ 1 –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –º—ã –º–æ–∂–µ–º –∏–¥–µ–∞–ª—å–Ω–æ –ø—Ä–µ–¥—Å–∫–∞–∑–∞—Ç—å –≤—Å–µ –æ–∂–∏–¥–∞–µ–º—ã–µ –≤—ã—Ö–æ–¥—ã. –í –Ω–∞—à–µ–º —Å–ª—É—á–∞–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç –æ–∫–æ–ª–æ 0.06, —á—Ç–æ –¥–æ–≤–æ–ª—å–Ω–æ –Ω–∏–∑–∫–æ.

–ú—ã —Ç–∞–∫–∂–µ –º–æ–∂–µ–º –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –≤–º–µ—Å—Ç–µ —Å —Ä–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω–æ–π –ª–∏–Ω–∏–µ–π, —á—Ç–æ–±—ã –ª—É—á—à–µ —É–≤–∏–¥–µ—Ç—å, –∫–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ä–µ–≥—Ä–µ—Å—Å–∏—è –≤ –Ω–∞—à–µ–º —Å–ª—É—á–∞–µ:

```python
plt.scatter(X_test,y_test)
plt.plot(X_test,pred)
```

<img alt="–õ–∏–Ω–µ–π–Ω–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏—è" src="images/linear-results.png" width="50%" />

## –ü–æ–ª–∏–Ω–æ–º–∏–∞–ª—å–Ω–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏—è

–î—Ä—É–≥–∏–º —Ç–∏–ø–æ–º –ª–∏–Ω–µ–π–Ω–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ —è–≤–ª—è–µ—Ç—Å—è –ø–æ–ª–∏–Ω–æ–º–∏–∞–ª—å–Ω–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏—è. –•–æ—Ç—è –∏–Ω–æ–≥–¥–∞ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏–Ω–µ–π–Ω–∞—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –º–µ–∂–¥—É –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ - —á–µ–º –±–æ–ª—å—à–µ —Ç—ã–∫–≤–∞ –ø–æ –æ–±—ä–µ–º—É, —Ç–µ–º –≤—ã—à–µ —Ü–µ–Ω–∞ - –∏–Ω–æ–≥–¥–∞ —ç—Ç–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –Ω–µ–ª—å–∑—è –∏–∑–æ–±—Ä–∞–∑–∏—Ç—å –∫–∞–∫ –ø–ª–æ—Å–∫–æ—Å—Ç—å –∏–ª–∏ –ø—Ä—è–º—É—é –ª–∏–Ω–∏—é. 

‚úÖ –í–æ—Ç [–Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã](https://online.stat.psu.edu/stat501/lesson/9/9.8) –¥–∞–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–æ–ª–∏–Ω–æ–º–∏–∞–ª—å–Ω—É—é —Ä–µ–≥—Ä–µ—Å—Å–∏—é.

–ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –µ—â–µ —Ä–∞–∑ –Ω–∞ –≤–∑–∞–∏–º–æ—Å–≤—è–∑—å –º–µ–∂–¥—É –¥–∞—Ç–æ–π –∏ —Ü–µ–Ω–æ–π. –ö–∞–∂–µ—Ç—Å—è –ª–∏ –≤–∞–º, —á—Ç–æ —ç—Ç–æ—Ç –≥—Ä–∞—Ñ–∏–∫ —Ä–∞—Å—Å–µ—è–Ω–∏—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –Ω—É–∂–Ω–æ –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å –ø–æ–º–æ—â—å—é –ø—Ä—è–º–æ–π –ª–∏–Ω–∏–∏? –ù–µ –º–æ–≥—É—Ç –ª–∏ —Ü–µ–Ω—ã –∫–æ–ª–µ–±–∞—Ç—å—Å—è? –í —ç—Ç–æ–º —Å–ª—É—á–∞–µ –≤—ã –º–æ–∂–µ—Ç–µ –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –ø–æ–ª–∏–Ω–æ–º–∏–∞–ª—å–Ω—É—é —Ä–µ–≥—Ä–µ—Å—Å–∏—é.

‚úÖ –ü–æ–ª–∏–Ω–æ–º—ã - —ç—Ç–æ –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç —Å–æ—Å—Ç–æ—è—Ç—å –∏–∑ –æ–¥–Ω–æ–π –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –∏ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤.

–ü–æ–ª–∏–Ω–æ–º–∏–∞–ª—å–Ω–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏—è —Å–æ–∑–¥–∞–µ—Ç –∫—Ä–∏–≤—É—é –ª–∏–Ω–∏—é, —á—Ç–æ–±—ã –ª—É—á—à–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –Ω–µ–ª–∏–Ω–µ–π–Ω—ã–º –¥–∞–Ω–Ω—ã–º. –í –Ω–∞—à–µ–º —Å–ª—É—á–∞–µ, –µ—Å–ª–∏ –º—ã –≤–∫–ª—é—á–∏–º –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é `DayOfYear`, –≤–æ–∑–≤–µ–¥–µ–Ω–Ω—É—é –≤ –∫–≤–∞–¥—Ä–∞—Ç, –≤ –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, –º—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ –ø–æ–¥–æ–≥–Ω–∞—Ç—å –Ω–∞—à–∏ –¥–∞–Ω–Ω—ã–µ —Å –ø–æ–º–æ—â—å—é –ø–∞—Ä–∞–±–æ–ª–∏—á–µ—Å–∫–æ–π –∫—Ä–∏–≤–æ–π, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –∏–º–µ—Ç—å –º–∏–Ω–∏–º—É–º –≤ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–π —Ç–æ—á–∫–µ –≤ —Ç–µ—á–µ–Ω–∏–µ –≥–æ–¥–∞.

Scikit-learn –≤–∫–ª—é—á–∞–µ—Ç –ø–æ–ª–µ–∑–Ω—ã–π [pipeline API](https://scikit-learn.org/stable/modules/generated/sklearn.pipeline.make_pipeline.html?highlight=pipeline#sklearn.pipeline.make_pipeline), —á—Ç–æ–±—ã –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å —Ä–∞–∑–ª–∏—á–Ω—ã–µ —ç—Ç–∞–ø—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö –≤–º–µ—Å—Ç–µ. **Pipeline** - —ç—Ç–æ —Ü–µ–ø–æ—á–∫–∞ **–æ—Ü–µ–Ω—â–∏–∫–æ–≤**. –í –Ω–∞—à–µ–º —Å–ª—É—á–∞–µ –º—ã —Å–æ–∑–¥–∞–¥–∏–º pipeline, –∫–æ—Ç–æ—Ä—ã–π —Å–Ω–∞—á–∞–ª–∞ –¥–æ–±–∞–≤–∏—Ç –ø–æ–ª–∏–Ω–æ–º–∏–∞–ª—å–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ –≤ –Ω–∞—à—É –º–æ–¥–µ–ª—å, –∞ –∑–∞—Ç–µ–º –æ–±—É—á–∏—Ç —Ä–µ–≥—Ä–µ—Å—Å–∏—é:

```python
from sklearn.preprocessing import PolynomialFeatures
from sklearn.pipeline import make_pipeline

pipeline = make_pipeline(PolynomialFeatures(2), LinearRegression())

pipeline.fit(X_train,y_train)
```

–ò—Å–ø–æ–ª—å–∑—É—è `PolynomialFeatures(2)` means that we will include all second-degree polynomials from the input data. In our case it will just mean `DayOfYear`<sup>2</sup>, but given two input variables X and Y, this will add X<sup>2</sup>, XY and Y<sup>2</sup>. We may also use higher degree polynomials if we want.

Pipelines can be used in the same manner as the original `LinearRegression` object, i.e. we can `fit` the pipeline, and then use `predict` to get the prediction results. Here is the graph showing test data, and the approximation curve:

<img alt="Polynomial regression" src="images/poly-results.png" width="50%" />

Using Polynomial Regression, we can get slightly lower MSE and higher determination, but not significantly. We need to take into account other features!

> You can see that the minimal pumpkin prices are observed somewhere around Halloween. How can you explain this? 

üéÉ Congratulations, you just created a model that can help predict the price of pie pumpkins. You can probably repeat the same procedure for all pumpkin types, but that would be tedious. Let's learn now how to take pumpkin variety into account in our model!

## Categorical Features

In the ideal world, we want to be able to predict prices for different pumpkin varieties using the same model. However, the `Variety` column is somewhat different from columns like `Month`, because it contains non-numeric values. Such columns are called **categorical**.

[![ML for beginners - Categorical Feature Predictions with Linear Regression](https://img.youtube.com/vi/DYGliioIAE0/0.jpg)](https://youtu.be/DYGliioIAE0 "ML for beginners - Categorical Feature Predictions with Linear Regression")

> üé• Click the image above for a short video overview of using categorical features.

Here you can see how average price depends on variety:

<img alt="Average price by variety" src="images/price-by-variety.png" width="50%" />

To take variety into account, we first need to convert it to numeric form, or **encode** it. There are several way we can do it:

* Simple **numeric encoding** will build a table of different varieties, and then replace the variety name by an index in that table. This is not the best idea for linear regression, because linear regression takes the actual numeric value of the index, and adds it to the result, multiplying by some coefficient. In our case, the relationship between the index number and the price is clearly non-linear, even if we make sure that indices are ordered in some specific way.
* **One-hot encoding** will replace the `Variety` column by 4 different columns, one for each variety. Each column will contain `1` if the corresponding row is of a given variety, and `0`, –∏–Ω–∞—á–µ. –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –≤ –ª–∏–Ω–µ–π–Ω–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ –±—É–¥–µ—Ç —á–µ—Ç—ã—Ä–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞, –ø–æ –æ–¥–Ω–æ–º—É –¥–ª—è –∫–∞–∂–¥–æ–π —Å–æ—Ä—Ç–∞ —Ç—ã–∫–≤—ã, –æ—Ç–≤–µ—á–∞—é—â–µ–≥–æ –∑–∞ "–Ω–∞—á–∞–ª—å–Ω—É—é —Ü–µ–Ω—É" (–∏–ª–∏ —Å–∫–æ—Ä–µ–µ "–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—É—é —Ü–µ–Ω—É") –¥–ª—è —ç—Ç–æ–≥–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å–æ—Ä—Ç–∞.

–ö–æ–¥ –Ω–∏–∂–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –∫–∞–∫ –º—ã –º–æ–∂–µ–º –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞—Ç—å —Å–æ—Ä—Ç —Å –ø–æ–º–æ—â—å—é one-hot:

```python
pd.get_dummies(new_pumpkins['Variety'])
```

 ID | –°–ö–ê–ó–ö–ê | –ú–ò–ù–ò–ê–¢–Æ–†–ê | –°–ú–ï–°–¨ –°–¢–ê–†–ò–ù–ù–´–• –°–û–†–¢–û–í | –ü–ò–†–û–ì
----|-----------|-----------|--------------------------|----------
70 | 0 | 0 | 0 | 1
71 | 0 | 0 | 0 | 1
... | ... | ... | ... | ...
1738 | 0 | 1 | 0 | 0
1739 | 0 | 1 | 0 | 0
1740 | 0 | 1 | 0 | 0
1741 | 0 | 1 | 0 | 0
1742 | 0 | 1 | 0 | 0

–ß—Ç–æ–±—ã –æ–±—É—á–∏—Ç—å –ª–∏–Ω–µ–π–Ω—É—é —Ä–µ–≥—Ä–µ—Å—Å–∏—é, –∏—Å–ø–æ–ª—å–∑—É—è –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω—É—é —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫—É –∫–∞–∫ –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, –Ω–∞–º –ø—Ä–æ—Å—Ç–æ –Ω—É–∂–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ `X` and `y`:

```python
X = pd.get_dummies(new_pumpkins['Variety'])
y = new_pumpkins['Price']
```

–û—Å—Ç–∞–ª—å–Ω–∞—è —á–∞—Å—Ç—å –∫–æ–¥–∞ —Ç–∞–∫–∞—è –∂–µ, –∫–∞–∫ –∏ —Ç–∞, –∫–æ—Ç–æ—Ä—É—é –º—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ –≤—ã—à–µ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –ª–∏–Ω–µ–π–Ω–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏. –ï—Å–ª–∏ –≤—ã –ø–æ–ø—Ä–æ–±—É–µ—Ç–µ, –≤—ã —É–≤–∏–¥–∏—Ç–µ, —á—Ç–æ —Å—Ä–µ–¥–Ω–µ–∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω–∞—è –æ—à–∏–±–∫–∞ –ø—Ä–∏–º–µ—Ä–Ω–æ —Ç–∞–∫–∞—è –∂–µ, –Ω–æ –º—ã –ø–æ–ª—É—á–∞–µ–º –≥–æ—Ä–∞–∑–¥–æ –±–æ–ª–µ–µ –≤—ã—Å–æ–∫–∏–π –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –¥–µ—Ç–µ—Ä–º–∏–Ω–∞—Ü–∏–∏ (~77%). –ß—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –µ—â–µ –±–æ–ª–µ–µ —Ç–æ—á–Ω—ã–µ –ø—Ä–æ–≥–Ω–æ–∑—ã, –º—ã –º–æ–∂–µ–º —É—á–∏—Ç—ã–≤–∞—Ç—å –±–æ–ª—å—à–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤, –∞ —Ç–∞–∫–∂–µ —á–∏—Å–ª–æ–≤—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏, —Ç–∞–∫–∏–µ –∫–∞–∫ `Month` or `DayOfYear`. To get one large array of features, we can use `join`:

```python
X = pd.get_dummies(new_pumpkins['Variety']) \
        .join(new_pumpkins['Month']) \
        .join(pd.get_dummies(new_pumpkins['City'])) \
        .join(pd.get_dummies(new_pumpkins['Package']))
y = new_pumpkins['Price']
```

–ó–¥–µ—Å—å –º—ã —Ç–∞–∫–∂–µ —É—á–∏—Ç—ã–≤–∞–µ–º —Ç–∏–ø `City` and `Package`, —á—Ç–æ –¥–∞–µ—Ç –Ω–∞–º MSE 2.84 (10%) –∏ –¥–µ—Ç–µ—Ä–º–∏–Ω–∞—Ü–∏—é 0.94!

## –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –≤—Å–µ–≥–æ –≤–æ–µ–¥–∏–Ω–æ

–ß—Ç–æ–±—ã —Å–æ–∑–¥–∞—Ç—å –ª—É—á—à—É—é –º–æ–¥–µ–ª—å, –º—ã –º–æ–∂–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—ã–µ (one-hot –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–µ + —á–∏—Å–ª–æ–≤—ã–µ) –¥–∞–Ω–Ω—ã–µ –∏–∑ –ø—Ä–∏–≤–µ–¥–µ–Ω–Ω–æ–≥–æ –≤—ã—à–µ –ø—Ä–∏–º–µ—Ä–∞ –≤–º–µ—Å—Ç–µ —Å –ø–æ–ª–∏–Ω–æ–º–∏–∞–ª—å–Ω–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–µ–π. –í–æ—Ç –ø–æ–ª–Ω—ã–π –∫–æ–¥ –¥–ª—è –≤–∞—à–µ–≥–æ —É–¥–æ–±—Å—Ç–≤–∞:

```python
# set up training data
X = pd.get_dummies(new_pumpkins['Variety']) \
        .join(new_pumpkins['Month']) \
        .join(pd.get_dummies(new_pumpkins['City'])) \
        .join(pd.get_dummies(new_pumpkins['Package']))
y = new_pumpkins['Price']

# make train-test split
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=0)

# setup and train the pipeline
pipeline = make_pipeline(PolynomialFeatures(2), LinearRegression())
pipeline.fit(X_train,y_train)

# predict results for test data
pred = pipeline.predict(X_test)

# calculate MSE and determination
mse = np.sqrt(mean_squared_error(y_test,pred))
print(f'Mean error: {mse:3.3} ({mse/np.mean(pred)*100:3.3}%)')

score = pipeline.score(X_train,y_train)
print('Model determination: ', score)
```

–≠—Ç–æ –¥–æ–ª–∂–Ω–æ –¥–∞—Ç—å –Ω–∞–º –ª—É—á—à–∏–π –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –¥–µ—Ç–µ—Ä–º–∏–Ω–∞—Ü–∏–∏ –ø–æ—á—Ç–∏ 97%, –∏ MSE=2.23 (~8% –æ—à–∏–±–∫–∞ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è).

| –ú–æ–¥–µ–ª—å | MSE | –î–µ—Ç–µ—Ä–º–∏–Ω–∞—Ü–∏—è |
|-------|-----|---------------|
| `DayOfYear` Linear | 2.77 (17.2%) | 0.07 |
| `DayOfYear` Polynomial | 2.73 (17.0%) | 0.08 |
| `Variety` –õ–∏–Ω–µ–π–Ω–∞—è | 5.24 (19.7%) | 0.77 |
| –í—Å–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ –õ–∏–Ω–µ–π–Ω–∞—è | 2.84 (10.5%) | 0.94 |
| –í—Å–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ –ü–æ–ª–∏–Ω–æ–º–∏–∞–ª—å–Ω–∞—è | 2.23 (8.25%) | 0.97 |

üèÜ –û—Ç–ª–∏—á–Ω–æ! –í—ã —Å–æ–∑–¥–∞–ª–∏ —á–µ—Ç—ã—Ä–µ —Ä–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏ –∑–∞ –æ–¥–∏–Ω —É—Ä–æ–∫ –∏ —É–ª—É—á—à–∏–ª–∏ –∫–∞—á–µ—Å—Ç–≤–æ –º–æ–¥–µ–ª–∏ –¥–æ 97%. –í –ø–æ—Å–ª–µ–¥–Ω–µ–º —Ä–∞–∑–¥–µ–ª–µ –æ —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ –≤—ã —É–∑–Ω–∞–µ—Ç–µ –æ –ª–æ–≥–∏—Å—Ç–∏—á–µ—Å–∫–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∫–∞—Ç–µ–≥–æ—Ä–∏–π. 

---
## üöÄ–ó–∞–¥–∞—á–∞

–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –≤ —ç—Ç–æ–º –±–ª–æ–∫–Ω–æ—Ç–µ, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å, –∫–∞–∫ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ç–æ—á–Ω–æ—Å—Ç–∏ –º–æ–¥–µ–ª–∏.

## [–í–∏–∫—Ç–æ—Ä–∏–Ω–∞ –ø–æ—Å–ª–µ –ª–µ–∫—Ü–∏–∏](https://gray-sand-07a10f403.1.azurestaticapps.net/quiz/14/)

## –û–±–∑–æ—Ä –∏ —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ–µ –∏–∑—É—á–µ–Ω–∏–µ

–í —ç—Ç–æ–º —É—Ä–æ–∫–µ –º—ã —É–∑–Ω–∞–ª–∏ –æ –ª–∏–Ω–µ–π–Ω–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏. –°—É—â–µ—Å—Ç–≤—É—é—Ç –∏ –¥—Ä—É–≥–∏–µ –≤–∞–∂–Ω—ã–µ —Ç–∏–ø—ã —Ä–µ–≥—Ä–µ—Å—Å–∏–∏. –û–∑–Ω–∞–∫–æ–º—å—Ç–µ—Å—å —Å —Ç–µ—Ö–Ω–∏–∫–∞–º–∏ –ø–æ—à–∞–≥–æ–≤–æ–π, –≥—Ä–µ–±–Ω–µ–≤–æ–π, –ª–∞—Å—Å–æ –∏ —ç–ª–∞—Å—Ç–∏—á–Ω–æ–π —Å–µ—Ç–∫–∏. –•–æ—Ä–æ—à–∏–π –∫—É—Ä—Å –¥–ª—è –∏–∑—É—á–µ–Ω–∏—è, —á—Ç–æ–±—ã —É–∑–Ω–∞—Ç—å –±–æ–ª—å—à–µ, —ç—Ç–æ [–∫—É—Ä—Å –°—Ç—ç–Ω—Ñ–æ—Ä–¥—Å–∫–æ–≥–æ —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–∞ –ø–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–æ–º—É –æ–±—É—á–µ–Ω–∏—é](https://online.stanford.edu/courses/sohs-ystatslearning-statistical-learning).

## –ó–∞–¥–∞–Ω–∏–µ 

[–ü–æ—Å—Ç—Ä–æ–∏—Ç—å –º–æ–¥–µ–ª—å](assignment.md)

**–û—Ç–∫–∞–∑ –æ—Ç –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏**:  
–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –±—ã–ª –ø–µ—Ä–µ–≤–µ–¥–µ–Ω —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —É—Å–ª—É–≥ –º–∞—à–∏–Ω–Ω–æ–≥–æ –ø–µ—Ä–µ–≤–æ–¥–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ò–ò. –•–æ—Ç—è –º—ã —Å—Ç—Ä–µ–º–∏–º—Å—è –∫ —Ç–æ—á–Ω–æ—Å—Ç–∏, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –∏–º–µ–π—Ç–µ –≤ –≤–∏–¥—É, —á—Ç–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø–µ—Ä–µ–≤–æ–¥—ã –º–æ–≥—É—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –æ—à–∏–±–∫–∏ –∏–ª–∏ –Ω–µ—Ç–æ—á–Ω–æ—Å—Ç–∏. –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π –¥–æ–∫—É–º–µ–Ω—Ç –Ω–∞ —Ä–æ–¥–Ω–æ–º —è–∑—ã–∫–µ —Å–ª–µ–¥—É–µ—Ç —Å—á–∏—Ç–∞—Ç—å –∞–≤—Ç–æ—Ä–∏—Ç–µ—Ç–Ω—ã–º –∏—Å—Ç–æ—á–Ω–∏–∫–æ–º. –î–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π —á–µ–ª–æ–≤–µ—á–µ—Å–∫–∏–π –ø–µ—Ä–µ–≤–æ–¥. –ú—ã –Ω–µ –Ω–µ—Å–µ–º –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ –∑–∞ –ª—é–±—ã–µ –Ω–µ–¥–æ—Ä–∞–∑—É–º–µ–Ω–∏—è –∏–ª–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏, –≤–æ–∑–Ω–∏–∫–∞—é—â–∏–µ –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —ç—Ç–æ–≥–æ –ø–µ—Ä–µ–≤–æ–¥–∞.