<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "f80e513b3279869e7661e3190cc83076",
  "translation_date": "2025-09-03T22:53:53+00:00",
  "source_file": "7-TimeSeries/3-SVR/README.md",
  "language_code": "fa"
}
-->
# ูพุดโุจู ุณุฑโูุง ุฒูุงู ุจุง ุงุณุชูุงุฏู ุงุฒ ูุฏู Support Vector Regressor

ุฏุฑ ุฏุฑุณ ูุจูุ ุงุฏ ฺฏุฑูุชุฏ ฺฉู ฺฺฏููู ุงุฒ ูุฏู ARIMA ุจุฑุง ูพุดโุจู ุณุฑโูุง ุฒูุงู ุงุณุชูุงุฏู ฺฉูุฏ. ุงฺฉููู ุจู ูุฏู Support Vector Regressor ูโูพุฑุฏุงุฒู ฺฉู ฺฉ ูุฏู ุฑฺฏุฑุณูู ุจุฑุง ูพุดโุจู ุฏุงุฏูโูุง ูพูุณุชู ุงุณุช.

## [ุขุฒููู ูพุด ุงุฒ ุฏุฑุณ](https://gray-sand-07a10f403.1.azurestaticapps.net/quiz/51/) 

## ููุฏูู

ุฏุฑ ุงู ุฏุฑุณุ ุจุง ุฑูุด ุฎุงุต ุจุฑุง ุณุงุฎุช ูุฏูโูุง ุจุง [**SVM**: **ูุงุดู ุจุฑุฏุงุฑ ูพุดุชุจุงู**](https://en.wikipedia.org/wiki/Support-vector_machine) ุจุฑุง ุฑฺฏุฑุณููุ ุง **SVR: Support Vector Regressor** ุขุดูุง ุฎูุงูุฏ ุดุฏ.

### SVR ุฏุฑ ุฒููู ุณุฑโูุง ุฒูุงู [^1]

ูุจู ุงุฒ ุฏุฑฺฉ ุงููุช SVR ุฏุฑ ูพุดโุจู ุณุฑโูุง ุฒูุงูุ ุจุฑุฎ ุงุฒ ููุงูู ููู ฺฉู ุจุงุฏ ุจุฏุงูุฏ ุนุจุงุฑุชูุฏ ุงุฒ:

- **ุฑฺฏุฑุณูู:** ุชฺฉูฺฉ ุงุฏฺฏุฑ ูุธุงุฑุชโุดุฏู ุจุฑุง ูพุดโุจู ููุงุฏุฑ ูพูุณุชู ุงุฒ ูุฌููุนูโุง ุงุฒ ูุฑูุฏโูุง. ุงุฏู ุงู ุงุณุช ฺฉู ฺฉ ููุญู (ุง ุฎุท) ุฏุฑ ูุถุง ูฺฺฏโูุง ูพุฏุง ุดูุฏ ฺฉู ุจุดุชุฑู ุชุนุฏุงุฏ ููุงุท ุฏุงุฏู ุฑุง ุดุงูู ุดูุฏ. [ุงูุฌุง ฺฉูฺฉ ฺฉูุฏ](https://en.wikipedia.org/wiki/Regression_analysis) ุจุฑุง ุงุทูุงุนุงุช ุจุดุชุฑ.
- **ูุงุดู ุจุฑุฏุงุฑ ูพุดุชุจุงู (SVM):** ููุน ูุฏู ุงุฏฺฏุฑ ูุงุดู ูุธุงุฑุชโุดุฏู ฺฉู ุจุฑุง ุทุจููโุจูุฏุ ุฑฺฏุฑุณูู ู ุชุดุฎุต ููุงุท ุฎุงุฑุฌ ุงุฒ ูุญุฏูุฏู ุงุณุชูุงุฏู ูโุดูุฏ. ุงู ูุฏู ฺฉ ุงุจุฑุตูุญู ุฏุฑ ูุถุง ูฺฺฏโูุง ุงุณุช ฺฉู ุฏุฑ ููุฑุฏ ุทุจููโุจูุฏ ุจู ุนููุงู ูุฑุฒ ุนูู ูโฺฉูุฏ ู ุฏุฑ ููุฑุฏ ุฑฺฏุฑุณูู ุจู ุนููุงู ุฎุท ุจูุชุฑู ุจุฑุงุฒุด. ุฏุฑ SVMุ ูุนูููุงู ุงุฒ ฺฉ ุชุงุจุน Kernel ุจุฑุง ุชุจุฏู ูุฌููุนู ุฏุงุฏู ุจู ูุถุง ุจุง ุงุจุนุงุฏ ุจุงูุงุชุฑ ุงุณุชูุงุฏู ูโุดูุฏ ุชุง ุจุชูุงู ุขูโูุง ุฑุง ุจู ุฑุงุญุช ุฌุฏุง ฺฉุฑุฏ. [ุงูุฌุง ฺฉูฺฉ ฺฉูุฏ](https://en.wikipedia.org/wiki/Support-vector_machine) ุจุฑุง ุงุทูุงุนุงุช ุจุดุชุฑ ุฏุฑุจุงุฑู SVM.
- **Support Vector Regressor (SVR):** ููุน SVM ฺฉู ุฎุท ุจูุชุฑู ุจุฑุงุฒุด (ฺฉู ุฏุฑ ููุฑุฏ SVM ฺฉ ุงุจุฑุตูุญู ุงุณุช) ุฑุง ูพุฏุง ูโฺฉูุฏ ฺฉู ุจุดุชุฑู ุชุนุฏุงุฏ ููุงุท ุฏุงุฏู ุฑุง ุดุงูู ุดูุฏ.

### ฺุฑุง SVRุ [^1]

ุฏุฑ ุฏุฑุณ ูุจู ุฏุฑุจุงุฑู ARIMA ุงุฏ ฺฏุฑูุชุฏุ ฺฉู ฺฉ ุฑูุด ุขูุงุฑ ุฎุท ุจุณุงุฑ ูููู ุจุฑุง ูพุดโุจู ุฏุงุฏูโูุง ุณุฑโูุง ุฒูุงู ุงุณุช. ุจุง ุงู ุญุงูุ ุฏุฑ ุจุณุงุฑ ุงุฒ ููุงุฑุฏุ ุฏุงุฏูโูุง ุณุฑโูุง ุฒูุงู ุฏุงุฑุง *ุบุฑุฎุท ุจูุฏู* ูุณุชูุฏ ฺฉู ููโุชูุงููุฏ ุชูุณุท ูุฏูโูุง ุฎุท ููุดูโุจุฑุฏุงุฑ ุดููุฏ. ุฏุฑ ฺูู ููุงุฑุฏุ ุชูุงูุง SVM ุฏุฑ ุฏุฑ ูุธุฑ ฺฏุฑูุชู ุบุฑุฎุท ุจูุฏู ุฏุงุฏูโูุง ุจุฑุง ูุธุงู ุฑฺฏุฑุณููุ SVR ุฑุง ุฏุฑ ูพุดโุจู ุณุฑโูุง ุฒูุงู ูููู ูโฺฉูุฏ.

## ุชูุฑู - ุณุงุฎุช ูุฏู SVR

ูุฑุงุญู ุงููู ุขูุงุฏูโุณุงุฒ ุฏุงุฏูโูุง ูุดุงุจู ุฏุฑุณ ูุจู ุฏุฑุจุงุฑู [ARIMA](https://github.com/microsoft/ML-For-Beginners/tree/main/7-TimeSeries/2-ARIMA) ุงุณุช.

ูพูุดู [_/working_](https://github.com/microsoft/ML-For-Beginners/tree/main/7-TimeSeries/3-SVR/working) ุฑุง ุฏุฑ ุงู ุฏุฑุณ ุจุงุฒ ฺฉูุฏ ู ูุงู [_notebook.ipynb_](https://github.com/microsoft/ML-For-Beginners/blob/main/7-TimeSeries/3-SVR/working/notebook.ipynb) ุฑุง ูพุฏุง ฺฉูุฏ.[^2]

1. ููุชโุจูฺฉ ุฑุง ุงุฌุฑุง ฺฉูุฏ ู ฺฉุชุงุจุฎุงููโูุง ูุงุฒู ุฑุง ูุงุฑุฏ ฺฉูุฏ: [^2]

   ```python
   import sys
   sys.path.append('../../')
   ```

   ```python
   import os
   import warnings
   import matplotlib.pyplot as plt
   import numpy as np
   import pandas as pd
   import datetime as dt
   import math
   
   from sklearn.svm import SVR
   from sklearn.preprocessing import MinMaxScaler
   from common.utils import load_data, mape
   ```

2. ุฏุงุฏูโูุง ุฑุง ุงุฒ ูุงู `/data/energy.csv` ุจู ฺฉ ุฏุชุงูุฑู Pandas ุจุงุฑฺฏุฐุงุฑ ฺฉูุฏ ู ูฺฏุงู ุจูุฏุงุฒุฏ: [^2]

   ```python
   energy = load_data('../../data')[['load']]
   ```

3. ุชูุงู ุฏุงุฏูโูุง ุงูุฑฺ ููุฌูุฏ ุงุฒ ฺุงููู 2012 ุชุง ุฏุณุงูุจุฑ 2014 ุฑุง ุฑุณู ฺฉูุฏ: [^2]

   ```python
   energy.plot(y='load', subplots=True, figsize=(15, 8), fontsize=12)
   plt.xlabel('timestamp', fontsize=12)
   plt.ylabel('load', fontsize=12)
   plt.show()
   ```

   ![ุฏุงุฏู ฺฉุงูู](../../../../translated_images/full-data.a82ec9957e580e976f651a4fc38f280b9229c6efdbe3cfe7c60abaa9486d2cbe.fa.png)

   ุญุงูุง ุจุงุฏ ูุฏู SVR ุฎูุฏ ุฑุง ุจุณุงุฒู.

### ุงุฌุงุฏ ูุฌููุนูโูุง ุขููุฒุด ู ุขุฒูุงุด

ุงฺฉููู ุฏุงุฏูโูุง ุดูุง ุจุงุฑฺฏุฐุงุฑ ุดุฏู ุงุณุชุ ุจูุงุจุฑุงู ูโุชูุงูุฏ ุขูโูุง ุฑุง ุจู ูุฌููุนูโูุง ุขููุฒุด ู ุขุฒูุงุด ุชูุณู ฺฉูุฏ. ุณูพุณ ุฏุงุฏูโูุง ุฑุง ุชุบุฑ ุดฺฉู ุฏูุฏ ุชุง ูุฌููุนู ุฏุงุฏูโุง ูุจุชู ุจุฑ ุฒูุงู ุงุฌุงุฏ ฺฉูุฏ ฺฉู ุจุฑุง SVR ููุฑุฏ ูุงุฒ ุฎูุงูุฏ ุจูุฏ. ุดูุง ูุฏู ุฎูุฏ ุฑุง ุจุฑ ุฑู ูุฌููุนู ุขููุฒุด ุขููุฒุด ุฎูุงูุฏ ุฏุงุฏ. ูพุณ ุงุฒ ุงุชูุงู ุขููุฒุด ูุฏูุ ุฏูุช ุขู ุฑุง ุจุฑ ุฑู ูุฌููุนู ุขููุฒุดุ ูุฌููุนู ุขุฒูุงุด ู ุณูพุณ ฺฉู ูุฌููุนู ุฏุงุฏู ุงุฑุฒุงุจ ุฎูุงูุฏ ฺฉุฑุฏ ุชุง ุนููฺฉุฑุฏ ฺฉู ุฑุง ูุดุงูุฏู ฺฉูุฏ. ุจุงุฏ ุงุทููุงู ุญุงุตู ฺฉูุฏ ฺฉู ูุฌููุนู ุขุฒูุงุด ุฏูุฑู ุฒูุงู ุจุนุฏ ุฑุง ูุณุจุช ุจู ูุฌููุนู ุขููุฒุด ูพูุดุด ูโุฏูุฏ ุชุง ูุทูุฆู ุดูุฏ ฺฉู ูุฏู ุงุทูุงุนุงุช ุงุฒ ุฏูุฑูโูุง ุฒูุงู ุขูุฏู ฺฉุณุจ ููโฺฉูุฏ [^2] (ูุถุนุช ฺฉู ุจู ุขู *Overfitting* ฺฏูุชู ูโุดูุฏ).

1. ฺฉ ุฏูุฑู ุฏู ูุงูู ุงุฒ 1 ุณูพุชุงูุจุฑ ุชุง 31 ุงฺฉุชุจุฑ 2014 ุฑุง ุจู ูุฌููุนู ุขููุฒุด ุงุฎุชุตุงุต ุฏูุฏ. ูุฌููุนู ุขุฒูุงุด ุดุงูู ุฏูุฑู ุฏู ูุงูู ุงุฒ 1 ููุงูุจุฑ ุชุง 31 ุฏุณุงูุจุฑ 2014 ุฎูุงูุฏ ุจูุฏ: [^2]

   ```python
   train_start_dt = '2014-11-01 00:00:00'
   test_start_dt = '2014-12-30 00:00:00'
   ```

2. ุชูุงูุชโูุง ุฑุง ุจุตุฑโุณุงุฒ ฺฉูุฏ: [^2]

   ```python
   energy[(energy.index < test_start_dt) & (energy.index >= train_start_dt)][['load']].rename(columns={'load':'train'}) \
       .join(energy[test_start_dt:][['load']].rename(columns={'load':'test'}), how='outer') \
       .plot(y=['train', 'test'], figsize=(15, 8), fontsize=12)
   plt.xlabel('timestamp', fontsize=12)
   plt.ylabel('load', fontsize=12)
   plt.show()
   ```

   ![ุฏุงุฏูโูุง ุขููุฒุด ู ุขุฒูุงุด](../../../../translated_images/train-test.ead0cecbfc341921d4875eccf25fed5eefbb860cdbb69cabcc2276c49e4b33e5.fa.png)

### ุขูุงุฏูโุณุงุฒ ุฏุงุฏูโูุง ุจุฑุง ุขููุฒุด

ุงฺฉููู ุจุงุฏ ุฏุงุฏูโูุง ุฑุง ุจุฑุง ุขููุฒุด ุขูุงุฏู ฺฉูุฏุ ุจุง ุงูุฌุงู ููุชุฑ ฺฉุฑุฏู ู ููุงุณโุจูุฏ ุฏุงุฏูโูุง. ูุฌููุนู ุฏุงุฏู ุฎูุฏ ุฑุง ููุชุฑ ฺฉูุฏ ุชุง ููุท ุฏูุฑูโูุง ุฒูุงู ู ุณุชููโูุง ููุฑุฏ ูุงุฒ ุฑุง ุดุงูู ุดูุฏุ ู ููุงุณโุจูุฏ ฺฉูุฏ ุชุง ุฏุงุฏูโูุง ุฏุฑ ุจุงุฒู 0,1 ูุฑุงุฑ ฺฏุฑูุฏ.

1. ูุฌููุนู ุฏุงุฏู ุงุตู ุฑุง ููุชุฑ ฺฉูุฏ ุชุง ููุท ุฏูุฑูโูุง ุฒูุงู ุฐฺฉุฑ ุดุฏู ุจุฑุง ูุฑ ูุฌููุนู ู ููุท ุณุชูู ููุฑุฏ ูุงุฒ 'load' ุจู ุนูุงูู ุชุงุฑุฎ ุฑุง ุดุงูู ุดูุฏ: [^2]

   ```python
   train = energy.copy()[(energy.index >= train_start_dt) & (energy.index < test_start_dt)][['load']]
   test = energy.copy()[energy.index >= test_start_dt][['load']]
   
   print('Training data shape: ', train.shape)
   print('Test data shape: ', test.shape)
   ```

   ```output
   Training data shape:  (1416, 1)
   Test data shape:  (48, 1)
   ```
   
2. ุฏุงุฏูโูุง ุขููุฒุด ุฑุง ุฏุฑ ุจุงุฒู (0, 1) ููุงุณโุจูุฏ ฺฉูุฏ: [^2]

   ```python
   scaler = MinMaxScaler()
   train['load'] = scaler.fit_transform(train)
   ```
   
4. ุงฺฉููู ุฏุงุฏูโูุง ุขุฒูุงุด ุฑุง ููุงุณโุจูุฏ ฺฉูุฏ: [^2]

   ```python
   test['load'] = scaler.transform(test)
   ```

### ุงุฌุงุฏ ุฏุงุฏูโูุง ุจุง ฺฏุงูโูุง ุฒูุงู [^1]

ุจุฑุง SVRุ ุฏุงุฏูโูุง ูุฑูุฏ ุฑุง ุจู ุดฺฉู `[batch, timesteps]` ุชุจุฏู ูโฺฉูุฏ. ุจูุงุจุฑุงูุ ุฏุงุฏูโูุง ููุฌูุฏ `train_data` ู `test_data` ุฑุง ุจู ฺฏูููโุง ุชุบุฑ ุดฺฉู ูโุฏูุฏ ฺฉู ฺฉ ุจุนุฏ ุฌุฏุฏ ูุฌูุฏ ุฏุงุดุชู ุจุงุดุฏ ฺฉู ุจู ฺฏุงูโูุง ุฒูุงู ุงุดุงุฑู ุฏุงุฑุฏ.

```python
# Converting to numpy arrays
train_data = train.values
test_data = test.values
```

ุจุฑุง ุงู ูุซุงูุ ูุง `timesteps = 5` ุฑุง ุฏุฑ ูุธุฑ ูโฺฏุฑู. ุจูุงุจุฑุงูุ ูุฑูุฏโูุง ูุฏู ุฏุงุฏูโูุง 4 ฺฏุงู ุฒูุงู ุงูู ูุณุชูุฏุ ู ุฎุฑูุฌ ุฏุงุฏูโูุง ฺฏุงู ุฒูุงู ูพูุฌู ุฎูุงูุฏ ุจูุฏ.

```python
timesteps=5
```

ุชุจุฏู ุฏุงุฏูโูุง ุขููุฒุด ุจู ุชูุณูุฑ ุฏูโุจุนุฏ ุจุง ุงุณุชูุงุฏู ุงุฒ ูุณุชโูุง ุชู ุฏุฑ ุชู:

```python
train_data_timesteps=np.array([[j for j in train_data[i:i+timesteps]] for i in range(0,len(train_data)-timesteps+1)])[:,:,0]
train_data_timesteps.shape
```

```output
(1412, 5)
```

ุชุจุฏู ุฏุงุฏูโูุง ุขุฒูุงุด ุจู ุชูุณูุฑ ุฏูโุจุนุฏ:

```python
test_data_timesteps=np.array([[j for j in test_data[i:i+timesteps]] for i in range(0,len(test_data)-timesteps+1)])[:,:,0]
test_data_timesteps.shape
```

```output
(44, 5)
```

ุงูุชุฎุงุจ ูุฑูุฏโูุง ู ุฎุฑูุฌโูุง ุงุฒ ุฏุงุฏูโูุง ุขููุฒุด ู ุขุฒูุงุด:

```python
x_train, y_train = train_data_timesteps[:,:timesteps-1],train_data_timesteps[:,[timesteps-1]]
x_test, y_test = test_data_timesteps[:,:timesteps-1],test_data_timesteps[:,[timesteps-1]]

print(x_train.shape, y_train.shape)
print(x_test.shape, y_test.shape)
```

```output
(1412, 4) (1412, 1)
(44, 4) (44, 1)
```

### ูพุงุฏูโุณุงุฒ SVR [^1]

ุงฺฉููู ุฒูุงู ูพุงุฏูโุณุงุฒ SVR ุงุณุช. ุจุฑุง ูุทุงูุนู ุจุดุชุฑ ุฏุฑุจุงุฑู ุงู ูพุงุฏูโุณุงุฒุ ูโุชูุงูุฏ ุจู [ุงู ูุณุชูุฏุงุช](https://scikit-learn.org/stable/modules/generated/sklearn.svm.SVR.html) ูุฑุงุฌุนู ฺฉูุฏ. ุจุฑุง ูพุงุฏูโุณุงุฒ ูุงุ ูุฑุงุญู ุฒุฑ ุฑุง ุฏูุจุงู ูโฺฉูู:

  1. ูุฏู ุฑุง ุจุง ูุฑุงุฎูุงู `SVR()` ู ุงุฑุณุงู ูุงูพุฑูพุงุฑุงูุชุฑูุง ูุฏู ุชุนุฑู ฺฉูุฏ: kernelุ gammaุ c ู epsilon
  2. ูุฏู ุฑุง ุจุฑุง ุฏุงุฏูโูุง ุขููุฒุด ุจุง ูุฑุงุฎูุงู ุชุงุจุน `fit()` ุขูุงุฏู ฺฉูุฏ
  3. ูพุดโุจูโูุง ุฑุง ุจุง ูุฑุงุฎูุงู ุชุงุจุน `predict()` ุงูุฌุงู ุฏูุฏ

ุงฺฉููู ฺฉ ูุฏู SVR ุงุฌุงุฏ ูโฺฉูู. ุฏุฑ ุงูุฌุง ุงุฒ [ูุณุชู RBF](https://scikit-learn.org/stable/modules/svm.html#parameters-of-the-rbf-kernel) ุงุณุชูุงุฏู ูโฺฉูู ู ูุงูพุฑูพุงุฑุงูุชุฑูุง gammaุ C ู epsilon ุฑุง ุจู ุชุฑุชุจ 0.5ุ 10 ู 0.05 ุชูุธู ูโฺฉูู.

```python
model = SVR(kernel='rbf',gamma=0.5, C=10, epsilon = 0.05)
```

#### ุขููุฒุด ูุฏู ุจุฑ ุฑู ุฏุงุฏูโูุง ุขููุฒุด [^1]

```python
model.fit(x_train, y_train[:,0])
```

```output
SVR(C=10, cache_size=200, coef0=0.0, degree=3, epsilon=0.05, gamma=0.5,
    kernel='rbf', max_iter=-1, shrinking=True, tol=0.001, verbose=False)
```

#### ุงูุฌุงู ูพุดโุจูโูุง ูุฏู [^1]

```python
y_train_pred = model.predict(x_train).reshape(-1,1)
y_test_pred = model.predict(x_test).reshape(-1,1)

print(y_train_pred.shape, y_test_pred.shape)
```

```output
(1412, 1) (44, 1)
```

ุดูุง ูุฏู SVR ุฎูุฏ ุฑุง ุณุงุฎุชูโุงุฏ! ุงฺฉููู ุจุงุฏ ุขู ุฑุง ุงุฑุฒุงุจ ฺฉูู.

### ุงุฑุฒุงุจ ูุฏู [^1]

ุจุฑุง ุงุฑุฒุงุจุ ุงุจุชุฏุง ุฏุงุฏูโูุง ุฑุง ุจู ููุงุณ ุงุตู ุฎูุฏ ุจุงุฒูโฺฏุฑุฏุงูู. ุณูพุณุ ุจุฑุง ุจุฑุฑุณ ุนููฺฉุฑุฏุ ูููุฏุงุฑ ุณุฑโูุง ุฒูุงู ุงุตู ู ูพุดโุจูโุดุฏู ุฑุง ุฑุณู ูโฺฉูู ู ููฺูู ูุชุฌู MAPE ุฑุง ฺุงูพ ูโฺฉูู.

ููุงุณโุจูุฏ ุฎุฑูุฌ ูพุดโุจูโุดุฏู ู ุงุตู:

```python
# Scaling the predictions
y_train_pred = scaler.inverse_transform(y_train_pred)
y_test_pred = scaler.inverse_transform(y_test_pred)

print(len(y_train_pred), len(y_test_pred))
```

```python
# Scaling the original values
y_train = scaler.inverse_transform(y_train)
y_test = scaler.inverse_transform(y_test)

print(len(y_train), len(y_test))
```

#### ุจุฑุฑุณ ุนููฺฉุฑุฏ ูุฏู ุจุฑ ุฑู ุฏุงุฏูโูุง ุขููุฒุด ู ุขุฒูุงุด [^1]

ูุง ุฒูุงูโุจูุฏโูุง ุฑุง ุงุฒ ูุฌููุนู ุฏุงุฏู ุงุณุชุฎุฑุงุฌ ูโฺฉูู ุชุง ุฏุฑ ูุญูุฑ x ูููุฏุงุฑ ุฎูุฏ ูุดุงู ุฏูู. ุชูุฌู ุฏุงุดุชู ุจุงุดุฏ ฺฉู ูุง ุงุฒ ุงููู ```timesteps-1``` ููุงุฏุฑ ุจู ุนููุงู ูุฑูุฏ ุจุฑุง ุงููู ุฎุฑูุฌ ุงุณุชูุงุฏู ูโฺฉููุ ุจูุงุจุฑุงู ุฒูุงูโุจูุฏโูุง ุจุฑุง ุฎุฑูุฌ ูพุณ ุงุฒ ุขู ุดุฑูุน ูโุดููุฏ.

```python
train_timestamps = energy[(energy.index < test_start_dt) & (energy.index >= train_start_dt)].index[timesteps-1:]
test_timestamps = energy[test_start_dt:].index[timesteps-1:]

print(len(train_timestamps), len(test_timestamps))
```

```output
1412 44
```

ุฑุณู ูพุดโุจูโูุง ุจุฑุง ุฏุงุฏูโูุง ุขููุฒุด:

```python
plt.figure(figsize=(25,6))
plt.plot(train_timestamps, y_train, color = 'red', linewidth=2.0, alpha = 0.6)
plt.plot(train_timestamps, y_train_pred, color = 'blue', linewidth=0.8)
plt.legend(['Actual','Predicted'])
plt.xlabel('Timestamp')
plt.title("Training data prediction")
plt.show()
```

![ูพุดโุจู ุฏุงุฏูโูุง ุขููุฒุด](../../../../translated_images/train-data-predict.3c4ef4e78553104ffdd53d47a4c06414007947ea328e9261ddf48d3eafdefbbf.fa.png)

ฺุงูพ MAPE ุจุฑุง ุฏุงุฏูโูุง ุขููุฒุด

```python
print('MAPE for training data: ', mape(y_train_pred, y_train)*100, '%')
```

```output
MAPE for training data: 1.7195710200875551 %
```

ุฑุณู ูพุดโุจูโูุง ุจุฑุง ุฏุงุฏูโูุง ุขุฒูุงุด

```python
plt.figure(figsize=(10,3))
plt.plot(test_timestamps, y_test, color = 'red', linewidth=2.0, alpha = 0.6)
plt.plot(test_timestamps, y_test_pred, color = 'blue', linewidth=0.8)
plt.legend(['Actual','Predicted'])
plt.xlabel('Timestamp')
plt.show()
```

![ูพุดโุจู ุฏุงุฏูโูุง ุขุฒูุงุด](../../../../translated_images/test-data-predict.8afc47ee7e52874f514ebdda4a798647e9ecf44a97cc927c535246fcf7a28aa9.fa.png)

ฺุงูพ MAPE ุจุฑุง ุฏุงุฏูโูุง ุขุฒูุงุด

```python
print('MAPE for testing data: ', mape(y_test_pred, y_test)*100, '%')
```

```output
MAPE for testing data:  1.2623790187854018 %
```

๐ ุดูุง ูุชุฌู ุจุณุงุฑ ุฎูุจ ุจุฑ ุฑู ูุฌููุนู ุฏุงุฏู ุขุฒูุงุด ุฏุงุฑุฏ!

### ุจุฑุฑุณ ุนููฺฉุฑุฏ ูุฏู ุจุฑ ุฑู ฺฉู ูุฌููุนู ุฏุงุฏู [^1]

```python
# Extracting load values as numpy array
data = energy.copy().values

# Scaling
data = scaler.transform(data)

# Transforming to 2D tensor as per model input requirement
data_timesteps=np.array([[j for j in data[i:i+timesteps]] for i in range(0,len(data)-timesteps+1)])[:,:,0]
print("Tensor shape: ", data_timesteps.shape)

# Selecting inputs and outputs from data
X, Y = data_timesteps[:,:timesteps-1],data_timesteps[:,[timesteps-1]]
print("X shape: ", X.shape,"\nY shape: ", Y.shape)
```

```output
Tensor shape:  (26300, 5)
X shape:  (26300, 4) 
Y shape:  (26300, 1)
```

```python
# Make model predictions
Y_pred = model.predict(X).reshape(-1,1)

# Inverse scale and reshape
Y_pred = scaler.inverse_transform(Y_pred)
Y = scaler.inverse_transform(Y)
```

```python
plt.figure(figsize=(30,8))
plt.plot(Y, color = 'red', linewidth=2.0, alpha = 0.6)
plt.plot(Y_pred, color = 'blue', linewidth=0.8)
plt.legend(['Actual','Predicted'])
plt.xlabel('Timestamp')
plt.show()
```

![ูพุดโุจู ุฏุงุฏู ฺฉุงูู](../../../../translated_images/full-data-predict.4f0fed16a131c8f3bcc57a3060039dc7f2f714a05b07b68c513e0fe7fb3d8964.fa.png)

```python
print('MAPE: ', mape(Y_pred, Y)*100, '%')
```

```output
MAPE:  2.0572089029888656 %
```

๐ ูููุฏุงุฑูุง ุจุณุงุฑ ุฎูุจุ ูุดุงูโุฏููุฏู ูุฏู ุจุง ุฏูุช ุจุงูุง. ุขูุฑู!

---

## ๐ฺุงูุด

- ุณุน ฺฉูุฏ ูุงูพุฑูพุงุฑุงูุชุฑูุง (gammaุ Cุ epsilon) ุฑุง ููฺฏุงู ุงุฌุงุฏ ูุฏู ุชุบุฑ ุฏูุฏ ู ุจุฑ ุฑู ุฏุงุฏูโูุง ุงุฑุฒุงุจ ฺฉูุฏ ุชุง ุจุจูุฏ ฺฉุฏุงู ูุฌููุนู ูุงูพุฑูพุงุฑุงูุชุฑูุง ุจูุชุฑู ูุชุงุฌ ุฑุง ุจุฑ ุฑู ุฏุงุฏูโูุง ุขุฒูุงุด ูโุฏููุฏ. ุจุฑุง ุงุทูุงุนุงุช ุจุดุชุฑ ุฏุฑุจุงุฑู ุงู ูุงูพุฑูพุงุฑุงูุชุฑูุงุ ูโุชูุงูุฏ ุจู [ุงู ูุณุชูุฏุงุช](https://scikit-learn.org/stable/modules/svm.html#parameters-of-the-rbf-kernel) ูุฑุงุฌุนู ฺฉูุฏ.
- ุณุน ฺฉูุฏ ุงุฒ ุชูุงุจุน ูุณุชู ูุฎุชูู ุจุฑุง ูุฏู ุงุณุชูุงุฏู ฺฉูุฏ ู ุนููฺฉุฑุฏ ุขูโูุง ุฑุง ุจุฑ ุฑู ูุฌููุนู ุฏุงุฏู ุชุญูู ฺฉูุฏ. ฺฉ ูุณุชูุฏ ููุฏ ุฑุง ูโุชูุงูุฏ [ุงูุฌุง](https://scikit-learn.org/stable/modules/svm.html#kernel-functions) ูพุฏุง ฺฉูุฏ.
- ุณุน ฺฉูุฏ ุงุฒ ููุงุฏุฑ ูุฎุชูู ุจุฑุง `timesteps` ุงุณุชูุงุฏู ฺฉูุฏ ุชุง ูุฏู ุจุชูุงูุฏ ุจุฑุง ูพุดโุจู ุจู ุนูุจ ูฺฏุงู ฺฉูุฏ.

## [ุขุฒููู ูพุณ ุงุฒ ุฏุฑุณ](https://gray-sand-07a10f403.1.azurestaticapps.net/quiz/52/)

## ูุฑูุฑ ู ูุทุงูุนู ุดุฎุต

ุงู ุฏุฑุณ ุจุฑุง ูุนุฑู ฺฉุงุฑุจุฑุฏ SVR ุฏุฑ ูพุดโุจู ุณุฑโูุง ุฒูุงู ุจูุฏ. ุจุฑุง ูุทุงูุนู ุจุดุชุฑ ุฏุฑุจุงุฑู SVRุ ูโุชูุงูุฏ ุจู [ุงู ุจูุงฺฏ](https://www.analyticsvidhya.com/blog/2020/03/support-vector-regression-tutorial-for-machine-learning/) ูุฑุงุฌุนู ฺฉูุฏ. ุงู [ูุณุชูุฏุงุช ุฏุฑ scikit-learn](https://scikit-learn.org/stable/modules/svm.html) ุชูุถุญุงุช ุฌุงูุนโุชุฑ ุฏุฑุจุงุฑู SVMโูุง ุจู ุทูุฑ ฺฉูุ [SVRูุง](https://scikit-learn.org/stable/modules/svm.html#regression) ู ููฺูู ุฌุฒุฆุงุช ุฏฺฏุฑ ูพุงุฏูโุณุงุฒ ูุงููุฏ [ุชูุงุจุน ูุณุชู](https://scikit-learn.org/stable/modules/svm.html#kernel-functions) ฺฉู ูโุชูุงููุฏ ุงุณุชูุงุฏู ุดููุฏ ู ูพุงุฑุงูุชุฑูุง ุขูโูุง ุงุฑุงุฆู ูโุฏูุฏ.

## ุชฺฉูู

[ฺฉ ูุฏู SVR ุฌุฏุฏ](assignment.md)

## ุงุนุชุจุงุฑูุง

[^1]: ูุชูุ ฺฉุฏ ู ุฎุฑูุฌ ุฏุฑ ุงู ุจุฎุด ุชูุณุท [@AnirbanMukherjeeXD](https://github.com/AnirbanMukherjeeXD) ุงุฑุงุฆู ุดุฏู ุงุณุช.
[^2]: ูุชูุ ฺฉุฏ ู ุฎุฑูุฌ ุฏุฑ ุงู ุจุฎุด ุงุฒ [ARIMA](https://github.com/microsoft/ML-For-Beginners/tree/main/7-TimeSeries/2-ARIMA) ฺฏุฑูุชู ุดุฏู ุงุณุช.

---

**ุณูุจ ูุณุฆููุช**:  
ุงู ุณูุฏ ุจุง ุงุณุชูุงุฏู ุงุฒ ุณุฑูุณ ุชุฑุฌูู ููุด ูุตููุน [Co-op Translator](https://github.com/Azure/co-op-translator) ุชุฑุฌูู ุดุฏู ุงุณุช. ุฏุฑ ุญุงู ฺฉู ูุง ุจุฑุง ุฏูุช ุชูุงุด ูโฺฉููุ ูุทูุงู ุชูุฌู ุฏุงุดุชู ุจุงุดุฏ ฺฉู ุชุฑุฌููโูุง ุฎูุฏฺฉุงุฑ ููฺฉู ุงุณุช ุดุงูู ุฎุทุงูุง ุง ูุงุฏุฑุณุชโูุง ุจุงุดูุฏ. ุณูุฏ ุงุตู ุจู ุฒุจุงู ุงุตู ุขู ุจุงุฏ ุจู ุนููุงู ููุจุน ูุนุชุจุฑ ุฏุฑ ูุธุฑ ฺฏุฑูุชู ุดูุฏ. ุจุฑุง ุงุทูุงุนุงุช ุญุณุงุณุ ุชุฑุฌูู ุญุฑููโุง ุงูุณุงู ุชูุตู ูโุดูุฏ. ูุง ูฺ ูุณุฆููุช ุฏุฑ ูุจุงู ุณูุกุชูุงููโูุง ุง ุชูุณุฑูุง ูุงุฏุฑุณุช ูุงุด ุงุฒ ุงุณุชูุงุฏู ุงุฒ ุงู ุชุฑุฌูู ูุฏุงุฑู.