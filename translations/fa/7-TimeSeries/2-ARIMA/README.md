<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "2f400075e003e749fdb0d6b3b4787a99",
  "translation_date": "2025-09-03T22:44:40+00:00",
  "source_file": "7-TimeSeries/2-ARIMA/README.md",
  "language_code": "fa"
}
-->
# ูพุดโุจู ุณุฑโูุง ุฒูุงู ุจุง ARIMA

ุฏุฑ ุฏุฑุณ ูุจูุ ฺฉู ุฏุฑุจุงุฑู ูพุดโุจู ุณุฑโูุง ุฒูุงู ุงุฏ ฺฏุฑูุชุฏ ู ฺฉ ูุฌููุนู ุฏุงุฏู ุฑุง ฺฉู ููุณุงูุงุช ุจุงุฑ ุงูฺฉุชุฑฺฉ ุฑุง ุฏุฑ ุทูู ฺฉ ุจุงุฒู ุฒูุงู ูุดุงู ูโุฏุงุฏุ ุจุงุฑฺฏุฐุงุฑ ฺฉุฑุฏุฏ.

[![ูุนุฑู ARIMA](https://img.youtube.com/vi/IUSk-YDau10/0.jpg)](https://youtu.be/IUSk-YDau10 "ูุนุฑู ARIMA")

> ๐ฅ ุฑู ุชุตูุฑ ุจุงูุง ฺฉูฺฉ ฺฉูุฏ ุชุง ูุฏู ุฑุง ุจุจูุฏ: ูุนุฑู ฺฉูุชุงู ุงุฒ ูุฏูโูุง ARIMA. ูุซุงู ุฏุฑ ุฒุจุงู R ุงูุฌุงู ุดุฏู ุงุณุชุ ุงูุง ููุงูู ุขู ุฌูุงู ูุณุชูุฏ.

## [ุขุฒููู ูพุด ุงุฒ ุฏุฑุณ](https://gray-sand-07a10f403.1.azurestaticapps.net/quiz/43/)

## ููุฏูู

ุฏุฑ ุงู ุฏุฑุณุ ุดูุง ุจุง ฺฉ ุฑูุด ุฎุงุต ุจุฑุง ุณุงุฎุช ูุฏูโูุง ุจุง ุงุณุชูุงุฏู ุงุฒ [ARIMA: *A*uto*R*egressive *I*ntegrated *M*oving *A*verage](https://wikipedia.org/wiki/Autoregressive_integrated_moving_average) ุขุดูุง ุฎูุงูุฏ ุดุฏ. ูุฏูโูุง ARIMA ุจูโูฺู ุจุฑุง ุฏุงุฏูโูุง ฺฉู [ุบุฑุงุณุชุง](https://wikipedia.org/wiki/Stationary_process) ูุณุชูุฏุ ููุงุณุจ ูุณุชูุฏ.

## ููุงูู ฺฉู

ุจุฑุง ฺฉุงุฑ ุจุง ARIMAุ ุจุงุฏ ุจุง ฺูุฏ ููููู ุขุดูุง ุดูุฏ:

- ๐ **ุงุณุชุง**. ุงุฒ ุฏุฏฺฏุงู ุขูุงุฑุ ุงุณุชุง ุจู ุฏุงุฏูโูุง ุงุดุงุฑู ุฏุงุฑุฏ ฺฉู ุชูุฒุน ุขูโูุง ุจุง ุชุบุฑ ุฒูุงู ุซุงุจุช ูโูุงูุฏ. ุฏุงุฏูโูุง ุบุฑุงุณุชุง ููุณุงูุงุช ุฑุง ุจู ุฏูู ุฑููุฏูุง ูุดุงู ูโุฏููุฏ ฺฉู ุจุงุฏ ุจุฑุง ุชุญูู ุชุจุฏู ุดููุฏ. ุจู ุนููุงู ูุซุงูุ ูุตู ุจูุฏู ูโุชูุงูุฏ ููุณุงูุงุช ุฏุฑ ุฏุงุฏูโูุง ุงุฌุงุฏ ฺฉูุฏ ฺฉู ูโุชูุงู ุขู ุฑุง ุจุง ูุฑุขูุฏ ยซุชูุงุถูโฺฏุฑ ูุตูยป ุญุฐู ฺฉุฑุฏ.

- ๐ **[ุชูุงุถูโฺฏุฑ](https://wikipedia.org/wiki/Autoregressive_integrated_moving_average#Differencing)**. ุชูุงุถูโฺฏุฑ ุฏุงุฏูโูุงุ ุงุฒ ุฏุฏฺฏุงู ุขูุงุฑุ ุจู ูุฑุขูุฏ ุชุจุฏู ุฏุงุฏูโูุง ุบุฑุงุณุชุง ุจู ุงุณุชุง ุงุฒ ุทุฑู ุญุฐู ุฑููุฏูุง ุบุฑุซุงุจุช ุงุดุงุฑู ุฏุงุฑุฏ. "ุชูุงุถูโฺฏุฑ ุชุบุฑุงุช ุณุทุญ ฺฉ ุณุฑ ุฒูุงู ุฑุง ุญุฐู ูโฺฉูุฏุ ุฑููุฏ ู ูุตู ุจูุฏู ุฑุง ุงุฒ ุจู ูโุจุฑุฏ ู ุฏุฑ ูุชุฌู ูุงูฺฏู ุณุฑ ุฒูุงู ุฑุง ุชุซุจุช ูโฺฉูุฏ." [ููุงููโุง ุงุฒ Shixiong ู ููฺฉุงุฑุงู](https://arxiv.org/abs/1904.07632)

## ARIMA ุฏุฑ ุฒููู ุณุฑโูุง ุฒูุงู

ุจุงุฏ ุงุฌุฒุง ARIMA ุฑุง ุจุฑุฑุณ ฺฉูู ุชุง ุจูุชุฑ ุจูููู ฺฺฏููู ุจู ูุง ุฏุฑ ูุฏูโุณุงุฒ ุณุฑโูุง ุฒูุงู ู ูพุดโุจู ฺฉูฺฉ ูโฺฉูุฏ.

- **AR - ุจุฑุง ุฎูุฏุฑฺฏุฑุณู (AutoRegressive)**. ูุฏูโูุง ุฎูุฏุฑฺฏุฑุณูุ ููุงูโุทูุฑ ฺฉู ุงุฒ ูุงูุดุงู ูพุฏุงุณุชุ ุจู ฺฏุฐุดุชู ูฺฏุงู ูโฺฉููุฏ ุชุง ููุงุฏุฑ ูุจู ุฏุงุฏูโูุง ุฑุง ุชุญูู ฺฉุฑุฏู ู ูุฑุถุงุช ุฏุฑุจุงุฑู ุขูโูุง ุจุณุงุฒูุฏ. ุงู ููุงุฏุฑ ูุจู ุจู ุนููุงู ยซููููโูุงยป ุดูุงุฎุชู ูโุดููุฏ. ุจู ุนููุงู ูุซุงูุ ุฏุงุฏูโูุง ฺฉู ูุฑูุด ูุงูุงูู ูุฏุงุฏูุง ุฑุง ูุดุงู ูโุฏููุฏ. ูุฌููุน ูุฑูุด ูุฑ ูุงู ุจู ุนููุงู ฺฉ ยซูุชุบุฑ ุฏุฑ ุญุงู ุชฺฉุงููยป ุฏุฑ ูุฌููุนู ุฏุงุฏู ุฏุฑ ูุธุฑ ฺฏุฑูุชู ูโุดูุฏ. ุงู ูุฏู ุจู ุงู ุตูุฑุช ุณุงุฎุชู ูโุดูุฏ ฺฉู "ูุชุบุฑ ุฏุฑ ุญุงู ุชฺฉุงูู ููุฑุฏ ูุธุฑ ุจุฑ ุงุณุงุณ ููุงุฏุฑ ููููโุง (ุนู ูุจู) ุฎูุฏุด ุฑฺฏุฑุณ ูโุดูุฏ." [ูฺฉโูพุฏุง](https://wikipedia.org/wiki/Autoregressive_integrated_moving_average)

- **I - ุจุฑุง ฺฉูพุงุฑฺูโุณุงุฒ (Integrated)**. ุจุฑุฎูุงู ูุฏูโูุง ูุดุงุจู ARMAุ ุญุฑู 'I' ุฏุฑ ARIMA ุจู ุฌูุจู *[ฺฉูพุงุฑฺูโุณุงุฒ](https://wikipedia.org/wiki/Order_of_integration)* ุงุดุงุฑู ุฏุงุฑุฏ. ุฏุงุฏูโูุง ุฒูุงู ฺฉูพุงุฑฺู ูโุดููุฏ ฺฉู ูุฑุงุญู ุชูุงุถูโฺฏุฑ ุงุนูุงู ุดููุฏ ุชุง ุบุฑุงุณุชุง ุญุฐู ุดูุฏ.

- **MA - ุจุฑุง ูุงูฺฏู ูุชุญุฑฺฉ (Moving Average)**. ุฌูุจู [ูุงูฺฏู ูุชุญุฑฺฉ](https://wikipedia.org/wiki/Moving-average_model) ุงู ูุฏู ุจู ูุชุบุฑ ุฎุฑูุฌ ุงุดุงุฑู ุฏุงุฑุฏ ฺฉู ุจุง ูุดุงูุฏู ููุงุฏุฑ ูุนู ู ฺฏุฐุดุชู ููููโูุง ุชุนู ูโุดูุฏ.

ูุชุฌู ููุง: ARIMA ุจุฑุง ุณุงุฎุช ูุฏู ุงุณุชูุงุฏู ูโุดูุฏ ฺฉู ุชุง ุญุฏ ููฺฉู ุจุง ุดฺฉู ุฎุงุต ุฏุงุฏูโูุง ุณุฑ ุฒูุงู ูุทุงุจูุช ุฏุงุดุชู ุจุงุดุฏ.

## ุชูุฑู - ุณุงุฎุช ฺฉ ูุฏู ARIMA

ูพูุดู [_/working_](https://github.com/microsoft/ML-For-Beginners/tree/main/7-TimeSeries/2-ARIMA/working) ุฑุง ุฏุฑ ุงู ุฏุฑุณ ุจุงุฒ ฺฉูุฏ ู ูุงู [_notebook.ipynb_](https://github.com/microsoft/ML-For-Beginners/blob/main/7-TimeSeries/2-ARIMA/working/notebook.ipynb) ุฑุง ูพุฏุง ฺฉูุฏ.

1. ููุชโุจูฺฉ ุฑุง ุงุฌุฑุง ฺฉูุฏ ุชุง ฺฉุชุงุจุฎุงูู `statsmodels` ูพุงุชูู ุจุงุฑฺฏุฐุงุฑ ุดูุฏุ ุดูุง ุจู ุงู ฺฉุชุงุจุฎุงูู ุจุฑุง ูุฏูโูุง ARIMA ูุงุฒ ุฏุงุฑุฏ.

1. ฺฉุชุงุจุฎุงููโูุง ูุงุฒู ุฑุง ุจุงุฑฺฏุฐุงุฑ ฺฉูุฏ.

1. ุญุงูุง ฺูุฏ ฺฉุชุงุจุฎุงูู ุฏฺฏุฑ ฺฉู ุจุฑุง ุชุฑุณู ุฏุงุฏูโูุง ููุฏ ูุณุชูุฏ ุฑุง ุจุงุฑฺฏุฐุงุฑ ฺฉูุฏ:

    ```python
    import os
    import warnings
    import matplotlib.pyplot as plt
    import numpy as np
    import pandas as pd
    import datetime as dt
    import math

    from pandas.plotting import autocorrelation_plot
    from statsmodels.tsa.statespace.sarimax import SARIMAX
    from sklearn.preprocessing import MinMaxScaler
    from common.utils import load_data, mape
    from IPython.display import Image

    %matplotlib inline
    pd.options.display.float_format = '{:,.2f}'.format
    np.set_printoptions(precision=2)
    warnings.filterwarnings("ignore") # specify to ignore warning messages
    ```

1. ุฏุงุฏูโูุง ุฑุง ุงุฒ ูุงู `/data/energy.csv` ุจู ฺฉ ุฏุชุงูุฑู Pandas ุจุงุฑฺฏุฐุงุฑ ฺฉูุฏ ู ูฺฏุงู ุจู ุขู ุจูุฏุงุฒุฏ:

    ```python
    energy = load_data('./data')[['load']]
    energy.head(10)
    ```

1. ุชูุงู ุฏุงุฏูโูุง ุงูุฑฺ ููุฌูุฏ ุงุฒ ฺุงููู 2012 ุชุง ุฏุณุงูุจุฑ 2014 ุฑุง ุชุฑุณู ฺฉูุฏ. ูุจุงุฏ ุดฺฏูุชโุฒุฏู ุดูุฏ ุฒุฑุง ุงู ุฏุงุฏูโูุง ุฑุง ุฏุฑ ุฏุฑุณ ูุจู ุฏุฏู:

    ```python
    energy.plot(y='load', subplots=True, figsize=(15, 8), fontsize=12)
    plt.xlabel('timestamp', fontsize=12)
    plt.ylabel('load', fontsize=12)
    plt.show()
    ```

    ุญุงูุง ุจุงุฏ ฺฉ ูุฏู ุจุณุงุฒู!

### ุงุฌุงุฏ ูุฌููุนู ุฏุงุฏูโูุง ุขููุฒุด ู ุขุฒูุงุด

ุญุงูุง ฺฉู ุฏุงุฏูโูุง ุดูุง ุจุงุฑฺฏุฐุงุฑ ุดุฏูโุงูุฏุ ูโุชูุงูุฏ ุขูโูุง ุฑุง ุจู ูุฌููุนูโูุง ุขููุฒุด ู ุขุฒูุงุด ุชูุณู ฺฉูุฏ. ุดูุง ูุฏู ุฎูุฏ ุฑุง ุฑู ูุฌููุนู ุขููุฒุด ุขููุฒุด ุฎูุงูุฏ ุฏุงุฏ. ููุงูโุทูุฑ ฺฉู ูุนููู ุงุณุชุ ูพุณ ุงุฒ ุงุชูุงู ุขููุฒุด ูุฏูุ ุฏูุช ุขู ุฑุง ุจุง ุงุณุชูุงุฏู ุงุฒ ูุฌููุนู ุขุฒูุงุด ุงุฑุฒุงุจ ุฎูุงูุฏ ฺฉุฑุฏ. ุจุงุฏ ุงุทููุงู ุญุงุตู ฺฉูุฏ ฺฉู ูุฌููุนู ุขุฒูุงุด ฺฉ ุจุงุฒู ุฒูุงู ุจุนุฏ ุฑุง ูุณุจุช ุจู ูุฌููุนู ุขููุฒุด ูพูุดุด ูโุฏูุฏ ุชุง ูุฏู ุงุทูุงุนุงุช ุงุฒ ุฏูุฑูโูุง ุฒูุงู ุขูุฏู ุจู ุฏุณุช ูุงูุฑุฏ.

1. ฺฉ ุจุงุฒู ุฒูุงู ุฏู ูุงูู ุงุฒ 1 ุณูพุชุงูุจุฑ ุชุง 31 ุงฺฉุชุจุฑ 2014 ุฑุง ุจู ูุฌููุนู ุขููุฒุด ุงุฎุชุตุงุต ุฏูุฏ. ูุฌููุนู ุขุฒูุงุด ุดุงูู ุจุงุฒู ุฒูุงู ุฏู ูุงูู ุงุฒ 1 ููุงูุจุฑ ุชุง 31 ุฏุณุงูุจุฑ 2014 ุฎูุงูุฏ ุจูุฏ:

    ```python
    train_start_dt = '2014-11-01 00:00:00'
    test_start_dt = '2014-12-30 00:00:00'
    ```

    ุงุฒ ุขูุฌุง ฺฉู ุงู ุฏุงุฏูโูุง ูุตุฑู ุฑูุฒุงูู ุงูุฑฺ ุฑุง ููุนฺฉุณ ูโฺฉููุฏุ ฺฉ ุงูฺฏู ูุตู ูู ูุฌูุฏ ุฏุงุฑุฏุ ุงูุง ูุตุฑู ุจุดุชุฑ ุดุจู ูุตุฑู ุฏุฑ ุฑูุฒูุง ุงุฎุฑ ุงุณุช.

1. ุชูุงูุชโูุง ุฑุง ุชุฌุณู ฺฉูุฏ:

    ```python
    energy[(energy.index < test_start_dt) & (energy.index >= train_start_dt)][['load']].rename(columns={'load':'train'}) \
        .join(energy[test_start_dt:][['load']].rename(columns={'load':'test'}), how='outer') \
        .plot(y=['train', 'test'], figsize=(15, 8), fontsize=12)
    plt.xlabel('timestamp', fontsize=12)
    plt.ylabel('load', fontsize=12)
    plt.show()
    ```

    ![ุฏุงุฏูโูุง ุขููุฒุด ู ุขุฒูุงุด](../../../../translated_images/train-test.8928d14e5b91fc942f0ca9201b2d36c890ea7e98f7619fd94f75de3a4c2bacb9.fa.png)

    ุจูุงุจุฑุงูุ ุงุณุชูุงุฏู ุงุฒ ฺฉ ุจุงุฒู ุฒูุงู ูุณุจุชุงู ฺฉูฺฺฉ ุจุฑุง ุขููุฒุด ุฏุงุฏูโูุง ุจุงุฏ ฺฉุงู ุจุงุดุฏ.

    > ุชูุฌู: ุงุฒ ุขูุฌุง ฺฉู ุชุงุจุน ฺฉู ุจุฑุง ุจุฑุงุฒุด ูุฏู ARIMA ุงุณุชูุงุฏู ูโฺฉูู ุงุฒ ุงุนุชุจุงุฑุณูุฌ ุฏุฑูู ูููููโุง ุฏุฑ ุทูู ุจุฑุงุฒุด ุงุณุชูุงุฏู ูโฺฉูุฏุ ุฏุงุฏูโูุง ุงุนุชุจุงุฑุณูุฌ ุฑุง ุญุฐู ุฎูุงูู ฺฉุฑุฏ.

### ุขูุงุฏูโุณุงุฒ ุฏุงุฏูโูุง ุจุฑุง ุขููุฒุด

ุญุงูุง ุจุงุฏ ุฏุงุฏูโูุง ุฑุง ุจุฑุง ุขููุฒุด ุขูุงุฏู ฺฉูุฏ. ุงู ฺฉุงุฑ ุจุง ููุชุฑ ฺฉุฑุฏู ู ููุงุณโุจูุฏ ุฏุงุฏูโูุง ุงูุฌุงู ูโุดูุฏ. ุฏุงุฏูโูุง ุฎูุฏ ุฑุง ููุชุฑ ฺฉูุฏ ุชุง ููุท ุจุงุฒูโูุง ุฒูุงู ู ุณุชููโูุง ููุฑุฏ ูุงุฒ ุฑุง ุดุงูู ุดูุฏ ู ููุงุณโุจูุฏ ฺฉูุฏ ุชุง ุฏุงุฏูโูุง ุฏุฑ ุจุงุฒู 0 ู 1 ูุฑุงุฑ ฺฏุฑูุฏ.

1. ูุฌููุนู ุฏุงุฏู ุงุตู ุฑุง ููุชุฑ ฺฉูุฏ ุชุง ููุท ุจุงุฒูโูุง ุฒูุงู ุฐฺฉุฑ ุดุฏู ุฏุฑ ูุฑ ูุฌููุนู ู ููุท ุณุชูู ููุฑุฏ ูุงุฒ 'load' ุจู ุนูุงูู ุชุงุฑุฎ ุฑุง ุดุงูู ุดูุฏ:

    ```python
    train = energy.copy()[(energy.index >= train_start_dt) & (energy.index < test_start_dt)][['load']]
    test = energy.copy()[energy.index >= test_start_dt][['load']]

    print('Training data shape: ', train.shape)
    print('Test data shape: ', test.shape)
    ```

    ูโุชูุงูุฏ ุดฺฉู ุฏุงุฏูโูุง ุฑุง ุจุจูุฏ:

    ```output
    Training data shape:  (1416, 1)
    Test data shape:  (48, 1)
    ```

1. ุฏุงุฏูโูุง ุฑุง ุจู ุจุงุฒู (0, 1) ููุงุณโุจูุฏ ฺฉูุฏ.

    ```python
    scaler = MinMaxScaler()
    train['load'] = scaler.fit_transform(train)
    train.head(10)
    ```

1. ุฏุงุฏูโูุง ุงุตู ุฏุฑ ููุงุจู ุฏุงุฏูโูุง ููุงุณโุจูุฏ ุดุฏู ุฑุง ุชุฌุณู ฺฉูุฏ:

    ```python
    energy[(energy.index >= train_start_dt) & (energy.index < test_start_dt)][['load']].rename(columns={'load':'original load'}).plot.hist(bins=100, fontsize=12)
    train.rename(columns={'load':'scaled load'}).plot.hist(bins=100, fontsize=12)
    plt.show()
    ```

    ![ุงุตู](../../../../translated_images/original.b2b15efe0ce92b8745918f071dceec2231661bf49c8db6918e3ff4b3b0b183c2.fa.png)

    > ุฏุงุฏูโูุง ุงุตู

    ![ููุงุณโุจูุฏ ุดุฏู](../../../../translated_images/scaled.e35258ca5cd3d43f86d5175e584ba96b38d51501f234abf52e11f4fe2631e45f.fa.png)

    > ุฏุงุฏูโูุง ููุงุณโุจูุฏ ุดุฏู

1. ุญุงูุง ฺฉู ุฏุงุฏูโูุง ููุงุณโุจูุฏ ุดุฏู ุฑุง ฺฉุงูุจุฑู ฺฉุฑุฏูโุงุฏุ ูโุชูุงูุฏ ุฏุงุฏูโูุง ุขุฒูุงุด ุฑุง ูุฒ ููุงุณโุจูุฏ ฺฉูุฏ:

    ```python
    test['load'] = scaler.transform(test)
    test.head()
    ```

### ูพุงุฏูโุณุงุฒ ARIMA

ุฒูุงู ูพุงุฏูโุณุงุฒ ARIMA ูุฑุง ุฑุณุฏู ุงุณุช! ุงฺฉููู ุงุฒ ฺฉุชุงุจุฎุงูู `statsmodels` ฺฉู ูุจูุงู ูุตุจ ฺฉุฑุฏูโุงุฏ ุงุณุชูุงุฏู ุฎูุงูุฏ ฺฉุฑุฏ.

ุญุงูุง ุจุงุฏ ฺูุฏ ูุฑุญูู ุฑุง ุฏูุจุงู ฺฉูุฏ:

   1. ูุฏู ุฑุง ุจุง ูุฑุงุฎูุงู `SARIMAX()` ู ูุงุฑุฏ ฺฉุฑุฏู ูพุงุฑุงูุชุฑูุง ูุฏู: ูพุงุฑุงูุชุฑูุง pุ d ู qุ ู ูพุงุฑุงูุชุฑูุง Pุ D ู Q ุชุนุฑู ฺฉูุฏ.
   2. ูุฏู ุฑุง ุจุฑุง ุฏุงุฏูโูุง ุขููุฒุด ุจุง ูุฑุงุฎูุงู ุชุงุจุน fit() ุขูุงุฏู ฺฉูุฏ.
   3. ุจุง ูุฑุงุฎูุงู ุชุงุจุน `forecast()` ู ูุดุฎุต ฺฉุฑุฏู ุชุนุฏุงุฏ ฺฏุงูโูุง (ุงูู ูพุดโุจู)ุ ูพุดโุจู ฺฉูุฏ.

> ๐ ุงู ูพุงุฑุงูุชุฑูุง ุจุฑุง ฺุณุชุ ุฏุฑ ฺฉ ูุฏู ARIMA ุณู ูพุงุฑุงูุชุฑ ูุฌูุฏ ุฏุงุฑุฏ ฺฉู ุจุฑุง ฺฉูฺฉ ุจู ูุฏูโุณุงุฒ ุฌูุจูโูุง ุงุตู ฺฉ ุณุฑ ุฒูุงู ุงุณุชูุงุฏู ูโุดููุฏ: ูุตู ุจูุฏูุ ุฑููุฏ ู ููุฒ. ุงู ูพุงุฑุงูุชุฑูุง ุนุจุงุฑุชูุฏ ุงุฒ:

`p`: ูพุงุฑุงูุชุฑ ฺฉู ุจุง ุฌูุจู ุฎูุฏุฑฺฏุฑุณู ูุฏู ูุฑุชุจุท ุงุณุช ู ููุงุฏุฑ *ฺฏุฐุดุชู* ุฑุง ุฏุฑ ุจุฑ ูโฺฏุฑุฏ.  
`d`: ูพุงุฑุงูุชุฑ ฺฉู ุจุง ุจุฎุด ฺฉูพุงุฑฺู ูุฏู ูุฑุชุจุท ุงุณุช ู ูุฒุงู *ุชูุงุถูโฺฏุฑ* (๐ ุชูุงุถูโฺฏุฑ ุฑุง ุจู ุงุฏ ุฏุงุฑุฏุ ๐) ุฑุง ุจุฑุง ุงุนูุงู ุจุฑ ุณุฑ ุฒูุงู ุชุนู ูโฺฉูุฏ.  
`q`: ูพุงุฑุงูุชุฑ ฺฉู ุจุง ุจุฎุด ูุงูฺฏู ูุชุญุฑฺฉ ูุฏู ูุฑุชุจุท ุงุณุช.

> ุชูุฌู: ุงฺฏุฑ ุฏุงุฏูโูุง ุดูุง ุฌูุจู ูุตู ุฏุงุดุชู ุจุงุดุฏ - ฺฉู ุงู ุฏุงุฏูโูุง ุฏุงุฑูุฏ - ุงุฒ ฺฉ ูุฏู ARIMA ูุตู (SARIMA) ุงุณุชูุงุฏู ูโฺฉูู. ุฏุฑ ุงู ุตูุฑุช ุจุงุฏ ุงุฒ ูุฌููุนู ุฏฺฏุฑ ุงุฒ ูพุงุฑุงูุชุฑูุง ุงุณุชูุงุฏู ฺฉูุฏ: `P`ุ `D` ู `Q` ฺฉู ููุงู ุงุฑุชุจุงุทุงุช `p`ุ `d` ู `q` ุฑุง ุชูุตู ูโฺฉููุฏุ ุงูุง ุจู ุงุฌุฒุง ูุตู ูุฏู ูุฑุจูุท ูโุดููุฏ.

1. ุงุจุชุฏุง ููุฏุงุฑ ุงูู ูพุดโุจู ููุฑุฏ ูุธุฑ ุฎูุฏ ุฑุง ุชูุธู ฺฉูุฏ. ุจุงุฏ 3 ุณุงุนุช ุฑุง ุงูุชุญุงู ฺฉูู:

    ```python
    # Specify the number of steps to forecast ahead
    HORIZON = 3
    print('Forecasting horizon:', HORIZON, 'hours')
    ```

    ุงูุชุฎุงุจ ุจูุชุฑู ููุงุฏุฑ ุจุฑุง ูพุงุฑุงูุชุฑูุง ูุฏู ARIMA ูโุชูุงูุฏ ฺุงูุดโุจุฑุงูฺฏุฒ ุจุงุดุฏ ุฒุฑุง ุชุง ุญุฏ ุฐูู ู ุฒูุงูโุจุฑ ุงุณุช. ููฺฉู ุงุณุช ุจุฎูุงูุฏ ุงุฒ ุชุงุจุน `auto_arima()` ุงุฒ ฺฉุชุงุจุฎุงูู [`pyramid`](https://alkaline-ml.com/pmdarima/0.9.0/modules/generated/pyramid.arima.auto_arima.html) ุงุณุชูุงุฏู ฺฉูุฏ.

1. ูุนูุงู ฺูุฏ ุงูุชุฎุงุจ ุฏุณุช ุฑุง ุงูุชุญุงู ฺฉูุฏ ุชุง ฺฉ ูุฏู ุฎูุจ ูพุฏุง ฺฉูุฏ.

    ```python
    order = (4, 1, 0)
    seasonal_order = (1, 1, 0, 24)

    model = SARIMAX(endog=train, order=order, seasonal_order=seasonal_order)
    results = model.fit()

    print(results.summary())
    ```

    ฺฉ ุฌุฏูู ุงุฒ ูุชุงุฌ ฺุงูพ ูโุดูุฏ.

ุดูุง ุงููู ูุฏู ุฎูุฏ ุฑุง ุณุงุฎุชุฏ! ุญุงูุง ุจุงุฏ ุฑุงู ุจุฑุง ุงุฑุฒุงุจ ุขู ูพุฏุง ฺฉูู.

### ุงุฑุฒุงุจ ูุฏู ุดูุง

ุจุฑุง ุงุฑุฒุงุจ ูุฏู ุฎูุฏุ ูโุชูุงูุฏ ุงุฒ ุงุนุชุจุงุฑุณูุฌ ุจู ุฑูุด `walk forward` ุงุณุชูุงุฏู ฺฉูุฏ. ุฏุฑ ุนููุ ูุฏูโูุง ุณุฑ ุฒูุงู ูุฑ ุจุงุฑ ฺฉู ุฏุงุฏู ุฌุฏุฏ ุฏุฑ ุฏุณุชุฑุณ ูุฑุงุฑ ูโฺฏุฑุฏุ ุฏูุจุงุฑู ุขููุฒุด ุฏุงุฏู ูโุดููุฏ. ุงู ฺฉุงุฑ ุจู ูุฏู ุงุฌุงุฒู ูโุฏูุฏ ุชุง ุจูุชุฑู ูพุดโุจู ุฑุง ุฏุฑ ูุฑ ฺฏุงู ุฒูุงู ุงูุฌุงู ุฏูุฏ.

ุจุง ุดุฑูุน ุงุฒ ุงุจุชุฏุง ุณุฑ ุฒูุงู ู ุงุณุชูุงุฏู ุงุฒ ุงู ุชฺฉูฺฉุ ูุฏู ุฑุง ุฑู ูุฌููุนู ุฏุงุฏู ุขููุฒุด ุขููุฒุด ุฏูุฏ. ุณูพุณ ฺฉ ูพุดโุจู ุจุฑุง ฺฏุงู ุฒูุงู ุจุนุฏ ุงูุฌุงู ุฏูุฏ. ูพุดโุจู ุจุง ููุฏุงุฑ ุดูุงุฎุชูโุดุฏู ุงุฑุฒุงุจ ูโุดูุฏ. ุณูพุณ ูุฌููุนู ุขููุฒุด ฺฏุณุชุฑุด ูโุงุจุฏ ุชุง ููุฏุงุฑ ุดูุงุฎุชูโุดุฏู ุฑุง ุดุงูู ุดูุฏ ู ุงู ูุฑุขูุฏ ุชฺฉุฑุงุฑ ูโุดูุฏ.

> ุชูุฌู: ุจุฑุง ุขููุฒุด ฺฉุงุฑุขูุฏุชุฑุ ุจุงุฏ ูพูุฌุฑู ูุฌููุนู ุขููุฒุด ุฑุง ุซุงุจุช ูฺฏู ุฏุงุฑุฏ ุชุง ูุฑ ุจุงุฑ ฺฉู ฺฉ ูุดุงูุฏู ุฌุฏุฏ ุจู ูุฌููุนู ุขููุฒุด ุงุถุงูู ูโฺฉูุฏุ ูุดุงูุฏูโุง ุฑุง ุงุฒ ุงุจุชุฏุง ูุฌููุนู ุญุฐู ฺฉูุฏ.

ุงู ูุฑุขูุฏ ุชุฎูู ููโุชุฑ ุงุฒ ุนููฺฉุฑุฏ ูุฏู ุฏุฑ ุนูู ุงุฑุงุฆู ูโุฏูุฏ. ุจุง ุงู ุญุงูุ ูุฒูู ูุญุงุณุจุงุช ุงุฌุงุฏ ูุฏูโูุง ูุชุนุฏุฏ ุฑุง ุจู ููุฑุงู ุฏุงุฑุฏ. ุงู ููุถูุน ุฏุฑ ุตูุฑุช ฺฉู ุฏุงุฏูโูุง ฺฉูฺฺฉ ุจุงุดูุฏ ุง ูุฏู ุณุงุฏู ุจุงุดุฏ ูุงุจู ูุจูู ุงุณุชุ ุงูุง ุฏุฑ ููุงุณ ูโุชูุงูุฏ ูุดฺฉูโุณุงุฒ ุจุงุดุฏ.

ุงุนุชุจุงุฑุณูุฌ ุจู ุฑูุด walk-forward ุงุณุชุงูุฏุงุฑุฏ ุทูุง ุงุฑุฒุงุจ ูุฏูโูุง ุณุฑ ุฒูุงู ุงุณุช ู ุจุฑุง ูพุฑูฺูโูุง ุฎูุฏุชุงู ุชูุตู ูโุดูุฏ.

1. ุงุจุชุฏุง ฺฉ ููุทู ุฏุงุฏู ุขุฒูุงุด ุจุฑุง ูุฑ ฺฏุงู HORIZON ุงุฌุงุฏ ฺฉูุฏ.

    ```python
    test_shifted = test.copy()

    for t in range(1, HORIZON+1):
        test_shifted['load+'+str(t)] = test_shifted['load'].shift(-t, freq='H')

    test_shifted = test_shifted.dropna(how='any')
    test_shifted.head(5)
    ```

    |            |          | load | load+1 | load+2 |
    | ---------- | -------- | ---- | ------ | ------ |
    | 2014-12-30 | 00:00:00 | 0.33 | 0.29   | 0.27   |
    | 2014-12-30 | 01:00:00 | 0.29 | 0.27   | 0.27   |
    | 2014-12-30 | 02:00:00 | 0.27 | 0.27   | 0.30   |
    | 2014-12-30 | 03:00:00 | 0.27 | 0.30   | 0.41   |
    | 2014-12-30 | 04:00:00 | 0.30 | 0.41   | 0.57   |

    ุฏุงุฏูโูุง ุจู ุตูุฑุช ุงูู ุจุฑ ุงุณุงุณ ููุทู ุงูู ูพุดโุจู ุฌุงุจูโุฌุง ูโุดููุฏ.

1. ุจุง ุงุณุชูุงุฏู ุงุฒ ุงู ุฑูฺฉุฑุฏ ูพูุฌุฑู ูุบุฒุงู ุฏุฑ ฺฉ ุญููู ุจู ุงูุฏุงุฒู ุทูู ุฏุงุฏูโูุง ุขุฒูุงุดุ ูพุดโุจู ฺฉูุฏ:

    ```python
    %%time
    training_window = 720 # dedicate 30 days (720 hours) for training

    train_ts = train['load']
    test_ts = test_shifted

    history = [x for x in train_ts]
    history = history[(-training_window):]

    predictions = list()

    order = (2, 1, 0)
    seasonal_order = (1, 1, 0, 24)

    for t in range(test_ts.shape[0]):
        model = SARIMAX(endog=history, order=order, seasonal_order=seasonal_order)
        model_fit = model.fit()
        yhat = model_fit.forecast(steps = HORIZON)
        predictions.append(yhat)
        obs = list(test_ts.iloc[t])
        # move the training window
        history.append(obs[0])
        history.pop(0)
        print(test_ts.index[t])
        print(t+1, ': predicted =', yhat, 'expected =', obs)
    ```

    ูโุชูุงูุฏ ูุฑุขูุฏ ุขููุฒุด ุฑุง ูุดุงูุฏู ฺฉูุฏ:

    ```output
    2014-12-30 00:00:00
    1 : predicted = [0.32 0.29 0.28] expected = [0.32945389435989236, 0.2900626678603402, 0.2739480752014323]

    2014-12-30 01:00:00
    2 : predicted = [0.3  0.29 0.3 ] expected = [0.2900626678603402, 0.2739480752014323, 0.26812891674127126]

    2014-12-30 02:00:00
    3 : predicted = [0.27 0.28 0.32] expected = [0.2739480752014323, 0.26812891674127126, 0.3025962399283795]
    ```

1. ูพุดโุจูโูุง ุฑุง ุจุง ุจุงุฑ ูุงูุน ููุงุณู ฺฉูุฏ:

    ```python
    eval_df = pd.DataFrame(predictions, columns=['t+'+str(t) for t in range(1, HORIZON+1)])
    eval_df['timestamp'] = test.index[0:len(test.index)-HORIZON+1]
    eval_df = pd.melt(eval_df, id_vars='timestamp', value_name='prediction', var_name='h')
    eval_df['actual'] = np.array(np.transpose(test_ts)).ravel()
    eval_df[['prediction', 'actual']] = scaler.inverse_transform(eval_df[['prediction', 'actual']])
    eval_df.head()
    ```

    ุฎุฑูุฌ
    |     |            | timestamp | h   | prediction | actual   |
    | --- | ---------- | --------- | --- | ---------- | -------- |
    | 0   | 2014-12-30 | 00:00:00  | t+1 | 3,008.74   | 3,023.00 |
    | 1   | 2014-12-30 | 01:00:00  | t+1 | 2,955.53   | 2,935.00 |
    | 2   | 2014-12-30 | 02:00:00  | t+1 | 2,900.17   | 2,899.00 |
    | 3   | 2014-12-30 | 03:00:00  | t+1 | 2,917.69   | 2,886.00 |
    | 4   | 2014-12-30 | 04:00:00  | t+1 | 2,946.99   | 2,963.00 |

    ูพุดโุจู ุฏุงุฏูโูุง ุณุงุนุช ุฑุง ุฏุฑ ููุงุณู ุจุง ุจุงุฑ ูุงูุน ูุดุงูุฏู ฺฉูุฏ. ุงู ฺูุฏุฑ ุฏูู ุงุณุชุ

### ุจุฑุฑุณ ุฏูุช ูุฏู

ุฏูุช ูุฏู ุฎูุฏ ุฑุง ุจุง ุขุฒูุงุด ูุงูฺฏู ุฏุฑุตุฏ ุฎุทุง ูุทูู (MAPE) ุขู ุฏุฑ ุชูุงู ูพุดโุจูโูุง ุจุฑุฑุณ ฺฉูุฏ.
> **๐งฎ ูุฑููู ุฑุงุถ ุฑุง ุจุจูุฏ**
>
> ![MAPE](../../../../translated_images/mape.fd87bbaf4d346846df6af88b26bf6f0926bf9a5027816d5e23e1200866e3e8a4.fa.png)
>
> [MAPE](https://www.linkedin.com/pulse/what-mape-mad-msd-time-series-allameh-statistics/) ุจุฑุง ูุดุงู ุฏุงุฏู ุฏูุช ูพุดโุจู ุจู ุนููุงู ฺฉ ูุณุจุช ุชุนุฑู ุดุฏู ุชูุณุท ูุฑููู ุจุงูุง ุงุณุชูุงุฏู ูโุดูุฏ. ุชูุงูุช ุจู ููุฏุงุฑ ูุงูุน ู ูพุดโุจูโุดุฏู ุจุฑ ููุฏุงุฑ ูุงูุน ุชูุณู ูโุดูุฏ.  
> "ููุฏุงุฑ ูุทูู ุฏุฑ ุงู ูุญุงุณุจู ุจุฑุง ูุฑ ููุทู ูพุดโุจูโุดุฏู ุฏุฑ ุฒูุงู ุฌูุน ุดุฏู ู ุจุฑ ุชุนุฏุงุฏ ููุงุท ุจุฑุงุฒุดโุดุฏู n ุชูุณู ูโุดูุฏ." [ูฺฉโูพุฏุง](https://wikipedia.org/wiki/Mean_absolute_percentage_error)
1. ูุนุงุฏูู ุฑุง ุฏุฑ ฺฉุฏ ุจุงู ฺฉูุฏ:

    ```python
    if(HORIZON > 1):
        eval_df['APE'] = (eval_df['prediction'] - eval_df['actual']).abs() / eval_df['actual']
        print(eval_df.groupby('h')['APE'].mean())
    ```

1. MAPE ฺฉ ูุฑุญููโุง ุฑุง ูุญุงุณุจู ฺฉูุฏ:

    ```python
    print('One step forecast MAPE: ', (mape(eval_df[eval_df['h'] == 't+1']['prediction'], eval_df[eval_df['h'] == 't+1']['actual']))*100, '%')
    ```

    MAPE ูพุดโุจู ฺฉ ูุฑุญููโุง:  0.5570581332313952 %

1. MAPE ูพุดโุจู ฺูุฏ ูุฑุญููโุง ุฑุง ฺุงูพ ฺฉูุฏ:

    ```python
    print('Multi-step forecast MAPE: ', mape(eval_df['prediction'], eval_df['actual'])*100, '%')
    ```

    ```output
    Multi-step forecast MAPE:  1.1460048657704118 %
    ```

    ฺฉ ุนุฏุฏ ูพุงู ู ููุงุณุจ ุจูุชุฑู ุงุณุช: ุฏุฑ ูุธุฑ ุฏุงุดุชู ุจุงุดุฏ ฺฉู ูพุดโุจู ุจุง MAPE ุจุฑุงุจุฑ ุจุง 10 ุจู ูุนูุง ุฎุทุง 10 ุฏุฑุตุฏ ุงุณุช.

1. ุงูุง ููุงูโุทูุฑ ฺฉู ููุดู ฺฏูุชู ูโุดูุฏุ ุฏุฏู ุงู ููุน ุงูุฏุงุฒูโฺฏุฑ ุฏูุช ุจู ุตูุฑุช ุจุตุฑ ุขุณุงูโุชุฑ ุงุณุชุ ูพุณ ุจุงุฏ ุขู ุฑุง ุฑุณู ฺฉูู:

    ```python
     if(HORIZON == 1):
        ## Plotting single step forecast
        eval_df.plot(x='timestamp', y=['actual', 'prediction'], style=['r', 'b'], figsize=(15, 8))

    else:
        ## Plotting multi step forecast
        plot_df = eval_df[(eval_df.h=='t+1')][['timestamp', 'actual']]
        for t in range(1, HORIZON+1):
            plot_df['t+'+str(t)] = eval_df[(eval_df.h=='t+'+str(t))]['prediction'].values

        fig = plt.figure(figsize=(15, 8))
        ax = plt.plot(plot_df['timestamp'], plot_df['actual'], color='red', linewidth=4.0)
        ax = fig.add_subplot(111)
        for t in range(1, HORIZON+1):
            x = plot_df['timestamp'][(t-1):]
            y = plot_df['t+'+str(t)][0:len(x)]
            ax.plot(x, y, color='blue', linewidth=4*math.pow(.9,t), alpha=math.pow(0.8,t))

        ax.legend(loc='best')

    plt.xlabel('timestamp', fontsize=12)
    plt.ylabel('load', fontsize=12)
    plt.show()
    ```

    ![ฺฉ ูุฏู ุณุฑ ุฒูุงู](../../../../translated_images/accuracy.2c47fe1bf15f44b3656651c84d5e2ba9b37cd929cd2aa8ab6cc3073f50570f4e.fa.png)

๐ ฺฉ ูููุฏุงุฑ ุจุณุงุฑ ุฒุจุง ฺฉู ูุฏู ุจุง ุฏูุช ุฎูุจ ุฑุง ูุดุงู ูโุฏูุฏ. ุนุงู ฺฉุงุฑ ฺฉุฑุฏุฏ!

---

## ๐ฺุงูุด

ุฑูุดโูุง ูุฎุชูู ุจุฑุง ุขุฒููุฏู ุฏูุช ฺฉ ูุฏู ุณุฑ ุฒูุงู ุฑุง ุจุฑุฑุณ ฺฉูุฏ. ุฏุฑ ุงู ุฏุฑุณ ุจู MAPE ุงุดุงุฑู ุดุฏุ ุงูุง ุขุง ุฑูุดโูุง ุฏฺฏุฑ ูุฌูุฏ ุฏุงุฑุฏ ฺฉู ุจุชูุงูุฏ ุงุณุชูุงุฏู ฺฉูุฏุ ุฏุฑุจุงุฑู ุขูโูุง ุชุญูู ฺฉูุฏ ู ุชูุถุญ ุฏูุฏ. ฺฉ ุณูุฏ ููุฏ ุฑุง ูโุชูุงูุฏ [ุงูุฌุง](https://otexts.com/fpp2/accuracy.html) ูพุฏุง ฺฉูุฏ.

## [ุขุฒููู ูพุณ ุงุฒ ุฏุฑุณ](https://gray-sand-07a10f403.1.azurestaticapps.net/quiz/44/)

## ูุฑูุฑ ู ูุทุงูุนู ุดุฎุต

ุงู ุฏุฑุณ ุชููุง ุจู ุงุตูู ุงููู ูพุดโุจู ุณุฑ ุฒูุงู ุจุง ARIMA ูพุฑุฏุงุฎุชู ุงุณุช. ุฒูุงู ุฑุง ุจุฑุง ุนููโุชุฑ ฺฉุฑุฏู ุฏุงูุด ุฎูุฏ ุงุฎุชุตุงุต ุฏูุฏ ู ุจู [ุงู ูุฎุฒู](https://microsoft.github.io/forecasting/) ู ุงููุงุน ูุฏูโูุง ูุฎุชูู ุขู ูฺฏุงู ุจูุฏุงุฒุฏ ุชุง ุฑูุดโูุง ุฏฺฏุฑ ุจุฑุง ุณุงุฎุช ูุฏูโูุง ุณุฑ ุฒูุงู ุงุฏ ุจฺฏุฑุฏ.

## ุชฺฉูู

[ฺฉ ูุฏู ARIMA ุฌุฏุฏ](assignment.md)

---

**ุณูุจ ูุณุฆููุช**:  
ุงู ุณูุฏ ุจุง ุงุณุชูุงุฏู ุงุฒ ุณุฑูุณ ุชุฑุฌูู ููุด ูุตููุน [Co-op Translator](https://github.com/Azure/co-op-translator) ุชุฑุฌูู ุดุฏู ุงุณุช. ุฏุฑ ุญุงู ฺฉู ูุง ุชูุงุด ูโฺฉูู ุฏูุช ุฑุง ุญูุธ ฺฉููุ ูุทูุงู ุชูุฌู ุฏุงุดุชู ุจุงุดุฏ ฺฉู ุชุฑุฌููโูุง ุฎูุฏฺฉุงุฑ ููฺฉู ุงุณุช ุดุงูู ุฎุทุงูุง ุง ูุงุฏุฑุณุชโูุง ุจุงุดูุฏ. ุณูุฏ ุงุตู ุจู ุฒุจุงู ุงุตู ุขู ุจุงุฏ ุจู ุนููุงู ููุจุน ูุนุชุจุฑ ุฏุฑ ูุธุฑ ฺฏุฑูุชู ุดูุฏ. ุจุฑุง ุงุทูุงุนุงุช ุญุณุงุณุ ุชูุตู ูโุดูุฏ ุงุฒ ุชุฑุฌูู ุญุฑููโุง ุงูุณุงู ุงุณุชูุงุฏู ฺฉูุฏ. ูุง ูุณุฆููุช ุฏุฑ ูุจุงู ุณูุกุชูุงููโูุง ุง ุชูุณุฑูุง ูุงุฏุฑุณุช ูุงุด ุงุฒ ุงุณุชูุงุฏู ุงุฒ ุงู ุชุฑุฌูู ูุฏุงุฑู.