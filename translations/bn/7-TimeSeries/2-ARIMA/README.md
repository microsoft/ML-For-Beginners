<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "917dbf890db71a322f306050cb284749",
  "translation_date": "2025-09-04T21:01:18+00:00",
  "source_file": "7-TimeSeries/2-ARIMA/README.md",
  "language_code": "bn"
}
-->
# ARIMA ржжрж┐рзЯрзЗ ржЯрж╛ржЗржо рж╕рж┐рж░рж┐ржЬ ржкрзВрж░рзНржмрж╛ржнрж╛рж╕

ржкрзВрж░рзНржмржмрж░рзНрждрзА ржкрж╛ржарзЗ, ржЖржкржирж┐ ржЯрж╛ржЗржо рж╕рж┐рж░рж┐ржЬ ржкрзВрж░рзНржмрж╛ржнрж╛рж╕ рж╕ржорзНржкрж░рзНржХрзЗ ржХрж┐ржЫрзБ рж╢рж┐ржЦрзЗржЫрзЗржи ржПржмржВ ржПржХржЯрж┐ ржбрзЗржЯрж╛рж╕рзЗржЯ рж▓рзЛржб ржХрж░рзЗржЫрзЗржи ржпрж╛ ржПржХржЯрж┐ ржирж┐рж░рзНржжрж┐рж╖рзНржЯ рж╕ржоржпрж╝ржХрж╛рж▓рзЗ ржмрзИржжрзНржпрзБрждрж┐ржХ рж▓рзЛржбрзЗрж░ ржУржарж╛ржирж╛ржорж╛ ржжрзЗржЦрж╛ржпрж╝ред

[![ARIMA ржкрж░рж┐ржЪрж┐рждрж┐](https://img.youtube.com/vi/IUSk-YDau10/0.jpg)](https://youtu.be/IUSk-YDau10 "ARIMA ржоржбрзЗрж▓рзЗрж░ ржкрж░рж┐ржЪрж┐рждрж┐")

> ЁЯОе ржЙржкрж░рзЗрж░ ржЫржмрж┐рждрзЗ ржХрзНрж▓рж┐ржХ ржХрж░рзБржи ржПржХржЯрж┐ ржнрж┐ржбрж┐ржУрж░ ржЬржирзНржп: ARIMA ржоржбрзЗрж▓рзЗрж░ рж╕ржВржХрзНрж╖рж┐ржкрзНржд ржкрж░рж┐ржЪрж┐рждрж┐ред ржЙржжрж╛рж╣рж░ржгржЯрж┐ R-ржП ржХрж░рж╛ рж╣ржпрж╝рзЗржЫрзЗ, рждржмрзЗ ржзрж╛рж░ржгрж╛ржЧрзБрж▓рж┐ рж╕рж╛рж░рзНржмржЬржирзАржиред

## [ржкрзВрж░рзНржм-ржкрж╛ржа ржХрзБржЗржЬ](https://ff-quizzes.netlify.app/en/ml/)

## ржкрж░рж┐ржЪрж┐рждрж┐

ржПржЗ ржкрж╛ржарзЗ, ржЖржкржирж┐ ржПржХржЯрж┐ ржирж┐рж░рзНржжрж┐рж╖рзНржЯ ржкржжрзНржзрждрж┐ ржЖржмрж┐рж╖рзНржХрж╛рж░ ржХрж░ржмрзЗржи [ARIMA: *A*uto*R*egressive *I*ntegrated *M*oving *A*verage](https://wikipedia.org/wiki/Autoregressive_integrated_moving_average) ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ ржоржбрзЗрж▓ рждрзИрж░рж┐ ржХрж░рж╛рж░ред ARIMA ржоржбрзЗрж▓ ржмрж┐рж╢рзЗрж╖ржнрж╛ржмрзЗ ржЙржкржпрзБржХрзНржд [non-stationarity](https://wikipedia.org/wiki/Stationary_process) ржкрзНрж░ржжрж░рзНрж╢ржиржХрж╛рж░рзА ржбрзЗржЯрж╛рж░ ржЬржирзНржпред

## рж╕рж╛ржзрж╛рж░ржг ржзрж╛рж░ржгрж╛

ARIMA ржирж┐ржпрж╝рзЗ ржХрж╛ржЬ ржХрж░рждрзЗ рж╣рж▓рзЗ ржХрж┐ржЫрзБ ржзрж╛рж░ржгрж╛ рж╕ржорзНржкрж░рзНржХрзЗ ржЬрж╛ржирж╛ ржкрзНрж░ржпрж╝рзЛржЬржи:

- ЁЯОУ **Stationarity**ред ржкрж░рж┐рж╕ржВржЦрзНржпрж╛ржиржЧржд ржкрзНрж░рзЗржХрзНрж╖рж╛ржкржЯрзЗ, рж╕рзНржЯрзЗрж╢ржирж╛рж░рж┐ржЯрж┐ ржПржоржи ржбрзЗржЯрж╛ржХрзЗ ржмрзЛржЭрж╛ржпрж╝ ржпрж╛рж░ ржмрж┐рждрж░ржг рж╕ржоржпрж╝рзЗ рж╕рзНржерж╛ржирж╛ржирзНрждрж░рж┐ржд рж╣рж▓рзЗржУ ржкрж░рж┐ржмрж░рзНрждрж┐ржд рж╣ржпрж╝ ржирж╛ред Non-stationary ржбрзЗржЯрж╛, рждржЦржи ржкрзНрж░ржмржгрждрж╛рж░ ржХрж╛рж░ржгрзЗ ржУржарж╛ржирж╛ржорж╛ ржжрзЗржЦрж╛ржпрж╝ ржпрж╛ ржмрж┐рж╢рзНрж▓рзЗрж╖ржгрзЗрж░ ржЬржирзНржп рж░рзВржкрж╛ржирзНрждрж░рж┐ржд ржХрж░рждрзЗ рж╣ржпрж╝ред ржЙржжрж╛рж╣рж░ржгрж╕рзНржмрж░рзВржк, ржорзМрж╕рзБржорзА ржкрзНрж░ржмржгрждрж╛ ржбрзЗржЯрж╛ржпрж╝ ржУржарж╛ржирж╛ржорж╛ ржЖржирждрзЗ ржкрж╛рж░рзЗ ржПржмржВ 'seasonal-differencing' ржкрзНрж░ржХрзНрж░рж┐ржпрж╝рж╛рж░ ржорж╛ржзрзНржпржорзЗ ржПржЯрж┐ ржжрзВрж░ ржХрж░рж╛ ржпрж╛ржпрж╝ред

- ЁЯОУ **[Differencing](https://wikipedia.org/wiki/Autoregressive_integrated_moving_average#Differencing)**ред ржкрж░рж┐рж╕ржВржЦрзНржпрж╛ржиржЧржд ржкрзНрж░рзЗржХрзНрж╖рж╛ржкржЯрзЗ, ржбрзЗржЯрж╛ржХрзЗ рж╕рзНржЯрзЗрж╢ржирж╛рж░рж┐ ржХрж░рждрзЗ рж░рзВржкрж╛ржирзНрждрж░ ржХрж░рж╛рж░ ржкрзНрж░ржХрзНрж░рж┐ржпрж╝рж╛ржХрзЗ ржбрж┐ржлрж╛рж░рзЗржирзНрж╕рж┐ржВ ржмрж▓рж╛ рж╣ржпрж╝ред ржПржЯрж┐ ржбрзЗржЯрж╛рж░ non-constant ржкрзНрж░ржмржгрждрж╛ рж╕рж░рж┐ржпрж╝рзЗ ржжрзЗржпрж╝ред "ржбрж┐ржлрж╛рж░рзЗржирзНрж╕рж┐ржВ ржЯрж╛ржЗржо рж╕рж┐рж░рж┐ржЬрзЗрж░ рж╕рзНрждрж░рзЗрж░ ржкрж░рж┐ржмрж░рзНрждржиржЧрзБрж▓рж┐ рж╕рж░рж┐ржпрж╝рзЗ ржжрзЗржпрж╝, ржкрзНрж░ржмржгрждрж╛ ржПржмржВ ржорзМрж╕рзБржорзАрждрж╛ ржжрзВрж░ ржХрж░рзЗ ржПржмржВ ржЯрж╛ржЗржо рж╕рж┐рж░рж┐ржЬрзЗрж░ ржЧржбрж╝ржХрзЗ рж╕рзНржерж┐рждрж┐рж╢рзАрж▓ ржХрж░рзЗред" [Shixiong et al-ржПрж░ ржкрзЗржкрж╛рж░](https://arxiv.org/abs/1904.07632)

## ржЯрж╛ржЗржо рж╕рж┐рж░рж┐ржЬрзЗрж░ ржкрзНрж░рзЗржХрзНрж╖рж╛ржкржЯрзЗ ARIMA

ARIMA-ржПрж░ ржЕржВрж╢ржЧрзБрж▓рзЛ ржмрж┐рж╢рзНрж▓рзЗрж╖ржг ржХрж░рзЗ ржжрзЗржЦрж╛ ржпрж╛ржХ ржПржЯрж┐ ржХрзАржнрж╛ржмрзЗ ржЯрж╛ржЗржо рж╕рж┐рж░рж┐ржЬ ржоржбрзЗрж▓ ржХрж░рждрзЗ рж╕рж╛рж╣рж╛ржпрзНржп ржХрж░рзЗ ржПржмржВ ржкрзВрж░рзНржмрж╛ржнрж╛рж╕ ржжрж┐рждрзЗ рж╕рж╣рж╛ржпрж╝рждрж╛ ржХрж░рзЗред

- **AR - AutoRegressive**ред ржЕржЯрзЛ-рж░рж┐ржЧрзНрж░рзЗрж╕рж┐ржн ржоржбрзЗрж▓, ржирж╛ржо ржерзЗржХрзЗржЗ ржмрзЛржЭрж╛ ржпрж╛ржпрж╝, ржбрзЗржЯрж╛рж░ ржкрзВрж░рзНржмржмрж░рзНрждрзА ржорж╛ржиржЧрзБрж▓рзЛ ржмрж┐рж╢рзНрж▓рзЗрж╖ржг ржХрж░рзЗ ржПржмржВ рж╕рзЗржЧрзБрж▓рзЛрж░ ржЙржкрж░ ржнрж┐рждрзНрждрж┐ ржХрж░рзЗ ржЕржирзБржорж╛ржи ржХрж░рзЗред ржПржЗ ржкрзВрж░рзНржмржмрж░рзНрждрзА ржорж╛ржиржЧрзБрж▓рзЛржХрзЗ 'lags' ржмрж▓рж╛ рж╣ржпрж╝ред ржЙржжрж╛рж╣рж░ржгрж╕рзНржмрж░рзВржк, ржорж╛рж╕рж┐ржХ ржкрзЗржирзНрж╕рж┐рж▓ ржмрж┐ржХрзНрж░рж┐рж░ ржбрзЗржЯрж╛ред ржкрзНрж░рждрж┐ржЯрж┐ ржорж╛рж╕рзЗрж░ ржмрж┐ржХрзНрж░рж┐рж░ ржорзЛржЯ ржкрж░рж┐ржорж╛ржг ржбрзЗржЯрж╛рж╕рзЗржЯрзЗ ржПржХржЯрж┐ 'evolving variable' рж╣рж┐рж╕рзЗржмрзЗ ржмрж┐ржмрзЗржЪрж┐ржд рж╣ржмрзЗред ржПржЗ ржоржбрзЗрж▓ржЯрж┐ рждрзИрж░рж┐ рж╣ржпрж╝ ржпрзЗржЦрж╛ржирзЗ "evolving variable of interest рждрж╛рж░ ржирж┐ржЬрж╕рзНржм lagged (ржЕрж░рзНржерж╛рзО ржкрзВрж░рзНржмржмрж░рзНрждрзА) ржорж╛ржиржЧрзБрж▓рзЛрж░ ржЙржкрж░ рж░рж┐ржЧрзНрж░рзЗрж╕ ржХрж░рж╛ рж╣ржпрж╝ред" [wikipedia](https://wikipedia.org/wiki/Autoregressive_integrated_moving_average)

- **I - Integrated**ред 'ARMA' ржоржбрзЗрж▓рзЗрж░ рж╕рж╛ржерзЗ рждрзБрж▓ржирж╛ржпрж╝, ARIMA-рждрзЗ 'I' ржПрж░ ржЕрж░рзНрже *[integrated](https://wikipedia.org/wiki/Order_of_integration)*ред ржбрзЗржЯрж╛ 'integrated' рж╣ржпрж╝ ржпржЦржи ржбрж┐ржлрж╛рж░рзЗржирзНрж╕рж┐ржВ ржзрж╛ржкржЧрзБрж▓рзЛ ржкрзНрж░ржпрж╝рзЛржЧ ржХрж░рж╛ рж╣ржпрж╝ non-stationarity ржжрзВрж░ ржХрж░рждрзЗред

- **MA - Moving Average**ред ржПржЗ ржоржбрзЗрж▓рзЗрж░ [moving-average](https://wikipedia.org/wiki/Moving-average_model) ржЕржВрж╢ржЯрж┐ ржмрж░рзНрждржорж╛ржи ржПржмржВ ржкрзВрж░рзНржмржмрж░рзНрждрзА рж▓рзНржпрж╛ржЧ ржорж╛ржиржЧрзБрж▓рзЛ ржкрж░рзНржпржмрзЗржХрзНрж╖ржг ржХрж░рзЗ ржЖржЙржЯржкрзБржЯ ржнрзЗрж░рж┐ржпрж╝рзЗржмрж▓ ржирж┐рж░рзНржзрж╛рж░ржг ржХрж░рзЗред

ржорзВрж▓ ржХржерж╛: ARIMA ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛ рж╣ржпрж╝ ржЯрж╛ржЗржо рж╕рж┐рж░рж┐ржЬ ржбрзЗржЯрж╛рж░ ржмрж┐рж╢рзЗрж╖ ржлрж░рзНржорзЗрж░ рж╕рж╛ржерзЗ ржоржбрзЗрж▓ржХрзЗ ржпрждржЯрж╛ рж╕ржорзНржнржм ржШржирж┐рж╖рзНржаржнрж╛ржмрзЗ ржлрж┐ржЯ ржХрж░рж╛рж░ ржЬржирзНржпред

## ржЕржирзБрж╢рзАрж▓ржи - ржПржХржЯрж┐ ARIMA ржоржбрзЗрж▓ рждрзИрж░рж┐ ржХрж░рзБржи

ржПржЗ ржкрж╛ржарзЗрж░ [_/working_](https://github.com/microsoft/ML-For-Beginners/tree/main/7-TimeSeries/2-ARIMA/working) ржлрзЛрж▓рзНржбрж╛рж░ ржЦрзБрж▓рзБржи ржПржмржВ [_notebook.ipynb_](https://github.com/microsoft/ML-For-Beginners/blob/main/7-TimeSeries/2-ARIMA/working/notebook.ipynb) ржлрж╛ржЗрж▓ржЯрж┐ ржЦрзБржБржЬрзБржиред

1. ржирзЛржЯржмрзБржХ ржЪрж╛рж▓рж╛ржи `statsmodels` Python рж▓рж╛ржЗржмрзНрж░рзЗрж░рж┐ рж▓рзЛржб ржХрж░рждрзЗ; ARIMA ржоржбрзЗрж▓рзЗрж░ ржЬржирзНржп ржПржЯрж┐ ржкрзНрж░ржпрж╝рзЛржЬржиред

1. ржкрзНрж░ржпрж╝рзЛржЬржирзАржпрж╝ рж▓рж╛ржЗржмрзНрж░рзЗрж░рж┐ рж▓рзЛржб ржХрж░рзБржиред

1. ржПржЦржи, ржбрзЗржЯрж╛ ржкрзНрж▓ржЯ ржХрж░рж╛рж░ ржЬржирзНржп ржЖрж░ржУ ржХрж┐ржЫрзБ ржжрж░ржХрж╛рж░рзА рж▓рж╛ржЗржмрзНрж░рзЗрж░рж┐ рж▓рзЛржб ржХрж░рзБржи:

    ```python
    import os
    import warnings
    import matplotlib.pyplot as plt
    import numpy as np
    import pandas as pd
    import datetime as dt
    import math

    from pandas.plotting import autocorrelation_plot
    from statsmodels.tsa.statespace.sarimax import SARIMAX
    from sklearn.preprocessing import MinMaxScaler
    from common.utils import load_data, mape
    from IPython.display import Image

    %matplotlib inline
    pd.options.display.float_format = '{:,.2f}'.format
    np.set_printoptions(precision=2)
    warnings.filterwarnings("ignore") # specify to ignore warning messages
    ```

1. `/data/energy.csv` ржлрж╛ржЗрж▓ ржерзЗржХрзЗ ржбрзЗржЯрж╛ ржПржХржЯрж┐ Pandas ржбрзЗржЯрж╛ржлрзНрж░рзЗржорзЗ рж▓рзЛржб ржХрж░рзБржи ржПржмржВ ржПржЯрж┐ ржжрзЗржЦрзБржи:

    ```python
    energy = load_data('./data')[['load']]
    energy.head(10)
    ```

1. ржЬрж╛ржирзБржпрж╝рж╛рж░рж┐ 2012 ржерзЗржХрзЗ ржбрж┐рж╕рзЗржорзНржмрж░ 2014 ржкрж░рзНржпржирзНржд рж╕ржорж╕рзНржд ржЙржкрж▓ржмрзНржз ржПржирж╛рж░рзНржЬрж┐ ржбрзЗржЯрж╛ ржкрзНрж▓ржЯ ржХрж░рзБржиред ржПржЦрж╛ржирзЗ ржХрзЛржирзЛ ржЪржоржХ ржерж╛ржХржмрзЗ ржирж╛ ржХрж╛рж░ржг ржЖржорж░рж╛ ржПржЗ ржбрзЗржЯрж╛ ржЖржЧрзЗрж░ ржкрж╛ржарзЗ ржжрзЗржЦрзЗржЫрж┐:

    ```python
    energy.plot(y='load', subplots=True, figsize=(15, 8), fontsize=12)
    plt.xlabel('timestamp', fontsize=12)
    plt.ylabel('load', fontsize=12)
    plt.show()
    ```

    ржПржЦржи, ржПржХржЯрж┐ ржоржбрзЗрж▓ рждрзИрж░рж┐ ржХрж░рж╛ ржпрж╛ржХ!

### ржкрзНрж░рж╢рж┐ржХрзНрж╖ржг ржПржмржВ ржкрж░рзАржХрзНрж╖рж╛рж░ ржбрзЗржЯрж╛рж╕рзЗржЯ рждрзИрж░рж┐ ржХрж░рзБржи

ржПржЦржи ржЖржкржирж╛рж░ ржбрзЗржЯрж╛ рж▓рзЛржб рж╣ржпрж╝рзЗржЫрзЗ, рждрж╛ржЗ ржЖржкржирж┐ ржПржЯрж┐ ржкрзНрж░рж╢рж┐ржХрзНрж╖ржг ржПржмржВ ржкрж░рзАржХрзНрж╖рж╛рж░ рж╕рзЗржЯрзЗ ржнрж╛ржЧ ржХрж░рждрзЗ ржкрж╛рж░рзЗржиред ржЖржкржирж┐ ржЖржкржирж╛рж░ ржоржбрзЗрж▓ржЯрж┐ ржкрзНрж░рж╢рж┐ржХрзНрж╖ржг рж╕рзЗржЯрзЗ ржкрзНрж░рж╢рж┐ржХрзНрж╖ржг ржжрзЗржмрзЗржиред ржпржерж╛рж░рзАрждрж┐, ржоржбрзЗрж▓ржЯрж┐ ржкрзНрж░рж╢рж┐ржХрзНрж╖ржг рж╢рзЗрж╖ ржХрж░рж╛рж░ ржкрж░рзЗ, ржЖржкржирж┐ ржкрж░рзАржХрзНрж╖рж╛рж░ рж╕рзЗржЯ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ ржПрж░ рж╕ржарж┐ржХрждрж╛ ржорзВрж▓рзНржпрж╛ржпрж╝ржи ржХрж░ржмрзЗржиред ржирж┐рж╢рзНржЪрж┐ржд ржХрж░рзБржи ржпрзЗ ржкрж░рзАржХрзНрж╖рж╛рж░ рж╕рзЗржЯржЯрж┐ ржкрзНрж░рж╢рж┐ржХрзНрж╖ржг рж╕рзЗржЯрзЗрж░ ржЪрзЗржпрж╝рзЗ ржкрж░ржмрж░рзНрждрзА рж╕ржоржпрж╝ржХрж╛рж▓рзЗрж░ ржбрзЗржЯрж╛ ржХржнрж╛рж░ ржХрж░рзЗ ржпрж╛рждрзЗ ржоржбрзЗрж▓ ржнржмрж┐рж╖рзНржпрждрзЗрж░ рж╕ржоржпрж╝ржХрж╛рж▓ ржерзЗржХрзЗ рждржерзНржп ржирж╛ ржкрж╛ржпрж╝ред

1. рж╕рзЗржкрзНржЯрзЗржорзНржмрж░ 1 ржерзЗржХрзЗ ржЕржХрзНржЯрзЛржмрж░ 31, 2014 ржкрж░рзНржпржирзНржд ржжрзБржЗ ржорж╛рж╕рзЗрж░ рж╕ржоржпрж╝ржХрж╛рж▓ ржкрзНрж░рж╢рж┐ржХрзНрж╖ржг рж╕рзЗржЯрзЗ ржмрж░рж╛ржжрзНржж ржХрж░рзБржиред ржкрж░рзАржХрзНрж╖рж╛рж░ рж╕рзЗржЯрзЗ ржиржнрзЗржорзНржмрж░ 1 ржерзЗржХрзЗ ржбрж┐рж╕рзЗржорзНржмрж░ 31, 2014 ржкрж░рзНржпржирзНржд ржжрзБржЗ ржорж╛рж╕рзЗрж░ рж╕ржоржпрж╝ржХрж╛рж▓ ржЕржирзНрждрж░рзНржнрзБржХрзНржд ржерж╛ржХржмрзЗ:

    ```python
    train_start_dt = '2014-11-01 00:00:00'
    test_start_dt = '2014-12-30 00:00:00'
    ```

    ржпрзЗрж╣рзЗрждрзБ ржПржЗ ржбрзЗржЯрж╛ ржжрзИржирж┐ржХ ржПржирж╛рж░рзНржЬрж┐ ржмрзНржпржмрж╣рж╛рж░рзЗрж░ ржкрзНрж░рждрж┐ржлрж▓ржи ржХрж░рзЗ, рждрж╛ржЗ ржПржЦрж╛ржирзЗ ржПржХржЯрж┐ рж╢ржХрзНрждрж┐рж╢рж╛рж▓рзА ржорзМрж╕рзБржорзА ржкрзНржпрж╛ржЯрж╛рж░рзНржи рж░ржпрж╝рзЗржЫрзЗ, рждржмрзЗ рж╕рж╛ржорзНржкрзНрж░рждрж┐ржХ ржжрж┐ржирзЗрж░ ржмрзНржпржмрж╣рж╛рж░рзЗрж░ рж╕рж╛ржерзЗ ржПржЯрж┐ рж╕ржмржЪрзЗржпрж╝рзЗ ржмрзЗрж╢рж┐ рж╕рж╛ржжрзГрж╢рзНржпржкрзВрж░рзНржгред

1. ржкрж╛рж░рзНржержХрзНржпржЧрзБрж▓рзЛ ржЪрж┐рждрзНрж░рж┐ржд ржХрж░рзБржи:

    ```python
    energy[(energy.index < test_start_dt) & (energy.index >= train_start_dt)][['load']].rename(columns={'load':'train'}) \
        .join(energy[test_start_dt:][['load']].rename(columns={'load':'test'}), how='outer') \
        .plot(y=['train', 'test'], figsize=(15, 8), fontsize=12)
    plt.xlabel('timestamp', fontsize=12)
    plt.ylabel('load', fontsize=12)
    plt.show()
    ```

    ![ржкрзНрж░рж╢рж┐ржХрзНрж╖ржг ржПржмржВ ржкрж░рзАржХрзНрж╖рж╛рж░ ржбрзЗржЯрж╛](../../../../7-TimeSeries/2-ARIMA/images/train-test.png)

    рж╕рзБрждрж░рж╛ржВ, ржбрзЗржЯрж╛ ржкрзНрж░рж╢рж┐ржХрзНрж╖ржгрзЗрж░ ржЬржирзНржп ржПржХржЯрж┐ рждрзБрж▓ржирж╛ржорзВрж▓ржХржнрж╛ржмрзЗ ржЫрзЛржЯ рж╕ржоржпрж╝ ржЙржЗржирзНржбрзЛ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛ ржпржерзЗрж╖рзНржЯ рж╣ржУржпрж╝рж╛ ржЙржЪрж┐рждред

    > ржирзЛржЯ: ржпрзЗрж╣рзЗрждрзБ ржЖржорж░рж╛ ARIMA ржоржбрзЗрж▓ ржлрж┐ржЯ ржХрж░рж╛рж░ ржЬржирзНржп ржпрзЗ ржлрж╛ржВрж╢ржиржЯрж┐ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж┐ рждрж╛ ржлрж┐ржЯрж┐ржВржпрж╝рзЗрж░ рж╕ржоржпрж╝ ржЗржи-рж╕рзНржпрж╛ржорзНржкрж▓ ржнрзНржпрж╛рж▓рж┐ржбрзЗрж╢ржи ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ, ржЖржорж░рж╛ ржнрзНржпрж╛рж▓рж┐ржбрзЗрж╢ржи ржбрзЗржЯрж╛ ржмрж╛ржж ржжрзЗржмред

### ржкрзНрж░рж╢рж┐ржХрзНрж╖ржгрзЗрж░ ржЬржирзНржп ржбрзЗржЯрж╛ ржкрзНрж░рж╕рзНрждрзБржд ржХрж░рзБржи

ржПржЦржи, ржЖржкржирж╛ржХрзЗ ржбрзЗржЯрж╛ ржлрж┐рж▓рзНржЯрж╛рж░рж┐ржВ ржПржмржВ рж╕рзНржХрзЗрж▓рж┐ржВржпрж╝рзЗрж░ ржорж╛ржзрзНржпржорзЗ ржкрзНрж░рж╢рж┐ржХрзНрж╖ржгрзЗрж░ ржЬржирзНржп ржкрзНрж░рж╕рзНрждрзБржд ржХрж░рждрзЗ рж╣ржмрзЗред ржЖржкржирж╛рж░ ржбрзЗржЯрж╛рж╕рзЗржЯржЯрж┐ рж╢рзБржзрзБржорж╛рждрзНрж░ ржкрзНрж░ржпрж╝рзЛржЬржирзАржпрж╝ рж╕ржоржпрж╝ржХрж╛рж▓ ржПржмржВ ржХрж▓рж╛ржоржЧрзБрж▓рзЛ ржЕржирзНрждрж░рзНржнрзБржХрзНржд ржХрж░рждрзЗ ржлрж┐рж▓рзНржЯрж╛рж░ ржХрж░рзБржи ржПржмржВ ржбрзЗржЯрж╛ 0,1 ржПрж░ ржоржзрзНржпрзЗ ржкрзНрж░ржЬрзЗржХрзНржЯ ржХрж░рж╛рж░ ржЬржирзНржп рж╕рзНржХрзЗрж▓рж┐ржВ ржХрж░рзБржиред

1. ржорзВрж▓ ржбрзЗржЯрж╛рж╕рзЗржЯржЯрж┐ рж╢рзБржзрзБржорж╛рждрзНрж░ ржЙрж▓рзНрж▓рзЗржЦрж┐ржд рж╕ржоржпрж╝ржХрж╛рж▓ ржПржмржВ рж╕рзЗржЯ ржЕржирзБржпрж╛ржпрж╝рзА ржкрзНрж░ржпрж╝рзЛржЬржирзАржпрж╝ ржХрж▓рж╛ржо 'load' ржПржмржВ рждрж╛рж░рж┐ржЦ ржЕржирзНрждрж░рзНржнрзБржХрзНржд ржХрж░рждрзЗ ржлрж┐рж▓рзНржЯрж╛рж░ ржХрж░рзБржи:

    ```python
    train = energy.copy()[(energy.index >= train_start_dt) & (energy.index < test_start_dt)][['load']]
    test = energy.copy()[energy.index >= test_start_dt][['load']]

    print('Training data shape: ', train.shape)
    print('Test data shape: ', test.shape)
    ```

    ржбрзЗржЯрж╛рж░ ржЖржХрж╛рж░ ржжрзЗржЦрждрзЗ ржкрж╛рж░рзЗржи:

    ```output
    Training data shape:  (1416, 1)
    Test data shape:  (48, 1)
    ```

1. ржбрзЗржЯрж╛ржХрзЗ (0, 1) ржкрж░рж┐рж╕рж░рзЗ рж╕рзНржХрзЗрж▓ ржХрж░рзБржиред

    ```python
    scaler = MinMaxScaler()
    train['load'] = scaler.fit_transform(train)
    train.head(10)
    ```

1. ржорзВрж▓ ржмржирж╛ржо рж╕рзНржХрзЗрж▓ ржХрж░рж╛ ржбрзЗржЯрж╛ ржЪрж┐рждрзНрж░рж┐ржд ржХрж░рзБржи:

    ```python
    energy[(energy.index >= train_start_dt) & (energy.index < test_start_dt)][['load']].rename(columns={'load':'original load'}).plot.hist(bins=100, fontsize=12)
    train.rename(columns={'load':'scaled load'}).plot.hist(bins=100, fontsize=12)
    plt.show()
    ```

    ![ржорзВрж▓](../../../../7-TimeSeries/2-ARIMA/images/original.png)

    > ржорзВрж▓ ржбрзЗржЯрж╛

    ![рж╕рзНржХрзЗрж▓ ржХрж░рж╛](../../../../7-TimeSeries/2-ARIMA/images/scaled.png)

    > рж╕рзНржХрзЗрж▓ ржХрж░рж╛ ржбрзЗржЯрж╛

1. ржПржЦржи ржЖржкржирж┐ рж╕рзНржХрзЗрж▓ ржХрж░рж╛ ржбрзЗржЯрж╛ ржХрзНржпрж╛рж▓рж┐ржмрзНрж░рзЗржЯ ржХрж░рзЗржЫрзЗржи, ржЖржкржирж┐ ржкрж░рзАржХрзНрж╖рж╛рж░ ржбрзЗржЯрж╛ рж╕рзНржХрзЗрж▓ ржХрж░рждрзЗ ржкрж╛рж░рзЗржи:

    ```python
    test['load'] = scaler.transform(test)
    test.head()
    ```

### ARIMA ржмрж╛рж╕рзНрждржмрж╛ржпрж╝ржи ржХрж░рзБржи

ржПржЦржи ARIMA ржмрж╛рж╕рзНрждржмрж╛ржпрж╝ржирзЗрж░ рж╕ржоржпрж╝! ржЖржкржирж┐ ржЖржЧрзЗ ржЗржирж╕рзНржЯрж▓ ржХрж░рж╛ `statsmodels` рж▓рж╛ржЗржмрзНрж░рзЗрж░рж┐ ржмрзНржпржмрж╣рж╛рж░ ржХрж░ржмрзЗржиред

ржПржЦржи ржЖржкржирж╛ржХрзЗ ржХржпрж╝рзЗржХржЯрж┐ ржзрж╛ржк ржЕржирзБрж╕рж░ржг ржХрж░рждрзЗ рж╣ржмрзЗ:

   1. `SARIMAX()` ржХрж▓ ржХрж░рзЗ ржПржмржВ ржоржбрзЗрж▓ ржкрзНржпрж╛рж░рж╛ржорж┐ржЯрж╛рж░ржЧрзБрж▓рзЛ: p, d, ржПржмржВ q ржкрзНржпрж╛рж░рж╛ржорж┐ржЯрж╛рж░, ржПржмржВ P, D, ржПржмржВ Q ржкрзНржпрж╛рж░рж╛ржорж┐ржЯрж╛рж░ ржкрж╛рж╕ ржХрж░рзЗ ржоржбрзЗрж▓ржЯрж┐ рж╕ржВржЬрзНржЮрж╛ржпрж╝рж┐ржд ржХрж░рзБржиред
   2. `fit()` ржлрж╛ржВрж╢ржи ржХрж▓ ржХрж░рзЗ ржкрзНрж░рж╢рж┐ржХрзНрж╖ржгрзЗрж░ ржбрзЗржЯрж╛рж░ ржЬржирзНржп ржоржбрзЗрж▓ ржкрзНрж░рж╕рзНрждрзБржд ржХрж░рзБржиред
   3. `forecast()` ржлрж╛ржВрж╢ржи ржХрж▓ ржХрж░рзЗ ржПржмржВ ржкрзВрж░рзНржмрж╛ржнрж╛рж╕рзЗрж░ ржзрж╛ржкрзЗрж░ рж╕ржВржЦрзНржпрж╛ (рж╣рж░рж╛ржЗржЬржи) ржирж┐рж░рзНржжрж┐рж╖рзНржЯ ржХрж░рзЗ ржкрзВрж░рзНржмрж╛ржнрж╛рж╕ рждрзИрж░рж┐ ржХрж░рзБржиред

> ЁЯОУ ржПржЗ ржкрзНржпрж╛рж░рж╛ржорж┐ржЯрж╛рж░ржЧрзБрж▓рзЛ ржХрзА ржЬржирзНржп? ржПржХржЯрж┐ ARIMA ржоржбрзЗрж▓рзЗ 3ржЯрж┐ ржкрзНржпрж╛рж░рж╛ржорж┐ржЯрж╛рж░ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛ рж╣ржпрж╝ ржпрж╛ ржЯрж╛ржЗржо рж╕рж┐рж░рж┐ржЬрзЗрж░ ржкрзНрж░ржзрж╛ржи ржжрж┐ржХржЧрзБрж▓рзЛ ржоржбрзЗрж▓ ржХрж░рждрзЗ рж╕рж╛рж╣рж╛ржпрзНржп ржХрж░рзЗ: ржорзМрж╕рзБржорзАрждрж╛, ржкрзНрж░ржмржгрждрж╛, ржПржмржВ рж╢ржмрзНржжред ржПржЗ ржкрзНржпрж╛рж░рж╛ржорж┐ржЯрж╛рж░ржЧрзБрж▓рзЛ рж╣рж▓рзЛ:

`p`: ржоржбрзЗрж▓рзЗрж░ ржЕржЯрзЛ-рж░рж┐ржЧрзНрж░рзЗрж╕рж┐ржн ржЕржВрж╢рзЗрж░ рж╕рж╛ржерзЗ рж╕ржорзНржкрж░рзНржХрж┐ржд ржкрзНржпрж╛рж░рж╛ржорж┐ржЯрж╛рж░, ржпрж╛ *ржкрзВрж░рзНржмржмрж░рзНрждрзА* ржорж╛ржиржЧрзБрж▓рзЛ ржЕржирзНрждрж░рзНржнрзБржХрзНржд ржХрж░рзЗред
`d`: ржоржбрзЗрж▓рзЗрж░ ржЗржирзНржЯрж┐ржЧрзНрж░рзЗржЯрзЗржб ржЕржВрж╢рзЗрж░ рж╕рж╛ржерзЗ рж╕ржорзНржкрж░рзНржХрж┐ржд ржкрзНржпрж╛рж░рж╛ржорж┐ржЯрж╛рж░, ржпрж╛ ржЯрж╛ржЗржо рж╕рж┐рж░рж┐ржЬрзЗ *ржбрж┐ржлрж╛рж░рзЗржирзНрж╕рж┐ржВ* (ЁЯОУ ржбрж┐ржлрж╛рж░рзЗржирзНрж╕рж┐ржВ ржоржирзЗ ржЖржЫрзЗ ЁЯСЖ?) ржкрзНрж░ржпрж╝рзЛржЧрзЗрж░ ржкрж░рж┐ржорж╛ржгржХрзЗ ржкрзНрж░ржнрж╛ржмрж┐ржд ржХрж░рзЗред
`q`: ржоржбрзЗрж▓рзЗрж░ ржорзБржнрж┐ржВ-ржЕрзНржпрж╛ржнрж╛рж░рзЗржЬ ржЕржВрж╢рзЗрж░ рж╕рж╛ржерзЗ рж╕ржорзНржкрж░рзНржХрж┐ржд ржкрзНржпрж╛рж░рж╛ржорж┐ржЯрж╛рж░ред

> ржирзЛржЯ: ржпржжрж┐ ржЖржкржирж╛рж░ ржбрзЗржЯрж╛ржпрж╝ ржорзМрж╕рзБржорзА ржжрж┐ржХ ржерж╛ржХрзЗ - ржпрзЗржоржи ржПржЗ ржбрзЗржЯрж╛ржпрж╝ ржЖржЫрзЗ - , ржЖржорж░рж╛ ржПржХржЯрж┐ ржорзМрж╕рзБржорзА ARIMA ржоржбрзЗрж▓ (SARIMA) ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж┐ред рж╕рзЗржЗ ржХрзНрж╖рзЗрждрзНрж░рзЗ ржЖржкржирж╛ржХрзЗ ржЖрж░рзЗржХржЯрж┐ ржкрзНржпрж╛рж░рж╛ржорж┐ржЯрж╛рж░ рж╕рзЗржЯ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рждрзЗ рж╣ржмрзЗ: `P`, `D`, ржПржмржВ `Q` ржпрж╛ `p`, `d`, ржПржмржВ `q` ржПрж░ ржорждрзЛ ржПржХржЗ рж╕ржорзНржкрж░рзНржХ ржмрж░рзНржгржирж╛ ржХрж░рзЗ, рждржмрзЗ ржоржбрзЗрж▓рзЗрж░ ржорзМрж╕рзБржорзА ржЙржкрж╛ржжрж╛ржиржЧрзБрж▓рзЛрж░ рж╕рж╛ржерзЗ рж╕ржорзНржкрж░рзНржХрж┐рждред

1. ржЖржкржирж╛рж░ ржкржЫржирзНржжрзЗрж░ рж╣рж░рж╛ржЗржЬржи ржорж╛ржи рж╕рзЗржЯ ржХрж░рзБржиред ржЪрж▓рзБржи 3 ржШржгрзНржЯрж╛ ржЪрзЗрж╖рзНржЯрж╛ ржХрж░рж┐:

    ```python
    # Specify the number of steps to forecast ahead
    HORIZON = 3
    print('Forecasting horizon:', HORIZON, 'hours')
    ```

    ARIMA ржоржбрзЗрж▓рзЗрж░ ржкрзНржпрж╛рж░рж╛ржорж┐ржЯрж╛рж░ржЧрзБрж▓рзЛрж░ рж╕рзЗрж░рж╛ ржорж╛ржи ржирж┐рж░рзНржмрж╛ржЪржи ржХрж░рж╛ ржЪрзНржпрж╛рж▓рзЗржЮрзНржЬрж┐ржВ рж╣рждрзЗ ржкрж╛рж░рзЗ ржХрж╛рж░ржг ржПржЯрж┐ ржХрж┐ржЫрзБржЯрж╛ ржмрж┐рж╖ржпрж╝ржнрж┐рждрзНрждрж┐ржХ ржПржмржВ рж╕ржоржпрж╝рж╕рж╛ржкрзЗржХрзНрж╖ред ржЖржкржирж┐ [`pyramid` рж▓рж╛ржЗржмрзНрж░рзЗрж░рж┐](https://alkaline-ml.com/pmdarima/0.9.0/modules/generated/pyramid.arima.auto_arima.html) ржерзЗржХрзЗ `auto_arima()` ржлрж╛ржВрж╢ржи ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛рж░ ржХржерж╛ ржмрж┐ржмрзЗржЪржирж╛ ржХрж░рждрзЗ ржкрж╛рж░рзЗржиред

1. ржЖржкрж╛рждржд ржХрж┐ржЫрзБ ржорзНржпрж╛ржирзБржпрж╝рж╛рж▓ ржирж┐рж░рзНржмрж╛ржЪржи ржЪрзЗрж╖рзНржЯрж╛ ржХрж░рзБржи ржПржХржЯрж┐ ржнрж╛рж▓рзЛ ржоржбрзЗрж▓ ржЦрзБржБржЬрзЗ ржкрзЗрждрзЗред

    ```python
    order = (4, 1, 0)
    seasonal_order = (1, 1, 0, 24)

    model = SARIMAX(endog=train, order=order, seasonal_order=seasonal_order)
    results = model.fit()

    print(results.summary())
    ```

    ржПржХржЯрж┐ ржлрж▓рж╛ржлрж▓рзЗрж░ ржЯрзЗржмрж┐рж▓ ржкрзНрж░рж┐ржирзНржЯ ржХрж░рж╛ рж╣ржпрж╝ред

ржЖржкржирж┐ ржЖржкржирж╛рж░ ржкрзНрж░ржержо ржоржбрзЗрж▓ рждрзИрж░рж┐ ржХрж░рзЗржЫрзЗржи! ржПржЦржи ржЖржорж╛ржжрзЗрж░ ржПржЯрж┐ ржорзВрж▓рзНржпрж╛ржпрж╝ржирзЗрж░ ржПржХржЯрж┐ ржЙржкрж╛ржпрж╝ ржЦрзБржБржЬрзЗ ржмрзЗрж░ ржХрж░рждрзЗ рж╣ржмрзЗред

### ржЖржкржирж╛рж░ ржоржбрзЗрж▓ ржорзВрж▓рзНржпрж╛ржпрж╝ржи ржХрж░рзБржи

ржЖржкржирж╛рж░ ржоржбрзЗрж▓ ржорзВрж▓рзНржпрж╛ржпрж╝ржи ржХрж░рждрзЗ, ржЖржкржирж┐ рждржерж╛ржХржерж┐ржд `walk forward` ржнрзНржпрж╛рж▓рж┐ржбрзЗрж╢ржи ржХрж░рждрзЗ ржкрж╛рж░рзЗржиред ржмрж╛рж╕рзНрждржмрзЗ, ржЯрж╛ржЗржо рж╕рж┐рж░рж┐ржЬ ржоржбрзЗрж▓ржЧрзБрж▓рзЛ ржкрзНрж░рждрж┐ржмрж╛рж░ ржирждрзБржи ржбрзЗржЯрж╛ ржЙржкрж▓ржмрзНржз рж╣рж▓рзЗ ржкрзБржирж░рж╛ржпрж╝ ржкрзНрж░рж╢рж┐ржХрзНрж╖ржг ржжрзЗржУржпрж╝рж╛ рж╣ржпрж╝ред ржПржЯрж┐ ржоржбрзЗрж▓ржХрзЗ ржкрзНрж░рждрж┐ржЯрж┐ рж╕ржоржпрж╝ ржзрж╛ржкрзЗ рж╕рзЗрж░рж╛ ржкрзВрж░рзНржмрж╛ржнрж╛рж╕ ржжрж┐рждрзЗ рж╕ржХрзНрж╖ржо ржХрж░рзЗред

ржЯрж╛ржЗржо рж╕рж┐рж░рж┐ржЬрзЗрж░ рж╢рзБрж░рзБ ржерзЗржХрзЗ ржПржЗ ржХрзМрж╢рж▓ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ, ржкрзНрж░рж╢рж┐ржХрзНрж╖ржг ржбрзЗржЯрж╛рж╕рзЗржЯрзЗ ржоржбрзЗрж▓ржЯрж┐ ржкрзНрж░рж╢рж┐ржХрзНрж╖ржг ржжрж┐ржиред рждрж╛рж░ржкрж░ ржкрж░ржмрж░рзНрждрзА рж╕ржоржпрж╝ ржзрж╛ржкрзЗ ржПржХржЯрж┐ ржкрзВрж░рзНржмрж╛ржнрж╛рж╕ рждрзИрж░рж┐ ржХрж░рзБржиред ржкрзВрж░рзНржмрж╛ржнрж╛рж╕ржЯрж┐ ржкрж░рж┐ржЪрж┐ржд ржорж╛ржирзЗрж░ рж╕рж╛ржерзЗ ржорзВрж▓рзНржпрж╛ржпрж╝ржи ржХрж░рж╛ рж╣ржпрж╝ред ржкрзНрж░рж╢рж┐ржХрзНрж╖ржг рж╕рзЗржЯржЯрж┐ ржкрж░рж┐ржЪрж┐ржд ржорж╛ржи ржЕржирзНрждрж░рзНржнрзБржХрзНржд ржХрж░рждрзЗ ржкрзНрж░рж╕рж╛рж░рж┐ржд рж╣ржпрж╝ ржПржмржВ ржкрзНрж░ржХрзНрж░рж┐ржпрж╝рж╛ржЯрж┐ ржкрзБржирж░рж╛ржмрзГрждрзНрждрж┐ рж╣ржпрж╝ред

> ржирзЛржЯ: ржкрзНрж░рж╢рж┐ржХрзНрж╖ржг рж╕рзЗржЯ ржЙржЗржирзНржбрзЛ рж╕рзНржерж┐рж░ рж░рж╛ржЦрзБржи ржЖрж░ржУ ржжржХрзНрж╖ ржкрзНрж░рж╢рж┐ржХрзНрж╖ржгрзЗрж░ ржЬржирзНржп ржпрж╛рждрзЗ ржЖржкржирж┐ ржкрзНрж░рждрж┐ржмрж╛рж░ ржкрзНрж░рж╢рж┐ржХрзНрж╖ржг рж╕рзЗржЯрзЗ ржПржХржЯрж┐ ржирждрзБржи ржкрж░рзНржпржмрзЗржХрзНрж╖ржг ржпрзЛржЧ ржХрж░рзЗржи, ржЖржкржирж┐ рж╕рзЗржЯрзЗрж░ рж╢рзБрж░рзБ ржерзЗржХрзЗ ржкрж░рзНржпржмрзЗржХрзНрж╖ржгржЯрж┐ рж╕рж░рж┐ржпрж╝рзЗ ржлрзЗрж▓рзЗржиред

ржПржЗ ржкрзНрж░ржХрзНрж░рж┐ржпрж╝рж╛ржЯрж┐ ржоржбрзЗрж▓ржЯрж┐ ржмрж╛рж╕рзНрждржмрзЗ ржХрзАржнрж╛ржмрзЗ ржХрж╛ржЬ ржХрж░ржмрзЗ рждрж╛рж░ ржЖрж░ржУ рж╢ржХрзНрждрж┐рж╢рж╛рж▓рзА ржЕржирзБржорж╛ржи ржкрзНрж░ржжрж╛ржи ржХрж░рзЗред рждржмрзЗ, ржПржЯрж┐ ржПрждржЧрзБрж▓рзЛ ржоржбрзЗрж▓ рждрзИрж░рж┐ ржХрж░рж╛рж░ ржЧржгржирж╛ ржЦрж░ржЪрзЗ ржЖрж╕рзЗред ржпржжрж┐ ржбрзЗржЯрж╛ ржЫрзЛржЯ рж╣ржпрж╝ ржмрж╛ ржоржбрзЗрж▓ржЯрж┐ рж╕рж╣ржЬ рж╣ржпрж╝ рждржмрзЗ ржПржЯрж┐ ржЧрзНрж░рж╣ржгржпрзЛржЧрзНржп, рждржмрзЗ ржмржбрж╝ рж╕рзНржХрзЗрж▓рзЗ ржПржЯрж┐ ржПржХржЯрж┐ рж╕ржорж╕рзНржпрж╛ рж╣рждрзЗ ржкрж╛рж░рзЗред

Walk-forward validation ржЯрж╛ржЗржо рж╕рж┐рж░рж┐ржЬ ржоржбрзЗрж▓ ржорзВрж▓рзНржпрж╛ржпрж╝ржирзЗрж░ рж╕рзЛржирж╛рж░ ржорж╛ржи ржПржмржВ ржПржЯрж┐ ржЖржкржирж╛рж░ ржирж┐ржЬрж╕рзНржм ржкрзНрж░ржХрж▓рзНржкржЧрзБрж▓рзЛрж░ ржЬржирзНржп рж╕рзБржкрж╛рж░рж┐рж╢ ржХрж░рж╛ рж╣ржпрж╝ред

1. ржкрзНрж░ржержорзЗ, ржкрзНрж░рждрж┐ржЯрж┐ HORIZON ржзрж╛ржкрзЗрж░ ржЬржирзНржп ржПржХржЯрж┐ ржкрж░рзАржХрзНрж╖рж╛рж░ ржбрзЗржЯрж╛ ржкржпрж╝рзЗржирзНржЯ рждрзИрж░рж┐ ржХрж░рзБржиред

    ```python
    test_shifted = test.copy()

    for t in range(1, HORIZON+1):
        test_shifted['load+'+str(t)] = test_shifted['load'].shift(-t, freq='H')

    test_shifted = test_shifted.dropna(how='any')
    test_shifted.head(5)
    ```

    |            |          | load | load+1 | load+2 |
    | ---------- | -------- | ---- | ------ | ------ |
    | 2014-12-30 | 00:00:00 | 0.33 | 0.29   | 0.27   |
    | 2014-12-30 | 01:00:00 | 0.29 | 0.27   | 0.27   |
    | 2014-12-30 | 02:00:00 | 0.27 | 0.27   | 0.30   |
    | 2014-12-30 | 03:00:00 | 0.27 | 0.30   | 0.41   |
    | 2014-12-30 | 04:00:00 | 0.30 | 0.41   | 0.57   |

    ржбрзЗржЯрж╛ рждрж╛рж░ рж╣рж░рж╛ржЗржЬржи ржкржпрж╝рзЗржирзНржЯ ржЕржирзБржпрж╛ржпрж╝рзА ржЕржирзБржнрзВржорж┐ржХржнрж╛ржмрзЗ рж╕рзНржерж╛ржирж╛ржирзНрждрж░рж┐ржд рж╣ржпрж╝ред

1. ржПржЗ рж╕рзНрж▓рж╛ржЗржбрж┐ржВ ржЙржЗржирзНржбрзЛ ржкржжрзНржзрждрж┐ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ ржПржХржЯрж┐ рж▓рзБржкрзЗ ржкрж░рзАржХрзНрж╖рж╛рж░ ржбрзЗржЯрж╛рж░ ржжрзИрж░рзНржШрзНржпрзЗрж░ ржЖржХрж╛рж░рзЗ ржкрзВрж░рзНржмрж╛ржнрж╛рж╕ рждрзИрж░рж┐ ржХрж░рзБржи:

    ```python
    %%time
    training_window = 720 # dedicate 30 days (720 hours) for training

    train_ts = train['load']
    test_ts = test_shifted

    history = [x for x in train_ts]
    history = history[(-training_window):]

    predictions = list()

    order = (2, 1, 0)
    seasonal_order = (1, 1, 0, 24)

    for t in range(test_ts.shape[0]):
        model = SARIMAX(endog=history, order=order, seasonal_order=seasonal_order)
        model_fit = model.fit()
        yhat = model_fit.forecast(steps = HORIZON)
        predictions.append(yhat)
        obs = list(test_ts.iloc[t])
        # move the training window
        history.append(obs[0])
        history.pop(0)
        print(test_ts.index[t])
        print(t+1, ': predicted =', yhat, 'expected =', obs)
    ```

    ржЖржкржирж┐ ржкрзНрж░рж╢рж┐ржХрзНрж╖ржгржЯрж┐ ржжрзЗржЦрждрзЗ ржкрж╛рж░рзЗржи:

    ```output
    2014-12-30 00:00:00
    1 : predicted = [0.32 0.29 0.28] expected = [0.32945389435989236, 0.2900626678603402, 0.2739480752014323]

    2014-12-30 01:00:00
    2 : predicted = [0.3  0.29 0.3 ] expected = [0.2900626678603402, 0.2739480752014323, 0.26812891674127126]

    2014-12-30 02:00:00
    3 : predicted = [0.27 0.28 0.32] expected = [0.2739480752014323, 0.26812891674127126, 0.3025962399283795]
    ```

1. ржкрзВрж░рзНржмрж╛ржнрж╛рж╕ржЧрзБрж▓рзЛ ржкрзНрж░ржХрзГржд рж▓рзЛржбрзЗрж░ рж╕рж╛ржерзЗ рждрзБрж▓ржирж╛ ржХрж░рзБржи:

    ```python
    eval_df = pd.DataFrame(predictions, columns=['t+'+str(t) for t in range(1, HORIZON+1)])
    eval_df['timestamp'] = test.index[0:len(test.index)-HORIZON+1]
    eval_df = pd.melt(eval_df, id_vars='timestamp', value_name='prediction', var_name='h')
    eval_df['actual'] = np.array(np.transpose(test_ts)).ravel()
    eval_df[['prediction', 'actual']] = scaler.inverse_transform(eval_df[['prediction', 'actual']])
    eval_df.head()
    ```

    ржЖржЙржЯржкрзБржЯ
    |     |            | timestamp | h   | prediction | actual   |
    | --- | ---------- | --------- | --- | ---------- | -------- |
    | 0   | 2014-12-30 | 00:00:00  | t+1 | 3,008.74   | 3,023.00 |
    | 1   | 2014-12-30 | 01:00:00  | t+1 | 2,955.53   | 2,935.00 |
    | 2   | 2014-12-30 | 02:00:00  | t+1 | 2,900.17   | 2,899.00 |
    | 3   | 2014-12-30 | 03:00:00  | t+1 | 2,917.69   | 2,886.00 |
    | 4   | 2014-12-30 | 04:00:00  | t+1 | 2,946.99   | 2,963.00 |

    ржШржгрзНржЯрж╛ржнрж┐рждрзНрждрж┐ржХ ржбрзЗржЯрж╛рж░ ржкрзВрж░рзНржмрж╛ржнрж╛рж╕ ржжрзЗржЦрзБржи, ржкрзНрж░ржХрзГржд рж▓рзЛржбрзЗрж░ рж╕рж╛ржерзЗ рждрзБрж▓ржирж╛ ржХрж░рзБржиред ржПржЯрж┐ ржХрждржЯрж╛ рж╕ржарж┐ржХ?

### ржоржбрзЗрж▓рзЗрж░ рж╕ржарж┐ржХрждрж╛ ржкрж░рзАржХрзНрж╖рж╛ ржХрж░рзБржи

ржЖржкржирж╛рж░ ржоржбрзЗрж▓рзЗрж░ рж╕ржарж┐ржХрждрж╛ ржкрж░рзАржХрзНрж╖рж╛ ржХрж░рзБржи рж╕ржорж╕рзНржд ржкрзВрж░рзНржмрж╛ржнрж╛рж╕рзЗрж░ ржЙржкрж░ ржПрж░ mean absolute percentage error (MAPE) ржкрж░рзАржХрзНрж╖рж╛ ржХрж░рзЗред
> **ЁЯзо ржЧржгрж┐ржд ржжрзЗржЦрзБржи**
>
> ![MAPE](../../../../7-TimeSeries/2-ARIMA/images/mape.png)
>
> [MAPE](https://www.linkedin.com/pulse/what-mape-mad-msd-time-series-allameh-statistics/) ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛ рж╣ржпрж╝ ржкрзВрж░рзНржмрж╛ржнрж╛рж╕рзЗрж░ рж╕ржарж┐ржХрждрж╛ ржПржХржЯрж┐ ржЕржирзБржкрж╛ржд рж╣рж┐рж╕рзЗржмрзЗ ржжрзЗржЦрж╛ржирзЛрж░ ржЬржирзНржп, ржпрж╛ ржЙржкрж░рзЗрж░ рж╕рзВрждрзНрж░ ржжрзНржмрж╛рж░рж╛ рж╕ржВржЬрзНржЮрж╛ржпрж╝рж┐рждред ржкрзНрж░ржХрзГржд ржПржмржВ ржкрзВрж░рзНржмрж╛ржнрж╛рж╕рж┐ржд ржорж╛ржирзЗрж░ ржкрж╛рж░рзНржержХрзНржп ржкрзНрж░ржХрзГржд ржорж╛ржи ржжрзНржмрж╛рж░рж╛ ржнрж╛ржЧ ржХрж░рж╛ рж╣ржпрж╝ред  
"ржПржЗ ржЧржгржирж╛рж░ ржоржзрзНржпрзЗ ржкрж╛рж░рзНржержХрзНржпрзЗрж░ ржкрж░ржо ржорж╛ржи ржкрзНрж░рждрж┐ржЯрж┐ ржкрзВрж░рзНржмрж╛ржнрж╛рж╕рж┐ржд рж╕ржоржпрж╝ ржмрж┐ржирзНржжрзБрж░ ржЬржирзНржп ржпрзЛржЧ ржХрж░рж╛ рж╣ржпрж╝ ржПржмржВ n рж╕ржВржЦрзНржпржХ ржлрж┐ржЯ ржХрж░рж╛ ржмрж┐ржирзНржжрзБ ржжрзНржмрж╛рж░рж╛ ржнрж╛ржЧ ржХрж░рж╛ рж╣ржпрж╝ред" [wikipedia](https://wikipedia.org/wiki/Mean_absolute_percentage_error)
1. ржХрзЛржбрзЗ рж╕ржорзАржХрж░ржг ржкрзНрж░ржХрж╛рж╢ ржХрж░рзБржи:

    ```python
    if(HORIZON > 1):
        eval_df['APE'] = (eval_df['prediction'] - eval_df['actual']).abs() / eval_df['actual']
        print(eval_df.groupby('h')['APE'].mean())
    ```

1. ржПржХ ржзрж╛ржкрзЗрж░ MAPE ржЧржгржирж╛ ржХрж░рзБржи:

    ```python
    print('One step forecast MAPE: ', (mape(eval_df[eval_df['h'] == 't+1']['prediction'], eval_df[eval_df['h'] == 't+1']['actual']))*100, '%')
    ```

    ржПржХ ржзрж╛ржкрзЗрж░ ржкрзВрж░рзНржмрж╛ржнрж╛рж╕ MAPE:  0.5570581332313952 %

1. ржмрж╣рзБ ржзрж╛ржкрзЗрж░ ржкрзВрж░рзНржмрж╛ржнрж╛рж╕ MAPE ржкрзНрж░рж┐ржирзНржЯ ржХрж░рзБржи:

    ```python
    print('Multi-step forecast MAPE: ', mape(eval_df['prediction'], eval_df['actual'])*100, '%')
    ```

    ```output
    Multi-step forecast MAPE:  1.1460048657704118 %
    ```

    ржПржХржЯрж┐ рж╕рзБржирзНржжрж░ ржХржо рж╕ржВржЦрзНржпрж╛ рж╕рж░рзНржмрзЛрждрзНрждржо: ржоржирзЗ рж░рж╛ржЦрзБржи, ржпржжрж┐ ржкрзВрж░рзНржмрж╛ржнрж╛рж╕рзЗрж░ MAPE 10 рж╣ржпрж╝, рждржмрзЗ ржПржЯрж┐ 10% ржкрж░рзНржпржирзНржд ржнрзБрж▓ рж╣рждрзЗ ржкрж╛рж░рзЗред

1. рждржмрзЗ рж╕ржмрж╕ржоржпрж╝ржЗ, ржПржЗ ржзрж░ржирзЗрж░ рж╕ржарж┐ржХрждрж╛ ржкрж░рж┐ржорж╛ржк ржжрзГрж╢рзНржпржд ржжрзЗржЦрж╛ рж╕рж╣ржЬ, рждрж╛ржЗ ржЪрж▓рзБржи ржПржЯрж┐ ржкрзНрж▓ржЯ ржХрж░рж┐:

    ```python
     if(HORIZON == 1):
        ## Plotting single step forecast
        eval_df.plot(x='timestamp', y=['actual', 'prediction'], style=['r', 'b'], figsize=(15, 8))

    else:
        ## Plotting multi step forecast
        plot_df = eval_df[(eval_df.h=='t+1')][['timestamp', 'actual']]
        for t in range(1, HORIZON+1):
            plot_df['t+'+str(t)] = eval_df[(eval_df.h=='t+'+str(t))]['prediction'].values

        fig = plt.figure(figsize=(15, 8))
        ax = plt.plot(plot_df['timestamp'], plot_df['actual'], color='red', linewidth=4.0)
        ax = fig.add_subplot(111)
        for t in range(1, HORIZON+1):
            x = plot_df['timestamp'][(t-1):]
            y = plot_df['t+'+str(t)][0:len(x)]
            ax.plot(x, y, color='blue', linewidth=4*math.pow(.9,t), alpha=math.pow(0.8,t))

        ax.legend(loc='best')

    plt.xlabel('timestamp', fontsize=12)
    plt.ylabel('load', fontsize=12)
    plt.show()
    ```

    ![ржПржХржЯрж┐ ржЯрж╛ржЗржо рж╕рж┐рж░рж┐ржЬ ржоржбрзЗрж▓](../../../../7-TimeSeries/2-ARIMA/images/accuracy.png)

ЁЯПЖ ржПржХржЯрж┐ ржЦрзБржм рж╕рзБржирзНржжрж░ ржкрзНрж▓ржЯ, ржпрж╛ ржПржХржЯрж┐ ржнрж╛рж▓рзЛ рж╕ржарж┐ржХрждрж╛рж░ ржоржбрзЗрж▓ ржжрзЗржЦрж╛ржЪрзНржЫрзЗред ржЦрзБржм ржнрж╛рж▓рзЛ ржХрж╛ржЬ!

---

## ЁЯЪАржЪрзНржпрж╛рж▓рзЗржЮрзНржЬ

ржЯрж╛ржЗржо рж╕рж┐рж░рж┐ржЬ ржоржбрзЗрж▓рзЗрж░ рж╕ржарж┐ржХрждрж╛ ржкрж░рзАржХрзНрж╖рж╛ ржХрж░рж╛рж░ ржмрж┐ржнрж┐ржирзНржи ржкржжрзНржзрждрж┐ ржирж┐ржпрж╝рзЗ ржЧржмрзЗрж╖ржгрж╛ ржХрж░рзБржиред ржПржЗ ржкрж╛ржарзЗ ржЖржорж░рж╛ MAPE ржирж┐ржпрж╝рзЗ ржЖрж▓рзЛржЪржирж╛ ржХрж░рзЗржЫрж┐, рждржмрзЗ ржЖржкржирж┐ ржХрж┐ ржЕржирзНржп ржкржжрзНржзрждрж┐ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рждрзЗ ржкрж╛рж░рзЗржи? рж╕рзЗржЧрзБрж▓рзЛ ржирж┐ржпрж╝рзЗ ржЧржмрзЗрж╖ржгрж╛ ржХрж░рзБржи ржПржмржВ ржоржирзНрждржмрзНржп ржпрзЛржЧ ржХрж░рзБржиред ржПржХржЯрж┐ рж╕рж╣рж╛ржпрж╝ржХ ржбржХрзБржорзЗржирзНржЯ [ржПржЦрж╛ржирзЗ](https://otexts.com/fpp2/accuracy.html) ржкрж╛ржУржпрж╝рж╛ ржпрж╛ржмрзЗред

## [ржкрзЛрж╕рзНржЯ-рж▓рзЗржХржЪрж╛рж░ ржХрзБржЗржЬ](https://ff-quizzes.netlify.app/en/ml/)

## ржкрж░рзНржпрж╛рж▓рзЛржЪржирж╛ ржУ рж╕рзНржм-ржЕржзрзНржпржпрж╝ржи

ржПржЗ ржкрж╛ржарзЗ ARIMA ржжрж┐ржпрж╝рзЗ ржЯрж╛ржЗржо рж╕рж┐рж░рж┐ржЬ ржкрзВрж░рзНржмрж╛ржнрж╛рж╕рзЗрж░ рж╢рзБржзрзБржорж╛рждрзНрж░ ржорзМрж▓рж┐ржХ ржмрж┐рж╖ржпрж╝ржЧрзБрж▓рзЛ ржЖрж▓рзЛржЪржирж╛ ржХрж░рж╛ рж╣ржпрж╝рзЗржЫрзЗред [ржПржЗ рж░рж┐ржкрзЛржЬрж┐ржЯрж░рж┐](https://microsoft.github.io/forecasting/) ржПржмржВ ржПрж░ ржмрж┐ржнрж┐ржирзНржи ржоржбрзЗрж▓ ржЯрж╛ржЗржк ржирж┐ржпрж╝рзЗ ржЧржмрзЗрж╖ржгрж╛ ржХрж░рзЗ ржЯрж╛ржЗржо рж╕рж┐рж░рж┐ржЬ ржоржбрзЗрж▓ рждрзИрж░рж┐рж░ ржЕржирзНржпрж╛ржирзНржп ржкржжрзНржзрждрж┐ рж╢рж┐ржЦрзЗ ржЖржкржирж╛рж░ ржЬрзНржЮрж╛ржи ржЖрж░ржУ ржЧржнрзАрж░ ржХрж░рзБржиред

## ржЕрзНржпрж╛рж╕рж╛ржЗржиржорзЗржирзНржЯ

[ржПржХржЯрж┐ ржирждрзБржи ARIMA ржоржбрзЗрж▓](assignment.md)

---

**ржЕрж╕рзНржмрзАржХрзГрждрж┐**:  
ржПржЗ ржиржерж┐ржЯрж┐ AI ржЕржирзБржмрж╛ржж ржкрж░рж┐рж╖рзЗржмрж╛ [Co-op Translator](https://github.com/Azure/co-op-translator) ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ ржЕржирзБржмрж╛ржж ржХрж░рж╛ рж╣ржпрж╝рзЗржЫрзЗред ржЖржорж░рж╛ ржпржерж╛рж╕ржорзНржнржм рж╕ржарж┐ржХ ржЕржирзБржмрж╛ржж ржкрзНрж░ржжрж╛ржирзЗрж░ ржЪрзЗрж╖рзНржЯрж╛ ржХрж░рж┐, рждржмрзЗ ржЕржирзБржЧрзНрж░рж╣ ржХрж░рзЗ ржоржирзЗ рж░рж╛ржЦржмрзЗржи ржпрзЗ рж╕рзНржмржпрж╝ржВржХрзНрж░рж┐ржпрж╝ ржЕржирзБржмрж╛ржжрзЗ рждрзНрж░рзБржЯрж┐ ржмрж╛ ржЕрж╕ржЩрзНржЧрждрж┐ ржерж╛ржХрждрзЗ ржкрж╛рж░рзЗред ржорзВрж▓ ржнрж╛рж╖рж╛ржпрж╝ ржерж╛ржХрж╛ ржиржерж┐ржЯрж┐ржХрзЗ ржкрзНрж░рж╛ржорж╛ржгрж┐ржХ ржЙрзОрж╕ рж╣рж┐рж╕рзЗржмрзЗ ржмрж┐ржмрзЗржЪржирж╛ ржХрж░рж╛ ржЙржЪрж┐рждред ржЧрзБрж░рзБрждрзНржмржкрзВрж░рзНржг рждржерзНржпрзЗрж░ ржЬржирзНржп, ржкрзЗрж╢рж╛ржжрж╛рж░ ржорж╛ржиржм ржЕржирзБржмрж╛ржж рж╕рзБржкрж╛рж░рж┐рж╢ ржХрж░рж╛ рж╣ржпрж╝ред ржПржЗ ржЕржирзБржмрж╛ржж ржмрзНржпржмрж╣рж╛рж░рзЗрж░ ржлрж▓рзЗ ржХрзЛржирзЛ ржнрзБрж▓ ржмрзЛржЭрж╛ржмрзБржЭрж┐ ржмрж╛ ржнрзБрж▓ ржмрзНржпрж╛ржЦрзНржпрж╛ рж╣рж▓рзЗ ржЖржорж░рж╛ ржжрж╛ржпрж╝ржмржжрзНржз ржерж╛ржХржм ржирж╛ред