<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "107d5bb29da8a562e7ae72262d251a75",
  "translation_date": "2025-09-05T13:47:29+00:00",
  "source_file": "8-Reinforcement/2-Gym/README.md",
  "language_code": "uk"
}
-->
# CartPole –ö–∞—Ç–∞–Ω–Ω—è

–ó–∞–¥–∞—á–∞, —è–∫—É –º–∏ –≤–∏—Ä—ñ—à—É–≤–∞–ª–∏ –≤ –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–º—É —É—Ä–æ—Ü—ñ, –º–æ–∂–µ –∑–¥–∞—Ç–∏—Å—è —ñ–≥—Ä–∞—à–∫–æ–≤–æ—é, –Ω–µ –¥—É–∂–µ –∑–∞—Å—Ç–æ—Å–æ–≤–Ω–æ—é –¥–æ —Ä–µ–∞–ª—å–Ω–∏—Ö —Å—Ü–µ–Ω–∞—Ä—ñ—ó–≤. –ê–ª–µ —Ü–µ –Ω–µ —Ç–∞–∫, –∞–¥–∂–µ –±–∞–≥–∞—Ç–æ —Ä–µ–∞–ª—å–Ω–∏—Ö –ø—Ä–æ–±–ª–µ–º –º–∞—é—Ç—å —Å—Ö–æ–∂—ñ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ ‚Äî –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –≥—Ä–∞ –≤ —à–∞—Ö–∏ —á–∏ “ê–æ. –í–æ–Ω–∏ —Å—Ö–æ–∂—ñ —Ç–∏–º, —â–æ —Ç–∞–∫–æ–∂ –º–∞—é—Ç—å –¥–æ—à–∫—É –∑ –ø–µ–≤–Ω–∏–º–∏ –ø—Ä–∞–≤–∏–ª–∞–º–∏ —Ç–∞ **–¥–∏—Å–∫—Ä–µ—Ç–Ω–∏–π —Å—Ç–∞–Ω**.

## [–ü–µ—Ä–µ–¥–ª–µ–∫—Ü—ñ–π–Ω–∞ –≤—ñ–∫—Ç–æ—Ä–∏–Ω–∞](https://ff-quizzes.netlify.app/en/ml/)

## –í—Å—Ç—É–ø

–£ —Ü—å–æ–º—É —É—Ä–æ—Ü—ñ –º–∏ –∑–∞—Å—Ç–æ—Å—É—î–º–æ —Ç—ñ –∂ –ø—Ä–∏–Ω—Ü–∏–ø–∏ Q-–Ω–∞–≤—á–∞–Ω–Ω—è –¥–æ –∑–∞–¥–∞—á—ñ –∑ **–Ω–µ–ø–µ—Ä–µ—Ä–≤–Ω–∏–º —Å—Ç–∞–Ω–æ–º**, —Ç–æ–±—Ç–æ —Å—Ç–∞–Ω–æ–º, —è–∫–∏–π –≤–∏–∑–Ω–∞—á–∞—î—Ç—å—Å—è –æ–¥–Ω–∏–º –∞–±–æ –∫—ñ–ª—å–∫–æ–º–∞ –¥—ñ–π—Å–Ω–∏–º–∏ —á–∏—Å–ª–∞–º–∏. –ú–∏ —Ä–æ–∑–≥–ª—è–Ω–µ–º–æ –Ω–∞—Å—Ç—É–ø–Ω—É –∑–∞–¥–∞—á—É:

> **–ó–∞–¥–∞—á–∞**: –Ø–∫—â–æ –ü–µ—Ç—Ä–æ —Ö–æ—á–µ –≤—Ç–µ–∫—Ç–∏ –≤—ñ–¥ –≤–æ–≤–∫–∞, –π–æ–º—É –ø–æ—Ç—Ä—ñ–±–Ω–æ –Ω–∞–≤—á–∏—Ç–∏—Å—è —Ä—É—Ö–∞—Ç–∏—Å—è —à–≤–∏–¥—à–µ. –ú–∏ –ø–æ–±–∞—á–∏–º–æ, —è–∫ –ü–µ—Ç—Ä–æ –º–æ–∂–µ –Ω–∞–≤—á–∏—Ç–∏—Å—è –∫–∞—Ç–∞—Ç–∏—Å—è –Ω–∞ –∫–æ–≤–∑–∞–Ω–∞—Ö, –∑–æ–∫—Ä–µ–º–∞ —Ç—Ä–∏–º–∞—Ç–∏ —Ä—ñ–≤–Ω–æ–≤–∞–≥—É, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ Q-–Ω–∞–≤—á–∞–Ω–Ω—è.

![–í–µ–ª–∏–∫–∞ –≤—Ç–µ—á–∞!](../../../../8-Reinforcement/2-Gym/images/escape.png)

> –ü–µ—Ç—Ä–æ —Ç–∞ –π–æ–≥–æ –¥—Ä—É–∑—ñ –ø—Ä–æ—è–≤–ª—è—é—Ç—å –∫—Ä–µ–∞—Ç–∏–≤–Ω—ñ—Å—Ç—å, —â–æ–± –≤—Ç–µ–∫—Ç–∏ –≤—ñ–¥ –≤–æ–≤–∫–∞! –ó–æ–±—Ä–∞–∂–µ–Ω–Ω—è –≤—ñ–¥ [Jen Looper](https://twitter.com/jenlooper)

–ú–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—î–º–æ —Å–ø—Ä–æ—â–µ–Ω—É –≤–µ—Ä—Å—ñ—é –∑–∞–¥–∞—á—ñ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è —Ä—ñ–≤–Ω–æ–≤–∞–≥–∏, –≤—ñ–¥–æ–º—É —è–∫ –∑–∞–¥–∞—á–∞ **CartPole**. –£ —Å–≤—ñ—Ç—ñ CartPole —î –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–∏–π —Å–ª–∞–π–¥–µ—Ä, —è–∫–∏–π –º–æ–∂–µ —Ä—É—Ö–∞—Ç–∏—Å—è –≤–ª—ñ–≤–æ –∞–±–æ –≤–ø—Ä–∞–≤–æ, —ñ –º–µ—Ç–∞ ‚Äî —É—Ç—Ä–∏–º–∞—Ç–∏ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–∏–π —Å—Ç–æ–≤–ø –Ω–∞ –≤–µ—Ä—à–∏–Ω—ñ —Å–ª–∞–π–¥–µ—Ä–∞.

## –ü–µ—Ä–µ–¥—É–º–æ–≤–∏

–£ —Ü—å–æ–º—É —É—Ä–æ—Ü—ñ –º–∏ –±—É–¥–µ–º–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –±—ñ–±–ª—ñ–æ—Ç–µ–∫—É **OpenAI Gym** –¥–ª—è —Å–∏–º—É–ª—è—Ü—ñ—ó —Ä—ñ–∑–Ω–∏—Ö **—Å–µ—Ä–µ–¥–æ–≤–∏—â**. –í–∏ –º–æ–∂–µ—Ç–µ –∑–∞–ø—É—Å–∫–∞—Ç–∏ –∫–æ–¥ —Ü—å–æ–≥–æ —É—Ä–æ–∫—É –ª–æ–∫–∞–ª—å–Ω–æ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, —É Visual Studio Code), —É —Ç–∞–∫–æ–º—É –≤–∏–ø–∞–¥–∫—É —Å–∏–º—É–ª—è—Ü—ñ—è –≤—ñ–¥–∫—Ä–∏—î—Ç—å—Å—è —É –Ω–æ–≤–æ–º—É –≤—ñ–∫–Ω—ñ. –Ø–∫—â–æ –≤–∏ –∑–∞–ø—É—Å–∫–∞—î—Ç–µ –∫–æ–¥ –æ–Ω–ª–∞–π–Ω, –º–æ–∂–ª–∏–≤–æ, –¥–æ–≤–µ–¥–µ—Ç—å—Å—è –≤–Ω–µ—Å—Ç–∏ –¥–µ—è–∫—ñ –∑–º—ñ–Ω–∏ –≤ –∫–æ–¥, —è–∫ –æ–ø–∏—Å–∞–Ω–æ [—Ç—É—Ç](https://towardsdatascience.com/rendering-openai-gym-envs-on-binder-and-google-colab-536f99391cc7).

## OpenAI Gym

–£ –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–º—É —É—Ä–æ—Ü—ñ –ø—Ä–∞–≤–∏–ª–∞ –≥—Ä–∏ —Ç–∞ —Å—Ç–∞–Ω –±—É–ª–∏ –∑–∞–¥–∞–Ω—ñ –∫–ª–∞—Å–æ–º `Board`, —è–∫–∏–π –º–∏ –≤–∏–∑–Ω–∞—á–∏–ª–∏ —Å–∞–º–æ—Å—Ç—ñ–π–Ω–æ. –¢—É—Ç –º–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—î–º–æ —Å–ø–µ—Ü—ñ–∞–ª—å–Ω–µ **—Å–µ—Ä–µ–¥–æ–≤–∏—â–µ —Å–∏–º—É–ª—è—Ü—ñ—ó**, —è–∫–µ –º–æ–¥–µ–ª—é–≤–∞—Ç–∏–º–µ —Ñ—ñ–∑–∏–∫—É —Å—Ç–æ–≤–ø–∞, —â–æ –±–∞–ª–∞–Ω—Å—É—î. –û–¥–Ω–∏–º —ñ–∑ –Ω–∞–π–ø–æ–ø—É–ª—è—Ä–Ω—ñ—à–∏—Ö —Å–µ—Ä–µ–¥–æ–≤–∏—â —Å–∏–º—É–ª—è—Ü—ñ—ó –¥–ª—è –Ω–∞–≤—á–∞–Ω–Ω—è –∞–ª–≥–æ—Ä–∏—Ç–º—ñ–≤ –∑ –ø—ñ–¥–∫—Ä—ñ–ø–ª–µ–Ω–Ω—è–º —î [Gym](https://gym.openai.com/), —è–∫–∏–π –ø—ñ–¥—Ç—Ä–∏–º—É—î—Ç—å—Å—è [OpenAI](https://openai.com/). –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ Gym, –º–∏ –º–æ–∂–µ–º–æ —Å—Ç–≤–æ—Ä—é–≤–∞—Ç–∏ —Ä—ñ–∑–Ω—ñ **—Å–µ—Ä–µ–¥–æ–≤–∏—â–∞** ‚Äî –≤—ñ–¥ —Å–∏–º—É–ª—è—Ü—ñ—ó CartPole –¥–æ —ñ–≥–æ—Ä Atari.

> **–ü—Ä–∏–º—ñ—Ç–∫–∞**: –Ü–Ω—à—ñ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞, –¥–æ—Å—Ç—É–ø–Ω—ñ –≤ OpenAI Gym, –º–æ–∂–Ω–∞ –ø–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ [—Ç—É—Ç](https://gym.openai.com/envs/#classic_control).

–°–ø–æ—á–∞—Ç–∫—É –≤—Å—Ç–∞–Ω–æ–≤–∏–º–æ Gym —ñ —ñ–º–ø–æ—Ä—Ç—É—î–º–æ –Ω–µ–æ–±—Ö—ñ–¥–Ω—ñ –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∏ (–±–ª–æ–∫ –∫–æ–¥—É 1):

```python
import sys
!{sys.executable} -m pip install gym 

import gym
import matplotlib.pyplot as plt
import numpy as np
import random
```

## –í–ø—Ä–∞–≤–∞ ‚Äî —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞ CartPole

–©–æ–± –ø—Ä–∞—Ü—é–≤–∞—Ç–∏ —ñ–∑ –∑–∞–¥–∞—á–µ—é –±–∞–ª–∞–Ω—Å—É–≤–∞–Ω–Ω—è CartPole, –ø–æ—Ç—Ä—ñ–±–Ω–æ —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–µ —Å–µ—Ä–µ–¥–æ–≤–∏—â–µ. –ö–æ–∂–Ω–µ —Å–µ—Ä–µ–¥–æ–≤–∏—â–µ –º–∞—î:

- **Observation space** (–ø—Ä–æ—Å—Ç—ñ—Ä —Å–ø–æ—Å—Ç–µ—Ä–µ–∂–µ–Ω—å), —è–∫–∏–π –≤–∏–∑–Ω–∞—á–∞—î —Å—Ç—Ä—É–∫—Ç—É—Ä—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó, —è–∫—É –º–∏ –æ—Ç—Ä–∏–º—É—î–º–æ –≤—ñ–¥ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞. –î–ª—è –∑–∞–¥–∞—á—ñ CartPole –º–∏ –æ—Ç—Ä–∏–º—É—î–º–æ –ø–æ–ª–æ–∂–µ–Ω–Ω—è —Å—Ç–æ–≤–ø–∞, —à–≤–∏–¥–∫—ñ—Å—Ç—å —Ç–∞ —ñ–Ω—à—ñ –∑–Ω–∞—á–µ–Ω–Ω—è.

- **Action space** (–ø—Ä–æ—Å—Ç—ñ—Ä –¥—ñ–π), —è–∫–∏–π –≤–∏–∑–Ω–∞—á–∞—î –º–æ–∂–ª–∏–≤—ñ –¥—ñ—ó. –£ –Ω–∞—à–æ–º—É –≤–∏–ø–∞–¥–∫—É –ø—Ä–æ—Å—Ç—ñ—Ä –¥—ñ–π –¥–∏—Å–∫—Ä–µ—Ç–Ω–∏–π —ñ —Å–∫–ª–∞–¥–∞—î—Ç—å—Å—è –∑ –¥–≤–æ—Ö –¥—ñ–π ‚Äî **–≤–ª—ñ–≤–æ** —Ç–∞ **–≤–ø—Ä–∞–≤–æ**. (–±–ª–æ–∫ –∫–æ–¥—É 2)

1. –î–ª—è —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—ó –≤–≤–µ–¥—ñ—Ç—å –Ω–∞—Å—Ç—É–ø–Ω–∏–π –∫–æ–¥:

    ```python
    env = gym.make("CartPole-v1")
    print(env.action_space)
    print(env.observation_space)
    print(env.action_space.sample())
    ```

–©–æ–± –ø–æ–±–∞—á–∏—Ç–∏, —è–∫ –ø—Ä–∞—Ü—é—î —Å–µ—Ä–µ–¥–æ–≤–∏—â–µ, –∑–∞–ø—É—Å—Ç–∏–º–æ –∫–æ—Ä–æ—Ç–∫—É —Å–∏–º—É–ª—è—Ü—ñ—é –Ω–∞ 100 –∫—Ä–æ–∫—ñ–≤. –ù–∞ –∫–æ–∂–Ω–æ–º—É –∫—Ä–æ—Ü—ñ –º–∏ –Ω–∞–¥–∞—î–º–æ –æ–¥–Ω—É –∑ –¥—ñ–π –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è ‚Äî —É —Ü—ñ–π —Å–∏–º—É–ª—è—Ü—ñ—ó –º–∏ –ø—Ä–æ—Å—Ç–æ –≤–∏–ø–∞–¥–∫–æ–≤–æ –≤–∏–±–∏—Ä–∞—î–º–æ –¥—ñ—é –∑ `action_space`.

1. –ó–∞–ø—É—Å—Ç—ñ—Ç—å –∫–æ–¥ –Ω–∏–∂—á–µ —ñ –ø–æ–¥–∏–≤—ñ—Ç—å—Å—è, –¥–æ —á–æ–≥–æ —Ü–µ –ø—Ä–∏–∑–≤–µ–¥–µ.

    ‚úÖ –ü–∞–º‚Äô—è—Ç–∞–π—Ç–µ, —â–æ –±–∞–∂–∞–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç–∏ —Ü–µ–π –∫–æ–¥ –Ω–∞ –ª–æ–∫–∞–ª—å–Ω—ñ–π —É—Å—Ç–∞–Ω–æ–≤—Ü—ñ Python! (–±–ª–æ–∫ –∫–æ–¥—É 3)

    ```python
    env.reset()
    
    for i in range(100):
       env.render()
       env.step(env.action_space.sample())
    env.close()
    ```

    –í–∏ –ø–æ–≤–∏–Ω–Ω—ñ –ø–æ–±–∞—á–∏—Ç–∏ —â–æ—Å—å –ø–æ–¥—ñ–±–Ω–µ –¥–æ —Ü—å–æ–≥–æ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è:

    ![CartPole –±–µ–∑ –±–∞–ª–∞–Ω—Å—É](../../../../8-Reinforcement/2-Gym/images/cartpole-nobalance.gif)

1. –ü—ñ–¥ —á–∞—Å —Å–∏–º—É–ª—è—Ü—ñ—ó –Ω–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –æ—Ç—Ä–∏–º—É–≤–∞—Ç–∏ —Å–ø–æ—Å—Ç–µ—Ä–µ–∂–µ–Ω–Ω—è, —â–æ–± –≤–∏—Ä—ñ—à–∏—Ç–∏, —è–∫ –¥—ñ—è—Ç–∏. –ù–∞—Å–ø—Ä–∞–≤–¥—ñ —Ñ—É–Ω–∫—Ü—ñ—è `step` –ø–æ–≤–µ—Ä—Ç–∞—î –ø–æ—Ç–æ—á–Ω—ñ —Å–ø–æ—Å—Ç–µ—Ä–µ–∂–µ–Ω–Ω—è, —Ñ—É–Ω–∫—Ü—ñ—é –≤–∏–Ω–∞–≥–æ—Ä–æ–¥–∏ —Ç–∞ –ø—Ä–∞–ø–æ—Ä–µ—Ü—å `done`, —è–∫–∏–π –≤–∫–∞–∑—É—î, —á–∏ –º–∞—î —Å–µ–Ω—Å –ø—Ä–æ–¥–æ–≤–∂—É–≤–∞—Ç–∏ —Å–∏–º—É–ª—è—Ü—ñ—é: (–±–ª–æ–∫ –∫–æ–¥—É 4)

    ```python
    env.reset()
    
    done = False
    while not done:
       env.render()
       obs, rew, done, info = env.step(env.action_space.sample())
       print(f"{obs} -> {rew}")
    env.close()
    ```

    –í–∏ –ø–æ–±–∞—á–∏—Ç–µ —â–æ—Å—å –ø–æ–¥—ñ–±–Ω–µ –¥–æ —Ü—å–æ–≥–æ —É –≤–∏–≤–æ–¥—ñ –±–ª–æ–∫–Ω–æ—Ç–∞:

    ```text
    [ 0.03403272 -0.24301182  0.02669811  0.2895829 ] -> 1.0
    [ 0.02917248 -0.04828055  0.03248977  0.00543839] -> 1.0
    [ 0.02820687  0.14636075  0.03259854 -0.27681916] -> 1.0
    [ 0.03113408  0.34100283  0.02706215 -0.55904489] -> 1.0
    [ 0.03795414  0.53573468  0.01588125 -0.84308041] -> 1.0
    ...
    [ 0.17299878  0.15868546 -0.20754175 -0.55975453] -> 1.0
    [ 0.17617249  0.35602306 -0.21873684 -0.90998894] -> 1.0
    ```

    –í–µ–∫—Ç–æ—Ä —Å–ø–æ—Å—Ç–µ—Ä–µ–∂–µ–Ω—å, —è–∫–∏–π –ø–æ–≤–µ—Ä—Ç–∞—î—Ç—å—Å—è –Ω–∞ –∫–æ–∂–Ω–æ–º—É –∫—Ä–æ—Ü—ñ —Å–∏–º—É–ª—è—Ü—ñ—ó, –º—ñ—Å—Ç–∏—Ç—å –Ω–∞—Å—Ç—É–ø–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è:
    - –ü–æ–ª–æ–∂–µ–Ω–Ω—è –≤—ñ–∑–∫–∞
    - –®–≤–∏–¥–∫—ñ—Å—Ç—å –≤—ñ–∑–∫–∞
    - –ö—É—Ç –Ω–∞—Ö–∏–ª—É —Å—Ç–æ–≤–ø–∞
    - –®–≤–∏–¥–∫—ñ—Å—Ç—å –æ–±–µ—Ä—Ç–∞–Ω–Ω—è —Å—Ç–æ–≤–ø–∞

1. –û—Ç—Ä–∏–º–∞–π—Ç–µ –º—ñ–Ω—ñ–º–∞–ª—å–Ω–µ —Ç–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–µ –∑–Ω–∞—á–µ–Ω–Ω—è —Ü–∏—Ö —á–∏—Å–µ–ª: (–±–ª–æ–∫ –∫–æ–¥—É 5)

    ```python
    print(env.observation_space.low)
    print(env.observation_space.high)
    ```

    –í–∏ —Ç–∞–∫–æ–∂ –º–æ–∂–µ—Ç–µ –ø–æ–º—ñ—Ç–∏—Ç–∏, —â–æ –∑–Ω–∞—á–µ–Ω–Ω—è –≤–∏–Ω–∞–≥–æ—Ä–æ–¥–∏ –Ω–∞ –∫–æ–∂–Ω–æ–º—É –∫—Ä–æ—Ü—ñ —Å–∏–º—É–ª—è—Ü—ñ—ó –∑–∞–≤–∂–¥–∏ –¥–æ—Ä—ñ–≤–Ω—é—î 1. –¶–µ —Ç–æ–º—É, —â–æ –Ω–∞—à–∞ –º–µ—Ç–∞ ‚Äî –≤–∏–∂–∏—Ç–∏ —è–∫–æ–º–æ–≥–∞ –¥–æ–≤—à–µ, —Ç–æ–±—Ç–æ —É—Ç—Ä–∏–º—É–≤–∞—Ç–∏ —Å—Ç–æ–≤–ø —É –≤—ñ–¥–Ω–æ—Å–Ω–æ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–º—É –ø–æ–ª–æ–∂–µ–Ω–Ω—ñ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –¥–æ–≤–≥–∏–π —á–∞—Å.

    ‚úÖ –ù–∞—Å–ø—Ä–∞–≤–¥—ñ —Å–∏–º—É–ª—è—Ü—ñ—è CartPole –≤–≤–∞–∂–∞—î—Ç—å—Å—è –≤–∏—Ä—ñ—à–µ–Ω–æ—é, —è–∫—â–æ –º–∏ –∑–º–æ–∂–µ–º–æ –æ—Ç—Ä–∏–º–∞—Ç–∏ —Å–µ—Ä–µ–¥–Ω—é –≤–∏–Ω–∞–≥–æ—Ä–æ–¥—É 195 –∑–∞ 100 –ø–æ—Å–ª—ñ–¥–æ–≤–Ω–∏—Ö —Å–ø—Ä–æ–±.

## –î–∏—Å–∫—Ä–µ—Ç–∏–∑–∞—Ü—ñ—è —Å—Ç–∞–Ω—É

–£ Q-–Ω–∞–≤—á–∞–Ω–Ω—ñ –Ω–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ —Å—Ç–≤–æ—Ä–∏—Ç–∏ Q-—Ç–∞–±–ª–∏—Ü—é, —è–∫–∞ –≤–∏–∑–Ω–∞—á–∞—î, —â–æ —Ä–æ–±–∏—Ç–∏ –≤ –∫–æ–∂–Ω–æ–º—É —Å—Ç–∞–Ω—ñ. –©–æ–± —Ü–µ –∑—Ä–æ–±–∏—Ç–∏, —Å—Ç–∞–Ω –º–∞—î –±—É—Ç–∏ **–¥–∏—Å–∫—Ä–µ—Ç–Ω–∏–º**, —Ç–æ—á–Ω—ñ—à–µ, –≤—ñ–Ω –ø–æ–≤–∏–Ω–µ–Ω –º—ñ—Å—Ç–∏—Ç–∏ –∫—ñ–Ω—Ü–µ–≤—É –∫—ñ–ª—å–∫—ñ—Å—Ç—å –¥–∏—Å–∫—Ä–µ—Ç–Ω–∏—Ö –∑–Ω–∞—á–µ–Ω—å. –¢–∞–∫–∏–º —á–∏–Ω–æ–º, –Ω–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ —è–∫–æ—Å—å **–¥–∏—Å–∫—Ä–µ—Ç–∏–∑—É–≤–∞—Ç–∏** –Ω–∞—à—ñ —Å–ø–æ—Å—Ç–µ—Ä–µ–∂–µ–Ω–Ω—è, –≤—ñ–¥–æ–±—Ä–∞–∂–∞—é—á–∏ —ó—Ö —É –∫—ñ–Ω—Ü–µ–≤–∏–π –Ω–∞–±—ñ—Ä —Å—Ç–∞–Ω—ñ–≤.

–Ñ –∫—ñ–ª—å–∫–∞ —Å–ø–æ—Å–æ–±—ñ–≤ —Ü–µ –∑—Ä–æ–±–∏—Ç–∏:

- **–†–æ–∑–¥—ñ–ª–µ–Ω–Ω—è –Ω–∞ —ñ–Ω—Ç–µ—Ä–≤–∞–ª–∏**. –Ø–∫—â–æ –º–∏ –∑–Ω–∞—î–º–æ –¥—ñ–∞–ø–∞–∑–æ–Ω –ø–µ–≤–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–Ω—è, –º–∏ –º–æ–∂–µ–º–æ —Ä–æ–∑–¥—ñ–ª–∏—Ç–∏ —Ü–µ–π –¥—ñ–∞–ø–∞–∑–æ–Ω –Ω–∞ –∫—ñ–ª—å–∫–∞ **—ñ–Ω—Ç–µ—Ä–≤–∞–ª—ñ–≤** —ñ –∑–∞–º—ñ–Ω–∏—Ç–∏ –∑–Ω–∞—á–µ–Ω–Ω—è –Ω–æ–º–µ—Ä–æ–º —ñ–Ω—Ç–µ—Ä–≤–∞–ª—É, –¥–æ —è–∫–æ–≥–æ –≤–æ–Ω–æ –Ω–∞–ª–µ–∂–∏—Ç—å. –¶–µ –º–æ–∂–Ω–∞ –∑—Ä–æ–±–∏—Ç–∏ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –º–µ—Ç–æ–¥—É numpy [`digitize`](https://numpy.org/doc/stable/reference/generated/numpy.digitize.html). –£ —Ü—å–æ–º—É –≤–∏–ø–∞–¥–∫—É –º–∏ —Ç–æ—á–Ω–æ –∑–Ω–∞—Ç–∏–º–µ–º–æ —Ä–æ–∑–º—ñ—Ä —Å—Ç–∞–Ω—É, –æ—Å–∫—ñ–ª—å–∫–∏ –≤—ñ–Ω –∑–∞–ª–µ–∂–∞—Ç–∏–º–µ –≤—ñ–¥ –∫—ñ–ª—å–∫–æ—Å—Ç—ñ —ñ–Ω—Ç–µ—Ä–≤–∞–ª—ñ–≤, —è–∫—ñ –º–∏ –≤–∏–±–µ—Ä–µ–º–æ –¥–ª—è –¥–∏—Å–∫—Ä–µ—Ç–∏–∑–∞—Ü—ñ—ó.

‚úÖ –ú–∏ –º–æ–∂–µ–º–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –ª—ñ–Ω—ñ–π–Ω—É —ñ–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü—ñ—é, —â–æ–± –ø—Ä–∏–≤–µ—Å—Ç–∏ –∑–Ω–∞—á–µ–Ω–Ω—è –¥–æ –ø–µ–≤–Ω–æ–≥–æ –∫—ñ–Ω—Ü–µ–≤–æ–≥–æ –¥—ñ–∞–ø–∞–∑–æ–Ω—É (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –≤—ñ–¥ -20 –¥–æ 20), –∞ –ø–æ—Ç—ñ–º –ø–µ—Ä–µ—Ç–≤–æ—Ä–∏—Ç–∏ —á–∏—Å–ª–∞ –Ω–∞ —Ü—ñ–ª—ñ, –æ–∫—Ä—É–≥–ª–∏–≤—à–∏ —ó—Ö. –¶–µ –¥–∞—î –Ω–∞–º —Ç—Ä–æ—Ö–∏ –º–µ–Ω—à–µ –∫–æ–Ω—Ç—Ä–æ–ª—é –Ω–∞–¥ —Ä–æ–∑–º—ñ—Ä–æ–º —Å—Ç–∞–Ω—É, –æ—Å–æ–±–ª–∏–≤–æ —è–∫—â–æ –º–∏ –Ω–µ –∑–Ω–∞—î–º–æ —Ç–æ—á–Ω–∏—Ö –¥—ñ–∞–ø–∞–∑–æ–Ω—ñ–≤ –≤—Ö—ñ–¥–Ω–∏—Ö –∑–Ω–∞—á–µ–Ω—å. –ù–∞–ø—Ä–∏–∫–ª–∞–¥, —É –Ω–∞—à–æ–º—É –≤–∏–ø–∞–¥–∫—É 2 —ñ–∑ 4 –∑–Ω–∞—á–µ–Ω—å –Ω–µ –º–∞—é—Ç—å –≤–µ—Ä—Ö–Ω—ñ—Ö/–Ω–∏–∂–Ω—ñ—Ö –º–µ–∂, —â–æ –º–æ–∂–µ –ø—Ä–∏–∑–≤–µ—Å—Ç–∏ –¥–æ –Ω–µ—Å–∫—ñ–Ω—á–µ–Ω–Ω–æ—ó –∫—ñ–ª—å–∫–æ—Å—Ç—ñ —Å—Ç–∞–Ω—ñ–≤.

–£ –Ω–∞—à–æ–º—É –ø—Ä–∏–∫–ª–∞–¥—ñ –º–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—î–º–æ –¥—Ä—É–≥–∏–π –ø—ñ–¥—Ö—ñ–¥. –Ø–∫ –≤–∏ –ø–æ–º—ñ—Ç–∏—Ç–µ –ø—ñ–∑–Ω—ñ—à–µ, –Ω–µ–∑–≤–∞–∂–∞—é—á–∏ –Ω–∞ –Ω–µ–≤–∏–∑–Ω–∞—á–µ–Ω—ñ –≤–µ—Ä—Ö–Ω—ñ/–Ω–∏–∂–Ω—ñ –º–µ–∂—ñ, —Ü—ñ –∑–Ω–∞—á–µ–Ω–Ω—è —Ä—ñ–¥–∫–æ –≤–∏—Ö–æ–¥—è—Ç—å –∑–∞ –ø–µ–≤–Ω—ñ –∫—ñ–Ω—Ü–µ–≤—ñ —ñ–Ω—Ç–µ—Ä–≤–∞–ª–∏, —Ç–æ–º—É —Å—Ç–∞–Ω–∏ –∑ –µ–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω–∏–º–∏ –∑–Ω–∞—á–µ–Ω–Ω—è–º–∏ –±—É–¥—É—Ç—å –¥—É–∂–µ —Ä—ñ–¥–∫—ñ—Å–Ω–∏–º–∏.

1. –û—Å—å —Ñ—É–Ω–∫—Ü—ñ—è, —è–∫–∞ –±–µ—Ä–µ —Å–ø–æ—Å—Ç–µ—Ä–µ–∂–µ–Ω–Ω—è –∑ –Ω–∞—à–æ—ó –º–æ–¥–µ–ª—ñ —Ç–∞ —Å—Ç–≤–æ—Ä—é—î –∫–æ—Ä—Ç–µ–∂ —ñ–∑ 4 —Ü—ñ–ª–∏—Ö –∑–Ω–∞—á–µ–Ω—å: (–±–ª–æ–∫ –∫–æ–¥—É 6)

    ```python
    def discretize(x):
        return tuple((x/np.array([0.25, 0.25, 0.01, 0.1])).astype(np.int))
    ```

1. –î–∞–≤–∞–π—Ç–µ —Ç–∞–∫–æ–∂ –¥–æ—Å–ª—ñ–¥–∏–º–æ —ñ–Ω—à–∏–π –º–µ—Ç–æ–¥ –¥–∏—Å–∫—Ä–µ—Ç–∏–∑–∞—Ü—ñ—ó –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —ñ–Ω—Ç–µ—Ä–≤–∞–ª—ñ–≤: (–±–ª–æ–∫ –∫–æ–¥—É 7)

    ```python
    def create_bins(i,num):
        return np.arange(num+1)*(i[1]-i[0])/num+i[0]
    
    print("Sample bins for interval (-5,5) with 10 bins\n",create_bins((-5,5),10))
    
    ints = [(-5,5),(-2,2),(-0.5,0.5),(-2,2)] # intervals of values for each parameter
    nbins = [20,20,10,10] # number of bins for each parameter
    bins = [create_bins(ints[i],nbins[i]) for i in range(4)]
    
    def discretize_bins(x):
        return tuple(np.digitize(x[i],bins[i]) for i in range(4))
    ```

1. –¢–µ–ø–µ—Ä –∑–∞–ø—É—Å—Ç–∏–º–æ –∫–æ—Ä–æ—Ç–∫—É —Å–∏–º—É–ª—è—Ü—ñ—é —Ç–∞ —Å–ø–æ—Å—Ç–µ—Ä—ñ–≥–∞—Ç–∏–º–µ–º–æ —Ü—ñ –¥–∏—Å–∫—Ä–µ—Ç–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞. –°–ø—Ä–æ–±—É–π—Ç–µ –æ–±–∏–¥–≤–∞ –º–µ—Ç–æ–¥–∏ `discretize` —Ç–∞ `discretize_bins` —ñ –ø–æ–¥–∏–≤—ñ—Ç—å—Å—è, —á–∏ —î —Ä—ñ–∑–Ω–∏—Ü—è.

    ‚úÖ `discretize_bins` –ø–æ–≤–µ—Ä—Ç–∞—î –Ω–æ–º–µ—Ä —ñ–Ω—Ç–µ—Ä–≤–∞–ª—É, —è–∫–∏–π –ø–æ—á–∏–Ω–∞—î—Ç—å—Å—è –∑ 0. –¢–∞–∫–∏–º —á–∏–Ω–æ–º, –¥–ª—è –∑–Ω–∞—á–µ–Ω—å –≤—Ö—ñ–¥–Ω–æ—ó –∑–º—ñ–Ω–Ω–æ—ó –±–ª–∏–∑—å–∫–æ 0 –≤—ñ–Ω –ø–æ–≤–µ—Ä—Ç–∞—î —á–∏—Å–ª–æ –∑ —Å–µ—Ä–µ–¥–∏–Ω–∏ —ñ–Ω—Ç–µ—Ä–≤–∞–ª—É (10). –£ `discretize` –º–∏ –Ω–µ –≤—Ä–∞—Ö–æ–≤—É–≤–∞–ª–∏ –¥—ñ–∞–ø–∞–∑–æ–Ω –≤–∏—Ö—ñ–¥–Ω–∏—Ö –∑–Ω–∞—á–µ–Ω—å, –¥–æ–∑–≤–æ–ª—è—é—á–∏ —ó–º –±—É—Ç–∏ –≤—ñ–¥‚Äô—î–º–Ω–∏–º–∏, —Ç–æ–º—É –∑–Ω–∞—á–µ–Ω–Ω—è —Å—Ç–∞–Ω—É –Ω–µ –∑–º—ñ—â–µ–Ω—ñ, —ñ 0 –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î 0. (–±–ª–æ–∫ –∫–æ–¥—É 8)

    ```python
    env.reset()
    
    done = False
    while not done:
       #env.render()
       obs, rew, done, info = env.step(env.action_space.sample())
       #print(discretize_bins(obs))
       print(discretize(obs))
    env.close()
    ```

    ‚úÖ –†–æ–∑–∫–æ–º–µ–Ω—Ç—É–π—Ç–µ —Ä—è–¥–æ–∫, —è–∫–∏–π –ø–æ—á–∏–Ω–∞—î—Ç—å—Å—è –∑ `env.render`, —è–∫—â–æ —Ö–æ—á–µ—Ç–µ –ø–æ–±–∞—á–∏—Ç–∏, —è–∫ –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è —Å–µ—Ä–µ–¥–æ–≤–∏—â–µ. –í —ñ–Ω—à–æ–º—É –≤–∏–ø–∞–¥–∫—É –≤–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ –π–æ–≥–æ —É —Ñ–æ–Ω–æ–≤–æ–º—É —Ä–µ–∂–∏–º—ñ, —â–æ —à–≤–∏–¥—à–µ. –ú–∏ –±—É–¥–µ–º–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —Ü–µ "–Ω–µ–≤–∏–¥–∏–º–µ" –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –ø—ñ–¥ —á–∞—Å –ø—Ä–æ—Ü–µ—Å—É Q-–Ω–∞–≤—á–∞–Ω–Ω—è.

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ Q-—Ç–∞–±–ª–∏—Ü—ñ

–£ –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–º—É —É—Ä–æ—Ü—ñ —Å—Ç–∞–Ω –±—É–≤ –ø—Ä–æ—Å—Ç–æ—é –ø–∞—Ä–æ—é —á–∏—Å–µ–ª –≤—ñ–¥ 0 –¥–æ 8, —Ç–æ–º—É –±—É–ª–æ –∑—Ä—É—á–Ω–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—Ç–∏ Q-—Ç–∞–±–ª–∏—Ü—é –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Ç–µ–Ω–∑–æ—Ä–∞ numpy –∑ —Ñ–æ—Ä–º–æ—é 8x8x2. –Ø–∫—â–æ –º–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ –¥–∏—Å–∫—Ä–µ—Ç–∏–∑–∞—Ü—ñ—é –∑–∞ —ñ–Ω—Ç–µ—Ä–≤–∞–ª–∞–º–∏, —Ä–æ–∑–º—ñ—Ä –Ω–∞—à–æ–≥–æ –≤–µ–∫—Ç–æ—Ä–∞ —Å—Ç–∞–Ω—É —Ç–∞–∫–æ–∂ –≤—ñ–¥–æ–º–∏–π, —Ç–æ–º—É –º–∏ –º–æ–∂–µ–º–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —Ç–æ–π —Å–∞–º–∏–π –ø—ñ–¥—Ö—ñ–¥ —ñ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—Ç–∏ —Å—Ç–∞–Ω —É –≤–∏–≥–ª—è–¥—ñ –º–∞—Å–∏–≤—É —Ñ–æ—Ä–º–∏ 20x20x10x10x2 (—Ç—É—Ç 2 ‚Äî —Ü–µ —Ä–æ–∑–º—ñ—Ä–Ω—ñ—Å—Ç—å –ø—Ä–æ—Å—Ç–æ—Ä—É –¥—ñ–π, –∞ –ø–µ—Ä—à—ñ —Ä–æ–∑–º—ñ—Ä–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—é—Ç—å –∫—ñ–ª—å–∫–æ—Å—Ç—ñ —ñ–Ω—Ç–µ—Ä–≤–∞–ª—ñ–≤, —è–∫—ñ –º–∏ –≤–∏–±—Ä–∞–ª–∏ –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ –∑ –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ —É –ø—Ä–æ—Å—Ç–æ—Ä—ñ —Å–ø–æ—Å—Ç–µ—Ä–µ–∂–µ–Ω—å).

–û–¥–Ω–∞–∫ —ñ–Ω–æ–¥—ñ —Ç–æ—á–Ω—ñ —Ä–æ–∑–º—ñ—Ä–∏ –ø—Ä–æ—Å—Ç–æ—Ä—É —Å–ø–æ—Å—Ç–µ—Ä–µ–∂–µ–Ω—å –Ω–µ–≤—ñ–¥–æ–º—ñ. –£ –≤–∏–ø–∞–¥–∫—É —Ñ—É–Ω–∫—Ü—ñ—ó `discretize` –º–∏ –Ω—ñ–∫–æ–ª–∏ –Ω–µ –º–æ–∂–µ–º–æ –±—É—Ç–∏ –≤–ø–µ–≤–Ω–µ–Ω—ñ, —â–æ –Ω–∞—à —Å—Ç–∞–Ω –∑–∞–ª–∏—à–∞—î—Ç—å—Å—è –≤ –ø–µ–≤–Ω–∏—Ö –º–µ–∂–∞—Ö, –æ—Å–∫—ñ–ª—å–∫–∏ –¥–µ—è–∫—ñ –∑ –ø–æ—á–∞—Ç–∫–æ–≤–∏—Ö –∑–Ω–∞—á–µ–Ω—å –Ω–µ –æ–±–º–µ–∂–µ–Ω—ñ. –¢–æ–º—É –º–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—î–º–æ —Ç—Ä–æ—Ö–∏ —ñ–Ω—à–∏–π –ø—ñ–¥—Ö—ñ–¥ —ñ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏–º–æ Q-—Ç–∞–±–ª–∏—Ü—é —É –≤–∏–≥–ª—è–¥—ñ —Å–ª–æ–≤–Ω–∏–∫–∞.

1. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –ø–∞—Ä—É *(state, action)* —è–∫ –∫–ª—é—á —Å–ª–æ–≤–Ω–∏–∫–∞, –∞ –∑–Ω–∞—á–µ–Ω–Ω—è –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—Ç–∏–º–µ –∑–Ω–∞—á–µ–Ω–Ω—é –∑–∞–ø–∏—Å—É –≤ Q-—Ç–∞–±–ª–∏—Ü—ñ. (–±–ª–æ–∫ –∫–æ–¥—É 9)

    ```python
    Q = {}
    actions = (0,1)
    
    def qvalues(state):
        return [Q.get((state,a),0) for a in actions]
    ```

    –¢—É—Ç –º–∏ —Ç–∞–∫–æ–∂ –≤–∏–∑–Ω–∞—á–∞—î–º–æ —Ñ—É–Ω–∫—Ü—ñ—é `qvalues()`, —è–∫–∞ –ø–æ–≤–µ—Ä—Ç–∞—î —Å–ø–∏—Å–æ–∫ –∑–Ω–∞—á–µ–Ω—å Q-—Ç–∞–±–ª–∏—Ü—ñ –¥–ª—è –∑–∞–¥–∞–Ω–æ–≥–æ —Å—Ç–∞–Ω—É, —â–æ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –≤—Å—ñ–º –º–æ–∂–ª–∏–≤–∏–º –¥—ñ—è–º. –Ø–∫—â–æ –∑–∞–ø–∏—Å –≤—ñ–¥—Å—É—Ç–Ω—ñ–π —É Q-—Ç–∞–±–ª–∏—Ü—ñ, –º–∏ –ø–æ–≤–µ—Ä–Ω–µ–º–æ 0 –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º.

## –ü–æ—á–∏–Ω–∞—î–º–æ Q-–Ω–∞–≤—á–∞–Ω–Ω—è

–¢–µ–ø–µ—Ä –º–∏ –≥–æ—Ç–æ–≤—ñ –Ω–∞–≤—á–∏—Ç–∏ –ü–µ—Ç—Ä–∞ –±–∞–ª–∞–Ω—Å—É–≤–∞—Ç–∏!

1. –°–ø–æ—á–∞—Ç–∫—É –≤—Å—Ç–∞–Ω–æ–≤–∏–º–æ –¥–µ—è–∫—ñ –≥—ñ–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–∏: (–±–ª–æ–∫ –∫–æ–¥—É 10)

    ```python
    # hyperparameters
    alpha = 0.3
    gamma = 0.9
    epsilon = 0.90
    ```

    –¢—É—Ç `alpha` ‚Äî —Ü–µ **—à–≤–∏–¥–∫—ñ—Å—Ç—å –Ω–∞–≤—á–∞–Ω–Ω—è**, —è–∫–∞ –≤–∏–∑–Ω–∞—á–∞—î, –Ω–∞—Å–∫—ñ–ª—å–∫–∏ –º–∏ –ø–æ–≤–∏–Ω–Ω—ñ –∫–æ—Ä–∏–≥—É–≤–∞—Ç–∏ –ø–æ—Ç–æ—á–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è Q-—Ç–∞–±–ª–∏—Ü—ñ –Ω–∞ –∫–æ–∂–Ω–æ–º—É –∫—Ä–æ—Ü—ñ. –£ –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–º—É —É—Ä–æ—Ü—ñ –º–∏ –ø–æ—á–∏–Ω–∞–ª–∏ –∑ 1, –∞ –ø–æ—Ç—ñ–º –∑–º–µ–Ω—à—É–≤–∞–ª–∏ `alpha` –¥–æ –Ω–∏–∂—á–∏—Ö –∑–Ω–∞—á–µ–Ω—å –ø—ñ–¥ —á–∞—Å –Ω–∞–≤—á–∞–Ω–Ω—è. –£ —Ü—å–æ–º—É –ø—Ä–∏–∫–ª–∞–¥—ñ –º–∏ –∑–∞–ª–∏—à–∏–º–æ —ó—ó —Å—Ç–∞–ª–æ—é –¥–ª—è –ø—Ä–æ—Å—Ç–æ—Ç–∏, —ñ –≤–∏ –º–æ–∂–µ—Ç–µ –µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—É–≤–∞—Ç–∏ –∑ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è–º –∑–Ω–∞—á–µ–Ω—å `alpha` –ø—ñ–∑–Ω—ñ—à–µ.

    `gamma` ‚Äî —Ü–µ **–∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç –¥–∏—Å–∫–æ–Ω—Ç—É–≤–∞–Ω–Ω—è**, —è–∫–∏–π –ø–æ–∫–∞–∑—É—î, –Ω–∞—Å–∫—ñ–ª—å–∫–∏ –º–∏ –ø–æ–≤–∏–Ω–Ω—ñ –≤—ñ–¥–¥–∞–≤–∞—Ç–∏ –ø–µ—Ä–µ–≤–∞–≥—É –º–∞–π–±—É—Ç–Ω—ñ–π –≤–∏–Ω–∞–≥–æ—Ä–æ–¥—ñ –Ω–∞–¥ –ø–æ—Ç–æ—á–Ω–æ—é.

    `epsilon` ‚Äî —Ü–µ **—Ñ–∞–∫—Ç–æ—Ä –¥–æ—Å–ª—ñ–¥–∂–µ–Ω–Ω—è/–µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—ó**, —è–∫–∏–π –≤–∏–∑–Ω–∞—á–∞—î, —á–∏ –ø–æ–≤–∏–Ω–Ω—ñ –º–∏ –≤—ñ–¥–¥–∞–≤–∞—Ç–∏ –ø–µ—Ä–µ–≤–∞–≥—É –¥–æ—Å–ª—ñ–¥–∂–µ–Ω–Ω—é —á–∏ –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—ó. –£ –Ω–∞—à–æ–º—É –∞–ª–≥–æ—Ä–∏—Ç–º—ñ –º–∏ –≤ `epsilon` –≤—ñ–¥—Å–æ—Ç–∫–∞—Ö –≤–∏–ø–∞–¥–∫—ñ–≤ –≤–∏–±–∏—Ä–∞—Ç–∏–º–µ–º–æ –Ω–∞—Å—Ç—É–ø–Ω—É –¥—ñ—é –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ –¥–æ –∑–Ω–∞—á–µ–Ω—å Q-—Ç–∞–±–ª–∏—Ü—ñ, –∞ –≤ —Ä–µ—à—Ç—ñ –≤–∏–ø–∞–¥–∫—ñ–≤ –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏–º–µ–º–æ –≤–∏–ø–∞–¥–∫–æ–≤—É –¥—ñ—é. –¶–µ –¥–æ–∑–≤–æ–ª–∏—Ç—å –Ω–∞–º –¥–æ—Å–ª—ñ–¥–∂—É–≤–∞—Ç–∏ –æ–±–ª–∞—Å—Ç—ñ –ø—Ä–æ—Å—Ç–æ—Ä—É –ø–æ—à—É–∫—É, —è–∫—ñ –º–∏ —Ä–∞–Ω—ñ—à–µ –Ω–µ –±–∞—á–∏–ª–∏.

    ‚úÖ –£ –∫–æ–Ω—Ç–µ–∫—Å—Ç—ñ –±–∞–ª–∞–Ω—Å—É–≤–∞–Ω–Ω—è ‚Äî –≤–∏–±—ñ—Ä –≤–∏–ø–∞–¥–∫–æ–≤–æ—ó –¥—ñ—ó (–¥–æ—Å–ª—ñ–¥–∂–µ–Ω–Ω—è) –¥—ñ—è—Ç–∏–º–µ —è–∫ –≤–∏–ø–∞–¥–∫–æ–≤–∏–π –ø–æ—à—Ç–æ–≤—Ö —É –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–º—É –Ω–∞–ø—Ä—è–º–∫—É, —ñ —Å—Ç–æ–≤–ø –ø–æ–≤–∏–Ω–µ–Ω –±—É–¥–µ –Ω–∞–≤—á–∏—Ç–∏—Å—è –≤—ñ–¥–Ω–æ–≤–ª—é–≤–∞—Ç–∏ —Ä—ñ–≤–Ω–æ–≤–∞–≥—É –ø—ñ—Å–ª—è —Ü–∏—Ö "–ø–æ–º–∏–ª–æ–∫".

### –ü–æ–∫—Ä–∞—â–µ–Ω–Ω—è –∞–ª–≥–æ—Ä–∏—Ç–º—É

–ú–∏ —Ç–∞–∫–æ–∂ –º–æ–∂–µ–º–æ –∑—Ä–æ–±–∏—Ç–∏ –¥–≤–∞ –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è –¥–æ –Ω–∞—à–æ–≥–æ –∞–ª–≥–æ—Ä–∏—Ç–º—É –∑ –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–≥–æ —É—Ä–æ–∫—É:

- **–û–±—á–∏—Å–ª–µ–Ω–Ω—è —Å–µ—Ä–µ–¥–Ω—å–æ—ó –∫—É–º—É–ª—è—Ç–∏–≤–Ω–æ—ó –≤–∏–Ω–∞–≥–æ—Ä–æ–¥–∏** –∑–∞ –∫—ñ–ª—å–∫–∞ —Å–∏–º—É–ª—è—Ü—ñ–π. –ú–∏ –±—É–¥–µ–º–æ –≤–∏–≤–æ–¥–∏—Ç–∏ –ø—Ä–æ–≥—Ä–µ—Å –∫–æ–∂–Ω—ñ 5000 —ñ—Ç–µ—Ä–∞—Ü—ñ–π —ñ —É—Å–µ—Ä–µ–¥–Ω—é–≤–∞—Ç–∏ –Ω–∞—à—É –∫—É–º—É–ª—è—Ç–∏–≤–Ω—É –≤–∏–Ω–∞–≥–æ—Ä–æ–¥—É –∑–∞ —Ü–µ–π –ø–µ—Ä—ñ–æ–¥ —á–∞—Å—É. –¶–µ –æ–∑–Ω–∞—á–∞—î, —â–æ —è–∫—â–æ –º–∏ –æ—Ç—Ä–∏–º–∞—î–º–æ –±—ñ–ª—å—à–µ 195 –±–∞–ª—ñ–≤ ‚Äî –º–∏ –º–æ–∂–µ–º–æ –≤–≤–∞–∂–∞—Ç–∏ –∑–∞–¥–∞—á—É –≤–∏—Ä—ñ—à–µ–Ω–æ—é, –Ω–∞–≤—ñ—Ç—å —ñ–∑ –≤–∏—â–æ—é —è–∫—ñ—Å—Ç—é, –Ω—ñ–∂ –ø–æ—Ç—Ä—ñ–±–Ω–æ.

- **–û–±—á–∏—Å–ª–µ–Ω–Ω—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ—ó —Å–µ—Ä–µ–¥–Ω—å–æ—ó –∫—É–º—É–ª—è—Ç–∏–≤–Ω–æ—ó –≤–∏–Ω–∞–≥–æ—Ä–æ–¥–∏**, `Qmax`, —ñ –º–∏ –∑–±–µ—Ä–µ–∂–µ–º–æ Q-—Ç–∞–±–ª–∏—Ü—é, —â–æ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î —Ü—å–æ–º—É —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É. –ö–æ–ª–∏ –≤–∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ –Ω–∞–≤—á–∞–Ω–Ω—è, –≤–∏ –ø–æ–º—ñ—Ç–∏—Ç–µ, —â–æ —ñ–Ω–æ–¥—ñ —Å–µ—Ä–µ–¥–Ω—è –∫—É–º—É–ª—è—Ç–∏–≤–Ω–∞ –≤–∏–Ω–∞–≥–æ—Ä–æ–¥–∞ –ø–æ—á–∏–Ω–∞—î –∑–Ω–∏–∂—É–≤–∞—Ç–∏—Å—è, —ñ –º–∏ —Ö–æ—á–µ–º–æ –∑–±–µ—Ä–µ–≥—Ç–∏ –∑–Ω–∞—á–µ–Ω–Ω—è Q-—Ç–∞–±–ª–∏—Ü—ñ, —è–∫—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—é—Ç—å –Ω–∞–π–∫—Ä–∞—â—ñ–π –º–æ–¥–µ–ª—ñ, —Å–ø–æ—Å—Ç–µ—Ä–µ–∂–µ–Ω—ñ–π –ø—ñ–¥ —á–∞—Å –Ω–∞–≤—á–∞–Ω–Ω—è.

1. –ó–±–∏—Ä–∞–π—Ç–µ –≤—Å—ñ –∫—É–º—É–ª—è—Ç–∏–≤–Ω—ñ –≤–∏–Ω–∞–≥–æ—Ä–æ–¥–∏ –Ω–∞ –∫–æ–∂–Ω—ñ–π —Å–∏–º—É–ª—è—Ü—ñ—ó —É –≤–µ–∫—Ç–æ—Ä `rewards` –¥–ª—è –ø–æ–¥–∞–ª—å—à–æ–≥–æ –ø–æ–±—É–¥–æ–≤–∏ –≥—Ä–∞—Ñ—ñ–∫—ñ–≤. (–±–ª–æ–∫ –∫–æ–¥—É 11)

    ```python
    def probs(v,eps=1e-4):
        v = v-v.min()+eps
        v = v/v.sum()
        return v
    
    Qmax = 0
    cum_rewards = []
    rewards = []
    for epoch in range(100000):
        obs = env.reset()
        done = False
        cum_reward=0
        # == do the simulation ==
        while not done:
            s = discretize(obs)
            if random.random()<epsilon:
                # exploitation - chose the action according to Q-Table probabilities
                v = probs(np.array(qvalues(s)))
                a = random.choices(actions,weights=v)[0]
            else:
                # exploration - randomly chose the action
                a = np.random.randint(env.action_space.n)
    
            obs, rew, done, info = env.step(a)
            cum_reward+=rew
            ns = discretize(obs)
            Q[(s,a)] = (1 - alpha) * Q.get((s,a),0) + alpha * (rew + gamma * max(qvalues(ns)))
        cum_rewards.append(cum_reward)
        rewards.append(cum_reward)
        # == Periodically print results and calculate average reward ==
        if epoch%5000==0:
            print(f"{epoch}: {np.average(cum_rewards)}, alpha={alpha}, epsilon={epsilon}")
            if np.average(cum_rewards) > Qmax:
                Qmax = np.average(cum_rewards)
                Qbest = Q
            cum_rewards=[]
    ```

–©–æ –≤–∏ –º–æ–∂–µ—Ç–µ –ø–æ–º—ñ—Ç–∏—Ç–∏ –∑ —Ü–∏—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤:

- **–ë–ª–∏–∑—å–∫–æ –¥–æ –Ω–∞—à–æ—ó –º–µ—Ç–∏**. –ú–∏ –¥—É–∂–µ –±–ª–∏–∑—å–∫—ñ –¥–æ –¥–æ—Å—è–≥–Ω–µ–Ω–Ω—è –º–µ—Ç–∏ –æ—Ç—Ä–∏–º–∞–Ω–Ω—è 195 –∫—É–º—É–ª—è—Ç–∏–≤–Ω–∏—Ö –≤–∏–Ω–∞–≥–æ—Ä–æ–¥ –∑–∞ 100+ –ø–æ—Å–ª—ñ–¥–æ–≤–Ω–∏—Ö –∑–∞–ø—É—Å–∫—ñ–≤ —Å–∏–º—É–ª—è—Ü—ñ—ó, –∞–±–æ –º–∏ –≤–∂–µ –¥–æ—Å—è–≥–ª–∏ —ó—ó! –ù–∞–≤—ñ—Ç—å —è–∫—â–æ –º–∏ –æ—Ç—Ä–∏–º—É—î–º–æ –º–µ–Ω—à—ñ —á–∏—Å–ª–∞, –º–∏ –≤—Å–µ –æ–¥–Ω–æ –Ω–µ –∑–Ω–∞—î–º–æ, —Ç–æ–º—É —â–æ —É—Å–µ—Ä–µ–¥–Ω—é—î–º–æ –∑–∞ 5000 –∑–∞–ø—É—Å–∫—ñ–≤, –∞ —Ñ–æ—Ä–º–∞–ª—å–Ω–∏–π –∫—Ä–∏—Ç–µ—Ä—ñ–π –≤–∏–º–∞–≥–∞—î –ª–∏—à–µ 100 –∑–∞–ø—É—Å–∫—ñ–≤.

- **–í–∏–Ω–∞–≥–æ—Ä–æ–¥–∞ –ø–æ—á–∏–Ω–∞—î –∑–Ω–∏–∂—É–≤–∞—Ç–∏—Å—è**. –Ü–Ω–æ–¥—ñ –≤–∏–Ω–∞–≥–æ—Ä–æ–¥–∞ –ø–æ—á–∏–Ω–∞—î –∑–Ω–∏–∂—É–≤–∞—Ç–∏—Å—è, —â–æ –æ–∑–Ω–∞—á–∞—î, —â–æ –º–∏ –º–æ–∂–µ–º–æ "–∑—Ä—É–π–Ω—É–≤–∞—Ç–∏" –≤–∂–µ –≤–∏–≤—á–µ–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è –≤ Q-—Ç–∞–±–ª–∏—Ü—ñ, –∑–∞–º—ñ–Ω–∏–≤—à–∏ —ó—Ö —Ç–∏–º–∏, —è–∫—ñ –ø–æ–≥—ñ—Ä—à—É—é—Ç—å —Å–∏—Ç—É–∞—Ü—ñ—é.

–¶–µ —Å–ø–æ—Å—Ç–µ—Ä–µ–∂–µ–Ω–Ω—è —Å—Ç–∞—î –±—ñ–ª—å—à –æ—á–µ–≤–∏–¥–Ω–∏–º, —è–∫—â–æ –º–∏ –ø–æ–±—É–¥—É—î–º–æ –≥—Ä–∞—Ñ—ñ–∫ –ø—Ä–æ–≥—Ä–µ—Å—É –Ω–∞–≤—á–∞–Ω–Ω—è.

## –ü–æ–±—É–¥–æ–≤–∞ –≥—Ä–∞—Ñ—ñ–∫–∞ –ø—Ä–æ–≥—Ä–µ—Å—É –Ω–∞–≤—á–∞–Ω–Ω—è

–ü—ñ–¥ —á–∞—Å –Ω–∞–≤—á–∞–Ω–Ω—è –º–∏ –∑–±–∏—Ä–∞–ª–∏ –∑–Ω–∞—á–µ–Ω–Ω—è –∫—É–º—É–ª—è—Ç–∏–≤–Ω–æ—ó –≤–∏–Ω–∞–≥–æ—Ä–æ–¥–∏ –Ω–∞ –∫–æ–∂–Ω—ñ–π —ñ—Ç–µ—Ä–∞—Ü—ñ—ó —É –≤–µ–∫—Ç–æ—Ä `rewards`. –û—Å—å —è–∫ —Ü–µ –≤–∏–≥–ª—è–¥–∞—î, —è–∫—â–æ –ø–æ–±—É–¥—É–≤–∞—Ç–∏ –≥—Ä–∞—Ñ—ñ–∫ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ –≤—ñ–¥ –Ω–æ–º–µ—Ä–∞ —ñ—Ç–µ—Ä–∞—Ü—ñ—ó:

```python
plt.plot(rewards)
```

![–°–∏—Ä–∏–π –ø—Ä–æ–≥—Ä–µ—Å](../../../../8-Reinforcement/2-Gym/images/train_progress_raw.png)

–ó —Ü—å–æ–≥–æ –≥—Ä–∞—Ñ—ñ–∫–∞ –Ω–µ–º–æ–∂–ª–∏–≤–æ –Ω—ñ—á–æ–≥–æ —Å–∫–∞–∑–∞—Ç–∏, –æ—Å–∫—ñ–ª—å–∫–∏ —á–µ—Ä–µ–∑ –ø—Ä–∏—Ä–æ–¥—É —Å—Ç–æ—Ö–∞—Å—Ç–∏—á–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—É –Ω–∞–≤—á–∞–Ω–Ω—è —Ç—Ä–∏–≤–∞–ª—ñ—Å—Ç—å –Ω–∞–≤—á–∞–ª—å–Ω–∏—Ö —Å–µ—Å—ñ–π —Å–∏–ª—å–Ω–æ –≤–∞—Ä—ñ—é—î—Ç—å—Å—è. –©–æ–± –Ω–∞–¥–∞—Ç–∏ –±—ñ–ª—å—à–µ —Å–µ–Ω—Å—É —Ü—å–æ–º—É –≥—Ä–∞—Ñ—ñ–∫—É, –º–∏ –º–æ–∂–µ–º–æ –æ–±—á–∏—Å–ª–∏—Ç–∏ **–∫–æ–≤–∑–Ω–µ —Å–µ—Ä–µ–¥–Ω—î** –∑–∞ —Å–µ—Ä—ñ—î—é –µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ñ–≤, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, 100. –¶–µ –º–æ–∂–Ω–∞ –∑—Ä—É—á–Ω–æ –∑—Ä–æ–±–∏—Ç–∏ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é `np.convolve`: (–±–ª–æ–∫ –∫–æ–¥—É 12)

```python
def running_average(x,window):
    return np.convolve(x,np.ones(window)/window,mode='valid')

plt.plot(running_average(rewards,100))
```

![–ü—Ä–æ–≥—Ä–µ—Å –Ω–∞–≤—á–∞–Ω–Ω—è](../../../../8-Reinforcement/2-Gym/images/train_progress_runav.png)

## –ó–º—ñ–Ω–∞ –≥—ñ–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤

–©–æ–± –∑—Ä–æ–±–∏—Ç–∏ –Ω–∞–≤—á–∞–Ω–Ω—è –±—ñ–ª—å—à —Å—Ç–∞–±—ñ–ª—å–Ω–∏–º, –º–∞—î —Å–µ–Ω—Å –Ω–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ –¥–µ—è–∫—ñ –∑ –Ω–∞—à–∏—Ö –≥—ñ–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ –ø—ñ–¥ —á–∞—Å –Ω–∞–≤—á–∞–Ω–Ω—è. –ó–æ–∫—Ä–µ–º–∞:

- **–î–ª—è —à–≤–∏–¥–∫–æ—Å—Ç—ñ –Ω–∞–≤—á–∞–Ω–Ω—è**, `alpha`, –º–∏ –º–æ–∂–µ–º–æ –ø–æ—á–∞—Ç–∏ –∑—ñ –∑–Ω–∞—á–µ–Ω—å, –±–ª–∏–∑—å–∫–∏—Ö –¥–æ 1, –∞ –ø–æ—Ç—ñ–º –ø–æ—Å—Ç—É–ø–æ–≤–æ –∑–º–µ–Ω—à—É–≤–∞—Ç–∏ —Ü–µ–π –ø–∞—Ä–∞–º–µ—Ç—Ä. –ó —á–∞—Å–æ–º –º–∏ –±—É–¥–µ–º–æ –æ—Ç—Ä–∏–º—É–≤–∞—Ç–∏ —Ö–æ—Ä–æ—à—ñ –π–º–æ–≤—ñ—Ä–Ω—ñ—Å–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è –≤ Q-—Ç–∞–±–ª–∏—Ü—ñ, —ñ —Ç–æ–º—É —Å–ª—ñ–¥ –∫–æ—Ä–∏–≥—É–≤–∞—Ç–∏ —ó—Ö –Ω–µ–∑–Ω–∞—á–Ω–æ, –∞ –Ω–µ –ø–æ–≤–Ω—ñ—Å—Ç—é –ø–µ—Ä–µ–∑–∞–ø–∏—Å—É–≤–∞—Ç–∏ –Ω–æ–≤–∏–º–∏ –∑–Ω–∞—á–µ–Ω–Ω—è–º–∏.

- **–ó–±—ñ–ª—å—à–µ–Ω–Ω—è epsilon**. –ú–∏ –º–æ–∂–µ–º–æ –ø–æ—Å—Ç—É–ø–æ–≤–æ –∑–±—ñ–ª—å—à—É–≤–∞—Ç–∏ `epsilon`, —â–æ–± –º–µ–Ω—à–µ –¥–æ—Å–ª—ñ–¥–∂—É–≤–∞—Ç–∏ —ñ –±—ñ–ª—å—à–µ –µ–∫—Å–ø–ª—É–∞—Ç—É–≤–∞—Ç–∏. –ô–º–æ–≤—ñ—Ä–Ω–æ, –º–∞—î —Å–µ–Ω—Å –ø–æ—á–∞—Ç–∏ –∑ –Ω–∏–∂—á–æ–≥–æ –∑–Ω–∞—á–µ–Ω–Ω—è `epsilon` —ñ –ø–æ—Å—Ç—É–ø–æ–≤–æ –∑–±—ñ–ª—å—à—É–≤–∞—Ç–∏ –π–æ–≥–æ –¥–æ –º–∞–π–∂–µ 1.
> **–ó–∞–≤–¥–∞–Ω–Ω—è 1**: –°–ø—Ä–æ–±—É–π—Ç–µ –∑–º—ñ–Ω–∏—Ç–∏ –∑–Ω–∞—á–µ–Ω–Ω—è –≥—ñ–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ —ñ –ø–æ–¥–∏–≤—ñ—Ç—å—Å—è, —á–∏ –∑–º–æ–∂–µ—Ç–µ –≤–∏ –¥–æ—Å—è–≥—Ç–∏ –±—ñ–ª—å—à–æ—ó —Å—É–∫—É–ø–Ω–æ—ó –≤–∏–Ω–∞–≥–æ—Ä–æ–¥–∏. –ß–∏ –æ—Ç—Ä–∏–º—É—î—Ç–µ –≤–∏ –±—ñ–ª—å—à–µ 195?
> **–ó–∞–≤–¥–∞–Ω–Ω—è 2**: –©–æ–± —Ñ–æ—Ä–º–∞–ª—å–Ω–æ –≤–∏—Ä—ñ—à–∏—Ç–∏ –ø—Ä–æ–±–ª–µ–º—É, –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ –¥–æ—Å—è–≥—Ç–∏ —Å–µ—Ä–µ–¥–Ω—å–æ—ó –≤–∏–Ω–∞–≥–æ—Ä–æ–¥–∏ 195 –ø—Ä–æ—Ç—è–≥–æ–º 100 –ø–æ—Å–ª—ñ–¥–æ–≤–Ω–∏—Ö –∑–∞–ø—É—Å–∫—ñ–≤. –í–∏–º—ñ—Ä—è–π—Ç–µ —Ü–µ –ø—ñ–¥ —á–∞—Å –Ω–∞–≤—á–∞–Ω–Ω—è —ñ –ø–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ –≤–∏ —Ñ–æ—Ä–º–∞–ª—å–Ω–æ –≤–∏—Ä—ñ—à–∏–ª–∏ –ø—Ä–æ–±–ª–µ–º—É!

## –ü–µ—Ä–µ–≥–ª—è–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É –≤ –¥—ñ—ó

–ë—É–ª–æ –± —Ü—ñ–∫–∞–≤–æ –ø–æ–±–∞—á–∏—Ç–∏, —è–∫ –ø–æ–≤–æ–¥–∏—Ç—å—Å—è –Ω–∞–≤—á–µ–Ω–∞ –º–æ–¥–µ–ª—å. –î–∞–≤–∞–π—Ç–µ –∑–∞–ø—É—Å—Ç–∏–º–æ —Å–∏–º—É–ª—è—Ü—ñ—é —ñ –±—É–¥–µ–º–æ –¥–æ—Ç—Ä–∏–º—É–≤–∞—Ç–∏—Å—è —Ç—ñ—î—ó –∂ —Å—Ç—Ä–∞—Ç–µ–≥—ñ—ó –≤–∏–±–æ—Ä—É –¥—ñ–π, —â–æ –π –ø—ñ–¥ —á–∞—Å –Ω–∞–≤—á–∞–Ω–Ω—è, –≤–∏–±–∏—Ä–∞—é—á–∏ –¥—ñ—ó –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ –¥–æ —Ä–æ–∑–ø–æ–¥—ñ–ª—É –π–º–æ–≤—ñ—Ä–Ω–æ—Å—Ç–µ–π —É Q-—Ç–∞–±–ª–∏—Ü—ñ: (–±–ª–æ–∫ –∫–æ–¥—É 13)

```python
obs = env.reset()
done = False
while not done:
   s = discretize(obs)
   env.render()
   v = probs(np.array(qvalues(s)))
   a = random.choices(actions,weights=v)[0]
   obs,_,done,_ = env.step(a)
env.close()
```

–í–∏ –ø–æ–≤–∏–Ω–Ω—ñ –ø–æ–±–∞—á–∏—Ç–∏ —â–æ—Å—å –ø–æ–¥—ñ–±–Ω–µ:

![–±–∞–ª–∞–Ω—Å—É—é—á–∏–π CartPole](../../../../8-Reinforcement/2-Gym/images/cartpole-balance.gif)

---

## üöÄ–í–∏–∫–ª–∏–∫

> **–ó–∞–≤–¥–∞–Ω–Ω—è 3**: –¢—É—Ç –º–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞–ª–∏ —Ñ—ñ–Ω–∞–ª—å–Ω—É –∫–æ–ø—ñ—é Q-—Ç–∞–±–ª–∏—Ü—ñ, —è–∫–∞ –º–æ–∂–µ –±—É—Ç–∏ –Ω–µ –Ω–∞–π–∫—Ä–∞—â–æ—é. –ü–∞–º‚Äô—è—Ç–∞–π—Ç–µ, —â–æ –º–∏ –∑–±–µ—Ä–µ–≥–ª–∏ –Ω–∞–π–∫—Ä–∞—â—É Q-—Ç–∞–±–ª–∏—Ü—é —É –∑–º—ñ–Ω–Ω—ñ–π `Qbest`! –°–ø—Ä–æ–±—É–π—Ç–µ —Ç–æ–π —Å–∞–º–∏–π –ø—Ä–∏–∫–ª–∞–¥ —ñ–∑ –Ω–∞–π–∫—Ä–∞—â–æ—é Q-—Ç–∞–±–ª–∏—Ü–µ—é, —Å–∫–æ–ø—ñ—é–≤–∞–≤—à–∏ `Qbest` —É `Q`, —ñ –ø–æ–¥–∏–≤—ñ—Ç—å—Å—è, —á–∏ –ø–æ–º—ñ—Ç–∏—Ç–µ —Ä—ñ–∑–Ω–∏—Ü—é.

> **–ó–∞–≤–¥–∞–Ω–Ω—è 4**: –¢—É—Ç –º–∏ –Ω–µ –≤–∏–±–∏—Ä–∞–ª–∏ –Ω–∞–π–∫—Ä–∞—â—É –¥—ñ—é –Ω–∞ –∫–æ–∂–Ω–æ–º—É –∫—Ä–æ—Ü—ñ, –∞ –Ω–∞—Ç–æ–º—ñ—Å—Ç—å –≤–∏–±–∏—Ä–∞–ª–∏ –¥—ñ—ó –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ –¥–æ —Ä–æ–∑–ø–æ–¥—ñ–ª—É –π–º–æ–≤—ñ—Ä–Ω–æ—Å—Ç–µ–π. –ß–∏ –±—É–ª–æ –± –ª–æ–≥—ñ—á–Ω—ñ—à–µ –∑–∞–≤–∂–¥–∏ –≤–∏–±–∏—Ä–∞—Ç–∏ –Ω–∞–π–∫—Ä–∞—â—É –¥—ñ—é –∑ –Ω–∞–π–≤–∏—â–∏–º –∑–Ω–∞—á–µ–Ω–Ω—è–º —É Q-—Ç–∞–±–ª–∏—Ü—ñ? –¶–µ –º–æ–∂–Ω–∞ –∑—Ä–æ–±–∏—Ç–∏ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Ñ—É–Ω–∫—Ü—ñ—ó `np.argmax`, —â–æ–± –≤–∏–∑–Ω–∞—á–∏—Ç–∏ –Ω–æ–º–µ—Ä –¥—ñ—ó, —â–æ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –Ω–∞–π–≤–∏—â–æ–º—É –∑–Ω–∞—á–µ–Ω–Ω—é Q-—Ç–∞–±–ª–∏—Ü—ñ. –†–µ–∞–ª—ñ–∑—É–π—Ç–µ —Ü—é —Å—Ç—Ä–∞—Ç–µ–≥—ñ—é —ñ –ø–æ–¥–∏–≤—ñ—Ç—å—Å—è, —á–∏ –ø–æ–∫—Ä–∞—â–∏—Ç—å—Å—è –±–∞–ª–∞–Ω—Å—É–≤–∞–Ω–Ω—è.

## [–¢–µ—Å—Ç –ø—ñ—Å–ª—è –ª–µ–∫—Ü—ñ—ó](https://ff-quizzes.netlify.app/en/ml/)

## –ó–∞–≤–¥–∞–Ω–Ω—è
[–ù–∞–≤—á—ñ—Ç—å Mountain Car](assignment.md)

## –í–∏—Å–Ω–æ–≤–æ–∫

–ú–∏ —Ç–µ–ø–µ—Ä –∑–Ω–∞—î–º–æ, —è–∫ –Ω–∞–≤—á–∞—Ç–∏ –∞–≥–µ–Ω—Ç—ñ–≤ –¥–æ—Å—è–≥–∞—Ç–∏ —Ö–æ—Ä–æ—à–∏—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤, –ø—Ä–æ—Å—Ç–æ –Ω–∞–¥–∞—é—á–∏ —ó–º —Ñ—É–Ω–∫—Ü—ñ—é –≤–∏–Ω–∞–≥–æ—Ä–æ–¥–∏, —è–∫–∞ –≤–∏–∑–Ω–∞—á–∞—î –±–∞–∂–∞–Ω–∏–π —Å—Ç–∞–Ω –≥—Ä–∏, —ñ –¥–∞—é—á–∏ —ó–º –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å —Ä–æ–∑—É–º–Ω–æ –¥–æ—Å–ª—ñ–¥–∂—É–≤–∞—Ç–∏ –ø—Ä–æ—Å—Ç—ñ—Ä –ø–æ—à—É–∫—É. –ú–∏ —É—Å–ø—ñ—à–Ω–æ –∑–∞—Å—Ç–æ—Å—É–≤–∞–ª–∏ –∞–ª–≥–æ—Ä–∏—Ç–º Q-Learning —É –≤–∏–ø–∞–¥–∫–∞—Ö –¥–∏—Å–∫—Ä–µ—Ç–Ω–∏—Ö —ñ –±–µ–∑–ø–µ—Ä–µ—Ä–≤–Ω–∏—Ö —Å–µ—Ä–µ–¥–æ–≤–∏—â, –∞–ª–µ –∑ –¥–∏—Å–∫—Ä–µ—Ç–Ω–∏–º–∏ –¥—ñ—è–º–∏.

–í–∞–∂–ª–∏–≤–æ —Ç–∞–∫–æ–∂ –≤–∏–≤—á–∞—Ç–∏ —Å–∏—Ç—É–∞—Ü—ñ—ó, –∫–æ–ª–∏ —Å—Ç–∞–Ω –¥—ñ–π —Ç–∞–∫–æ–∂ —î –±–µ–∑–ø–µ—Ä–µ—Ä–≤–Ω–∏–º, –∞ –ø—Ä–æ—Å—Ç—ñ—Ä —Å–ø–æ—Å—Ç–µ—Ä–µ–∂–µ–Ω—å –Ω–∞–±–∞–≥–∞—Ç–æ —Å–∫–ª–∞–¥–Ω—ñ—à–∏–π, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è –∑ –µ–∫—Ä–∞–Ω—É –≥—Ä–∏ Atari. –£ —Ç–∞–∫–∏—Ö –∑–∞–¥–∞—á–∞—Ö —á–∞—Å—Ç–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –±—ñ–ª—å—à –ø–æ—Ç—É–∂–Ω—ñ –º–µ—Ç–æ–¥–∏ –º–∞—à–∏–Ω–Ω–æ–≥–æ –Ω–∞–≤—á–∞–Ω–Ω—è, —Ç–∞–∫—ñ —è–∫ –Ω–µ–π—Ä–æ–Ω–Ω—ñ –º–µ—Ä–µ–∂—ñ, —â–æ–± –¥–æ—Å—è–≥—Ç–∏ —Ö–æ—Ä–æ—à–∏—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤. –¶—ñ –±—ñ–ª—å—à —Å–∫–ª–∞–¥–Ω—ñ —Ç–µ–º–∏ —î –ø—Ä–µ–¥–º–µ—Ç–æ–º –Ω–∞—à–æ–≥–æ –º–∞–π–±—É—Ç–Ω—å–æ–≥–æ –∫—É—Ä—Å—É –∑ –ø—Ä–æ—Å—É–Ω—É—Ç–æ–≥–æ —à—Ç—É—á–Ω–æ–≥–æ —ñ–Ω—Ç–µ–ª–µ–∫—Ç—É.

---

**–í—ñ–¥–º–æ–≤–∞ –≤—ñ–¥ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞–ª—å–Ω–æ—Å—Ç—ñ**:  
–¶–µ–π –¥–æ–∫—É–º–µ–Ω—Ç –±—É–ª–æ –ø–µ—Ä–µ–∫–ª–∞–¥–µ–Ω–æ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Å–µ—Ä–≤—ñ—Å—É –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ–≥–æ –ø–µ—Ä–µ–∫–ª–∞–¥—É [Co-op Translator](https://github.com/Azure/co-op-translator). –•–æ—á–∞ –º–∏ –ø—Ä–∞–≥–Ω–µ–º–æ –¥–æ —Ç–æ—á–Ω–æ—Å—Ç—ñ, –∑–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω—ñ –ø–µ—Ä–µ–∫–ª–∞–¥–∏ –º–æ–∂—É—Ç—å –º—ñ—Å—Ç–∏—Ç–∏ –ø–æ–º–∏–ª–∫–∏ –∞–±–æ –Ω–µ—Ç–æ—á–Ω–æ—Å—Ç—ñ. –û—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–∏–π –¥–æ–∫—É–º–µ–Ω—Ç –º–æ–≤–æ—é –æ—Ä–∏–≥—ñ–Ω–∞–ª—É —Å–ª—ñ–¥ –≤–≤–∞–∂–∞—Ç–∏ –∞–≤—Ç–æ—Ä–∏—Ç–µ—Ç–Ω–∏–º –¥–∂–µ—Ä–µ–ª–æ–º. –î–ª—è –∫—Ä–∏—Ç–∏—á–Ω–æ –≤–∞–∂–ª–∏–≤–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó —Ä–µ–∫–æ–º–µ–Ω–¥—É—î—Ç—å—Å—è –ø—Ä–æ—Ñ–µ—Å—ñ–π–Ω–∏–π –ª—é–¥—Å—å–∫–∏–π –ø–µ—Ä–µ–∫–ª–∞–¥. –ú–∏ –Ω–µ –Ω–µ—Å–µ–º–æ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞–ª—å–Ω–æ—Å—Ç—ñ –∑–∞ –±—É–¥—å-—è–∫—ñ –Ω–µ–ø–æ—Ä–æ–∑—É–º—ñ–Ω–Ω—è –∞–±–æ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ñ —Ç–ª—É–º–∞—á–µ–Ω–Ω—è, —â–æ –≤–∏–Ω–∏–∫–ª–∏ –≤–Ω–∞—Å–ª—ñ–¥–æ–∫ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Ü—å–æ–≥–æ –ø–µ—Ä–µ–∫–ª–∞–¥—É.