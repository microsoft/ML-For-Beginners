<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "917dbf890db71a322f306050cb284749",
  "translation_date": "2025-09-05T11:54:13+00:00",
  "source_file": "7-TimeSeries/2-ARIMA/README.md",
  "language_code": "uk"
}
-->
# –ü—Ä–æ–≥–Ω–æ–∑—É–≤–∞–Ω–Ω—è —á–∞—Å–æ–≤–∏—Ö —Ä—è–¥—ñ–≤ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é ARIMA

–£ –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–º—É —É—Ä–æ—Ü—ñ –≤–∏ –¥—ñ–∑–Ω–∞–ª–∏—Å—è —Ç—Ä–æ—Ö–∏ –ø—Ä–æ –ø—Ä–æ–≥–Ω–æ–∑—É–≤–∞–Ω–Ω—è —á–∞—Å–æ–≤–∏—Ö —Ä—è–¥—ñ–≤ —ñ –∑–∞–≤–∞–Ω—Ç–∞–∂–∏–ª–∏ –Ω–∞–±—ñ—Ä –¥–∞–Ω–∏—Ö, —â–æ –ø–æ–∫–∞–∑—É—î –∫–æ–ª–∏–≤–∞–Ω–Ω—è –µ–ª–µ–∫—Ç—Ä–∏—á–Ω–æ–≥–æ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∑–∞ –ø–µ–≤–Ω–∏–π –ø–µ—Ä—ñ–æ–¥ —á–∞—Å—É.

[![–í—Å—Ç—É–ø –¥–æ ARIMA](https://img.youtube.com/vi/IUSk-YDau10/0.jpg)](https://youtu.be/IUSk-YDau10 "–í—Å—Ç—É–ø –¥–æ ARIMA")

> üé• –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å –Ω–∞ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è –≤–∏—â–µ, —â–æ–± –ø–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ –≤—ñ–¥–µ–æ: –ö–æ—Ä–æ—Ç–∫–∏–π –≤—Å—Ç—É–ø –¥–æ –º–æ–¥–µ–ª–µ–π ARIMA. –ü—Ä–∏–∫–ª–∞–¥ –≤–∏–∫–æ–Ω–∞–Ω–∏–π —É R, –∞–ª–µ –∫–æ–Ω—Ü–µ–ø—Ü—ñ—ó —î —É–Ω—ñ–≤–µ—Ä—Å–∞–ª—å–Ω–∏–º–∏.

## [–¢–µ—Å—Ç –ø–µ—Ä–µ–¥ –ª–µ–∫—Ü—ñ—î—é](https://ff-quizzes.netlify.app/en/ml/)

## –í—Å—Ç—É–ø

–£ —Ü—å–æ–º—É —É—Ä–æ—Ü—ñ –≤–∏ –¥—ñ–∑–Ω–∞—î—Ç–µ—Å—è –ø—Ä–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏–π —Å–ø–æ—Å—ñ–± —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –º–æ–¥–µ–ª–µ–π –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é [ARIMA: *A*uto*R*egressive *I*ntegrated *M*oving *A*verage](https://wikipedia.org/wiki/Autoregressive_integrated_moving_average). –ú–æ–¥–µ–ª—ñ ARIMA –æ—Å–æ–±–ª–∏–≤–æ –¥–æ–±—Ä–µ –ø—ñ–¥—Ö–æ–¥—è—Ç—å –¥–ª—è –∞–Ω–∞–ª—ñ–∑—É –¥–∞–Ω–∏—Ö, —è–∫—ñ –¥–µ–º–æ–Ω—Å—Ç—Ä—É—é—Ç—å [–Ω–µ—Å—Ç–∞—Ü—ñ–æ–Ω–∞—Ä–Ω—ñ—Å—Ç—å](https://wikipedia.org/wiki/Stationary_process).

## –ó–∞–≥–∞–ª—å–Ω—ñ –∫–æ–Ω—Ü–µ–ø—Ü—ñ—ó

–©–æ–± –ø—Ä–∞—Ü—é–≤–∞—Ç–∏ –∑ ARIMA, –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ –∑–Ω–∞—Ç–∏ –∫—ñ–ª—å–∫–∞ –∫–ª—é—á–æ–≤–∏—Ö –ø–æ–Ω—è—Ç—å:

- üéì **–°—Ç–∞—Ü—ñ–æ–Ω–∞—Ä–Ω—ñ—Å—Ç—å**. –£ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–Ω–æ–º—É –∫–æ–Ω—Ç–µ–∫—Å—Ç—ñ —Å—Ç–∞—Ü—ñ–æ–Ω–∞—Ä–Ω—ñ—Å—Ç—å –æ–∑–Ω–∞—á–∞—î –¥–∞–Ω—ñ, —Ä–æ–∑–ø–æ–¥—ñ–ª —è–∫–∏—Ö –Ω–µ –∑–º—ñ–Ω—é—î—Ç—å—Å—è –ø—Ä–∏ –∑—Å—É–≤—ñ –≤ —á–∞—Å—ñ. –ù–µ—Å—Ç–∞—Ü—ñ–æ–Ω–∞—Ä–Ω—ñ –¥–∞–Ω—ñ, –Ω–∞–≤–ø–∞–∫–∏, –¥–µ–º–æ–Ω—Å—Ç—Ä—É—é—Ç—å –∫–æ–ª–∏–≤–∞–Ω–Ω—è —á–µ—Ä–µ–∑ —Ç—Ä–µ–Ω–¥–∏, —è–∫—ñ –ø–æ—Ç—Ä—ñ–±–Ω–æ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º—É–≤–∞—Ç–∏ –¥–ª—è –∞–Ω–∞–ª—ñ–∑—É. –ù–∞–ø—Ä–∏–∫–ª–∞–¥, —Å–µ–∑–æ–Ω–Ω—ñ—Å—Ç—å –º–æ–∂–µ –≤–∏–∫–ª–∏–∫–∞—Ç–∏ –∫–æ–ª–∏–≤–∞–Ω–Ω—è –≤ –¥–∞–Ω–∏—Ö, —è–∫—ñ –º–æ–∂–Ω–∞ —É—Å—É–Ω—É—Ç–∏ —à–ª—è—Ö–æ–º "—Å–µ–∑–æ–Ω–Ω–æ–≥–æ –¥–∏—Ñ–µ—Ä–µ–Ω—Ü—ñ—é–≤–∞–Ω–Ω—è".

- üéì **[–î–∏—Ñ–µ—Ä–µ–Ω—Ü—ñ—é–≤–∞–Ω–Ω—è](https://wikipedia.org/wiki/Autoregressive_integrated_moving_average#Differencing)**. –î–∏—Ñ–µ—Ä–µ–Ω—Ü—ñ—é–≤–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö —É —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–Ω–æ–º—É –∫–æ–Ω—Ç–µ–∫—Å—Ç—ñ –æ–∑–Ω–∞—á–∞—î –ø—Ä–æ—Ü–µ—Å —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü—ñ—ó –Ω–µ—Å—Ç–∞—Ü—ñ–æ–Ω–∞—Ä–Ω–∏—Ö –¥–∞–Ω–∏—Ö –¥–ª—è –ø–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è —ó—Ö —É —Å—Ç–∞—Ü—ñ–æ–Ω–∞—Ä–Ω—ñ —à–ª—è—Ö–æ–º —É—Å—É–Ω–µ–Ω–Ω—è –Ω–µ–∫–æ–Ω—Å—Ç–∞–Ω—Ç–Ω–æ–≥–æ —Ç—Ä–µ–Ω–¥—É. "–î–∏—Ñ–µ—Ä–µ–Ω—Ü—ñ—é–≤–∞–Ω–Ω—è —É—Å—É–≤–∞—î –∑–º—ñ–Ω–∏ —Ä—ñ–≤–Ω—è —á–∞—Å–æ–≤–∏—Ö —Ä—è–¥—ñ–≤, –ª—ñ–∫–≤—ñ–¥—É—é—á–∏ —Ç—Ä–µ–Ω–¥ —ñ —Å–µ–∑–æ–Ω–Ω—ñ—Å—Ç—å, —Ç–∏–º —Å–∞–º–∏–º —Å—Ç–∞–±—ñ–ª—ñ–∑—É—é—á–∏ —Å–µ—Ä–µ–¥–Ω—î –∑–Ω–∞—á–µ–Ω–Ω—è —á–∞—Å–æ–≤–∏—Ö —Ä—è–¥—ñ–≤." [–°—Ç–∞—Ç—Ç—è –®—ñ–∫—Å—ñ–æ–Ω–≥–∞ —Ç–∞ —ñ–Ω.](https://arxiv.org/abs/1904.07632)

## ARIMA —É –∫–æ–Ω—Ç–µ–∫—Å—Ç—ñ —á–∞—Å–æ–≤–∏—Ö —Ä—è–¥—ñ–≤

–†–æ–∑–≥–ª—è–Ω–µ–º–æ —Å–∫–ª–∞–¥–æ–≤—ñ ARIMA, —â–æ–± –∫—Ä–∞—â–µ –∑—Ä–æ–∑—É–º—ñ—Ç–∏, —è–∫ –≤–æ–Ω–∞ –¥–æ–ø–æ–º–∞–≥–∞—î –º–æ–¥–µ–ª—é–≤–∞—Ç–∏ —á–∞—Å–æ–≤—ñ —Ä—è–¥–∏ —Ç–∞ —Ä–æ–±–∏—Ç–∏ –ø—Ä–æ–≥–Ω–æ–∑–∏.

- **AR - –ê–≤—Ç–æ–∫–æ—Ä–µ–ª—è—Ü—ñ—è**. –ê–≤—Ç–æ–∫–æ—Ä–µ–ª—è—Ü—ñ–π–Ω—ñ –º–æ–¥–µ–ª—ñ, —è–∫ –≤–∏–ø–ª–∏–≤–∞—î –∑ –Ω–∞–∑–≤–∏, –∞–Ω–∞–ª—ñ–∑—É—é—Ç—å –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è –≤–∞—à–∏—Ö –¥–∞–Ω–∏—Ö, —â–æ–± –∑—Ä–æ–±–∏—Ç–∏ –ø—Ä–∏–ø—É—â–µ–Ω–Ω—è –ø—Ä–æ –Ω–∏—Ö. –¶—ñ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è –Ω–∞–∑–∏–≤–∞—é—Ç—å—Å—è "–ª–∞–≥–∞–º–∏". –ù–∞–ø—Ä–∏–∫–ª–∞–¥, –¥–∞–Ω—ñ, —â–æ –ø–æ–∫–∞–∑—É—é—Ç—å —â–æ–º—ñ—Å—è—á–Ω—ñ –ø—Ä–æ–¥–∞–∂—ñ –æ–ª—ñ–≤—Ü—ñ–≤. –ó–∞–≥–∞–ª—å–Ω–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –ø—Ä–æ–¥–∞–∂—ñ–≤ –∫–æ–∂–Ω–æ–≥–æ –º—ñ—Å—è—Ü—è –±—É–¥–µ –≤–≤–∞–∂–∞—Ç–∏—Å—è "–∑–º—ñ–Ω–Ω–æ—é, —â–æ –µ–≤–æ–ª—é—Ü—ñ–æ–Ω—É—î" –≤ –Ω–∞–±–æ—Ä—ñ –¥–∞–Ω–∏—Ö. –¶—è –º–æ–¥–µ–ª—å –±—É–¥—É—î—Ç—å—Å—è —è–∫ "–∑–º—ñ–Ω–Ω–∞, —â–æ –µ–≤–æ–ª—é—Ü—ñ–æ–Ω—É—î, —Ä–µ–≥—Ä–µ—Å—É—î—Ç—å—Å—è –Ω–∞ —Å–≤–æ—ó—Ö –≤–ª–∞—Å–Ω–∏—Ö –ª–∞–≥–æ–≤–∏—Ö (—Ç–æ–±—Ç–æ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ—Ö) –∑–Ω–∞—á–µ–Ω–Ω—è—Ö." [wikipedia](https://wikipedia.org/wiki/Autoregressive_integrated_moving_average)

- **I - –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è**. –ù–∞ –≤—ñ–¥–º—ñ–Ω—É –≤—ñ–¥ —Å—Ö–æ–∂–∏—Ö –º–æ–¥–µ–ª–µ–π 'ARMA', 'I' –≤ ARIMA –æ–∑–Ω–∞—á–∞—î —ó—ó *[—ñ–Ω—Ç–µ–≥—Ä–æ–≤–∞–Ω—É](https://wikipedia.org/wiki/Order_of_integration)* —Å–∫–ª–∞–¥–æ–≤—É. –î–∞–Ω—ñ —Å—Ç–∞—é—Ç—å "—ñ–Ω—Ç–µ–≥—Ä–æ–≤–∞–Ω–∏–º–∏", –∫–æ–ª–∏ –∑–∞—Å—Ç–æ—Å–æ–≤—É—é—Ç—å—Å—è –∫—Ä–æ–∫–∏ –¥–∏—Ñ–µ—Ä–µ–Ω—Ü—ñ—é–≤–∞–Ω–Ω—è –¥–ª—è —É—Å—É–Ω–µ–Ω–Ω—è –Ω–µ—Å—Ç–∞—Ü—ñ–æ–Ω–∞—Ä–Ω–æ—Å—Ç—ñ.

- **MA - –ó–º—ñ–Ω–Ω–µ —Å–µ—Ä–µ–¥–Ω—î**. –°–∫–ª–∞–¥–æ–≤–∞ [–∑–º—ñ–Ω–Ω–æ–≥–æ —Å–µ—Ä–µ–¥–Ω—å–æ–≥–æ](https://wikipedia.org/wiki/Moving-average_model) —Ü—ñ—î—ó –º–æ–¥–µ–ª—ñ —Å—Ç–æ—Å—É—î—Ç—å—Å—è –≤–∏—Ö—ñ–¥–Ω–æ—ó –∑–º—ñ–Ω–Ω–æ—ó, —è–∫–∞ –≤–∏–∑–Ω–∞—á–∞—î—Ç—å—Å—è —à–ª—è—Ö–æ–º —Å–ø–æ—Å—Ç–µ—Ä–µ–∂–µ–Ω–Ω—è –∑–∞ –ø–æ—Ç–æ—á–Ω–∏–º–∏ —Ç–∞ –º–∏–Ω—É–ª–∏–º–∏ –∑–Ω–∞—á–µ–Ω–Ω—è–º–∏ –ª–∞–≥—ñ–≤.

–°—É—Ç—å: ARIMA –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è —Ç–æ–≥–æ, —â–æ–± –º–æ–¥–µ–ª—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ —Ç–æ—á–Ω–æ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞–ª–∞ –æ—Å–æ–±–ª–∏–≤—ñ–π —Ñ–æ—Ä–º—ñ –¥–∞–Ω–∏—Ö —á–∞—Å–æ–≤–∏—Ö —Ä—è–¥—ñ–≤.

## –í–ø—Ä–∞–≤–∞ - —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –º–æ–¥–µ–ª—ñ ARIMA

–í—ñ–¥–∫—Ä–∏–π—Ç–µ –ø–∞–ø–∫—É [_/working_](https://github.com/microsoft/ML-For-Beginners/tree/main/7-TimeSeries/2-ARIMA/working) —É —Ü—å–æ–º—É —É—Ä–æ—Ü—ñ —Ç–∞ –∑–Ω–∞–π–¥—ñ—Ç—å —Ñ–∞–π–ª [_notebook.ipynb_](https://github.com/microsoft/ML-For-Beginners/blob/main/7-TimeSeries/2-ARIMA/working/notebook.ipynb).

1. –ó–∞–ø—É—Å—Ç—ñ—Ç—å –Ω–æ—É—Ç–±—É–∫, —â–æ–± –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –±—ñ–±–ª—ñ–æ—Ç–µ–∫—É Python `statsmodels`; –≤–æ–Ω–∞ –∑–Ω–∞–¥–æ–±–∏—Ç—å—Å—è –¥–ª—è –º–æ–¥–µ–ª–µ–π ARIMA.

1. –ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ –Ω–µ–æ–±—Ö—ñ–¥–Ω—ñ –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∏.

1. –¢–µ–ø–µ—Ä –∑–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ –∫—ñ–ª—å–∫–∞ –¥–æ–¥–∞—Ç–∫–æ–≤–∏—Ö –±—ñ–±–ª—ñ–æ—Ç–µ–∫, –∫–æ—Ä–∏—Å–Ω–∏—Ö –¥–ª—è –ø–æ–±—É–¥–æ–≤–∏ –≥—Ä–∞—Ñ—ñ–∫—ñ–≤:

    ```python
    import os
    import warnings
    import matplotlib.pyplot as plt
    import numpy as np
    import pandas as pd
    import datetime as dt
    import math

    from pandas.plotting import autocorrelation_plot
    from statsmodels.tsa.statespace.sarimax import SARIMAX
    from sklearn.preprocessing import MinMaxScaler
    from common.utils import load_data, mape
    from IPython.display import Image

    %matplotlib inline
    pd.options.display.float_format = '{:,.2f}'.format
    np.set_printoptions(precision=2)
    warnings.filterwarnings("ignore") # specify to ignore warning messages
    ```

1. –ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ –¥–∞–Ω—ñ –∑ —Ñ–∞–π–ª—É `/data/energy.csv` —É Pandas DataFrame —ñ –ø–µ—Ä–µ–≥–ª—è–Ω—å—Ç–µ —ó—Ö:

    ```python
    energy = load_data('./data')[['load']]
    energy.head(10)
    ```

1. –ü–æ–±—É–¥—É–π—Ç–µ –≥—Ä–∞—Ñ—ñ–∫ —É—Å—ñ—Ö –¥–æ—Å—Ç—É–ø–Ω–∏—Ö –¥–∞–Ω–∏—Ö –ø—Ä–æ –µ–Ω–µ—Ä–≥—ñ—é –∑ —Å—ñ—á–Ω—è 2012 —Ä–æ–∫—É –ø–æ –≥—Ä—É–¥–µ–Ω—å 2014 —Ä–æ–∫—É. –ù—ñ—è–∫–∏—Ö —Å—é—Ä–ø—Ä–∏–∑—ñ–≤ –Ω–µ –±—É–¥–µ, –æ—Å–∫—ñ–ª—å–∫–∏ –º–∏ –±–∞—á–∏–ª–∏ —Ü—ñ –¥–∞–Ω—ñ –≤ –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–º—É —É—Ä–æ—Ü—ñ:

    ```python
    energy.plot(y='load', subplots=True, figsize=(15, 8), fontsize=12)
    plt.xlabel('timestamp', fontsize=12)
    plt.ylabel('load', fontsize=12)
    plt.show()
    ```

    –¢–µ–ø–µ—Ä –¥–∞–≤–∞–π—Ç–µ —Å—Ç–≤–æ—Ä–∏–º–æ –º–æ–¥–µ–ª—å!

### –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –Ω–∞–≤—á–∞–ª—å–Ω–∏—Ö —ñ —Ç–µ—Å—Ç–æ–≤–∏—Ö –Ω–∞–±–æ—Ä—ñ–≤ –¥–∞–Ω–∏—Ö

–¢–µ–ø–µ—Ä –≤–∞—à—ñ –¥–∞–Ω—ñ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω—ñ, —ñ –≤–∏ –º–æ–∂–µ—Ç–µ —Ä–æ–∑–¥—ñ–ª–∏—Ç–∏ —ó—Ö –Ω–∞ –Ω–∞–≤—á–∞–ª—å–Ω–∏–π —ñ —Ç–µ—Å—Ç–æ–≤–∏–π –Ω–∞–±–æ—Ä–∏. –í–∏ –±—É–¥–µ—Ç–µ —Ç—Ä–µ–Ω—É–≤–∞—Ç–∏ —Å–≤–æ—é –º–æ–¥–µ–ª—å –Ω–∞ –Ω–∞–≤—á–∞–ª—å–Ω–æ–º—É –Ω–∞–±–æ—Ä—ñ. –Ø–∫ –∑–∞–≤–∂–¥–∏, –ø—ñ—Å–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è –Ω–∞–≤—á–∞–Ω–Ω—è –º–æ–¥–µ–ª—ñ –≤–∏ –æ—Ü—ñ–Ω–∏—Ç–µ —ó—ó —Ç–æ—á–Ω—ñ—Å—Ç—å –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –Ω–∞–±–æ—Ä—É. –í–∏ –ø–æ–≤–∏–Ω–Ω—ñ –ø–µ—Ä–µ–∫–æ–Ω–∞—Ç–∏—Å—è, —â–æ —Ç–µ—Å—Ç–æ–≤–∏–π –Ω–∞–±—ñ—Ä –æ—Ö–æ–ø–ª—é—î –±—ñ–ª—å—à –ø—ñ–∑–Ω—ñ–π –ø–µ—Ä—ñ–æ–¥ —á–∞—Å—É, –Ω—ñ–∂ –Ω–∞–≤—á–∞–ª—å–Ω–∏–π, —â–æ–± –º–æ–¥–µ–ª—å –Ω–µ –æ—Ç—Ä–∏–º–∞–ª–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –∑ –º–∞–π–±—É—Ç–Ω—ñ—Ö –ø–µ—Ä—ñ–æ–¥—ñ–≤ —á–∞—Å—É.

1. –í–∏–¥—ñ–ª—ñ—Ç—å –¥–≤–æ–º—ñ—Å—è—á–Ω–∏–π –ø–µ—Ä—ñ–æ–¥ –∑ 1 –≤–µ—Ä–µ—Å–Ω—è –ø–æ 31 –∂–æ–≤—Ç–Ω—è 2014 —Ä–æ–∫—É –¥–ª—è –Ω–∞–≤—á–∞–ª—å–Ω–æ–≥–æ –Ω–∞–±–æ—Ä—É. –¢–µ—Å—Ç–æ–≤–∏–π –Ω–∞–±—ñ—Ä –≤–∫–ª—é—á–∞—Ç–∏–º–µ –¥–≤–æ–º—ñ—Å—è—á–Ω–∏–π –ø–µ—Ä—ñ–æ–¥ –∑ 1 –ª–∏—Å—Ç–æ–ø–∞–¥–∞ –ø–æ 31 –≥—Ä—É–¥–Ω—è 2014 —Ä–æ–∫—É:

    ```python
    train_start_dt = '2014-11-01 00:00:00'
    test_start_dt = '2014-12-30 00:00:00'
    ```

    –û—Å–∫—ñ–ª—å–∫–∏ —Ü—ñ –¥–∞–Ω—ñ –≤—ñ–¥–æ–±—Ä–∞–∂–∞—é—Ç—å —â–æ–¥–µ–Ω–Ω–µ —Å–ø–æ–∂–∏–≤–∞–Ω–Ω—è –µ–Ω–µ—Ä–≥—ñ—ó, —ñ—Å–Ω—É—î —Å–∏–ª—å–Ω–∞ —Å–µ–∑–æ–Ω–Ω–∞ –∑–∞–∫–æ–Ω–æ–º—ñ—Ä–Ω—ñ—Å—Ç—å, –∞–ª–µ —Å–ø–æ–∂–∏–≤–∞–Ω–Ω—è –Ω–∞–π–±—ñ–ª—å—à —Å—Ö–æ–∂–µ –Ω–∞ —Å–ø–æ–∂–∏–≤–∞–Ω–Ω—è –≤ –±—ñ–ª—å—à –Ω–µ–¥–∞–≤–Ω—ñ –¥–Ω—ñ.

1. –í—ñ–∑—É–∞–ª—ñ–∑—É–π—Ç–µ –≤—ñ–¥–º—ñ–Ω–Ω–æ—Å—Ç—ñ:

    ```python
    energy[(energy.index < test_start_dt) & (energy.index >= train_start_dt)][['load']].rename(columns={'load':'train'}) \
        .join(energy[test_start_dt:][['load']].rename(columns={'load':'test'}), how='outer') \
        .plot(y=['train', 'test'], figsize=(15, 8), fontsize=12)
    plt.xlabel('timestamp', fontsize=12)
    plt.ylabel('load', fontsize=12)
    plt.show()
    ```

    ![–Ω–∞–≤—á–∞–ª—å–Ω—ñ —Ç–∞ —Ç–µ—Å—Ç–æ–≤—ñ –¥–∞–Ω—ñ](../../../../7-TimeSeries/2-ARIMA/images/train-test.png)

    –¢–∞–∫–∏–º —á–∏–Ω–æ–º, –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –≤—ñ–¥–Ω–æ—Å–Ω–æ –Ω–µ–≤–µ–ª–∏–∫–æ–≥–æ –ø–µ—Ä—ñ–æ–¥—É —á–∞—Å—É –¥–ª—è –Ω–∞–≤—á–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö –º–∞—î –±—É—Ç–∏ –¥–æ—Å—Ç–∞—Ç–Ω—ñ–º.

    > –ü—Ä–∏–º—ñ—Ç–∫–∞: –û—Å–∫—ñ–ª—å–∫–∏ —Ñ—É–Ω–∫—Ü—ñ—è, —è–∫—É –º–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ –¥–ª—è –ø—ñ–¥–≥–æ–Ω–∫–∏ –º–æ–¥–µ–ª—ñ ARIMA, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –≤–Ω—É—Ç—Ä—ñ—à–Ω—å–æ–≤–∏–±—ñ—Ä–∫–æ–≤—É –≤–∞–ª—ñ–¥–∞—Ü—ñ—é –ø—ñ–¥ —á–∞—Å –ø—ñ–¥–≥–æ–Ω–∫–∏, –º–∏ –ø—Ä–æ–ø—É—Å—Ç–∏–º–æ –¥–∞–Ω—ñ –¥–ª—è –≤–∞–ª—ñ–¥–∞—Ü—ñ—ó.

### –ü—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–∏—Ö –¥–æ –Ω–∞–≤—á–∞–Ω–Ω—è

–¢–µ–ø–µ—Ä –≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –ø—ñ–¥–≥–æ—Ç—É–≤–∞—Ç–∏ –¥–∞–Ω—ñ –¥–æ –Ω–∞–≤—á–∞–Ω–Ω—è, –≤–∏–∫–æ–Ω–∞–≤—à–∏ —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—é —Ç–∞ –º–∞—Å—à—Ç–∞–±—É–≤–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö. –í—ñ–¥—Ñ—ñ–ª—å—Ç—Ä—É–π—Ç–µ –≤–∞—à –Ω–∞–±—ñ—Ä –¥–∞–Ω–∏—Ö, —â–æ–± –≤–∫–ª—é—á–∏—Ç–∏ –ª–∏—à–µ –ø–æ—Ç—Ä—ñ–±–Ω—ñ –ø–µ—Ä—ñ–æ–¥–∏ —á–∞—Å—É —Ç–∞ —Å—Ç–æ–≤–ø—Ü—ñ, –∞ —Ç–∞–∫–æ–∂ –º–∞—Å—à—Ç–∞–±—É–≤–∞–Ω–Ω—è, —â–æ–± –¥–∞–Ω—ñ –±—É–ª–∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ñ –≤ —ñ–Ω—Ç–µ—Ä–≤–∞–ª—ñ 0,1.

1. –í—ñ–¥—Ñ—ñ–ª—å—Ç—Ä—É–π—Ç–µ –æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–∏–π –Ω–∞–±—ñ—Ä –¥–∞–Ω–∏—Ö, —â–æ–± –≤–∫–ª—é—á–∏—Ç–∏ –ª–∏—à–µ –∑–∞–∑–Ω–∞—á–µ–Ω—ñ –ø–µ—Ä—ñ–æ–¥–∏ —á–∞—Å—É –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ –Ω–∞–±–æ—Ä—É —Ç–∞ –ª–∏—à–µ –ø–æ—Ç—Ä—ñ–±–Ω–∏–π —Å—Ç–æ–≤–ø–µ—Ü—å 'load' –ø–ª—é—Å –¥–∞—Ç—É:

    ```python
    train = energy.copy()[(energy.index >= train_start_dt) & (energy.index < test_start_dt)][['load']]
    test = energy.copy()[energy.index >= test_start_dt][['load']]

    print('Training data shape: ', train.shape)
    print('Test data shape: ', test.shape)
    ```

    –í–∏ –º–æ–∂–µ—Ç–µ –ø–æ–±–∞—á–∏—Ç–∏ —Ñ–æ—Ä–º—É –¥–∞–Ω–∏—Ö:

    ```output
    Training data shape:  (1416, 1)
    Test data shape:  (48, 1)
    ```

1. –ú–∞—Å—à—Ç–∞–±—É–π—Ç–µ –¥–∞–Ω—ñ, —â–æ–± –≤–æ–Ω–∏ –±—É–ª–∏ –≤ –¥—ñ–∞–ø–∞–∑–æ–Ω—ñ (0, 1).

    ```python
    scaler = MinMaxScaler()
    train['load'] = scaler.fit_transform(train)
    train.head(10)
    ```

1. –í—ñ–∑—É–∞–ª—ñ–∑—É–π—Ç–µ –æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω—ñ —Ç–∞ –º–∞—Å—à—Ç–∞–±–æ–≤–∞–Ω—ñ –¥–∞–Ω—ñ:

    ```python
    energy[(energy.index >= train_start_dt) & (energy.index < test_start_dt)][['load']].rename(columns={'load':'original load'}).plot.hist(bins=100, fontsize=12)
    train.rename(columns={'load':'scaled load'}).plot.hist(bins=100, fontsize=12)
    plt.show()
    ```

    ![–æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω—ñ](../../../../7-TimeSeries/2-ARIMA/images/original.png)

    > –û—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω—ñ –¥–∞–Ω—ñ

    ![–º–∞—Å—à—Ç–∞–±–æ–≤–∞–Ω—ñ](../../../../7-TimeSeries/2-ARIMA/images/scaled.png)

    > –ú–∞—Å—à—Ç–∞–±–æ–≤–∞–Ω—ñ –¥–∞–Ω—ñ

1. –¢–µ–ø–µ—Ä, –∫–æ–ª–∏ –≤–∏ –≤—ñ–¥–∫–∞–ª—ñ–±—Ä—É–≤–∞–ª–∏ –º–∞—Å—à—Ç–∞–±–æ–≤–∞–Ω—ñ –¥–∞–Ω—ñ, –≤–∏ –º–æ–∂–µ—Ç–µ –º–∞—Å—à—Ç–∞–±—É–≤–∞—Ç–∏ —Ç–µ—Å—Ç–æ–≤—ñ –¥–∞–Ω—ñ:

    ```python
    test['load'] = scaler.transform(test)
    test.head()
    ```

### –†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è ARIMA

–ù–∞—Å—Ç–∞–≤ —á–∞—Å —Ä–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ ARIMA! –¢–µ–ø–µ—Ä –≤–∏ –±—É–¥–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –±—ñ–±–ª—ñ–æ—Ç–µ–∫—É `statsmodels`, —è–∫—É –≤–∏ –≤—Å—Ç–∞–Ω–æ–≤–∏–ª–∏ —Ä–∞–Ω—ñ—à–µ.

–¢–µ–ø–µ—Ä –≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤–∏–∫–æ–Ω–∞—Ç–∏ –∫—ñ–ª—å–∫–∞ –∫—Ä–æ–∫—ñ–≤:

   1. –í–∏–∑–Ω–∞—á—Ç–µ –º–æ–¥–µ–ª—å, –≤–∏–∫–ª–∏–∫–∞–≤—à–∏ `SARIMAX()` —ñ –ø–µ—Ä–µ–¥–∞–≤—à–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ –º–æ–¥–µ–ª—ñ: –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ p, d —ñ q, –∞ —Ç–∞–∫–æ–∂ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ P, D —ñ Q.
   2. –ü—ñ–¥–≥–æ—Ç—É–π—Ç–µ –º–æ–¥–µ–ª—å –¥–ª—è –Ω–∞–≤—á–∞–ª—å–Ω–∏—Ö –¥–∞–Ω–∏—Ö, –≤–∏–∫–ª–∏–∫–∞–≤—à–∏ —Ñ—É–Ω–∫—Ü—ñ—é fit().
   3. –ó—Ä–æ–±—ñ—Ç—å –ø—Ä–æ–≥–Ω–æ–∑–∏, –≤–∏–∫–ª–∏–∫–∞–≤—à–∏ —Ñ—É–Ω–∫—Ü—ñ—é `forecast()` —ñ –≤–∫–∞–∑–∞–≤—à–∏ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –∫—Ä–æ–∫—ñ–≤ (–≥–æ—Ä–∏–∑–æ–Ω—Ç), —è–∫—ñ –ø–æ—Ç—Ä—ñ–±–Ω–æ –ø—Ä–æ–≥–Ω–æ–∑—É–≤–∞—Ç–∏.

> üéì –©–æ –æ–∑–Ω–∞—á–∞—é—Ç—å –≤—Å—ñ —Ü—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏? –£ –º–æ–¥–µ–ª—ñ ARIMA —î 3 –ø–∞—Ä–∞–º–µ—Ç—Ä–∏, —è–∫—ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è –¥–ª—è –º–æ–¥–µ–ª—é–≤–∞–Ω–Ω—è –æ—Å–Ω–æ–≤–Ω–∏—Ö –∞—Å–ø–µ–∫—Ç—ñ–≤ —á–∞—Å–æ–≤–∏—Ö —Ä—è–¥—ñ–≤: —Å–µ–∑–æ–Ω–Ω–æ—Å—Ç—ñ, —Ç—Ä–µ–Ω–¥—É —Ç–∞ —à—É–º—É. –¶—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏:

`p`: –ø–∞—Ä–∞–º–µ—Ç—Ä, –ø–æ–≤'—è–∑–∞–Ω–∏–π –∑ –∞–≤—Ç–æ–∫–æ—Ä–µ–ª—è—Ü—ñ–π–Ω–æ—é —Å–∫–ª–∞–¥–æ–≤–æ—é –º–æ–¥–µ–ª—ñ, —è–∫–∞ –≤—Ä–∞—Ö–æ–≤—É—î *–ø–æ–ø–µ—Ä–µ–¥–Ω—ñ* –∑–Ω–∞—á–µ–Ω–Ω—è.
`d`: –ø–∞—Ä–∞–º–µ—Ç—Ä, –ø–æ–≤'—è–∑–∞–Ω–∏–π –∑ —ñ–Ω—Ç–µ–≥—Ä–æ–≤–∞–Ω–æ—é —á–∞—Å—Ç–∏–Ω–æ—é –º–æ–¥–µ–ª—ñ, —è–∫–∏–π –≤–ø–ª–∏–≤–∞—î –Ω–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å *–¥–∏—Ñ–µ—Ä–µ–Ω—Ü—ñ—é–≤–∞–Ω—å* (üéì –ø–∞–º'—è—Ç–∞—î—Ç–µ –¥–∏—Ñ–µ—Ä–µ–Ω—Ü—ñ—é–≤–∞–Ω–Ω—è üëÜ?) –¥–ª—è –∑–∞—Å—Ç–æ—Å—É–≤–∞–Ω–Ω—è –¥–æ —á–∞—Å–æ–≤–∏—Ö —Ä—è–¥—ñ–≤.
`q`: –ø–∞—Ä–∞–º–µ—Ç—Ä, –ø–æ–≤'—è–∑–∞–Ω–∏–π —ñ–∑ —Å–∫–ª–∞–¥–æ–≤–æ—é –∑–º—ñ–Ω–Ω–æ–≥–æ —Å–µ—Ä–µ–¥–Ω—å–æ–≥–æ –º–æ–¥–µ–ª—ñ.

> –ü—Ä–∏–º—ñ—Ç–∫–∞: –Ø–∫—â–æ –≤–∞—à—ñ –¥–∞–Ω—ñ –º–∞—é—Ç—å —Å–µ–∑–æ–Ω–Ω–∏–π –∞—Å–ø–µ–∫—Ç - —è–∫ —É —Ü—å–æ–º—É –≤–∏–ø–∞–¥–∫—É - , –º–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ —Å–µ–∑–æ–Ω–Ω—É –º–æ–¥–µ–ª—å ARIMA (SARIMA). –£ —Ü—å–æ–º—É –≤–∏–ø–∞–¥–∫—É –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —ñ–Ω—à–∏–π –Ω–∞–±—ñ—Ä –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤: `P`, `D` —ñ `Q`, —è–∫—ñ –æ–ø–∏—Å—É—é—Ç—å —Ç—ñ –∂ –∞—Å–æ—Ü—ñ–∞—Ü—ñ—ó, —â–æ –π `p`, `d` —ñ `q`, –∞–ª–µ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—é—Ç—å —Å–µ–∑–æ–Ω–Ω–∏–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º –º–æ–¥–µ–ª—ñ.

1. –ü–æ—á–Ω—ñ—Ç—å —ñ–∑ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –±–∞–∂–∞–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–Ω—è –≥–æ—Ä–∏–∑–æ–Ω—Ç—É. –°–ø—Ä–æ–±—É—î–º–æ 3 –≥–æ–¥–∏–Ω–∏:

    ```python
    # Specify the number of steps to forecast ahead
    HORIZON = 3
    print('Forecasting horizon:', HORIZON, 'hours')
    ```

    –í–∏–±—ñ—Ä –Ω–∞–π–∫—Ä–∞—â–∏—Ö –∑–Ω–∞—á–µ–Ω—å –¥–ª—è –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ –º–æ–¥–µ–ª—ñ ARIMA –º–æ–∂–µ –±—É—Ç–∏ —Å–∫–ª–∞–¥–Ω–∏–º, –æ—Å–∫—ñ–ª—å–∫–∏ —Ü–µ –¥–µ—â–æ —Å—É–±'—î–∫—Ç–∏–≤–Ω–æ —ñ –ø–æ—Ç—Ä–µ–±—É—î —á–∞—Å—É. –í–∏ –º–æ–∂–µ—Ç–µ —Ä–æ–∑–≥–ª—è–Ω—É—Ç–∏ –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Ñ—É–Ω–∫—Ü—ñ—ó `auto_arima()` –∑ –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∏ [`pyramid`](https://alkaline-ml.com/pmdarima/0.9.0/modules/generated/pyramid.arima.auto_arima.html).

1. –ü–æ–∫–∏ —â–æ —Å–ø—Ä–æ–±—É–π—Ç–µ –∫—ñ–ª—å–∫–∞ —Ä—É—á–Ω–∏—Ö –≤–∞—Ä—ñ–∞–Ω—Ç—ñ–≤, —â–æ–± –∑–Ω–∞–π—Ç–∏ —Ö–æ—Ä–æ—à—É –º–æ–¥–µ–ª—å.

    ```python
    order = (4, 1, 0)
    seasonal_order = (1, 1, 0, 24)

    model = SARIMAX(endog=train, order=order, seasonal_order=seasonal_order)
    results = model.fit()

    print(results.summary())
    ```

    –í–∏–≤–æ–¥–∏—Ç—å—Å—è —Ç–∞–±–ª–∏—Ü—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤.

–í–∏ —Å—Ç–≤–æ—Ä–∏–ª–∏ —Å–≤–æ—é –ø–µ—Ä—à—É –º–æ–¥–µ–ª—å! –¢–µ–ø–µ—Ä –Ω–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑–Ω–∞–π—Ç–∏ —Å–ø–æ—Å—ñ–± —ó—ó –æ—Ü—ñ–Ω–∏—Ç–∏.

### –û—Ü—ñ–Ω–∫–∞ –≤–∞—à–æ—ó –º–æ–¥–µ–ª—ñ

–©–æ–± –æ—Ü—ñ–Ω–∏—Ç–∏ –≤–∞—à—É –º–æ–¥–µ–ª—å, –≤–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ–Ω–∞—Ç–∏ —Ç–∞–∫ –∑–≤–∞–Ω—É –≤–∞–ª—ñ–¥–∞—Ü—ñ—é `walk forward`. –ù–∞ –ø—Ä–∞–∫—Ç–∏—Ü—ñ –º–æ–¥–µ–ª—ñ —á–∞—Å–æ–≤–∏—Ö —Ä—è–¥—ñ–≤ –ø–µ—Ä–µ–Ω–∞–≤—á–∞—é—Ç—å—Å—è –∫–æ–∂–Ω–æ–≥–æ —Ä–∞–∑—É, –∫–æ–ª–∏ —Å—Ç–∞—é—Ç—å –¥–æ—Å—Ç—É–ø–Ω–∏–º–∏ –Ω–æ–≤—ñ –¥–∞–Ω—ñ. –¶–µ –¥–æ–∑–≤–æ–ª—è—î –º–æ–¥–µ–ª—ñ —Ä–æ–±–∏—Ç–∏ –Ω–∞–π–∫—Ä–∞—â–∏–π –ø—Ä–æ–≥–Ω–æ–∑ –Ω–∞ –∫–æ–∂–Ω–æ–º—É –∫—Ä–æ—Ü—ñ —á–∞—Å—É.

–ü–æ—á–∏–Ω–∞—é—á–∏ –∑ –ø–æ—á–∞—Ç–∫—É —á–∞—Å–æ–≤–∏—Ö —Ä—è–¥—ñ–≤, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ —Ü—é —Ç–µ—Ö–Ω—ñ–∫—É, –Ω–∞–≤—á—ñ—Ç—å –º–æ–¥–µ–ª—å –Ω–∞ –Ω–∞–≤—á–∞–ª—å–Ω–æ–º—É –Ω–∞–±–æ—Ä—ñ –¥–∞–Ω–∏—Ö. –ü–æ—Ç—ñ–º –∑—Ä–æ–±—ñ—Ç—å –ø—Ä–æ–≥–Ω–æ–∑ –Ω–∞ –Ω–∞—Å—Ç—É–ø–Ω–∏–π –∫—Ä–æ–∫ —á–∞—Å—É. –ü—Ä–æ–≥–Ω–æ–∑ –æ—Ü—ñ–Ω—é—î—Ç—å—Å—è –ø–æ—Ä—ñ–≤–Ω—è–Ω–æ –∑ –≤—ñ–¥–æ–º–∏–º –∑–Ω–∞—á–µ–Ω–Ω—è–º. –ù–∞–≤—á–∞–ª—å–Ω–∏–π –Ω–∞–±—ñ—Ä –ø–æ—Ç—ñ–º —Ä–æ–∑—à–∏—Ä—é—î—Ç—å—Å—è, —â–æ–± –≤–∫–ª—é—á–∏—Ç–∏ –≤—ñ–¥–æ–º–µ –∑–Ω–∞—á–µ–Ω–Ω—è, —ñ –ø—Ä–æ—Ü–µ—Å –ø–æ–≤—Ç–æ—Ä—é—î—Ç—å—Å—è.

> –ü—Ä–∏–º—ñ—Ç–∫–∞: –í–∏ –ø–æ–≤–∏–Ω–Ω—ñ –∑–±–µ—Ä—ñ–≥–∞—Ç–∏ —Ñ—ñ–∫—Å–æ–≤–∞–Ω–µ –≤—ñ–∫–Ω–æ –Ω–∞–≤—á–∞–ª—å–Ω–æ–≥–æ –Ω–∞–±–æ—Ä—É –¥–ª—è –±—ñ–ª—å—à –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥–æ –Ω–∞–≤—á–∞–Ω–Ω—è, —â–æ–± –∫–æ–∂–Ω–æ–≥–æ —Ä–∞–∑—É, –∫–æ–ª–∏ –≤–∏ –¥–æ–¥–∞—î—Ç–µ –Ω–æ–≤–µ —Å–ø–æ—Å—Ç–µ—Ä–µ–∂–µ–Ω–Ω—è –¥–æ –Ω–∞–≤—á–∞–ª—å–Ω–æ–≥–æ –Ω–∞–±–æ—Ä—É, –≤–∏ –≤–∏–¥–∞–ª—è–ª–∏ —Å–ø–æ—Å—Ç–µ—Ä–µ–∂–µ–Ω–Ω—è –∑ –ø–æ—á–∞—Ç–∫—É –Ω–∞–±–æ—Ä—É.

–¶–µ–π –ø—Ä–æ—Ü–µ—Å –∑–∞–±–µ–∑–ø–µ—á—É—î –±—ñ–ª—å—à –Ω–∞–¥—ñ–π–Ω—É –æ—Ü—ñ–Ω–∫—É —Ç–æ–≥–æ, —è–∫ –º–æ–¥–µ–ª—å –±—É–¥–µ –ø—Ä–∞—Ü—é–≤–∞—Ç–∏ –Ω–∞ –ø—Ä–∞–∫—Ç–∏—Ü—ñ. –û–¥–Ω–∞–∫ —Ü–µ –º–∞—î –æ–±—á–∏—Å–ª—é–≤–∞–ª—å–Ω—É –≤–∞—Ä—Ç—ñ—Å—Ç—å —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–∞–∫–æ—ó –∫—ñ–ª—å–∫–æ—Å—Ç—ñ –º–æ–¥–µ–ª–µ–π. –¶–µ –ø—Ä–∏–π–Ω—è—Ç–Ω–æ, —è–∫—â–æ –¥–∞–Ω—ñ –Ω–µ–≤–µ–ª–∏–∫—ñ –∞–±–æ –º–æ–¥–µ–ª—å –ø—Ä–æ—Å—Ç–∞, –∞–ª–µ –º–æ–∂–µ –±—É—Ç–∏ –ø—Ä–æ–±–ª–µ–º–æ—é –≤ –º–∞—Å—à—Ç–∞–±—ñ.

–í–∞–ª—ñ–¥–∞—Ü—ñ—è `walk forward` —î –∑–æ–ª–æ—Ç–∏–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–æ–º –æ—Ü—ñ–Ω–∫–∏ –º–æ–¥–µ–ª–µ–π —á–∞—Å–æ–≤–∏—Ö —Ä—è–¥—ñ–≤ —ñ —Ä–µ–∫–æ–º–µ–Ω–¥—É—î—Ç—å—Å—è –¥–ª—è –≤–∞—à–∏—Ö –≤–ª–∞—Å–Ω–∏—Ö –ø—Ä–æ—î–∫—Ç—ñ–≤.

1. –°–ø–æ—á–∞—Ç–∫—É —Å—Ç–≤–æ—Ä—ñ—Ç—å —Ç–µ—Å—Ç–æ–≤—É —Ç–æ—á–∫—É –¥–∞–Ω–∏—Ö –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ –∫—Ä–æ–∫—É HORIZON.

    ```python
    test_shifted = test.copy()

    for t in range(1, HORIZON+1):
        test_shifted['load+'+str(t)] = test_shifted['load'].shift(-t, freq='H')

    test_shifted = test_shifted.dropna(how='any')
    test_shifted.head(5)
    ```

    |            |          | load | load+1 | load+2 |
    | ---------- | -------- | ---- | ------ | ------ |
    | 2014-12-30 | 00:00:00 | 0.33 | 0.29   | 0.27   |
    | 2014-12-30 | 01:00:00 | 0.29 | 0.27   | 0.27   |
    | 2014-12-30 | 02:00:00 | 0.27 | 0.27   | 0.30   |
    | 2014-12-30 | 03:00:00 | 0.27 | 0.30   | 0.41   |
    | 2014-12-30 | 04:00:00 | 0.30 | 0.41   | 0.57   |

    –î–∞–Ω—ñ –∑–º—ñ—â—É—é—Ç—å—Å—è –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ –¥–æ —ó—Ö–Ω—å–æ—ó —Ç–æ—á–∫–∏ –≥–æ—Ä–∏–∑–æ–Ω—Ç—É.

1. –ó—Ä–æ–±—ñ—Ç—å –ø—Ä–æ–≥–Ω–æ–∑–∏ –¥–ª—è –≤–∞—à–∏—Ö —Ç–µ—Å—Ç–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ —Ü–µ–π –ø—ñ–¥—Ö—ñ–¥ –∫–æ–≤–∑–Ω–æ–≥–æ –≤—ñ–∫–Ω–∞ –≤ —Ü–∏–∫–ª—ñ —Ä–æ–∑–º—ñ—Ä–æ–º –¥–æ–≤–∂–∏–Ω–∏ —Ç–µ—Å—Ç–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö:

    ```python
    %%time
    training_window = 720 # dedicate 30 days (720 hours) for training

    train_ts = train['load']
    test_ts = test_shifted

    history = [x for x in train_ts]
    history = history[(-training_window):]

    predictions = list()

    order = (2, 1, 0)
    seasonal_order = (1, 1, 0, 24)

    for t in range(test_ts.shape[0]):
        model = SARIMAX(endog=history, order=order, seasonal_order=seasonal_order)
        model_fit = model.fit()
        yhat = model_fit.forecast(steps = HORIZON)
        predictions.append(yhat)
        obs = list(test_ts.iloc[t])
        # move the training window
        history.append(obs[0])
        history.pop(0)
        print(test_ts.index[t])
        print(t+1, ': predicted =', yhat, 'expected =', obs)
    ```

    –í–∏ –º–æ–∂–µ—Ç–µ —Å–ø–æ—Å—Ç–µ—Ä—ñ–≥–∞—Ç–∏ –∑–∞ –ø—Ä–æ—Ü–µ—Å–æ–º –Ω–∞–≤—á–∞–Ω–Ω—è:

    ```output
    2014-12-30 00:00:00
    1 : predicted = [0.32 0.29 0.28] expected = [0.32945389435989236, 0.2900626678603402, 0.2739480752014323]

    2014-12-30 01:00:00
    2 : predicted = [0.3  0.29 0.3 ] expected = [0.2900626678603402, 0.2739480752014323, 0.26812891674127126]

    2014-12-30 02:00:00
    3 : predicted = [0.27 0.28 0.32] expected = [0.2739480752014323, 0.26812891674127126, 0.3025962399283795]
    ```

1. –ü–æ—Ä—ñ–≤–Ω—è–π—Ç–µ –ø—Ä–æ–≥–Ω–æ–∑–∏ –∑ —Ñ–∞–∫—Ç–∏—á–Ω–∏–º –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è–º:

    ```python
    eval_df = pd.DataFrame(predictions, columns=['t+'+str(t) for t in range(1, HORIZON+1)])
    eval_df['timestamp'] = test.index[0:len(test.index)-HORIZON+1]
    eval_df = pd.melt(eval_df, id_vars='timestamp', value_name='prediction', var_name='h')
    eval_df['actual'] = np.array(np.transpose(test_ts)).ravel()
    eval_df[['prediction', 'actual']] = scaler.inverse_transform(eval_df[['prediction', 'actual']])
    eval_df.head()
    ```

    –í–∏–≤—ñ–¥
    |     |            | timestamp | h   | prediction | actual   |
    | --- | ---------- | --------- | --- | ---------- | -------- |
    | 0   | 2014-12-30 | 00:00:00  | t+1 | 3,008.74   | 3,023.00 |
    | 1   | 2014-12-30 | 01:00:00  | t+1 | 2,955.53   | 2,935.00 |
    | 2   | 2014-12-30 | 02:00:00  | t+1 | 2,900.17   | 2,899.00 |
    | 3   | 2014-12-30 | 03:00:00  | t+1 | 2,917.69   | 2,886.00 |
    | 4   | 2014-12-30 | 04:00:00  | t+1 | 2,946.99   | 2,963.00 |

    –°–ø–æ—Å—Ç–µ—Ä—ñ–≥–∞–π—Ç–µ –∑–∞ –ø—Ä–æ–≥–Ω–æ–∑–æ–º –¥–∞–Ω–∏—Ö –∑–∞ –≥–æ–¥–∏–Ω—É, –ø–æ—Ä—ñ–≤–Ω—è–Ω–æ –∑ —Ñ–∞–∫—Ç–∏—á–Ω–∏–º –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è–º. –ù–∞—Å–∫—ñ–ª—å–∫–∏ —Ü–µ —Ç–æ—á–Ω–æ?

### –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ç–æ—á–Ω–æ—Å—Ç—ñ –º–æ–¥–µ–ª—ñ

–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Ç–æ—á–Ω—ñ—Å—Ç—å –≤–∞—à–æ—ó –º–æ–¥–µ–ª—ñ, –ø—Ä–æ—Ç–µ—Å—Ç—É–≤–∞–≤—à–∏ —ó—ó —Å–µ—Ä–µ–¥–Ω—é –∞–±—Å–æ–ª—é—Ç–Ω—É –ø—Ä–æ—Ü–µ–Ω—Ç–Ω—É –ø–æ–º–∏–ª–∫—É (MAPE) –¥–ª—è –≤—Å—ñ—Ö –ø—Ä–æ–≥–Ω–æ–∑—ñ–≤.
> **üßÆ –ü–æ–∫–∞–∂—ñ—Ç—å –º–µ–Ω—ñ –º–∞—Ç–µ–º–∞—Ç–∏–∫—É**
>
> ![MAPE](../../../../7-TimeSeries/2-ARIMA/images/mape.png)
>
> [MAPE](https://www.linkedin.com/pulse/what-mape-mad-msd-time-series-allameh-statistics/) –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü—ñ—ó —Ç–æ—á–Ω–æ—Å—Ç—ñ –ø—Ä–æ–≥–Ω–æ–∑—É —è–∫ —Å–ø—ñ–≤–≤—ñ–¥–Ω–æ—à–µ–Ω–Ω—è, –≤–∏–∑–Ω–∞—á–µ–Ω–æ–≥–æ –∑–∞ —Ñ–æ—Ä–º—É–ª–æ—é –≤–∏—â–µ. –†—ñ–∑–Ω–∏—Ü—è –º—ñ–∂ —Ñ–∞–∫—Ç–∏—á–Ω–∏–º —ñ –ø—Ä–æ–≥–Ω–æ–∑–æ–≤–∞–Ω–∏–º –∑–Ω–∞—á–µ–Ω–Ω—è–º –¥—ñ–ª–∏—Ç—å—Å—è –Ω–∞ —Ñ–∞–∫—Ç–∏—á–Ω–µ.
>
> "–ê–±—Å–æ–ª—é—Ç–Ω–µ –∑–Ω–∞—á–µ–Ω–Ω—è –≤ —Ü—å–æ–º—É —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—É –ø—ñ–¥—Å—É–º–æ–≤—É—î—Ç—å—Å—è –¥–ª—è –∫–æ–∂–Ω–æ—ó –ø—Ä–æ–≥–Ω–æ–∑–æ–≤–∞–Ω–æ—ó —Ç–æ—á–∫–∏ –≤ —á–∞—Å—ñ —ñ –¥—ñ–ª–∏—Ç—å—Å—è –Ω–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å —Ç–æ—á–æ–∫ n." [wikipedia](https://wikipedia.org/wiki/Mean_absolute_percentage_error)
1. –í–∏—Ä–∞–∑—ñ—Ç—å —Ä—ñ–≤–Ω—è–Ω–Ω—è —É –∫–æ–¥—ñ:

    ```python
    if(HORIZON > 1):
        eval_df['APE'] = (eval_df['prediction'] - eval_df['actual']).abs() / eval_df['actual']
        print(eval_df.groupby('h')['APE'].mean())
    ```

1. –†–æ–∑—Ä–∞—Ö—É–π—Ç–µ MAPE –¥–ª—è –æ–¥–Ω–æ–≥–æ –∫—Ä–æ–∫—É:

    ```python
    print('One step forecast MAPE: ', (mape(eval_df[eval_df['h'] == 't+1']['prediction'], eval_df[eval_df['h'] == 't+1']['actual']))*100, '%')
    ```

    MAPE –ø—Ä–æ–≥–Ω–æ–∑—É –Ω–∞ –æ–¥–∏–Ω –∫—Ä–æ–∫:  0.5570581332313952 %

1. –í–∏–≤–µ–¥—ñ—Ç—å MAPE –¥–ª—è –±–∞–≥–∞—Ç–æ–∫—Ä–æ–∫–æ–≤–æ–≥–æ –ø—Ä–æ–≥–Ω–æ–∑—É:

    ```python
    print('Multi-step forecast MAPE: ', mape(eval_df['prediction'], eval_df['actual'])*100, '%')
    ```

    ```output
    Multi-step forecast MAPE:  1.1460048657704118 %
    ```

    –ù–∞–π–∫—Ä–∞—â–µ, –∫–æ–ª–∏ —á–∏—Å–ª–æ –Ω–∏–∑—å–∫–µ: –≤—Ä–∞—Ö—É–π—Ç–µ, —â–æ –ø—Ä–æ–≥–Ω–æ–∑ —ñ–∑ MAPE 10 –º–∞—î –ø–æ—Ö–∏–±–∫—É –≤ 10%.

1. –ê–ª–µ, —è–∫ –∑–∞–≤–∂–¥–∏, –ª–µ–≥—à–µ –æ—Ü—ñ–Ω–∏—Ç–∏ —Ç–æ—á–Ω—ñ—Å—Ç—å –≤—ñ–∑—É–∞–ª—å–Ω–æ, —Ç–æ–º—É –¥–∞–≤–∞–π—Ç–µ –ø–æ–±—É–¥—É—î–º–æ –≥—Ä–∞—Ñ—ñ–∫:

    ```python
     if(HORIZON == 1):
        ## Plotting single step forecast
        eval_df.plot(x='timestamp', y=['actual', 'prediction'], style=['r', 'b'], figsize=(15, 8))

    else:
        ## Plotting multi step forecast
        plot_df = eval_df[(eval_df.h=='t+1')][['timestamp', 'actual']]
        for t in range(1, HORIZON+1):
            plot_df['t+'+str(t)] = eval_df[(eval_df.h=='t+'+str(t))]['prediction'].values

        fig = plt.figure(figsize=(15, 8))
        ax = plt.plot(plot_df['timestamp'], plot_df['actual'], color='red', linewidth=4.0)
        ax = fig.add_subplot(111)
        for t in range(1, HORIZON+1):
            x = plot_df['timestamp'][(t-1):]
            y = plot_df['t+'+str(t)][0:len(x)]
            ax.plot(x, y, color='blue', linewidth=4*math.pow(.9,t), alpha=math.pow(0.8,t))

        ax.legend(loc='best')

    plt.xlabel('timestamp', fontsize=12)
    plt.ylabel('load', fontsize=12)
    plt.show()
    ```

    ![–º–æ–¥–µ–ª—å —á–∞—Å–æ–≤–∏—Ö —Ä—è–¥—ñ–≤](../../../../7-TimeSeries/2-ARIMA/images/accuracy.png)

üèÜ –î—É–∂–µ –≥–∞—Ä–Ω–∏–π –≥—Ä–∞—Ñ—ñ–∫, —è–∫–∏–π –¥–µ–º–æ–Ω—Å—Ç—Ä—É—î –º–æ–¥–µ–ª—å –∑ —Ö–æ—Ä–æ—à–æ—é —Ç–æ—á–Ω—ñ—Å—Ç—é. –ß—É–¥–æ–≤–∞ —Ä–æ–±–æ—Ç–∞!

---

## üöÄ–í–∏–∫–ª–∏–∫

–î–æ—Å–ª—ñ–¥–∂—É–π—Ç–µ —Å–ø–æ—Å–æ–±–∏ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ —Ç–æ—á–Ω–æ—Å—Ç—ñ –º–æ–¥–µ–ª—ñ —á–∞—Å–æ–≤–∏—Ö —Ä—è–¥—ñ–≤. –£ —Ü—å–æ–º—É —É—Ä–æ—Ü—ñ –º–∏ —Ç–æ—Ä–∫–∞—î–º–æ—Å—è MAPE, –∞–ª–µ —á–∏ —î —ñ–Ω—à—ñ –º–µ—Ç–æ–¥–∏, —è–∫—ñ –≤–∏ –º–æ–≥–ª–∏ –± –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏? –î–æ—Å–ª—ñ–¥—ñ—Ç—å —ó—Ö —ñ –¥–æ–¥–∞–π—Ç–µ –∫–æ–º–µ–Ω—Ç–∞—Ä—ñ. –ö–æ—Ä–∏—Å–Ω–∏–π –¥–æ–∫—É–º–µ–Ω—Ç –º–æ–∂–Ω–∞ –∑–Ω–∞–π—Ç–∏ [—Ç—É—Ç](https://otexts.com/fpp2/accuracy.html)

## [–¢–µ—Å—Ç –ø—ñ—Å–ª—è –ª–µ–∫—Ü—ñ—ó](https://ff-quizzes.netlify.app/en/ml/)

## –û–≥–ª—è–¥ —ñ —Å–∞–º–æ—Å—Ç—ñ–π–Ω–µ –Ω–∞–≤—á–∞–Ω–Ω—è

–£ —Ü—å–æ–º—É —É—Ä–æ—Ü—ñ –º–∏ —Ä–æ–∑–≥–ª—è–¥–∞—î–º–æ –ª–∏—à–µ –æ—Å–Ω–æ–≤–∏ –ø—Ä–æ–≥–Ω–æ–∑—É–≤–∞–Ω–Ω—è —á–∞—Å–æ–≤–∏—Ö —Ä—è–¥—ñ–≤ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é ARIMA. –ü—Ä–∏–¥—ñ–ª—ñ—Ç—å —á–∞—Å –¥–ª—è –ø–æ–≥–ª–∏–±–ª–µ–Ω–Ω—è –∑–Ω–∞–Ω—å, –¥–æ—Å–ª—ñ–¥–∏–≤—à–∏ [—Ü–µ–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π](https://microsoft.github.io/forecasting/) —ñ –π–æ–≥–æ —Ä—ñ–∑–Ω—ñ —Ç–∏–ø–∏ –º–æ–¥–µ–ª–µ–π, —â–æ–± –¥—ñ–∑–Ω–∞—Ç–∏—Å—è —ñ–Ω—à—ñ —Å–ø–æ—Å–æ–±–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –º–æ–¥–µ–ª–µ–π —á–∞—Å–æ–≤–∏—Ö —Ä—è–¥—ñ–≤.

## –ó–∞–≤–¥–∞–Ω–Ω—è

[–ù–æ–≤–∞ –º–æ–¥–µ–ª—å ARIMA](assignment.md)

---

**–í—ñ–¥–º–æ–≤–∞ –≤—ñ–¥ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞–ª—å–Ω–æ—Å—Ç—ñ**:  
–¶–µ–π –¥–æ–∫—É–º–µ–Ω—Ç –±—É–ª–æ –ø–µ—Ä–µ–∫–ª–∞–¥–µ–Ω–æ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Å–µ—Ä–≤—ñ—Å—É –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ–≥–æ –ø–µ—Ä–µ–∫–ª–∞–¥—É [Co-op Translator](https://github.com/Azure/co-op-translator). –•–æ—á–∞ –º–∏ –ø—Ä–∞–≥–Ω–µ–º–æ –¥–æ —Ç–æ—á–Ω–æ—Å—Ç—ñ, –∑–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω—ñ –ø–µ—Ä–µ–∫–ª–∞–¥–∏ –º–æ–∂—É—Ç—å –º—ñ—Å—Ç–∏—Ç–∏ –ø–æ–º–∏–ª–∫–∏ –∞–±–æ –Ω–µ—Ç–æ—á–Ω–æ—Å—Ç—ñ. –û—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–∏–π –¥–æ–∫—É–º–µ–Ω—Ç –º–æ–≤–æ—é –æ—Ä–∏–≥—ñ–Ω–∞–ª—É —Å–ª—ñ–¥ –≤–≤–∞–∂–∞—Ç–∏ –∞–≤—Ç–æ—Ä–∏—Ç–µ—Ç–Ω–∏–º –¥–∂–µ—Ä–µ–ª–æ–º. –î–ª—è –∫—Ä–∏—Ç–∏—á–Ω–æ –≤–∞–∂–ª–∏–≤–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó —Ä–µ–∫–æ–º–µ–Ω–¥—É—î—Ç—å—Å—è –ø—Ä–æ—Ñ–µ—Å—ñ–π–Ω–∏–π –ø–µ—Ä–µ–∫–ª–∞–¥ –ª—é–¥–∏–Ω–æ—é. –ú–∏ –Ω–µ –Ω–µ—Å–µ–º–æ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞–ª—å–Ω–æ—Å—Ç—ñ –∑–∞ –±—É–¥—å-—è–∫—ñ –Ω–µ–ø–æ—Ä–æ–∑—É–º—ñ–Ω–Ω—è –∞–±–æ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ñ —Ç–ª—É–º–∞—á–µ–Ω–Ω—è, —â–æ –≤–∏–Ω–∏–∫–ª–∏ –≤–Ω–∞—Å–ª—ñ–¥–æ–∫ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Ü—å–æ–≥–æ –ø–µ—Ä–µ–∫–ª–∞–¥—É.