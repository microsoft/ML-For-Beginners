<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "911efd5e595089000cb3c16fce1beab8",
  "translation_date": "2025-09-05T10:29:57+00:00",
  "source_file": "8-Reinforcement/1-QLearning/README.md",
  "language_code": "hi"
}
-->
# рдкрд░рд┐рдЪрдп: рд░рд┐рдЗрдВрдлреЛрд░реНрд╕рдореЗрдВрдЯ рд▓рд░реНрдирд┐рдВрдЧ рдФрд░ Q-рд▓рд░реНрдирд┐рдВрдЧ

![рдорд╢реАрди рд▓рд░реНрдирд┐рдВрдЧ рдореЗрдВ рд░рд┐рдЗрдВрдлреЛрд░реНрд╕рдореЗрдВрдЯ рдХрд╛ рд╕рд╛рд░рд╛рдВрд╢ рдПрдХ рд╕реНрдХреЗрдЪ рдиреЛрдЯ рдореЗрдВ](../../../../sketchnotes/ml-reinforcement.png)
> рд╕реНрдХреЗрдЪ рдиреЛрдЯ: [Tomomi Imura](https://www.twitter.com/girlie_mac)

рд░рд┐рдЗрдВрдлреЛрд░реНрд╕рдореЗрдВрдЯ рд▓рд░реНрдирд┐рдВрдЧ рддреАрди рдорд╣рддреНрд╡рдкреВрд░реНрдг рдЕрд╡рдзрд╛рд░рдгрд╛рдУрдВ рдкрд░ рдЖрдзрд╛рд░рд┐рдд рд╣реИ: рдПрдЬреЗрдВрдЯ, рдХреБрдЫ рд╕реНрдЯреЗрдЯреНрд╕, рдФрд░ рдкреНрд░рддреНрдпреЗрдХ рд╕реНрдЯреЗрдЯ рдХреЗ рд▓рд┐рдП рдПрдХреНрд╢рди рдХрд╛ рд╕реЗрдЯред рдХрд┐рд╕реА рдирд┐рд░реНрджрд┐рд╖реНрдЯ рд╕реНрдЯреЗрдЯ рдореЗрдВ рдПрдХреНрд╢рди рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдХреЗ, рдПрдЬреЗрдВрдЯ рдХреЛ рдПрдХ рдЗрдирд╛рдо рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдлрд┐рд░ рд╕реЗ рд╕реБрдкрд░ рдорд╛рд░рд┐рдпреЛ рдЧреЗрдо рдХреА рдХрд▓реНрдкрдирд╛ рдХрд░реЗрдВред рдЖрдк рдорд╛рд░рд┐рдпреЛ рд╣реИрдВ, рдЖрдк рдПрдХ рдЧреЗрдо рд▓реЗрд╡рд▓ рдореЗрдВ рд╣реИрдВ, рдФрд░ рдПрдХ рдЪрдЯреНрдЯрд╛рди рдХреЗ рдХрд┐рдирд╛рд░реЗ рдкрд░ рдЦрдбрд╝реЗ рд╣реИрдВред рдЖрдкрдХреЗ рдКрдкрд░ рдПрдХ рд╕рд┐рдХреНрдХрд╛ рд╣реИред рдЖрдк рдорд╛рд░рд┐рдпреЛ рд╣реИрдВ, рдПрдХ рдЧреЗрдо рд▓реЗрд╡рд▓ рдореЗрдВ, рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ рд╕реНрдерд┐рддрд┐ рдореЗрдВ ... рдпрд╣реА рдЖрдкрдХрд╛ рд╕реНрдЯреЗрдЯ рд╣реИред рджрд╛рдИрдВ рдУрд░ рдПрдХ рдХрджрдо рдмрдврд╝рд╛рдирд╛ (рдПрдХреНрд╢рди) рдЖрдкрдХреЛ рдХрд┐рдирд╛рд░реЗ рд╕реЗ рдиреАрдЪреЗ рдЧрд┐рд░рд╛ рджреЗрдЧрд╛, рдФрд░ рдпрд╣ рдЖрдкрдХреЛ рдХрдо рдЕрдВрдХ рджреЗрдЧрд╛ред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдЬрдВрдк рдмрдЯрди рджрдмрд╛рдиреЗ рд╕реЗ рдЖрдк рдПрдХ рдкреЙрдЗрдВрдЯ рд╕реНрдХреЛрд░ рдХрд░реЗрдВрдЧреЗ рдФрд░ рдЬреАрд╡рд┐рдд рд░рд╣реЗрдВрдЧреЗред рдпрд╣ рдПрдХ рд╕рдХрд╛рд░рд╛рддреНрдордХ рдкрд░рд┐рдгрд╛рдо рд╣реИ рдФрд░ рдЖрдкрдХреЛ рдПрдХ рд╕рдХрд╛рд░рд╛рддреНрдордХ рдЕрдВрдХ рдкреНрд░рджрд╛рди рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдПред

рд░рд┐рдЗрдВрдлреЛрд░реНрд╕рдореЗрдВрдЯ рд▓рд░реНрдирд┐рдВрдЧ рдФрд░ рдПрдХ рд╕рд┐рдореНрдпреБрд▓реЗрдЯрд░ (рдЧреЗрдо) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ, рдЖрдк рдЧреЗрдо рдЦреЗрд▓рдиреЗ рдХрд╛ рддрд░реАрдХрд╛ рд╕реАрдЦ рд╕рдХрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рдЖрдк рдЬреАрд╡рд┐рдд рд░рд╣ рд╕рдХреЗрдВ рдФрд░ рдЕрдзрд┐рдХрддрдо рдкреЙрдЗрдВрдЯреНрд╕ рд╕реНрдХреЛрд░ рдХрд░ рд╕рдХреЗрдВред

[![рд░рд┐рдЗрдВрдлреЛрд░реНрд╕рдореЗрдВрдЯ рд▓рд░реНрдирд┐рдВрдЧ рдХрд╛ рдкрд░рд┐рдЪрдп](https://img.youtube.com/vi/lDq_en8RNOo/0.jpg)](https://www.youtube.com/watch?v=lDq_en8RNOo)

> ЁЯОе рдКрдкрд░ рджреА рдЧрдИ рдЫрд╡рд┐ рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВ рдФрд░ Dmitry рд╕реЗ рд░рд┐рдЗрдВрдлреЛрд░реНрд╕рдореЗрдВрдЯ рд▓рд░реНрдирд┐рдВрдЧ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╕реБрдиреЗрдВ

## [рдкреНрд░реА-рд▓реЗрдХреНрдЪрд░ рдХреНрд╡рд┐рдЬрд╝](https://ff-quizzes.netlify.app/en/ml/)

## рдЖрд╡рд╢реНрдпрдХрддрд╛рдПрдБ рдФрд░ рд╕реЗрдЯрдЕрдк

рдЗрд╕ рдкрд╛рда рдореЗрдВ, рд╣рдо Python рдореЗрдВ рдХреБрдЫ рдХреЛрдб рдХреЗ рд╕рд╛рде рдкреНрд░рдпреЛрдЧ рдХрд░реЗрдВрдЧреЗред рдЖрдкрдХреЛ рдЗрд╕ рдкрд╛рда рдХреЗ Jupyter Notebook рдХреЛрдб рдХреЛ рдЕрдкрдиреЗ рдХрдВрдкреНрдпреВрдЯрд░ рдкрд░ рдпрд╛ рдХреНрд▓рд╛рдЙрдб рдореЗрдВ рдХрд╣реАрдВ рднреА рдЪрд▓рд╛рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред

рдЖрдк [рдкрд╛рда рдиреЛрдЯрдмреБрдХ](https://github.com/microsoft/ML-For-Beginners/blob/main/8-Reinforcement/1-QLearning/notebook.ipynb) рдЦреЛрд▓ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЗрд╕ рдкрд╛рда рдХреЛ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЗрд╕рдХрд╛ рдЕрдиреБрд╕рд░рдг рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

> **рдиреЛрдЯ:** рдпрджрд┐ рдЖрдк рдЗрд╕ рдХреЛрдб рдХреЛ рдХреНрд▓рд╛рдЙрдб рд╕реЗ рдЦреЛрд▓ рд░рд╣реЗ рд╣реИрдВ, рддреЛ рдЖрдкрдХреЛ [`rlboard.py`](https://github.com/microsoft/ML-For-Beginners/blob/main/8-Reinforcement/1-QLearning/rlboard.py) рдлрд╝рд╛рдЗрд▓ рднреА рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреА рд╣реЛрдЧреА, рдЬреЛ рдиреЛрдЯрдмреБрдХ рдХреЛрдб рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХреА рдЬрд╛рддреА рд╣реИред рдЗрд╕реЗ рдиреЛрдЯрдмреБрдХ рдХреЗ рд╕рдорд╛рди рдбрд╛рдпрд░реЗрдХреНрдЯрд░реА рдореЗрдВ рдЬреЛрдбрд╝реЗрдВред

## рдкрд░рд┐рдЪрдп

рдЗрд╕ рдкрд╛рда рдореЗрдВ, рд╣рдо **[Peter and the Wolf](https://en.wikipedia.org/wiki/Peter_and_the_Wolf)** рдХреА рджреБрдирд┐рдпрд╛ рдХрд╛ рдЕрдиреНрд╡реЗрд╖рдг рдХрд░реЗрдВрдЧреЗ, рдЬреЛ рдПрдХ рд░реВрд╕реА рд╕рдВрдЧреАрддрдХрд╛рд░ [Sergei Prokofiev](https://en.wikipedia.org/wiki/Sergei_Prokofiev) рдХреА рдПрдХ рд╕рдВрдЧреАрдд рдкрд░реА рдХрдерд╛ рд╕реЗ рдкреНрд░реЗрд░рд┐рдд рд╣реИред рд╣рдо **рд░рд┐рдЗрдВрдлреЛрд░реНрд╕рдореЗрдВрдЯ рд▓рд░реНрдирд┐рдВрдЧ** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗ рддрд╛рдХрд┐ рдкреАрдЯрд░ рдЕрдкрдиреЗ рд╡рд╛рддрд╛рд╡рд░рдг рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛ рд╕рдХреЗ, рд╕реНрд╡рд╛рджрд┐рд╖реНрдЯ рд╕реЗрдм рдЗрдХрдЯреНрдард╛ рдХрд░ рд╕рдХреЗ рдФрд░ рднреЗрдбрд╝рд┐рдпреЗ рд╕реЗ рдмрдЪ рд╕рдХреЗред

**рд░рд┐рдЗрдВрдлреЛрд░реНрд╕рдореЗрдВрдЯ рд▓рд░реНрдирд┐рдВрдЧ** (RL) рдПрдХ рд▓рд░реНрдирд┐рдВрдЧ рддрдХрдиреАрдХ рд╣реИ рдЬреЛ рд╣рдореЗрдВ рдХрдИ рдкреНрд░рдпреЛрдЧреЛрдВ рдХреЛ рдЪрд▓рд╛рдХрд░ рдХрд┐рд╕реА **рдПрдЬреЗрдВрдЯ** рдХреЗ **рд╡рд╛рддрд╛рд╡рд░рдг** рдореЗрдВ рдЗрд╖реНрдЯрддрдо рд╡реНрдпрд╡рд╣рд╛рд░ рд╕реАрдЦрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИред рдЗрд╕ рд╡рд╛рддрд╛рд╡рд░рдг рдореЗрдВ рдПрдХ рдПрдЬреЗрдВрдЯ рдХрд╛ рдХреБрдЫ **рд▓рдХреНрд╖реНрдп** рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП, рдЬрд┐рд╕реЗ рдПрдХ **рдЗрдирд╛рдо рдлрд╝рдВрдХреНрд╢рди** рджреНрд╡рд╛рд░рд╛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред

## рд╡рд╛рддрд╛рд╡рд░рдг

рд╕рд░рд▓рддрд╛ рдХреЗ рд▓рд┐рдП, рдЖрдЗрдП рдкреАрдЯрд░ рдХреА рджреБрдирд┐рдпрд╛ рдХреЛ `width` x `height` рдЖрдХрд╛рд░ рдХреЗ рдПрдХ рд╡рд░реНрдЧ рдмреЛрд░реНрдб рдХреЗ рд░реВрдк рдореЗрдВ рдорд╛рдиреЗрдВ, рдЬреИрд╕реЗ:

![рдкреАрдЯрд░ рдХрд╛ рд╡рд╛рддрд╛рд╡рд░рдг](../../../../8-Reinforcement/1-QLearning/images/environment.png)

рдЗрд╕ рдмреЛрд░реНрдб рдореЗрдВ рдкреНрд░рддреНрдпреЗрдХ рд╕реЗрд▓ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдореЗрдВ рд╕реЗ рдПрдХ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ:

* **рдЬрдореАрди**, рдЬрд┐рд╕ рдкрд░ рдкреАрдЯрд░ рдФрд░ рдЕрдиреНрдп рдЬреАрд╡ рдЪрд▓ рд╕рдХрддреЗ рд╣реИрдВред
* **рдкрд╛рдиреА**, рдЬрд┐рд╕ рдкрд░ рдЖрдк рд╕реНрдкрд╖реНрдЯ рд░реВрдк рд╕реЗ рдирд╣реАрдВ рдЪрд▓ рд╕рдХрддреЗред
* рдПрдХ **рдкреЗрдбрд╝** рдпрд╛ **рдШрд╛рд╕**, рдПрдХ рдЬрдЧрд╣ рдЬрд╣рд╛рдВ рдЖрдк рдЖрд░рд╛рдо рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
* рдПрдХ **рд╕реЗрдм**, рдЬрд┐рд╕реЗ рдкреАрдЯрд░ рдЦреБрд╢реА рд╕реЗ рдЦреЛрдЬреЗрдЧрд╛ рддрд╛рдХрд┐ рд╡рд╣ рдЦреБрдж рдХреЛ рдЦрд┐рд▓рд╛ рд╕рдХреЗред
* рдПрдХ **рднреЗрдбрд╝рд┐рдпрд╛**, рдЬреЛ рдЦрддрд░рдирд╛рдХ рд╣реИ рдФрд░ рдЗрд╕рд╕реЗ рдмрдЪрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред

рдПрдХ рдЕрд▓рдЧ Python рдореЙрдбреНрдпреВрд▓, [`rlboard.py`](https://github.com/microsoft/ML-For-Beginners/blob/main/8-Reinforcement/1-QLearning/rlboard.py), рдЗрд╕ рд╡рд╛рддрд╛рд╡рд░рдг рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреЛрдб рдХреЛ рд╢рд╛рдорд┐рд▓ рдХрд░рддрд╛ рд╣реИред рдЪреВрдВрдХрд┐ рдпрд╣ рдХреЛрдб рд╣рдорд╛рд░реЗ рдЕрд╡рдзрд╛рд░рдгрд╛рдУрдВ рдХреЛ рд╕рдордЭрдиреЗ рдХреЗ рд▓рд┐рдП рдорд╣рддреНрд╡рдкреВрд░реНрдг рдирд╣реАрдВ рд╣реИ, рд╣рдо рдореЙрдбреНрдпреВрд▓ рдХреЛ рдЖрдпрд╛рдд рдХрд░реЗрдВрдЧреЗ рдФрд░ рдирдореВрдирд╛ рдмреЛрд░реНрдб рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗ (рдХреЛрдб рдмреНрд▓реЙрдХ 1):

```python
from rlboard import *

width, height = 8,8
m = Board(width,height)
m.randomize(seed=13)
m.plot()
```

рдпрд╣ рдХреЛрдб рдКрдкрд░ рджрд┐рдП рдЧрдП рдЪрд┐рддреНрд░ рдХреЗ рд╕рдорд╛рди рд╡рд╛рддрд╛рд╡рд░рдг рдХрд╛ рдЪрд┐рддреНрд░ рдкреНрд░рд┐рдВрдЯ рдХрд░реЗрдЧрд╛ред

## рдПрдХреНрд╢рди рдФрд░ рдкреЙрд▓рд┐рд╕реА

рд╣рдорд╛рд░реЗ рдЙрджрд╛рд╣рд░рдг рдореЗрдВ, рдкреАрдЯрд░ рдХрд╛ рд▓рдХреНрд╖реНрдп рд╕реЗрдм рдХреЛ рдЦреЛрдЬрдирд╛ рд╣реЛрдЧрд╛, рдЬрдмрдХрд┐ рднреЗрдбрд╝рд┐рдпреЗ рдФрд░ рдЕрдиреНрдп рдмрд╛рдзрд╛рдУрдВ рд╕реЗ рдмрдЪрдирд╛ рд╣реЛрдЧрд╛ред рдРрд╕рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╡рд╣ рд╕реЗрдм рдХреЛ рдЦреЛрдЬрдиреЗ рддрдХ рдЗрдзрд░-рдЙрдзрд░ рдЪрд▓ рд╕рдХрддрд╛ рд╣реИред

рдЗрд╕рд▓рд┐рдП, рдХрд┐рд╕реА рднреА рд╕реНрдерд┐рддрд┐ рдореЗрдВ, рд╡рд╣ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдПрдХреНрд╢рди рдореЗрдВ рд╕реЗ рдПрдХ рдЪреБрди рд╕рдХрддрд╛ рд╣реИ: рдКрдкрд░, рдиреАрдЪреЗ, рдмрд╛рдПрдВ рдФрд░ рджрд╛рдПрдВред

рд╣рдо рдЗрди рдПрдХреНрд╢рди рдХреЛ рдПрдХ рдбрд┐рдХреНрд╢рдирд░реА рдХреЗ рд░реВрдк рдореЗрдВ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░реЗрдВрдЧреЗ, рдФрд░ рдЙрдиреНрд╣реЗрдВ рд╕рдВрдмрдВрдзрд┐рдд рд╕рдордиреНрд╡рдп рдкрд░рд┐рд╡рд░реНрддрдиреЛрдВ рдХреЗ рдЬреЛрдбрд╝реЗ рд╕реЗ рдореИрдк рдХрд░реЗрдВрдЧреЗред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рджрд╛рдИрдВ рдУрд░ рдмрдврд╝рдирд╛ (`R`) рдПрдХ рдЬреЛрдбрд╝реА `(1,0)` рдХреЗ рдЕрдиреБрд░реВрдк рд╣реЛрдЧрд╛ред (рдХреЛрдб рдмреНрд▓реЙрдХ 2):

```python
actions = { "U" : (0,-1), "D" : (0,1), "L" : (-1,0), "R" : (1,0) }
action_idx = { a : i for i,a in enumerate(actions.keys()) }
```

рдЗрд╕ рдкрд░рд┐рджреГрд╢реНрдп рдХреА рд░рдгрдиреАрддрд┐ рдФрд░ рд▓рдХреНрд╖реНрдп рдХреЛ рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ рдХрд╣реЗрдВ:

- **рд░рдгрдиреАрддрд┐**, рд╣рдорд╛рд░реЗ рдПрдЬреЗрдВрдЯ (рдкреАрдЯрд░) рдХреА, рдПрдХ рддрдерд╛рдХрдерд┐рдд **рдкреЙрд▓рд┐рд╕реА** рджреНрд╡рд╛рд░рд╛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХреА рдЬрд╛рддреА рд╣реИред рдкреЙрд▓рд┐рд╕реА рдПрдХ рдлрд╝рдВрдХреНрд╢рди рд╣реИ рдЬреЛ рдХрд┐рд╕реА рднреА рджрд┐рдП рдЧрдП рд╕реНрдЯреЗрдЯ рдкрд░ рдПрдХреНрд╢рди рд▓реМрдЯрд╛рддрд╛ рд╣реИред рд╣рдорд╛рд░реЗ рдорд╛рдорд▓реЗ рдореЗрдВ, рд╕рдорд╕реНрдпрд╛ рдХрд╛ рд╕реНрдЯреЗрдЯ рдмреЛрд░реНрдб рджреНрд╡рд╛рд░рд╛ рджрд░реНрд╢рд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рдЦрд┐рд▓рд╛рдбрд╝реА рдХреА рд╡рд░реНрддрдорд╛рди рд╕реНрдерд┐рддрд┐ рд╢рд╛рдорд┐рд▓ рд╣реИред

- **рд▓рдХреНрд╖реНрдп**, рд░рд┐рдЗрдВрдлреЛрд░реНрд╕рдореЗрдВрдЯ рд▓рд░реНрдирд┐рдВрдЧ рдХрд╛, рдЕрдВрддрддрдГ рдПрдХ рдЕрдЪреНрдЫреА рдкреЙрд▓рд┐рд╕реА рд╕реАрдЦрдирд╛ рд╣реИ рдЬреЛ рд╣рдореЗрдВ рд╕рдорд╕реНрдпрд╛ рдХреЛ рдХреБрд╢рд▓рддрд╛рдкреВрд░реНрд╡рдХ рд╣рд▓ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдЧрд╛ред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдПрдХ рдЖрдзрд╛рд░ рд░реЗрдЦрд╛ рдХреЗ рд░реВрдк рдореЗрдВ, рдЖрдЗрдП рд╕рдмрд╕реЗ рд╕рд░рд▓ рдкреЙрд▓рд┐рд╕реА рдкрд░ рд╡рд┐рдЪрд╛рд░ рдХрд░реЗрдВ рдЬрд┐рд╕реЗ **рд░реИрдВрдбрдо рд╡реЙрдХ** рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИред

## рд░реИрдВрдбрдо рд╡реЙрдХ

рдЖрдЗрдП рдкрд╣рд▓реЗ рд░реИрдВрдбрдо рд╡реЙрдХ рд░рдгрдиреАрддрд┐ рдХреЛ рд▓рд╛рдЧреВ рдХрд░рдХреЗ рдЕрдкрдиреА рд╕рдорд╕реНрдпрд╛ рдХреЛ рд╣рд▓ рдХрд░реЗрдВред рд░реИрдВрдбрдо рд╡реЙрдХ рдХреЗ рд╕рд╛рде, рд╣рдо рдЕрдиреБрдордд рдПрдХреНрд╢рди рдореЗрдВ рд╕реЗ рдЕрдЧрд▓реЗ рдПрдХреНрд╢рди рдХреЛ рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рд░реВрдк рд╕реЗ рдЪреБрдиреЗрдВрдЧреЗ, рдЬрдм рддрдХ рдХрд┐ рд╣рдо рд╕реЗрдм рддрдХ рдирд╣реАрдВ рдкрд╣реБрдВрдЪ рдЬрд╛рддреЗ (рдХреЛрдб рдмреНрд▓реЙрдХ 3)ред

1. рдиреАрдЪреЗ рджрд┐рдП рдЧрдП рдХреЛрдб рдХреЗ рд╕рд╛рде рд░реИрдВрдбрдо рд╡реЙрдХ рд▓рд╛рдЧреВ рдХрд░реЗрдВ:

    ```python
    def random_policy(m):
        return random.choice(list(actions))
    
    def walk(m,policy,start_position=None):
        n = 0 # number of steps
        # set initial position
        if start_position:
            m.human = start_position 
        else:
            m.random_start()
        while True:
            if m.at() == Board.Cell.apple:
                return n # success!
            if m.at() in [Board.Cell.wolf, Board.Cell.water]:
                return -1 # eaten by wolf or drowned
            while True:
                a = actions[policy(m)]
                new_pos = m.move_pos(m.human,a)
                if m.is_valid(new_pos) and m.at(new_pos)!=Board.Cell.water:
                    m.move(a) # do the actual move
                    break
            n+=1
    
    walk(m,random_policy)
    ```

    `walk` рдХреЛ рдХреЙрд▓ рдХрд░рдиреЗ рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рдкрде рдХреА рд▓рдВрдмрд╛рдИ рд▓реМрдЯрдиреА рдЪрд╛рд╣рд┐рдП, рдЬреЛ рдПрдХ рд░рди рд╕реЗ рджреВрд╕рд░реЗ рд░рди рдореЗрдВ рднрд┐рдиреНрди рд╣реЛ рд╕рдХрддреА рд╣реИред

1. рд╡реЙрдХ рдкреНрд░рдпреЛрдЧ рдХреЛ рдХрдИ рдмрд╛рд░ (рдХрд╣реЗрдВ, 100) рдЪрд▓рд╛рдПрдВ, рдФрд░ рдкрд░рд┐рдгрд╛рдореА рдЖрдБрдХрдбрд╝реЗ рдкреНрд░рд┐рдВрдЯ рдХрд░реЗрдВ (рдХреЛрдб рдмреНрд▓реЙрдХ 4):

    ```python
    def print_statistics(policy):
        s,w,n = 0,0,0
        for _ in range(100):
            z = walk(m,policy)
            if z<0:
                w+=1
            else:
                s += z
                n += 1
        print(f"Average path length = {s/n}, eaten by wolf: {w} times")
    
    print_statistics(random_policy)
    ```

    рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдкрде рдХреА рдФрд╕рдд рд▓рдВрдмрд╛рдИ рд▓рдЧрднрдЧ 30-40 рдХрджрдо рд╣реИ, рдЬреЛ рдХрд╛рдлреА рдЕрдзрд┐рдХ рд╣реИ, рдпрд╣ рджреЗрдЦрддреЗ рд╣реБрдП рдХрд┐ рдирд┐рдХрдЯрддрдо рд╕реЗрдм рдХреА рдФрд╕рдд рджреВрд░реА рд▓рдЧрднрдЧ 5-6 рдХрджрдо рд╣реИред

    рдЖрдк рдпрд╣ рднреА рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рд░реИрдВрдбрдо рд╡реЙрдХ рдХреЗ рджреМрд░рд╛рди рдкреАрдЯрд░ рдХреА рдЧрддрд┐ рдХреИрд╕реА рджрд┐рдЦрддреА рд╣реИ:

    ![рдкреАрдЯрд░ рдХрд╛ рд░реИрдВрдбрдо рд╡реЙрдХ](../../../../8-Reinforcement/1-QLearning/images/random_walk.gif)

## рдЗрдирд╛рдо рдлрд╝рдВрдХреНрд╢рди

рд╣рдорд╛рд░реА рдкреЙрд▓рд┐рд╕реА рдХреЛ рдЕрдзрд┐рдХ рдмреБрджреНрдзрд┐рдорд╛рди рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдореЗрдВ рдпрд╣ рд╕рдордЭрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ рдХрд┐ рдХреМрди рд╕реЗ рдХрджрдо рджреВрд╕рд░реЛрдВ рдХреА рддреБрд▓рдирд╛ рдореЗрдВ "рдмреЗрд╣рддрд░" рд╣реИрдВред рдРрд╕рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдореЗрдВ рдЕрдкрдирд╛ рд▓рдХреНрд╖реНрдп рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред

рд▓рдХреНрд╖реНрдп рдХреЛ рдПрдХ **рдЗрдирд╛рдо рдлрд╝рдВрдХреНрд╢рди** рдХреЗ рд╕рдВрджрд░реНрдн рдореЗрдВ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЬреЛ рдкреНрд░рддреНрдпреЗрдХ рд╕реНрдЯреЗрдЯ рдХреЗ рд▓рд┐рдП рдХреБрдЫ рд╕реНрдХреЛрд░ рдорд╛рди рд▓реМрдЯрд╛рдПрдЧрд╛ред рд╕рдВрдЦреНрдпрд╛ рдЬрд┐рддрдиреА рдЕрдзрд┐рдХ рд╣реЛрдЧреА, рдЗрдирд╛рдо рдлрд╝рдВрдХреНрд╢рди рдЙрддрдирд╛ рд╣реА рдмреЗрд╣рддрд░ рд╣реЛрдЧрд╛ред (рдХреЛрдб рдмреНрд▓реЙрдХ 5)

```python
move_reward = -0.1
goal_reward = 10
end_reward = -10

def reward(m,pos=None):
    pos = pos or m.human
    if not m.is_valid(pos):
        return end_reward
    x = m.at(pos)
    if x==Board.Cell.water or x == Board.Cell.wolf:
        return end_reward
    if x==Board.Cell.apple:
        return goal_reward
    return move_reward
```

рдЗрдирд╛рдо рдлрд╝рдВрдХреНрд╢рди рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдПрдХ рджрд┐рд▓рдЪрд╕реНрдк рдмрд╛рдд рдпрд╣ рд╣реИ рдХрд┐ рдЕрдзрд┐рдХрд╛рдВрд╢ рдорд╛рдорд▓реЛрдВ рдореЗрдВ, *рд╣рдореЗрдВ рдХреЗрд╡рд▓ рдЦреЗрд▓ рдХреЗ рдЕрдВрдд рдореЗрдВ рдПрдХ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдЗрдирд╛рдо рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ*ред рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рд╣рдорд╛рд░реЗ рдПрд▓реНрдЧреЛрд░рд┐рджрдо рдХреЛ "рдЕрдЪреНрдЫреЗ" рдХрджрдореЛрдВ рдХреЛ рдпрд╛рдж рд░рдЦрдирд╛ рдЪрд╛рд╣рд┐рдП рдЬреЛ рдЕрдВрдд рдореЗрдВ рд╕рдХрд╛рд░рд╛рддреНрдордХ рдЗрдирд╛рдо рдХреА рдУрд░ рд▓реЗ рдЬрд╛рддреЗ рд╣реИрдВ, рдФрд░ рдЙрдирдХреА рдорд╣рддреНрд╡рддрд╛ рдмрдврд╝рд╛рдиреА рдЪрд╛рд╣рд┐рдПред рдЗрд╕реА рддрд░рд╣, рд╕рднреА рдХрджрдо рдЬреЛ рдЦрд░рд╛рдм рдкрд░рд┐рдгрд╛рдореЛрдВ рдХреА рдУрд░ рд▓реЗ рдЬрд╛рддреЗ рд╣реИрдВ, рдЙрдиреНрд╣реЗрдВ рд╣рддреЛрддреНрд╕рд╛рд╣рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред

## Q-рд▓рд░реНрдирд┐рдВрдЧ

рдПрдХ рдПрд▓реНрдЧреЛрд░рд┐рджрдо рдЬрд┐рд╕реЗ рд╣рдо рдпрд╣рд╛рдВ рдЪрд░реНрдЪрд╛ рдХрд░реЗрдВрдЧреЗ, рдЙрд╕реЗ **Q-рд▓рд░реНрдирд┐рдВрдЧ** рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИред рдЗрд╕ рдПрд▓реНрдЧреЛрд░рд┐рджрдо рдореЗрдВ, рдкреЙрд▓рд┐рд╕реА рдХреЛ рдПрдХ рдлрд╝рдВрдХреНрд╢рди (рдпрд╛ рдбреЗрдЯрд╛ рд╕рдВрд░рдЪрдирд╛) рджреНрд╡рд╛рд░рд╛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬрд┐рд╕реЗ **Q-рдЯреЗрдмрд▓** рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИред рдпрд╣ рдкреНрд░рддреНрдпреЗрдХ рд╕реНрдЯреЗрдЯ рдореЗрдВ рджрд┐рдП рдЧрдП рдПрдХреНрд╢рди рдХреА "рдЕрдЪреНрдЫрд╛рдИ" рдХреЛ рд░рд┐рдХреЙрд░реНрдб рдХрд░рддрд╛ рд╣реИред

рдЗрд╕реЗ Q-рдЯреЗрдмрд▓ рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдЗрд╕реЗ рдЕрдХреНрд╕рд░ рдПрдХ рдЯреЗрдмрд▓ рдпрд╛ рдмрд╣реБ-рдЖрдпрд╛рдореА рдРрд░реЗ рдХреЗ рд░реВрдк рдореЗрдВ рдкреНрд░рд╕реНрддреБрдд рдХрд░рдирд╛ рд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рд╣реЛрддрд╛ рд╣реИред рдЪреВрдВрдХрд┐ рд╣рдорд╛рд░реЗ рдмреЛрд░реНрдб рдХрд╛ рдЖрдпрд╛рдо `width` x `height` рд╣реИ, рд╣рдо Q-рдЯреЗрдмрд▓ рдХреЛ `width` x `height` x `len(actions)` рдЖрдХрд╛рд░ рдХреЗ рд╕рд╛рде рдПрдХ numpy рдРрд░реЗ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкреНрд░рд╕реНрддреБрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: (рдХреЛрдб рдмреНрд▓реЙрдХ 6)

```python
Q = np.ones((width,height,len(actions)),dtype=np.float)*1.0/len(actions)
```

рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рд╣рдо Q-рдЯреЗрдмрд▓ рдХреЗ рд╕рднреА рдорд╛рдиреЛрдВ рдХреЛ рд╕рдорд╛рди рдорд╛рди рдХреЗ рд╕рд╛рде рдкреНрд░рд╛рд░рдВрдн рдХрд░рддреЗ рд╣реИрдВ, рд╣рдорд╛рд░реЗ рдорд╛рдорд▓реЗ рдореЗрдВ - 0.25ред рдпрд╣ "рд░реИрдВрдбрдо рд╡реЙрдХ" рдкреЙрд▓рд┐рд╕реА рдХреЗ рдЕрдиреБрд░реВрдк рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдкреНрд░рддреНрдпреЗрдХ рд╕реНрдЯреЗрдЯ рдореЗрдВ рд╕рднреА рдХрджрдо рд╕рдорд╛рди рд░реВрдк рд╕реЗ рдЕрдЪреНрдЫреЗ рд╣реИрдВред рд╣рдо рдмреЛрд░реНрдб рдкрд░ рдЯреЗрдмрд▓ рдХреЛ рд╡рд┐рдЬрд╝реБрдЕрд▓рд╛рдЗрдЬрд╝ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП Q-рдЯреЗрдмрд▓ рдХреЛ `plot` рдлрд╝рдВрдХреНрд╢рди рдореЗрдВ рдкрд╛рд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: `m.plot(Q)`ред

![рдкреАрдЯрд░ рдХрд╛ рд╡рд╛рддрд╛рд╡рд░рдг](../../../../8-Reinforcement/1-QLearning/images/env_init.png)

рдкреНрд░рддреНрдпреЗрдХ рд╕реЗрд▓ рдХреЗ рдХреЗрдВрджреНрд░ рдореЗрдВ рдПрдХ "рддреАрд░" рд╣реЛрддрд╛ рд╣реИ рдЬреЛ рдЧрддрд┐ рдХреА рдкрд╕рдВрджреАрджрд╛ рджрд┐рд╢рд╛ рдХреЛ рдЗрдВрдЧрд┐рдд рдХрд░рддрд╛ рд╣реИред рдЪреВрдВрдХрд┐ рд╕рднреА рджрд┐рд╢рд╛рдПрдБ рд╕рдорд╛рди рд╣реИрдВ, рдПрдХ рдмрд┐рдВрджреБ рдкреНрд░рджрд░реНрд╢рд┐рдд рд╣реЛрддрд╛ рд╣реИред

рдЕрдм рд╣рдореЗрдВ рд╕рд┐рдореБрд▓реЗрд╢рди рдЪрд▓рд╛рдиреЗ, рдЕрдкрдиреЗ рд╡рд╛рддрд╛рд╡рд░рдг рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ, рдФрд░ Q-рдЯреЗрдмрд▓ рдорд╛рдиреЛрдВ рдХреЗ рдмреЗрд╣рддрд░ рд╡рд┐рддрд░рдг рдХреЛ рд╕реАрдЦрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рдЬреЛ рд╣рдореЗрдВ рд╕реЗрдм рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХрд╛ рд░рд╛рд╕реНрддрд╛ рдмрд╣реБрдд рддреЗрдЬрд╝реА рд╕реЗ рдЦреЛрдЬрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдЧрд╛ред

## Q-рд▓рд░реНрдирд┐рдВрдЧ рдХрд╛ рд╕рд╛рд░: рдмреЗрд▓рдореИрди рд╕рдореАрдХрд░рдг

рдПрдХ рдмрд╛рд░ рдЬрдм рд╣рдо рдЪрд▓рдирд╛ рд╢реБрд░реВ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдкреНрд░рддреНрдпреЗрдХ рдПрдХреНрд╢рди рдХрд╛ рдПрдХ рд╕рдВрдмрдВрдзрд┐рдд рдЗрдирд╛рдо рд╣реЛрдЧрд╛, рдпрд╛рдиреА рд╣рдо рд╕реИрджреНрдзрд╛рдВрддрд┐рдХ рд░реВрдк рд╕реЗ рдЙрдЪреНрдЪрддрдо рддрддреНрдХрд╛рд▓ рдЗрдирд╛рдо рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдЕрдЧрд▓реЗ рдПрдХреНрд╢рди рдХрд╛ рдЪрдпрди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдЕрдзрд┐рдХрд╛рдВрд╢ рд╕реНрдЯреЗрдЯреНрд╕ рдореЗрдВ, рдпрд╣ рдХрджрдо рд╣рдорд╛рд░реЗ рд▓рдХреНрд╖реНрдп рдХреЛ рдкреНрд░рд╛рдкреНрдд рдирд╣реАрдВ рдХрд░реЗрдЧрд╛, рдФрд░ рдЗрд╕рд▓рд┐рдП рд╣рдо рддреБрд░рдВрдд рдпрд╣ рддрдп рдирд╣реАрдВ рдХрд░ рд╕рдХрддреЗ рдХрд┐ рдХреМрди рд╕реА рджрд┐рд╢рд╛ рдмреЗрд╣рддрд░ рд╣реИред

> рдпрд╛рдж рд░рдЦреЗрдВ рдХрд┐ рддрддреНрдХрд╛рд▓ рдкрд░рд┐рдгрд╛рдо рдорд╣рддреНрд╡рдкреВрд░реНрдг рдирд╣реАрдВ рд╣реИ, рдмрд▓реНрдХрд┐ рдЕрдВрддрд┐рдо рдкрд░рд┐рдгрд╛рдо рд╣реИ, рдЬрд┐рд╕реЗ рд╣рдо рд╕рд┐рдореБрд▓реЗрд╢рди рдХреЗ рдЕрдВрдд рдореЗрдВ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВрдЧреЗред

рдЗрд╕ рд╡рд┐рд▓рдВрдмрд┐рдд рдЗрдирд╛рдо рдХреЛ рдзреНрдпрд╛рди рдореЗрдВ рд░рдЦрдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдореЗрдВ **[рдбрд╛рдпрдирд╛рдорд┐рдХ рдкреНрд░реЛрдЧреНрд░рд╛рдорд┐рдВрдЧ](https://en.wikipedia.org/wiki/Dynamic_programming)** рдХреЗ рд╕рд┐рджреНрдзрд╛рдВрддреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рдЬреЛ рд╣рдореЗрдВ рдЕрдкрдиреА рд╕рдорд╕реНрдпрд╛ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдкреБрдирд░рд╛рд╡рд░реНрддреА рд░реВрдк рд╕реЗ рд╕реЛрдЪрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреЗ рд╣реИрдВред

рдорд╛рди рд▓реЗрдВ рдХрд┐ рд╣рдо рдЕрдм рд╕реНрдЯреЗрдЯ *s* рдкрд░ рд╣реИрдВ, рдФрд░ рд╣рдо рдЕрдЧрд▓реЗ рд╕реНрдЯреЗрдЯ *s'* рдкрд░ рдЬрд╛рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВред рдРрд╕рд╛ рдХрд░рдиреЗ рд╕реЗ, рд╣рдореЗрдВ рддрддреНрдХрд╛рд▓ рдЗрдирд╛рдо *r(s,a)* рдкреНрд░рд╛рдкреНрдд рд╣реЛрдЧрд╛, рдЬрд┐рд╕реЗ рдЗрдирд╛рдо рдлрд╝рдВрдХреНрд╢рди рджреНрд╡рд╛рд░рд╛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рд╕рд╛рде рд╣реА рдХреБрдЫ рднрд╡рд┐рд╖реНрдп рдХрд╛ рдЗрдирд╛рдо рднреАред рдпрджрд┐ рд╣рдо рдорд╛рди рд▓реЗрдВ рдХрд┐ рд╣рдорд╛рд░рд╛ Q-рдЯреЗрдмрд▓ рдкреНрд░рддреНрдпреЗрдХ рдПрдХреНрд╢рди рдХреА "рдЖрдХрд░реНрд╖рдХрддрд╛" рдХреЛ рд╕рд╣реА рдврдВрдЧ рд╕реЗ рджрд░реНрд╢рд╛рддрд╛ рд╣реИ, рддреЛ рд╕реНрдЯреЗрдЯ *s'* рдкрд░ рд╣рдо рдПрдХреНрд╢рди *a'* рдЪреБрдиреЗрдВрдЧреЗ рдЬреЛ *Q(s',a')* рдХреЗ рдЕрдзрд┐рдХрддрдо рдорд╛рди рдХреЗ рдЕрдиреБрд░реВрдк рд╣реЛрдЧрд╛ред рдЗрд╕ рдкреНрд░рдХрд╛рд░, рд╕реНрдЯреЗрдЯ *s* рдкрд░ рд╣рдореЗрдВ рдорд┐рд▓рдиреЗ рд╡рд╛рд▓рд╛ рд╕рдмрд╕реЗ рдЕрдЪреНрдЫрд╛ рд╕рдВрднрд╛рд╡рд┐рдд рднрд╡рд┐рд╖реНрдп рдХрд╛ рдЗрдирд╛рдо `max`

## рдиреАрддрд┐ рдХреА рдЬрд╛рдВрдЪ рдХрд░рдирд╛

рдЪреВрдВрдХрд┐ Q-Table рдкреНрд░рддреНрдпреЗрдХ рд╕реНрдерд┐рддрд┐ рдореЗрдВ рдкреНрд░рддреНрдпреЗрдХ рдХреНрд░рд┐рдпрд╛ рдХреА "рдЖрдХрд░реНрд╖рдХрддрд╛" рдХреЛ рд╕реВрдЪреАрдмрджреНрдз рдХрд░рддрд╛ рд╣реИ, рдЗрд╕реЗ рд╣рдорд╛рд░реЗ рд╕рдВрд╕рд╛рд░ рдореЗрдВ рдХреБрд╢рд▓ рдиреЗрд╡рд┐рдЧреЗрд╢рди рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдХрд╛рдлреА рдЖрд╕рд╛рди рд╣реИред рд╕рдмрд╕реЗ рд╕рд░рд▓ рдорд╛рдорд▓реЗ рдореЗрдВ, рд╣рдо рдЙрд╕ рдХреНрд░рд┐рдпрд╛ рдХрд╛ рдЪрдпрди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ Q-Table рдореЗрдВ рд╕рдмрд╕реЗ рдЙрдЪреНрдЪ рдорд╛рди рд╕реЗ рдореЗрд▓ рдЦрд╛рддреА рд╣реИ: (рдХреЛрдб рдмреНрд▓реЙрдХ 9)

```python
def qpolicy_strict(m):
        x,y = m.human
        v = probs(Q[x,y])
        a = list(actions)[np.argmax(v)]
        return a

walk(m,qpolicy_strict)
```

> рдпрджрд┐ рдЖрдк рдКрдкрд░ рджрд┐рдП рдЧрдП рдХреЛрдб рдХреЛ рдХрдИ рдмрд╛рд░ рдЖрдЬрд╝рдорд╛рддреЗ рд╣реИрдВ, рддреЛ рдЖрдк рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдХрднреА-рдХрднреА рдпрд╣ "рдЕрдЯрдХ" рдЬрд╛рддрд╛ рд╣реИ, рдФрд░ рдЖрдкрдХреЛ рдЗрд╕реЗ рд░реЛрдХрдиреЗ рдХреЗ рд▓рд┐рдП рдиреЛрдЯрдмреБрдХ рдореЗрдВ STOP рдмрдЯрди рджрдмрд╛рдирд╛ рдкрдбрд╝рддрд╛ рд╣реИред рдРрд╕рд╛ рдЗрд╕рд▓рд┐рдП рд╣реЛрддрд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдХреБрдЫ рд╕реНрдерд┐рддрд┐рдпреЛрдВ рдореЗрдВ рджреЛ рдЕрд╡рд╕реНрдерд╛рдПрдБ "рдПрдХ-рджреВрд╕рд░реЗ рдХреА рдУрд░ рдЗрд╢рд╛рд░рд╛ рдХрд░рддреА рд╣реИрдВ" рдЗрд╖реНрдЯрддрдо Q-Value рдХреЗ рд╕рдВрджрд░реНрдн рдореЗрдВ, рдЬрд┐рд╕рд╕реЗ рдПрдЬреЗрдВрдЯ рдЙрди рдЕрд╡рд╕реНрдерд╛рдУрдВ рдХреЗ рдмреАрдЪ рдЕрдирд┐рд╢реНрдЪрд┐рддрдХрд╛рд▓ рддрдХ рдШреВрдорддрд╛ рд░рд╣рддрд╛ рд╣реИред

## ЁЯЪАрдЪреБрдиреМрддреА

> **рдХрд╛рд░реНрдп 1:** `walk` рдлрд╝рдВрдХреНрд╢рди рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░реЗрдВ рддрд╛рдХрд┐ рдкрде рдХреА рдЕрдзрд┐рдХрддрдо рд▓рдВрдмрд╛рдИ рдХреЛ рдПрдХ рдирд┐рд╢реНрдЪрд┐рдд рд╕рдВрдЦреНрдпрд╛ (рдЬреИрд╕реЗ, 100) рддрдХ рд╕реАрдорд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗ, рдФрд░ рдКрдкрд░ рджрд┐рдпрд╛ рдЧрдпрд╛ рдХреЛрдб рд╕рдордп-рд╕рдордп рдкрд░ рдЗрд╕ рдорд╛рди рдХреЛ рд▓реМрдЯрд╛рдПред

> **рдХрд╛рд░реНрдп 2:** `walk` рдлрд╝рдВрдХреНрд╢рди рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░реЗрдВ рддрд╛рдХрд┐ рд╡рд╣ рдЙрди рд╕реНрдерд╛рдиреЛрдВ рдкрд░ рд╡рд╛рдкрд╕ рди рдЬрд╛рдП рдЬрд╣рд╛рдБ рд╡рд╣ рдкрд╣рд▓реЗ рд╣реА рдЬрд╛ рдЪреБрдХрд╛ рд╣реИред рдпрд╣ `walk` рдХреЛ рд▓реВрдкрд┐рдВрдЧ рд╕реЗ рд░реЛрдХ рджреЗрдЧрд╛, рд▓реЗрдХрд┐рди рдПрдЬреЗрдВрдЯ рдЕрднреА рднреА рдРрд╕реА рдЬрдЧрд╣ рдкрд░ "рдлрдВрд╕" рд╕рдХрддрд╛ рд╣реИ рдЬрд╣рд╛рдБ рд╕реЗ рд╡рд╣ рдмрд╛рд╣рд░ рдирд╣реАрдВ рдирд┐рдХрд▓ рд╕рдХрддрд╛ред

## рдиреЗрд╡рд┐рдЧреЗрд╢рди

рдПрдХ рдмреЗрд╣рддрд░ рдиреЗрд╡рд┐рдЧреЗрд╢рди рдиреАрддрд┐ рд╡рд╣ рд╣реЛрдЧреА рдЬреЛ рд╣рдордиреЗ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХреЗ рджреМрд░рд╛рди рдЙрдкрдпреЛрдЧ рдХреА рдереА, рдЬреЛ рд╢реЛрд╖рдг рдФрд░ рдЕрдиреНрд╡реЗрд╖рдг рдХреЛ рдЬреЛрдбрд╝рддреА рд╣реИред рдЗрд╕ рдиреАрддрд┐ рдореЗрдВ, рд╣рдо рдкреНрд░рддреНрдпреЗрдХ рдХреНрд░рд┐рдпрд╛ рдХреЛ рдПрдХ рдирд┐рд╢реНрдЪрд┐рдд рд╕рдВрднрд╛рд╡рдирд╛ рдХреЗ рд╕рд╛рде рдЪреБрдиреЗрдВрдЧреЗ, рдЬреЛ Q-Table рдореЗрдВ рдорд╛рдиреЛрдВ рдХреЗ рдЕрдиреБрдкрд╛рдд рдореЗрдВ рд╣реЛрдЧреАред рдпрд╣ рд░рдгрдиреАрддрд┐ рдЕрднреА рднреА рдПрдЬреЗрдВрдЯ рдХреЛ рдкрд╣рд▓реЗ рд╕реЗ рдЦреЛрдЬреЗ рдЧрдП рд╕реНрдерд╛рди рдкрд░ рд╡рд╛рдкрд╕ рд▓реМрдЯрдиреЗ рдХрд╛ рдХрд╛рд░рдг рдмрди рд╕рдХрддреА рд╣реИ, рд▓реЗрдХрд┐рди рдЬреИрд╕рд╛ рдХрд┐ рдЖрдк рдиреАрдЪреЗ рджрд┐рдП рдЧрдП рдХреЛрдб рд╕реЗ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ, рдпрд╣ рд╡рд╛рдВрдЫрд┐рдд рд╕реНрдерд╛рди рддрдХ рдмрд╣реБрдд рдЫреЛрдЯреЗ рдФрд╕рдд рдкрде рдХрд╛ рдкрд░рд┐рдгрд╛рдо рджреЗрддреА рд╣реИ (рдпрд╛рдж рд░рдЦреЗрдВ рдХрд┐ `print_statistics` рд╕рд┐рдореБрд▓реЗрд╢рди рдХреЛ 100 рдмрд╛рд░ рдЪрд▓рд╛рддрд╛ рд╣реИ): (рдХреЛрдб рдмреНрд▓реЙрдХ 10)

```python
def qpolicy(m):
        x,y = m.human
        v = probs(Q[x,y])
        a = random.choices(list(actions),weights=v)[0]
        return a

print_statistics(qpolicy)
```

рдЗрд╕ рдХреЛрдб рдХреЛ рдЪрд▓рд╛рдиреЗ рдХреЗ рдмрд╛рдж, рдЖрдкрдХреЛ рдкрд╣рд▓реЗ рдХреА рддреБрд▓рдирд╛ рдореЗрдВ рдмрд╣реБрдд рдЫреЛрдЯрд╛ рдФрд╕рдд рдкрде рд▓рдВрдмрд╛рдИ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреА рдЪрд╛рд╣рд┐рдП, рдЬреЛ 3-6 рдХреА рд╕реАрдорд╛ рдореЗрдВ рд╣реЛрдЧреАред

## рд╕реАрдЦрдиреЗ рдХреА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреА рдЬрд╛рдВрдЪ

рдЬреИрд╕рд╛ рдХрд┐ рд╣рдордиреЗ рдЙрд▓реНрд▓реЗрдЦ рдХрд┐рдпрд╛ рд╣реИ, рд╕реАрдЦрдиреЗ рдХреА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рд╕рдорд╕реНрдпрд╛ рд╕реНрдерд╛рди рдХреА рд╕рдВрд░рдЪрдирд╛ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдкреНрд░рд╛рдкреНрдд рдЬреНрдЮрд╛рди рдХреЗ рдЕрдиреНрд╡реЗрд╖рдг рдФрд░ рдЙрдкрдпреЛрдЧ рдХреЗ рдмреАрдЪ рд╕рдВрддреБрд▓рди рд╣реИред рд╣рдордиреЗ рджреЗрдЦрд╛ рд╣реИ рдХрд┐ рд╕реАрдЦрдиреЗ рдХреЗ рдкрд░рд┐рдгрд╛рдо (рдПрдЬреЗрдВрдЯ рдХреЛ рд▓рдХреНрд╖реНрдп рддрдХ рдкрд╣реБрдБрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рдЫреЛрдЯрд╛ рдкрде рдЦреЛрдЬрдиреЗ рдХреА рдХреНрд╖рдорддрд╛) рдореЗрдВ рд╕реБрдзрд╛рд░ рд╣реБрдЖ рд╣реИ, рд▓реЗрдХрд┐рди рдпрд╣ рджреЗрдЦрдирд╛ рднреА рджрд┐рд▓рдЪрд╕реНрдк рд╣реИ рдХрд┐ рд╕реАрдЦрдиреЗ рдХреА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рджреМрд░рд╛рди рдФрд╕рдд рдкрде рд▓рдВрдмрд╛рдИ рдХреИрд╕реЗ рд╡реНрдпрд╡рд╣рд╛рд░ рдХрд░рддреА рд╣реИ:

## рд╕реАрдЦрдиреЗ рдХреЛ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд░реВрдк рдореЗрдВ рд╕рдВрдХреНрд╖реЗрдкрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ:

- **рдФрд╕рдд рдкрде рд▓рдВрдмрд╛рдИ рдмрдврд╝рддреА рд╣реИ**ред рдпрд╣рд╛рдБ рд╣рдо рджреЗрдЦрддреЗ рд╣реИрдВ рдХрд┐ рд╢реБрд░реБрдЖрдд рдореЗрдВ рдФрд╕рдд рдкрде рд▓рдВрдмрд╛рдИ рдмрдврд╝рддреА рд╣реИред рдРрд╕рд╛ рд╕рдВрднрд╡рддрдГ рдЗрд╕рд▓рд┐рдП рд╣реЛрддрд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдЬрдм рд╣рдореЗрдВ рдкрд░реНрдпрд╛рд╡рд░рдг рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдХреБрдЫ рднреА рдкрддрд╛ рдирд╣реАрдВ рд╣реЛрддрд╛, рддреЛ рд╣рдо рдЦрд░рд╛рдм рдЕрд╡рд╕реНрдерд╛рдУрдВ, рдкрд╛рдиреА рдпрд╛ рднреЗрдбрд╝рд┐рдпреЗ рдореЗрдВ рдлрдВрд╕рдиреЗ рдХреА рд╕рдВрднрд╛рд╡рдирд╛ рд░рдЦрддреЗ рд╣реИрдВред рдЬреИрд╕реЗ-рдЬреИрд╕реЗ рд╣рдо рдЕрдзрд┐рдХ рд╕реАрдЦрддреЗ рд╣реИрдВ рдФрд░ рдЗрд╕ рдЬреНрдЮрд╛рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╢реБрд░реВ рдХрд░рддреЗ рд╣реИрдВ, рд╣рдо рдкрд░реНрдпрд╛рд╡рд░рдг рдХрд╛ рдЕрдзрд┐рдХ рд╕рдордп рддрдХ рдЕрдиреНрд╡реЗрд╖рдг рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рд╣рдореЗрдВ рдЕрднреА рднреА рд╕реЗрдмреЛрдВ рдХреЗ рд╕реНрдерд╛рди рдХрд╛ рд╕рд╣реА рдкрддрд╛ рдирд╣реАрдВ рд╣реЛрддрд╛ред

- **рдкрде рд▓рдВрдмрд╛рдИ рдШрдЯрддреА рд╣реИ, рдЬреИрд╕реЗ-рдЬреИрд╕реЗ рд╣рдо рдЕрдзрд┐рдХ рд╕реАрдЦрддреЗ рд╣реИрдВ**ред рдПрдХ рдмрд╛рд░ рдЬрдм рд╣рдо рдкрд░реНрдпрд╛рдкреНрдд рд╕реАрдЦ рд▓реЗрддреЗ рд╣реИрдВ, рддреЛ рдПрдЬреЗрдВрдЯ рдХреЗ рд▓рд┐рдП рд▓рдХреНрд╖реНрдп рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛ рдЖрд╕рд╛рди рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ, рдФрд░ рдкрде рд▓рдВрдмрд╛рдИ рдШрдЯрдиреЗ рд▓рдЧрддреА рд╣реИред рд╣рд╛рд▓рд╛рдВрдХрд┐, рд╣рдо рдЕрднреА рднреА рдЕрдиреНрд╡реЗрд╖рдг рдХреЗ рд▓рд┐рдП рдЦреБрд▓реЗ рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рд╣рдо рдЕрдХреНрд╕рд░ рд╕рдмрд╕реЗ рдЕрдЪреНрдЫреЗ рдкрде рд╕реЗ рджреВрд░ рдЪрд▓реЗ рдЬрд╛рддреЗ рд╣реИрдВ рдФрд░ рдирдП рд╡рд┐рдХрд▓реНрдкреЛрдВ рдХрд╛ рдЕрдиреНрд╡реЗрд╖рдг рдХрд░рддреЗ рд╣реИрдВ, рдЬрд┐рд╕рд╕реЗ рдкрде рдЖрджрд░реНрд╢ рд╕реЗ рд▓рдВрдмрд╛ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИред

- **рд▓рдВрдмрд╛рдИ рдЕрдЪрд╛рдирдХ рдмрдврд╝ рдЬрд╛рддреА рд╣реИ**ред рдЬреЛ рд╣рдо рдЗрд╕ рдЧреНрд░рд╛рдл рдкрд░ рднреА рджреЗрдЦрддреЗ рд╣реИрдВ рд╡рд╣ рдпрд╣ рд╣реИ рдХрд┐ рдХрд┐рд╕реА рдмрд┐рдВрджреБ рдкрд░, рд▓рдВрдмрд╛рдИ рдЕрдЪрд╛рдирдХ рдмрдврд╝ рдЬрд╛рддреА рд╣реИред рдпрд╣ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреА рдЕрдирд┐рд╢реНрдЪрд┐рдд рдкреНрд░рдХреГрддрд┐ рдХреЛ рдЗрдВрдЧрд┐рдд рдХрд░рддрд╛ рд╣реИ, рдФрд░ рдпрд╣ рдХрд┐ рд╣рдо рдХрд┐рд╕реА рдмрд┐рдВрджреБ рдкрд░ Q-Table рдЧреБрдгрд╛рдВрдХ рдХреЛ рдирдП рдорд╛рдиреЛрдВ рд╕реЗ рдЕрдзрд┐рд▓реЗрдЦрд┐рдд рдХрд░рдХреЗ "рдЦрд░рд╛рдм" рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдЗрд╕реЗ рдЖрджрд░реНрд╢ рд░реВрдк рд╕реЗ рд╕реАрдЦрдиреЗ рдХреА рджрд░ рдХреЛ рдХрдо рдХрд░рдХреЗ рдиреНрдпреВрдирддрдо рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХреЗ рдЕрдВрдд рдореЗрдВ, рд╣рдо рдХреЗрд╡рд▓ Q-Table рдорд╛рдиреЛрдВ рдХреЛ рдПрдХ рдЫреЛрдЯреЗ рдорд╛рди рд╕реЗ рд╕рдорд╛рдпреЛрдЬрд┐рдд рдХрд░рддреЗ рд╣реИрдВ)ред

рдХреБрд▓ рдорд┐рд▓рд╛рдХрд░, рдпрд╣ рдпрд╛рдж рд░рдЦрдирд╛ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ рдХрд┐ рд╕реАрдЦрдиреЗ рдХреА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреА рд╕рдлрд▓рддрд╛ рдФрд░ рдЧреБрдгрд╡рддреНрддрд╛ рдХрд╛рдлреА рд╣рдж рддрдХ рдкреИрд░рд╛рдореАрдЯрд░ рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддреА рд╣реИ, рдЬреИрд╕реЗ рд╕реАрдЦрдиреЗ рдХреА рджрд░, рд╕реАрдЦрдиреЗ рдХреА рджрд░ рдореЗрдВ рдХрдореА, рдФрд░ рдЫреВрдЯ рдХрд╛рд░рдХред рдЗрдиреНрд╣реЗрдВ рдЕрдХреНрд╕рд░ **рд╣рд╛рдЗрдкрд░рдкреИрд░рд╛рдореАрдЯрд░** рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ, рддрд╛рдХрд┐ рдЙрдиреНрд╣реЗрдВ **рдкреИрд░рд╛рдореАрдЯрд░** рд╕реЗ рдЕрд▓рдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗ, рдЬрд┐рдиреНрд╣реЗрдВ рд╣рдо рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХреЗ рджреМрд░рд╛рди рдЕрдиреБрдХреВрд▓рд┐рдд рдХрд░рддреЗ рд╣реИрдВ (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, Q-Table рдЧреБрдгрд╛рдВрдХ)ред рд╕рдмрд╕реЗ рдЕрдЪреНрдЫреЗ рд╣рд╛рдЗрдкрд░рдкреИрд░рд╛рдореАрдЯрд░ рдорд╛рдиреЛрдВ рдХреЛ рдЦреЛрдЬрдиреЗ рдХреА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ **рд╣рд╛рдЗрдкрд░рдкреИрд░рд╛рдореАрдЯрд░ рдЕрдиреБрдХреВрд▓рди** рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ, рдФрд░ рдпрд╣ рдПрдХ рдЕрд▓рдЧ рд╡рд┐рд╖рдп рдХреЗ рдпреЛрдЧреНрдп рд╣реИред

## [рдкреЛрд╕реНрдЯ-рд▓реЗрдХреНрдЪрд░ рдХреНрд╡рд┐рдЬрд╝](https://ff-quizzes.netlify.app/en/ml/)

## рдЕрд╕рд╛рдЗрдирдореЗрдВрдЯ 
[рдПрдХ рдЕрдзрд┐рдХ рдпрдерд╛рд░реНрдерд╡рд╛рджреА рд╕рдВрд╕рд╛рд░](assignment.md)

---

**рдЕрд╕реНрд╡реАрдХрд░рдг**:  
рдпрд╣ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ AI рдЕрдиреБрд╡рд╛рдж рд╕реЗрд╡рд╛ [Co-op Translator](https://github.com/Azure/co-op-translator) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЕрдиреБрд╡рд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред рдЬрдмрдХрд┐ рд╣рдо рд╕рдЯреАрдХрддрд╛ рдХреЗ рд▓рд┐рдП рдкреНрд░рдпрд╛рд╕рд░рдд рд╣реИрдВ, рдХреГрдкрдпрд╛ рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдЕрдиреБрд╡рд╛рдж рдореЗрдВ рддреНрд░реБрдЯрд┐рдпрд╛рдВ рдпрд╛ рдЕрд╢реБрджреНрдзрд┐рдпрд╛рдВ рд╣реЛ рд╕рдХрддреА рд╣реИрдВред рдореВрд▓ рднрд╛рд╖рд╛ рдореЗрдВ рдЙрдкрд▓рдмреНрдз рдореВрд▓ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдХреЛ рдЖрдзрд┐рдХрд╛рд░рд┐рдХ рд╕реНрд░реЛрдд рдорд╛рдирд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред рдорд╣рддреНрд╡рдкреВрд░реНрдг рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП, рдкреЗрд╢реЗрд╡рд░ рдорд╛рдирд╡ рдЕрдиреБрд╡рд╛рдж рдХреА рд╕рд┐рдлрд╛рд░рд┐рд╢ рдХреА рдЬрд╛рддреА рд╣реИред рдЗрд╕ рдЕрдиреБрд╡рд╛рдж рдХреЗ рдЙрдкрдпреЛрдЧ рд╕реЗ рдЙрддреНрдкрдиреНрди рдХрд┐рд╕реА рднреА рдЧрд▓рддрдлрд╣рдореА рдпрд╛ рдЧрд▓рдд рд╡реНрдпрд╛рдЦреНрдпрд╛ рдХреЗ рд▓рд┐рдП рд╣рдо рдЙрддреНрддрд░рджрд╛рдпреА рдирд╣реАрдВ рд╣реИрдВред  