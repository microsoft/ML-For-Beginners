# CartPole рд╕реНрдХреЗрдЯрд┐рдВрдЧ

рдкрд┐рдЫрд▓реЗ рдкрд╛рда рдореЗрдВ рд╣рдордиреЗ рдЬрд┐рд╕ рд╕рдорд╕реНрдпрд╛ рдХреЛ рд╣рд▓ рдХрд┐рдпрд╛ рдерд╛, рд╡рд╣ рдПрдХ рдЦрд┐рд▓реМрдирд╛ рд╕рдорд╕реНрдпрд╛ рдХреА рддрд░рд╣ рд▓рдЧ рд╕рдХрддреА рд╣реИ, рдЬреЛ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдЬреАрд╡рди рдкрд░рд┐рджреГрд╢реНрдпреЛрдВ рдХреЗ рд▓рд┐рдП рд▓рд╛рдЧреВ рдирд╣реАрдВ рд╣реЛрддреА рд╣реИред рдРрд╕рд╛ рдирд╣реАрдВ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдХрдИ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рджреБрдирд┐рдпрд╛ рдХреА рд╕рдорд╕реНрдпрд╛рдПрдВ рднреА рдЗрд╕ рдкрд░рд┐рджреГрд╢реНрдп рдХреЛ рд╕рд╛рдЭрд╛ рдХрд░рддреА рд╣реИрдВ - рдЬрд┐рд╕рдореЗрдВ рд╢рддрд░рдВрдЬ рдпрд╛ рдЧреЛ рдЦреЗрд▓рдирд╛ рднреА рд╢рд╛рдорд┐рд▓ рд╣реИред рд╡реЗ рд╕рдорд╛рди рд╣реИрдВ, рдХреНрдпреЛрдВрдХрд┐ рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рджрд┐рдП рдЧрдП рдирд┐рдпрдореЛрдВ рдХреЗ рд╕рд╛рде рдПрдХ рдмреЛрд░реНрдб рднреА рд╣реИ рдФрд░ рдПрдХ **рдбрд┐рд╕реНрдХреНрд░реАрдЯ рд╕реНрдЯреЗрдЯ**ред

## [рдкреНрд░реА-рд▓реЗрдХреНрдЪрд░ рдХреНрд╡рд┐рдЬрд╝](https://gray-sand-07a10f403.1.azurestaticapps.net/quiz/47/)

## рдкрд░рд┐рдЪрдп

рдЗрд╕ рдкрд╛рда рдореЗрдВ рд╣рдо Q-рд▓рд░реНрдирд┐рдВрдЧ рдХреЗ рд╕рдорд╛рди рд╕рд┐рджреНрдзрд╛рдВрддреЛрдВ рдХреЛ рдПрдХ рд╕рдорд╕реНрдпрд╛ рдкрд░ рд▓рд╛рдЧреВ рдХрд░реЗрдВрдЧреЗ рдЬрд┐рд╕рдореЗрдВ **рдХрдВрдЯреАрдиреНрдпреВрдЕрд╕ рд╕реНрдЯреЗрдЯ** рд╣реЛрддрд╛ рд╣реИ, рдпрд╛рдиреА рдПрдХ рд╕реНрдЯреЗрдЯ рдЬреЛ рдПрдХ рдпрд╛ рдЕрдзрд┐рдХ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд╕рдВрдЦреНрдпрд╛рдУрдВ рджреНрд╡рд╛рд░рд╛ рджреА рдЬрд╛рддреА рд╣реИред рд╣рдо рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╕рдорд╕реНрдпрд╛ рд╕реЗ рдирд┐рдкрдЯреЗрдВрдЧреЗ:

> **рд╕рдорд╕реНрдпрд╛**: рдЕрдЧрд░ рдкреАрдЯрд░ рдХреЛ рднреЗрдбрд╝рд┐рдпреЗ рд╕реЗ рдмрдЪрдирд╛ рд╣реИ, рддреЛ рдЙрд╕реЗ рддреЗрдЬреА рд╕реЗ рдЪрд▓рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред рд╣рдо рджреЗрдЦреЗрдВрдЧреЗ рдХрд┐ рдкреАрдЯрд░ рдХреИрд╕реЗ рд╕реНрдХреЗрдЯ рдХрд░рдирд╛ рд╕реАрдЦ рд╕рдХрддрд╛ рд╣реИ, рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рд╕рдВрддреБрд▓рди рдмрдирд╛рдП рд░рдЦрдирд╛, Q-рд▓рд░реНрдирд┐рдВрдЧ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗред

![The great escape!](../../../../translated_images/escape.18862db9930337e3fce23a9b6a76a06445f229dadea2268e12a6f0a1fde12115.hi.png)

> рдкреАрдЯрд░ рдФрд░ рдЙрд╕рдХреЗ рджреЛрд╕реНрдд рднреЗрдбрд╝рд┐рдпреЗ рд╕реЗ рдмрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рд░рдЪрдирд╛рддреНрдордХ рд╣реЛ рдЬрд╛рддреЗ рд╣реИрдВ! рдЪрд┐рддреНрд░ [Jen Looper](https://twitter.com/jenlooper) рджреНрд╡рд╛рд░рд╛

рд╣рдо рд╕рдВрддреБрд▓рди рдХреЗ рд░реВрдк рдореЗрдВ рдЬреНрдЮрд╛рдд рдПрдХ рд╕рд░рд▓реАрдХреГрдд рд╕рдВрд╕реНрдХрд░рдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗ рдЬрд┐рд╕реЗ **CartPole** рд╕рдорд╕реНрдпрд╛ рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИред CartPole рдХреА рджреБрдирд┐рдпрд╛ рдореЗрдВ, рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдПрдХ рдХреНрд╖реИрддрд┐рдЬ рд╕реНрд▓рд╛рдЗрдбрд░ рд╣реИ рдЬреЛ рдмрд╛рдПрдВ рдпрд╛ рджрд╛рдПрдВ рдЪрд▓ рд╕рдХрддрд╛ рд╣реИ, рдФрд░ рд▓рдХреНрд╖реНрдп рд╕реНрд▓рд╛рдЗрдбрд░ рдХреЗ рдКрдкрд░ рдПрдХ рд▓рдВрдмрд╡рдд рдкреЛрд▓ рдХреЛ рд╕рдВрддреБрд▓рд┐рдд рдХрд░рдирд╛ рд╣реИред

## рдЖрд╡рд╢реНрдпрдХрддрд╛рдПрдБ

рдЗрд╕ рдкрд╛рда рдореЗрдВ, рд╣рдо **OpenAI Gym** рдирд╛рдордХ рдПрдХ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗ рд╡рд┐рднрд┐рдиреНрди **рдПрдирд╡рд╛рдпрд░рдирдореЗрдВрдЯреНрд╕** рдХрд╛ рдЕрдиреБрдХрд░рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдПред рдЖрдк рдЗрд╕ рдкрд╛рда рдХреЗ рдХреЛрдб рдХреЛ рд╕реНрдерд╛рдиреАрдп рд░реВрдк рд╕реЗ (рдЬреИрд╕реЗ рдХрд┐ Visual Studio Code рд╕реЗ) рдЪрд▓рд╛ рд╕рдХрддреЗ рд╣реИрдВ, рдЗрд╕ рд╕реНрдерд┐рддрд┐ рдореЗрдВ рдЕрдиреБрдХрд░рдг рдПрдХ рдирдИ рд╡рд┐рдВрдбреЛ рдореЗрдВ рдЦреБрд▓реЗрдЧрд╛ред рдСрдирд▓рд╛рдЗрди рдХреЛрдб рдЪрд▓рд╛рддреЗ рд╕рдордп, рдЖрдкрдХреЛ рдХреЛрдб рдореЗрдВ рдХреБрдЫ рд╕рдорд╛рдпреЛрдЬрди рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛ рд╕рдХрддреА рд╣реИ, рдЬреИрд╕рд╛ рдХрд┐ [рдпрд╣рд╛рдБ](https://towardsdatascience.com/rendering-openai-gym-envs-on-binder-and-google-colab-536f99391cc7) рд╡рд░реНрдгрд┐рдд рд╣реИред

## OpenAI Gym

рдкрд┐рдЫрд▓реЗ рдкрд╛рда рдореЗрдВ, рдЦреЗрд▓ рдХреЗ рдирд┐рдпрдо рдФрд░ рд╕реНрдЯреЗрдЯ `Board` рдХреНрд▓рд╛рд╕ рджреНрд╡рд╛рд░рд╛ рджрд┐рдП рдЧрдП рдереЗ рдЬрд┐рд╕реЗ рд╣рдордиреЗ рд╕реНрд╡рдпрдВ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд┐рдпрд╛ рдерд╛ред рдпрд╣рд╛рдБ рд╣рдо рдПрдХ рд╡рд┐рд╢реЗрд╖ **рд╕рд┐рдореБрд▓реЗрд╢рди рдПрдирд╡рд╛рдпрд░рдирдореЗрдВрдЯ** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗ, рдЬреЛ рд╕рдВрддреБрд▓рди рдкреЛрд▓ рдХреЗ рдкреАрдЫреЗ рдХреЗ рднреМрддрд┐рдХреА рдХрд╛ рдЕрдиреБрдХрд░рдг рдХрд░реЗрдЧрд╛ред рд╕рдмрд╕реЗ рд▓реЛрдХрдкреНрд░рд┐рдп рд╕рд┐рдореБрд▓реЗрд╢рди рдПрдирд╡рд╛рдпрд░рдирдореЗрдВрдЯреНрд╕ рдореЗрдВ рд╕реЗ рдПрдХ рдЬрд┐рд╕реЗ рд░рд┐рдЗрдирдлреЛрд░реНрд╕рдореЗрдВрдЯ рд▓рд░реНрдирд┐рдВрдЧ рдПрд▓реНрдЧреЛрд░рд┐рджрдо рдХреЗ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЙрд╕реЗ [Gym](https://gym.openai.com/) рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬреЛ [OpenAI](https://openai.com/) рджреНрд╡рд╛рд░рд╛ рдмрдирд╛рдП рд░рдЦрд╛ рдЬрд╛рддрд╛ рд╣реИред рдЗрд╕ рдЬрд┐рдо рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╣рдо рдХрд╛рд░реНрдЯрдкреЛрд▓ рд╕рд┐рдореБрд▓реЗрд╢рди рд╕реЗ рд▓реЗрдХрд░ рдЕрдЯрд╛рд░реА рдЧреЗрдореНрд╕ рддрдХ рд╡рд┐рднрд┐рдиреНрди **рдПрдирд╡рд╛рдпрд░рдирдореЗрдВрдЯреНрд╕** рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВред

> **рдиреЛрдЯ**: рдЖрдк OpenAI Gym рд╕реЗ рдЙрдкрд▓рдмреНрдз рдЕрдиреНрдп рдПрдирд╡рд╛рдпрд░рдирдореЗрдВрдЯреНрд╕ рдХреЛ [рдпрд╣рд╛рдБ](https://gym.openai.com/envs/#classic_control) рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВред

рдкрд╣рд▓реЗ, рдЬрд┐рдо рдХреЛ рдЗрдВрд╕реНрдЯреЙрд▓ рдХрд░реЗрдВ рдФрд░ рдЖрд╡рд╢реНрдпрдХ рд▓рд╛рдЗрдмреНрд░реЗрд░реАрдЬрд╝ рдХреЛ рдЗрдореНрдкреЛрд░реНрдЯ рдХрд░реЗрдВ (рдХреЛрдб рдмреНрд▓реЙрдХ 1):

```python
import sys
!{sys.executable} -m pip install gym 

import gym
import matplotlib.pyplot as plt
import numpy as np
import random
```

## рд╡реНрдпрд╛рдпрд╛рдо - рдПрдХ рдХрд╛рд░реНрдЯрдкреЛрд▓ рдПрдирд╡рд╛рдпрд░рдирдореЗрдВрдЯ рдХреЛ рдкреНрд░рд╛рд░рдВрдн рдХрд░реЗрдВ

рдХрд╛рд░реНрдЯрдкреЛрд▓ рд╕рдВрддреБрд▓рди рд╕рдорд╕реНрдпрд╛ рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдореЗрдВ рд╕рдВрдмрдВрдзрд┐рдд рдПрдирд╡рд╛рдпрд░рдирдореЗрдВрдЯ рдХреЛ рдкреНрд░рд╛рд░рдВрдн рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред рдкреНрд░рддреНрдпреЗрдХ рдПрдирд╡рд╛рдпрд░рдирдореЗрдВрдЯ рдХреЗ рд╕рд╛рде рдПрдХ:

- **рдСрдмреНрдЬрд░реНрд╡реЗрд╢рди рд╕реНрдкреЗрд╕** рдЬреБрдбрд╝рд╛ рд╣реЛрддрд╛ рд╣реИ рдЬреЛ рдЙрд╕ рдЬрд╛рдирдХрд╛рд░реА рдХреА рд╕рдВрд░рдЪрдирд╛ рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рддрд╛ рд╣реИ рдЬреЛ рд╣рдореЗрдВ рдПрдирд╡рд╛рдпрд░рдирдореЗрдВрдЯ рд╕реЗ рдкреНрд░рд╛рдкреНрдд рд╣реЛрддреА рд╣реИред рдХрд╛рд░реНрдЯрдкреЛрд▓ рд╕рдорд╕реНрдпрд╛ рдХреЗ рд▓рд┐рдП, рд╣рдореЗрдВ рдкреЛрд▓ рдХреА рд╕реНрдерд┐рддрд┐, рд╡реЗрдЧ рдФрд░ рдХреБрдЫ рдЕрдиреНрдп рдорд╛рди рдкреНрд░рд╛рдкреНрдд рд╣реЛрддреЗ рд╣реИрдВред

- **рдПрдХреНрд╢рди рд╕реНрдкреЗрд╕** рдЬреЛ рд╕рдВрднрд╛рд╡рд┐рдд рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рддрд╛ рд╣реИред рд╣рдорд╛рд░реЗ рдорд╛рдорд▓реЗ рдореЗрдВ рдПрдХреНрд╢рди рд╕реНрдкреЗрд╕ рдбрд┐рд╕реНрдХреНрд░реАрдЯ рд╣реИ, рдФрд░ рдЗрд╕рдореЗрдВ рджреЛ рдХрд╛рд░реНрдп рд╢рд╛рдорд┐рд▓ рд╣реИрдВ - **рдмрд╛рдПрдВ** рдФрд░ **рджрд╛рдПрдВ**ред (рдХреЛрдб рдмреНрд▓реЙрдХ 2)

1. рдкреНрд░рд╛рд░рдВрдн рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреЛрдб рдЯрд╛рдЗрдк рдХрд░реЗрдВ:

    ```python
    env = gym.make("CartPole-v1")
    print(env.action_space)
    print(env.observation_space)
    print(env.action_space.sample())
    ```

рдПрдирд╡рд╛рдпрд░рдирдореЗрдВрдЯ рдХреИрд╕реЗ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ рдпрд╣ рджреЗрдЦрдиреЗ рдХреЗ рд▓рд┐рдП, рдЪрд▓рд┐рдП 100 рдЪрд░рдгреЛрдВ рдХреЗ рд▓рд┐рдП рдПрдХ рдЫреЛрдЯреА рд╕рд┐рдореБрд▓реЗрд╢рди рдЪрд▓рд╛рддреЗ рд╣реИрдВред рдкреНрд░рддреНрдпреЗрдХ рдЪрд░рдг рдореЗрдВ, рд╣рдо рдПрдХ рдХрд╛рд░реНрдп рдкреНрд░рджрд╛рди рдХрд░рддреЗ рд╣реИрдВ - рдЗрд╕ рд╕рд┐рдореБрд▓реЗрд╢рди рдореЗрдВ рд╣рдо рдмрд╕ `action_space` рд╕реЗ рдПрдХ рдХрд╛рд░реНрдп рдХреЛ рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рд░реВрдк рд╕реЗ рдЪреБрдирддреЗ рд╣реИрдВред

1. рдиреАрдЪреЗ рджрд┐рдП рдЧрдП рдХреЛрдб рдХреЛ рдЪрд▓рд╛рдПрдВ рдФрд░ рджреЗрдЦреЗрдВ рдХрд┐ рдЗрд╕рдХрд╛ рдкрд░рд┐рдгрд╛рдо рдХреНрдпрд╛ рд╣реИред

    тЬЕ рдпрд╛рдж рд░рдЦреЗрдВ рдХрд┐ рдЗрд╕ рдХреЛрдб рдХреЛ рд╕реНрдерд╛рдиреАрдп Python рдЗрдВрд╕реНрдЯреЙрд▓реЗрд╢рди рдкрд░ рдЪрд▓рд╛рдирд╛ рдмреЗрд╣рддрд░ рд╣реИ! (рдХреЛрдб рдмреНрд▓реЙрдХ 3)

    ```python
    env.reset()
    
    for i in range(100):
       env.render()
       env.step(env.action_space.sample())
    env.close()
    ```

    рдЖрдкрдХреЛ рдЗрд╕ рдЫрд╡рд┐ рдХреЗ рд╕рдорд╛рди рдХреБрдЫ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рд┐рдП:

    ![non-balancing cartpole](../../../../8-Reinforcement/2-Gym/images/cartpole-nobalance.gif)

1. рд╕рд┐рдореБрд▓реЗрд╢рди рдХреЗ рджреМрд░рд╛рди, рд╣рдореЗрдВ рдпрд╣ рддрдп рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдСрдмреНрдЬрд░реНрд╡реЗрд╢рди рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ рдХрд┐ рдХреИрд╕реЗ рдХрд╛рд░реНрдп рдХрд░рдирд╛ рд╣реИред рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ, рд╕реНрдЯреЗрдк рдлрд╝рдВрдХреНрд╢рди рд╡рд░реНрддрдорд╛рди рдСрдмреНрдЬрд░реНрд╡реЗрд╢рди, рдПрдХ рд░рд┐рд╡рд╛рд░реНрдб рдлрд╝рдВрдХреНрд╢рди рдФрд░ рдбрди рдлреНрд▓реИрдЧ рд▓реМрдЯрд╛рддрд╛ рд╣реИ рдЬреЛ рдЗрдВрдЧрд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рд╕рд┐рдореБрд▓реЗрд╢рди рдЬрд╛рд░реА рд░рдЦрдиреЗ рдХрд╛ рдХреЛрдИ рдорддрд▓рдм рд╣реИ рдпрд╛ рдирд╣реАрдВ: (рдХреЛрдб рдмреНрд▓реЙрдХ 4)

    ```python
    env.reset()
    
    done = False
    while not done:
       env.render()
       obs, rew, done, info = env.step(env.action_space.sample())
       print(f"{obs} -> {rew}")
    env.close()
    ```

    рдЖрдкрдХреЛ рдиреЛрдЯрдмреБрдХ рдЖрдЙрдЯрдкреБрдЯ рдореЗрдВ рдХреБрдЫ рдРрд╕рд╛ рд╣реА рджреЗрдЦрдирд╛ рдЪрд╛рд╣рд┐рдП:

    ```text
    [ 0.03403272 -0.24301182  0.02669811  0.2895829 ] -> 1.0
    [ 0.02917248 -0.04828055  0.03248977  0.00543839] -> 1.0
    [ 0.02820687  0.14636075  0.03259854 -0.27681916] -> 1.0
    [ 0.03113408  0.34100283  0.02706215 -0.55904489] -> 1.0
    [ 0.03795414  0.53573468  0.01588125 -0.84308041] -> 1.0
    ...
    [ 0.17299878  0.15868546 -0.20754175 -0.55975453] -> 1.0
    [ 0.17617249  0.35602306 -0.21873684 -0.90998894] -> 1.0
    ```

    рд╕рд┐рдореБрд▓реЗрд╢рди рдХреЗ рдкреНрд░рддреНрдпреЗрдХ рдЪрд░рдг рдореЗрдВ рд▓реМрдЯрд╛рдП рдЧрдП рдСрдмреНрдЬрд░реНрд╡реЗрд╢рди рд╡реЗрдХреНрдЯрд░ рдореЗрдВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдорд╛рди рд╢рд╛рдорд┐рд▓ рд╣реЛрддреЗ рд╣реИрдВ:
    - рдХрд╛рд░реНрдЯ рдХреА рд╕реНрдерд┐рддрд┐
    - рдХрд╛рд░реНрдЯ рдХреА рд╡реЗрдЧ
    - рдкреЛрд▓ рдХрд╛ рдХреЛрдг
    - рдкреЛрд▓ рдХрд╛ рд░реЛрдЯреЗрд╢рди рджрд░

1. рдЙрди рд╕рдВрдЦреНрдпрд╛рдУрдВ рдХрд╛ рдиреНрдпреВрдирддрдо рдФрд░ рдЕрдзрд┐рдХрддрдо рдорд╛рди рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ: (рдХреЛрдб рдмреНрд▓реЙрдХ 5)

    ```python
    print(env.observation_space.low)
    print(env.observation_space.high)
    ```

    рдЖрдк рдпрд╣ рднреА рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдкреНрд░рддреНрдпреЗрдХ рд╕рд┐рдореБрд▓реЗрд╢рди рдЪрд░рдг рдкрд░ рд░рд┐рд╡рд╛рд░реНрдб рдорд╛рди рд╣рдореЗрд╢рд╛ 1 рд╣реЛрддрд╛ рд╣реИред рдЗрд╕рдХрд╛ рдХрд╛рд░рдг рдпрд╣ рд╣реИ рдХрд┐ рд╣рдорд╛рд░рд╛ рд▓рдХреНрд╖реНрдп рдЬрд┐рддрдирд╛ рд╕рдВрднрд╡ рд╣реЛ рд╕рдХреЗ рдЬреАрд╡рд┐рдд рд░рд╣рдирд╛ рд╣реИ, рдпрд╛рдиреА рдкреЛрд▓ рдХреЛ рдпрдерд╛рд╕рдВрднрд╡ рд▓рдВрдмрд╡рдд рд╕реНрдерд┐рддрд┐ рдореЗрдВ рд░рдЦрдирд╛ рд╣реИред

    тЬЕ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ, рдпрджрд┐ рд╣рдо 100 рд▓рдЧрд╛рддрд╛рд░ рдкрд░реАрдХреНрд╖рдгреЛрдВ рдореЗрдВ 195 рдХрд╛ рдФрд╕рдд рд░рд┐рд╡рд╛рд░реНрдб рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдореЗрдВ рд╕рдлрд▓ рд╣реЛрддреЗ рд╣реИрдВ рддреЛ CartPole рд╕рд┐рдореБрд▓реЗрд╢рди рдХреЛ рд╣рд▓ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

## рд╕реНрдЯреЗрдЯ рдХрд╛ рдбрд┐рд╕реНрдХреНрд░реАрдЯрд╛рдЗрдЬреЗрд╢рди

Q-рд▓рд░реНрдирд┐рдВрдЧ рдореЗрдВ, рд╣рдореЗрдВ Q-рдЯреЗрдмрд▓ рдмрдирд╛рдирд╛ рд╣реЛрддрд╛ рд╣реИ рдЬреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдкреНрд░рддреНрдпреЗрдХ рд╕реНрдЯреЗрдЯ рдкрд░ рдХреНрдпрд╛ рдХрд░рдирд╛ рд╣реИред рдРрд╕рд╛ рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реЛрдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдореЗрдВ рд╕реНрдЯреЗрдЯ рдХреЛ **рдбрд┐рд╕реНрдХреНрд░реАрдЯ** рдмрдирд╛рдирд╛ рд╣реЛрдЧрд╛, рдЕрдзрд┐рдХ рд╕рдЯреАрдХ рд░реВрдк рд╕реЗ, рдЗрд╕рдореЗрдВ рд╕реАрдорд┐рдд рд╕рдВрдЦреНрдпрд╛ рдореЗрдВ рдбрд┐рд╕реНрдХреНрд░реАрдЯ рдорд╛рди рд╢рд╛рдорд┐рд▓ рд╣реЛрдиреЗ рдЪрд╛рд╣рд┐рдПред рдЗрд╕ рдкреНрд░рдХрд╛рд░, рд╣рдореЗрдВ рдХрд┐рд╕реА рдкреНрд░рдХрд╛рд░ рд╕реЗ рдЕрдкрдиреЗ рдСрдмреНрдЬрд░реНрд╡реЗрд╢рди рдХреЛ **рдбрд┐рд╕реНрдХреНрд░реАрдЯрд╛рдЗрдЬ** рдХрд░рдирд╛ рд╣реЛрдЧрд╛, рдЙрдиреНрд╣реЗрдВ рд╕реАрдорд┐рдд рд╕реНрдЯреЗрдЯ рд╕реЗрдЯ рдореЗрдВ рдореИрдк рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред

рд╣рдо рдЗрд╕реЗ рдХрд░рдиреЗ рдХреЗ рдХреБрдЫ рддрд░реАрдХреЗ рд╣реИрдВ:

- **рдмрд┐рдиреНрд╕ рдореЗрдВ рд╡рд┐рднрд╛рдЬрд┐рдд рдХрд░реЗрдВ**ред рдпрджрд┐ рд╣рдореЗрдВ рдХрд┐рд╕реА рдорд╛рди рдХрд╛ рдЕрдВрддрд░рд╛рд▓ рдкрддрд╛ рд╣реИ, рддреЛ рд╣рдо рдЗрд╕ рдЕрдВрддрд░рд╛рд▓ рдХреЛ рдХрдИ **рдмрд┐рдиреНрд╕** рдореЗрдВ рд╡рд┐рднрд╛рдЬрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдФрд░ рдлрд┐рд░ рдЙрд╕ рдорд╛рди рдХреЛ рдмрд┐рди рдирдВрдмрд░ рд╕реЗ рдмрджрд▓ рд╕рдХрддреЗ рд╣реИрдВ рдЬрд┐рд╕рдореЗрдВ рдпрд╣ рдЖрддрд╛ рд╣реИред рдпрд╣ numpy [`digitize`](https://numpy.org/doc/stable/reference/generated/numpy.digitize.html) рд╡рд┐рдзрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ, рд╣рдо рд╕реНрдЯреЗрдЯ рдЖрдХрд╛рд░ рдХреЛ рдареАрдХ рд╕реЗ рдЬрд╛рдиреЗрдВрдЧреЗ, рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рдЙрди рдмрд┐рдиреНрд╕ рдХреА рд╕рдВрдЦреНрдпрд╛ рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░реЗрдЧрд╛ рдЬрд┐рдиреНрд╣реЗрдВ рд╣рдо рдбрд┐рдЬрд┐рдЯрд▓реАрдХрд░рдг рдХреЗ рд▓рд┐рдП рдЪреБрдирддреЗ рд╣реИрдВред
  
тЬЕ рд╣рдо рдореВрд▓реНрдпреЛрдВ рдХреЛ рдХрд┐рд╕реА рд╕реАрдорд┐рдд рдЕрдВрддрд░рд╛рд▓ (рдХрд╣реЗрдВ, -20 рд╕реЗ 20 рддрдХ) рдореЗрдВ рд▓рд╛рдиреЗ рдХреЗ рд▓рд┐рдП рд░реИрдЦрд┐рдХ рдЗрдВрдЯрд░рдкреЛрд▓реЗрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдФрд░ рдлрд┐рд░ рдЙрдиреНрд╣реЗрдВ рдЧреЛрд▓ рдХрд░рдХреЗ рдкреВрд░реНрдгрд╛рдВрдХреЛрдВ рдореЗрдВ рдмрджрд▓ рд╕рдХрддреЗ рд╣реИрдВред рдЗрд╕рд╕реЗ рд╣рдореЗрдВ рд╕реНрдЯреЗрдЯ рдХреЗ рдЖрдХрд╛рд░ рдкрд░ рдереЛрдбрд╝рд╛ рдХрдо рдирд┐рдпрдВрддреНрд░рдг рдорд┐рд▓рддрд╛ рд╣реИ, рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдпрджрд┐ рд╣рдореЗрдВ рдЗрдирдкреБрдЯ рдореВрд▓реНрдпреЛрдВ рдХреА рд╕рдЯреАрдХ рд░реЗрдВрдЬ рдирд╣реАрдВ рдкрддрд╛ рд╣реИред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рд╣рдорд╛рд░реЗ рдорд╛рдорд▓реЗ рдореЗрдВ 4 рдореЗрдВ рд╕реЗ 2 рдорд╛рдиреЛрдВ рдХреА рдХреЛрдИ рдКрдкрд░реА/рдирд┐рдЪрд▓реА рд╕реАрдорд╛ рдирд╣реАрдВ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдЕрд╕реАрдорд┐рдд рд╕рдВрдЦреНрдпрд╛ рдореЗрдВ рд╕реНрдЯреЗрдЯ рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВред

рд╣рдорд╛рд░реЗ рдЙрджрд╛рд╣рд░рдг рдореЗрдВ, рд╣рдо рджреВрд╕рд░реЗ рджреГрд╖реНрдЯрд┐рдХреЛрдг рдХреЗ рд╕рд╛рде рдЬрд╛рдПрдВрдЧреЗред рдЬреИрд╕рд╛ рдХрд┐ рдЖрдк рдмрд╛рдж рдореЗрдВ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ, рдЕрдкрд░рд┐рднрд╛рд╖рд┐рдд рдКрдкрд░реА/рдирд┐рдЪрд▓реА рд╕реАрдорд╛рдУрдВ рдХреЗ рдмрд╛рд╡рдЬреВрдж, рд╡реЗ рдорд╛рди рд╢рд╛рдпрдж рд╣реА рдХрднреА рдХреБрдЫ рд╕реАрдорд┐рдд рдЕрдВрддрд░рд╛рд▓реЛрдВ рдХреЗ рдмрд╛рд╣рд░ рдорд╛рди рд▓реЗрддреЗ рд╣реИрдВ, рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдЙрди рд╕реНрдЯреЗрдЯреНрд╕ рдХреЗ рд╕рд╛рде рдЪрд░рдо рдорд╛рди рдмрд╣реБрдд рджреБрд░реНрд▓рдн рд╣реЛрдВрдЧреЗред

1. рдпрд╣рд╛рдБ рд╡рд╣ рдлрд╝рдВрдХреНрд╢рди рд╣реИ рдЬреЛ рд╣рдорд╛рд░реЗ рдореЙрдбрд▓ рд╕реЗ рдСрдмреНрдЬрд░реНрд╡реЗрд╢рди рд▓реЗрдЧрд╛ рдФрд░ 4 рдкреВрд░реНрдгрд╛рдВрдХ рдорд╛рдиреЛрдВ рдХрд╛ рдПрдХ рдЯреНрдпреВрдкрд▓ рдЙрддреНрдкрдиреНрди рдХрд░реЗрдЧрд╛: (рдХреЛрдб рдмреНрд▓реЙрдХ 6)

    ```python
    def discretize(x):
        return tuple((x/np.array([0.25, 0.25, 0.01, 0.1])).astype(np.int))
    ```

1. рдЪрд▓рд┐рдП рдмрд┐рдиреНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ рдФрд░ рдбрд┐рд╕реНрдХреНрд░реАрдЯрд╛рдЗрдЬреЗрд╢рди рд╡рд┐рдзрд┐ рдХрд╛ рднреА рдЕрдиреНрд╡реЗрд╖рдг рдХрд░рддреЗ рд╣реИрдВ: (рдХреЛрдб рдмреНрд▓реЙрдХ 7)

    ```python
    def create_bins(i,num):
        return np.arange(num+1)*(i[1]-i[0])/num+i[0]
    
    print("Sample bins for interval (-5,5) with 10 bins\n",create_bins((-5,5),10))
    
    ints = [(-5,5),(-2,2),(-0.5,0.5),(-2,2)] # intervals of values for each parameter
    nbins = [20,20,10,10] # number of bins for each parameter
    bins = [create_bins(ints[i],nbins[i]) for i in range(4)]
    
    def discretize_bins(x):
        return tuple(np.digitize(x[i],bins[i]) for i in range(4))
    ```

1. рдЕрдм рдЪрд▓рд┐рдП рдПрдХ рдЫреЛрдЯреА рд╕рд┐рдореБрд▓реЗрд╢рди рдЪрд▓рд╛рддреЗ рд╣реИрдВ рдФрд░ рдЙрди рдбрд┐рд╕реНрдХреНрд░реАрдЯ рдПрдирд╡рд╛рдпрд░рдирдореЗрдВрдЯ рдореВрд▓реНрдпреЛрдВ рдХрд╛ рдЕрд╡рд▓реЛрдХрди рдХрд░рддреЗ рд╣реИрдВред `discretize` and `discretize_bins` рджреЛрдиреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВ рдФрд░ рджреЗрдЦреЗрдВ рдХрд┐ рдХреНрдпрд╛ рдХреЛрдИ рдЕрдВрддрд░ рд╣реИред

    тЬЕ discretize_bins рдмрд┐рди рдирдВрдмрд░ рд▓реМрдЯрд╛рддрд╛ рд╣реИ, рдЬреЛ 0-рдЖрдзрд╛рд░рд┐рдд рд╣реЛрддрд╛ рд╣реИред рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдЗрдирдкреБрдЯ рд╡реЗрд░рд┐рдПрдмрд▓ рдХреЗ рдЪрд╛рд░реЛрдВ рдУрд░ 0 рдХреЗ рдорд╛рдиреЛрдВ рдХреЗ рд▓рд┐рдП рдпрд╣ рдЕрдВрддрд░рд╛рд▓ рдХреЗ рдордзреНрдп рд╕реЗ рд╕рдВрдЦреНрдпрд╛ рд▓реМрдЯрд╛рддрд╛ рд╣реИ (10)ред рдбрд┐рд╕реНрдХреНрд░реАрдЯрд╛рдЗрдЬ рдореЗрдВ, рд╣рдордиреЗ рдЖрдЙрдЯрдкреБрдЯ рдорд╛рдиреЛрдВ рдХреА рд░реЗрдВрдЬ рдХреА рдкрд░рд╡рд╛рд╣ рдирд╣реАрдВ рдХреА, рдЙрдиреНрд╣реЗрдВ рдирдХрд╛рд░рд╛рддреНрдордХ рд╣реЛрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреА, рдЗрд╕ рдкреНрд░рдХрд╛рд░ рд╕реНрдЯреЗрдЯ рдорд╛рди рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдирд╣реАрдВ рд╣реЛрддреЗ, рдФрд░ 0 рдХрд╛ рдорддрд▓рдм 0 рд╣реЛрддрд╛ рд╣реИред (рдХреЛрдб рдмреНрд▓реЙрдХ 8)

    ```python
    env.reset()
    
    done = False
    while not done:
       #env.render()
       obs, rew, done, info = env.step(env.action_space.sample())
       #print(discretize_bins(obs))
       print(discretize(obs))
    env.close()
    ```

    тЬЕ рдпрджрд┐ рдЖрдк рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдПрдирд╡рд╛рдпрд░рдирдореЗрдВрдЯ рдХреИрд╕реЗ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рд╣реЛрддрд╛ рд╣реИ рддреЛ env.render рд╕реЗ рд╢реБрд░реВ рд╣реЛрдиреЗ рд╡рд╛рд▓реА рдкрдВрдХреНрддрд┐ рдХреЛ рдЕрдирдХрдореЗрдВрдЯ рдХрд░реЗрдВред рдЕрдиреНрдпрдерд╛ рдЖрдк рдЗрд╕реЗ рдкреГрд╖реНрдарднреВрдорд┐ рдореЗрдВ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдЬреЛ рддреЗрдЬ рд╣реИред рд╣рдо рдЗрд╕ "рдЕрджреГрд╢реНрдп" рдирд┐рд╖реНрдкрд╛рджрди рдХрд╛ рдЙрдкрдпреЛрдЧ Q-рд▓рд░реНрдирд┐рдВрдЧ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рджреМрд░рд╛рди рдХрд░реЗрдВрдЧреЗред

## Q-рдЯреЗрдмрд▓ рд╕рдВрд░рдЪрдирд╛

рд╣рдорд╛рд░реЗ рдкрд┐рдЫрд▓реЗ рдкрд╛рда рдореЗрдВ, рд╕реНрдЯреЗрдЯ рдПрдХ рд╕рд╛рдзрд╛рд░рдг рд╕рдВрдЦреНрдпрд╛ рдЬреЛрдбрд╝реА рдереА 0 рд╕реЗ 8 рддрдХ, рдФрд░ рдЗрд╕ рдкреНрд░рдХрд╛рд░ Q-рдЯреЗрдмрд▓ рдХреЛ 8x8x2 рдЖрдХрд╛рд░ рдХреЗ numpy рдЯреЗрдВрд╕рд░ рджреНрд╡рд╛рд░рд╛ рдкреНрд░рд╕реНрддреБрдд рдХрд░рдирд╛ рд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рдерд╛ред рдпрджрд┐ рд╣рдо рдмрд┐рдиреНрд╕ рдбрд┐рд╕реНрдХреНрд░реАрдЯрд╛рдЗрдЬреЗрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рд╣рдорд╛рд░реЗ рд╕реНрдЯреЗрдЯ рд╡реЗрдХреНрдЯрд░ рдХрд╛ рдЖрдХрд╛рд░ рднреА рдЬреНрдЮрд╛рдд рд╣реЛрддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рд╣рдо рдЙрд╕реА рджреГрд╖реНрдЯрд┐рдХреЛрдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рд╕реНрдЯреЗрдЯ рдХреЛ 20x20x10x10x2 рдЖрдХрд╛рд░ рдХреЗ рдПрдХ рд╕рд░рдгреА рджреНрд╡рд╛рд░рд╛ рдкреНрд░рд╕реНрддреБрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ (рдпрд╣рд╛рдБ 2 рдПрдХреНрд╢рди рд╕реНрдкреЗрд╕ рдХрд╛ рдЖрдпрд╛рдо рд╣реИ, рдФрд░ рдкрд╣рд▓реЗ рдЖрдпрд╛рдо рдСрдмреНрдЬрд░реНрд╡реЗрд╢рди рд╕реНрдкреЗрд╕ рдореЗрдВ рдкреНрд░рддреНрдпреЗрдХ рдкреИрд░рд╛рдореАрдЯрд░ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЧрдП рдмрд┐рдиреНрд╕ рдХреА рд╕рдВрдЦреНрдпрд╛ рд╕реЗ рдореЗрд▓ рдЦрд╛рддреЗ рд╣реИрдВ)ред

рд╣рд╛рд▓рд╛рдВрдХрд┐, рдХрднреА-рдХрднреА рдСрдмреНрдЬрд░реНрд╡реЗрд╢рди рд╕реНрдкреЗрд╕ рдХреЗ рд╕рдЯреАрдХ рдЖрдпрд╛рдо рдЬреНрдЮрд╛рдд рдирд╣реАрдВ рд╣реЛрддреЗ рд╣реИрдВред `discretize` рдлрд╝рдВрдХреНрд╢рди рдХреЗ рдорд╛рдорд▓реЗ рдореЗрдВ, рд╣рдо рдХрднреА рднреА рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдирд╣реАрдВ рдХрд░ рд╕рдХрддреЗ рдХрд┐ рд╣рдорд╛рд░рд╛ рд╕реНрдЯреЗрдЯ рдирд┐рд╢реНрдЪрд┐рдд рд╕реАрдорд╛рдУрдВ рдХреЗ рднреАрддрд░ рд░рд╣рддрд╛ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдХреБрдЫ рдореВрд▓ рдорд╛рди рдмрд╛рдЙрдВрдб рдирд╣реАрдВ рд╣реЛрддреЗред рдЗрд╕ рдкреНрд░рдХрд╛рд░, рд╣рдо рдПрдХ рдЕрд▓рдЧ рджреГрд╖реНрдЯрд┐рдХреЛрдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗ рдФрд░ Q-рдЯреЗрдмрд▓ рдХреЛ рдПрдХ рдбрд┐рдХреНрд╢рдирд░реА рджреНрд╡рд╛рд░рд╛ рдкреНрд░рд╕реНрддреБрдд рдХрд░реЗрдВрдЧреЗред

1. *(state,action)* рдЬреЛрдбрд╝реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдбрд┐рдХреНрд╢рдирд░реА рдХреА рдХреБрдВрдЬреА рдХреЗ рд░реВрдк рдореЗрдВ рдХрд░реЗрдВ, рдФрд░ рдорд╛рди Q-рдЯреЗрдмрд▓ рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐ рдорд╛рди рд╕реЗ рдореЗрд▓ рдЦрд╛рддрд╛ рд╣реЛрдЧрд╛ред (рдХреЛрдб рдмреНрд▓реЙрдХ 9)

    ```python
    Q = {}
    actions = (0,1)
    
    def qvalues(state):
        return [Q.get((state,a),0) for a in actions]
    ```

    рдпрд╣рд╛рдБ рд╣рдо рдПрдХ рдлрд╝рдВрдХреНрд╢рди `qvalues()` рднреА рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рддреЗ рд╣реИрдВ, рдЬреЛ рдПрдХ рджрд┐рдП рдЧрдП рд╕реНрдЯреЗрдЯ рдХреЗ рд▓рд┐рдП рд╕рднреА рд╕рдВрднрд╛рд╡рд┐рдд рдХрд╛рд░реНрдпреЛрдВ рд╕реЗ рдореЗрд▓ рдЦрд╛рдиреЗ рд╡рд╛рд▓реЗ Q-рдЯреЗрдмрд▓ рдорд╛рдиреЛрдВ рдХреА рдПрдХ рд╕реВрдЪреА рд▓реМрдЯрд╛рддрд╛ рд╣реИред рдпрджрд┐ рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐ Q-рдЯреЗрдмрд▓ рдореЗрдВ рдореМрдЬреВрдж рдирд╣реАрдВ рд╣реИ, рддреЛ рд╣рдо рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ 0 рд▓реМрдЯрд╛рдПрдВрдЧреЗред

## рдЪрд▓рд┐рдП Q-рд▓рд░реНрдирд┐рдВрдЧ рд╢реБрд░реВ рдХрд░рддреЗ рд╣реИрдВ

рдЕрдм рд╣рдо рдкреАрдЯрд░ рдХреЛ рд╕рдВрддреБрд▓рди рд╕рд┐рдЦрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рддреИрдпрд╛рд░ рд╣реИрдВ!

1. рдкрд╣рд▓реЗ, рдХреБрдЫ рд╣рд╛рдЗрдкрд░рдкреИрд░рд╛рдореАрдЯрд░реНрд╕ рд╕реЗрдЯ рдХрд░реЗрдВ: (рдХреЛрдб рдмреНрд▓реЙрдХ 10)

    ```python
    # hyperparameters
    alpha = 0.3
    gamma = 0.9
    epsilon = 0.90
    ```

    рдпрд╣рд╛рдБ, `alpha` is the **learning rate** that defines to which extent we should adjust the current values of Q-Table at each step. In the previous lesson we started with 1, and then decreased `alpha` to lower values during training. In this example we will keep it constant just for simplicity, and you can experiment with adjusting `alpha` values later.

    `gamma` is the **discount factor** that shows to which extent we should prioritize future reward over current reward.

    `epsilon` is the **exploration/exploitation factor** that determines whether we should prefer exploration to exploitation or vice versa. In our algorithm, we will in `epsilon` percent of the cases select the next action according to Q-Table values, and in the remaining number of cases we will execute a random action. This will allow us to explore areas of the search space that we have never seen before. 

    тЬЕ In terms of balancing - choosing random action (exploration) would act as a random punch in the wrong direction, and the pole would have to learn how to recover the balance from those "mistakes"

### Improve the algorithm

We can also make two improvements to our algorithm from the previous lesson:

- **Calculate average cumulative reward**, over a number of simulations. We will print the progress each 5000 iterations, and we will average out our cumulative reward over that period of time. It means that if we get more than 195 point - we can consider the problem solved, with even higher quality than required.
  
- **Calculate maximum average cumulative result**, `Qmax`, and we will store the Q-Table corresponding to that result. When you run the training you will notice that sometimes the average cumulative result starts to drop, and we want to keep the values of Q-Table that correspond to the best model observed during training.

1. Collect all cumulative rewards at each simulation at `rewards` рд╡реЗрдХреНрдЯрд░ рдЖрдЧреЗ рдХреА рдкреНрд▓реЙрдЯрд┐рдВрдЧ рдХреЗ рд▓рд┐рдПред (рдХреЛрдб рдмреНрд▓реЙрдХ 11)

    ```python
    def probs(v,eps=1e-4):
        v = v-v.min()+eps
        v = v/v.sum()
        return v
    
    Qmax = 0
    cum_rewards = []
    rewards = []
    for epoch in range(100000):
        obs = env.reset()
        done = False
        cum_reward=0
        # == do the simulation ==
        while not done:
            s = discretize(obs)
            if random.random()<epsilon:
                # exploitation - chose the action according to Q-Table probabilities
                v = probs(np.array(qvalues(s)))
                a = random.choices(actions,weights=v)[0]
            else:
                # exploration - randomly chose the action
                a = np.random.randint(env.action_space.n)
    
            obs, rew, done, info = env.step(a)
            cum_reward+=rew
            ns = discretize(obs)
            Q[(s,a)] = (1 - alpha) * Q.get((s,a),0) + alpha * (rew + gamma * max(qvalues(ns)))
        cum_rewards.append(cum_reward)
        rewards.append(cum_reward)
        # == Periodically print results and calculate average reward ==
        if epoch%5000==0:
            print(f"{epoch}: {np.average(cum_rewards)}, alpha={alpha}, epsilon={epsilon}")
            if np.average(cum_rewards) > Qmax:
                Qmax = np.average(cum_rewards)
                Qbest = Q
            cum_rewards=[]
    ```

рдЖрдк рдЙрди рдкрд░рд┐рдгрд╛рдореЛрдВ рд╕реЗ рдХреНрдпрд╛ рдиреЛрдЯрд┐рд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

- **рд╣рдорд╛рд░реЗ рд▓рдХреНрд╖реНрдп рдХреЗ рдХрд░реАрдм**ред рд╣рдо 100+ рд▓рдЧрд╛рддрд╛рд░ рд╕рд┐рдореБрд▓реЗрд╢рди рд░рди рдХреЗ рджреМрд░рд╛рди 195 рд╕рдВрдЪрдпреА рд░рд┐рд╡рд╛рд░реНрдб рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рдХреНрд╖реНрдп рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рдмрд╣реБрдд рдХрд░реАрдм рд╣реИрдВ, рдпрд╛ рд╣рдо рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдЗрд╕реЗ рдкреНрд░рд╛рдкреНрдд рдХрд░ рдЪреБрдХреЗ рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ! рднрд▓реЗ рд╣реА рд╣рдореЗрдВ рдЫреЛрдЯреЗ рдирдВрдмрд░ рдорд┐рд▓реЗрдВ, рд╣рдо рдЕрднреА рднреА рдирд╣реАрдВ рдЬрд╛рдирддреЗ, рдХреНрдпреЛрдВрдХрд┐ рд╣рдо 5000 рд░рди рдХреЗ рдФрд╕рдд рдкрд░ рдЬрд╛ рд░рд╣реЗ рд╣реИрдВ, рдФрд░ рдХреЗрд╡рд▓ 100 рд░рди рдФрдкрдЪрд╛рд░рд┐рдХ рдорд╛рдирджрдВрдб рдореЗрдВ рдЖрд╡рд╢реНрдпрдХ рд╣реИрдВред
  
- **рд░рд┐рд╡рд╛рд░реНрдб рдЧрд┐рд░рдирд╛ рд╢реБрд░реВ рд╣реЛрддрд╛ рд╣реИ**ред рдХрднреА-рдХрднреА рд░рд┐рд╡рд╛рд░реНрдб рдЧрд┐рд░рдирд╛ рд╢реБрд░реВ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ, рдЬрд┐рд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рд╣рдо Q-рдЯреЗрдмрд▓ рдореЗрдВ рдкрд╣рд▓реЗ рд╕реЗ рд╕реАрдЦреЗ рдЧрдП рдорд╛рдиреЛрдВ рдХреЛ рдЙрди рдорд╛рдиреЛрдВ рд╕реЗ "рдирд╖реНрдЯ" рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ рд╕реНрдерд┐рддрд┐ рдХреЛ рдмрджрддрд░ рдмрдирд╛рддреЗ рд╣реИрдВред

рдпрд╣ рдЕрд╡рд▓реЛрдХрди рдЕрдзрд┐рдХ рд╕реНрдкрд╖реНрдЯ рд░реВрдк рд╕реЗ рджрд┐рдЦрд╛рдИ рджреЗрддрд╛ рд╣реИ рдпрджрд┐ рд╣рдо рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдкреНрд░рдЧрддрд┐ рдХрд╛ рдЧреНрд░рд╛рдлрд╝ рдмрдирд╛рддреЗ рд╣реИрдВред

## рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдкреНрд░рдЧрддрд┐ рдХрд╛ рдЧреНрд░рд╛рдлрд╝ рдмрдирд╛рдирд╛

рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХреЗ рджреМрд░рд╛рди, рд╣рдордиреЗ рдкреНрд░рддреНрдпреЗрдХ рдкреБрдирд░рд╛рд╡реГрддреНрддрд┐ рдореЗрдВ рд╕рдВрдЪрдпреА рд░рд┐рд╡рд╛рд░реНрдб рдорд╛рди рдХреЛ `rewards` рд╡реЗрдХреНрдЯрд░ рдореЗрдВ рдПрдХрддреНрд░ рдХрд┐рдпрд╛ рд╣реИред рдпрд╣рд╛рдБ рдпрд╣ рдХреИрд╕рд╛ рджрд┐рдЦрддрд╛ рд╣реИ рдЬрдм рд╣рдо рдЗрд╕реЗ рдкреБрдирд░рд╛рд╡реГрддреНрддрд┐ рд╕рдВрдЦреНрдпрд╛ рдХреЗ рдЦрд┐рд▓рд╛рдл рдкреНрд▓реЙрдЯ рдХрд░рддреЗ рд╣реИрдВ:

```python
plt.plot(rewards)
```

![raw  progress](../../../../translated_images/train_progress_raw.2adfdf2daea09c596fc786fa347a23e9aceffe1b463e2257d20a9505794823ec.hi.png)

рдЗрд╕ рдЧреНрд░рд╛рдлрд╝ рд╕реЗ, рдХреБрдЫ рднреА рдмрддрд╛рдирд╛ рд╕рдВрднрд╡ рдирд╣реАрдВ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рд╕реНрдЯреЛрдЪреИрд╕реНрдЯрд┐рдХ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреА рдкреНрд░рдХреГрддрд┐ рдХреЗ рдХрд╛рд░рдг рдкреНрд░рд╢рд┐рдХреНрд╖рдг рд╕рддреНрд░реЛрдВ рдХреА рд▓рдВрдмрд╛рдИ рдмрд╣реБрдд рднрд┐рдиреНрди рд╣реЛрддреА рд╣реИред рдЗрд╕ рдЧреНрд░рд╛рдлрд╝ рдХреЛ рдЕрдзрд┐рдХ рд╕рдордЭрдиреЗ рдпреЛрдЧреНрдп рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо рдкреНрд░рдпреЛрдЧреЛрдВ рдХреА рдПрдХ рд╢реНрд░реГрдВрдЦрд▓рд╛ рдкрд░ **рд░рдирд┐рдВрдЧ рдПрд╡рд░реЗрдЬ** рдХреА рдЧрдгрдирд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдХрд╣реЗрдВ 100ред рдЗрд╕реЗ `np.convolve` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЖрд╕рд╛рдиреА рд╕реЗ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ: (рдХреЛрдб рдмреНрд▓реЙрдХ 12)

```python
def running_average(x,window):
    return np.convolve(x,np.ones(window)/window,mode='valid')

plt.plot(running_average(rewards,100))
```

![training progress](../../../../translated_images/train_progress_runav.c71694a8fa9ab35935aff6f109e5ecdfdbdf1b0ae265da49479a81b5fae8f0aa.hi.png)

## рд╣рд╛рдЗрдкрд░рдкреИрд░рд╛рдореАрдЯрд░реНрд╕ рдХреЛ рдмрджрд▓рдирд╛

рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХреЛ рдЕрдзрд┐рдХ рд╕реНрдерд┐рд░ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП, рдпрд╣ рд╕рдордЭ рдореЗрдВ рдЖрддрд╛ рд╣реИ рдХрд┐ рд╣рдорд╛рд░реЗ рдХреБрдЫ рд╣рд╛рдЗрдкрд░рдкреИрд░рд╛рдореАрдЯрд░реНрд╕ рдХреЛ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХреЗ рджреМрд░рд╛рди рд╕рдорд╛рдпреЛрдЬрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдПред рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ:

- **рд▓рд░реНрдирд┐рдВрдЧ рд░реЗрдЯ** рдХреЗ рд▓рд┐рдП, `alpha`, we may start with values close to 1, and then keep decreasing the parameter. With time, we will be getting good probability values in the Q-Table, and thus we should be adjusting them slightly, and not overwriting completely with new values.

- **Increase epsilon**. We may want to increase the `epsilon` slowly, in order to explore less and exploit more. It probably makes sense to start with lower value of `epsilon`, рдФрд░ рд▓рдЧрднрдЧ 1 рддрдХ рдмрдврд╝реЗрдВред

> **рдХрд╛рд░реНрдп 1**: рд╣рд╛рдЗрдкрд░рдкреИрд░рд╛рдореАрдЯрд░ рдорд╛рдиреЛрдВ рдХреЗ рд╕рд╛рде рдЦреЗрд▓реЗрдВ рдФрд░ рджреЗрдЦреЗрдВ рдХрд┐ рдХреНрдпрд╛ рдЖрдк рдЙрдЪреНрдЪ рд╕рдВрдЪрдпреА рд░рд┐рд╡рд╛рд░реНрдб рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдХреНрдпрд╛ рдЖрдк 195 рд╕реЗ рдКрдкрд░ рдЬрд╛ рд░рд╣реЗ рд╣реИрдВ?

> **рдХрд╛рд░реНрдп 2**: рд╕рдорд╕реНрдпрд╛ рдХреЛ рдФрдкрдЪрд╛рд░рд┐рдХ рд░реВрдк рд╕реЗ рд╣рд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдкрдХреЛ 100 рд▓рдЧрд╛рддрд╛рд░ рд░рди рдХреЗ рджреМрд░рд╛рди 195 рдФрд╕рдд рд░рд┐рд╡рд╛рд░реНрдб рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХреЗ рджреМрд░рд╛рди рдЗрд╕реЗ рдорд╛рдкреЗрдВ рдФрд░ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░реЗрдВ рдХрд┐ рдЖрдкрдиреЗ рд╕рдорд╕реНрдпрд╛ рдХреЛ рдФрдкрдЪрд╛рд░рд┐рдХ рд░реВрдк рд╕реЗ рд╣рд▓ рдХрд░ рд▓рд┐рдпрд╛ рд╣реИ!

## рдкрд░рд┐рдгрд╛рдо рдХреЛ рдХреНрд░рд┐рдпрд╛рдиреНрд╡рд┐рдд рдореЗрдВ рджреЗрдЦрдирд╛

рдпрд╣ рджреЗрдЦрдирд╛ рджрд┐рд▓рдЪрд╕реНрдк рд╣реЛрдЧрд╛ рдХрд┐ рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдореЙрдбрд▓ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдХреИрд╕реЗ рд╡реНрдпрд╡рд╣рд╛рд░ рдХрд░рддрд╛ рд╣реИред рдЪрд▓рд┐рдП рд╕рд┐рдореБрд▓реЗрд╢рди рдЪрд▓рд╛рддреЗ рд╣реИрдВ рдФрд░ Q-рдЯреЗрдмрд▓ рдореЗрдВ рд╕рдВрднрд╛рд╡реНрдпрддрд╛ рд╡рд┐рддрд░рдг рдХреЗ рдЕрдиреБрд╕рд╛рд░ рдХрд╛рд░реНрдп рдЪрдпрди рд░рдгрдиреАрддрд┐ рдХрд╛ рдкрд╛рд▓рди рдХрд░рддреЗ рд╣реИрдВ: (рдХреЛрдб рдмреНрд▓реЙрдХ 13)

```python
obs = env.reset()
done = False
while not done:
   s = discretize(obs)
   env.render()
   v = probs(np.array(qvalues(s)))
   a = random.choices(actions,weights=v)[0]
   obs,_,done,_ = env.step(a)
env.close()
```

рдЖрдкрдХреЛ рдХреБрдЫ рдРрд╕рд╛ рджрд┐рдЦрдирд╛ рдЪрд╛рд╣рд┐рдП:

![a balancing cartpole](../../../../8-Reinforcement/2-Gym/images/cartpole-balance.gif)

---

## ЁЯЪАрдЪреБрдиреМрддреА

> **рдХрд╛рд░реНрдп 3**: рдпрд╣рд╛рдБ, рд╣рдо Q-рдЯреЗрдмрд▓ рдХреА рдЕрдВрддрд┐рдо рдкреНрд░рддрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд░рд╣реЗ рдереЗ, рдЬреЛ рд╕рдмрд╕реЗ рдЕрдЪреНрдЫреА рдирд╣реАрдВ рд╣реЛ рд╕рдХрддреАред рдпрд╛рдж рд░рдЦреЗрдВ рдХрд┐ рд╣рдордиреЗ рд╕рдмрд╕реЗ рдЕрдЪреНрдЫрд╛ рдкреНрд░рджрд░реНрд╢рди рдХрд░рдиреЗ рд╡рд╛рд▓реЗ Q-рдЯреЗрдмрд▓ рдХреЛ `Qbest` variable! Try the same example with the best-performing Q-Table by copying `Qbest` over to `Q` and see if you notice the difference.

> **Task 4**: Here we were not selecting the best action on each step, but rather sampling with corresponding probability distribution. Would it make more sense to always select the best action, with the highest Q-Table value? This can be done by using `np.argmax` рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕рдмрд╕реЗ рдЕрдзрд┐рдХ Q-рдЯреЗрдмрд▓ рдорд╛рди рд╕реЗ рдореЗрд▓ рдЦрд╛рдиреЗ рд╡рд╛рд▓реЗ рдХрд╛рд░реНрдп рд╕рдВрдЦреНрдпрд╛ рдХреЛ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдПред рдЗрд╕ рд░рдгрдиреАрддрд┐ рдХреЛ рд▓рд╛рдЧреВ рдХрд░реЗрдВ рдФрд░ рджреЗрдЦреЗрдВ рдХрд┐ рдХреНрдпрд╛ рдпрд╣ рд╕рдВрддреБрд▓рди рдореЗрдВ рд╕реБрдзрд╛рд░ рдХрд░рддрд╛ рд╣реИред

## [рдкреЛрд╕реНрдЯ-рд▓реЗрдХреНрдЪрд░ рдХреНрд╡рд┐рдЬрд╝](https://gray-sand-07a10f403.1.azurestaticapps.net/quiz/48/)

## рдЕрд╕рд╛рдЗрдирдореЗрдВрдЯ
[Train a Mountain Car](assignment.md)

## рдирд┐рд╖реНрдХрд░реНрд╖

рдЕрдм рд╣рдордиреЗ рд╕реАрдЦрд╛ рд╣реИ рдХрд┐ рдПрдЬреЗрдВрдЯреЛрдВ рдХреЛ рдЕрдЪреНрдЫреЗ рдкрд░рд┐рдгрд╛рдо рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреИрд╕реЗ рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдП, рдмрд╕ рдЙрдиреНрд╣реЗрдВ рдПрдХ рд░рд┐рд╡рд╛рд░реНрдб рдлрд╝рдВрдХреНрд╢рди рдкреНрд░рджрд╛рди рдХрд░рдХреЗ рдЬреЛ рдЦреЗрд▓ рдХреА рд╡рд╛рдВрдЫрд┐рдд рд╕реНрдерд┐рддрд┐ рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рддрд╛ рд╣реИ, рдФрд░ рдЙрдиреНрд╣реЗрдВ рдЦреЛрдЬ рд╕реНрдерд╛рди рдХреЛ рдмреБрджреНрдзрд┐рдорд╛рдиреА рд╕реЗ рдЕрдиреНрд╡реЗрд╖рдг рдХрд░рдиреЗ рдХрд╛ рдЕрд╡рд╕рд░ рджреЗрдХрд░ред рд╣рдордиреЗ рдбрд┐рд╕реНрдХреНрд░реАрдЯ рдФрд░ рдХрдВрдЯреАрдиреНрдпреВрдЕрд╕ рдПрдирд╡рд╛рдпрд░рдирдореЗрдВрдЯреНрд╕ рдХреЗ рдорд╛рдорд▓реЛрдВ рдореЗрдВ Q-рд▓рд░реНрдирд┐рдВрдЧ рдПрд▓реНрдЧреЛрд░рд┐рджрдо рдХреЛ рд╕рдлрд▓рддрд╛рдкреВрд░реНрд╡рдХ рд▓рд╛рдЧреВ рдХрд┐рдпрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдбрд┐рд╕реНрдХреНрд░реАрдЯ рдПрдХреНрд╢рдиреНрд╕ рдХреЗ рд╕рд╛рдеред

рдпрд╣ рдЕрдзреНрдпрдпрди рдХрд░рдирд╛ рднреА рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ рдХрд┐ рдЬрдм рдПрдХреНрд╢рди рд╕реНрдЯреЗрдЯ рднреА рдХрдВрдЯреАрдиреНрдпреВрдЕрд╕ рд╣реЛрддрд╛ рд╣реИ, рдФрд░ рдЬрдм рдСрдмреНрдЬрд░реНрд╡реЗрд╢рди рд╕реНрдкреЗрд╕ рдмрд╣реБрдд рдЕрдзрд┐рдХ рдЬрдЯрд┐рд▓ рд╣реЛрддрд╛ рд╣реИ, рдЬреИрд╕реЗ рдХрд┐ рдЕрдЯрд╛рд░реА рдЧреЗрдо рд╕реНрдХреНрд░реАрди рд╕реЗ рдЫрд╡рд┐ред рдЙрди рд╕рдорд╕реНрдпрд╛рдУрдВ рдореЗрдВ рд╣рдореЗрдВ рдЕрдХреНрд╕рд░ рдЕрдЪреНрдЫреЗ рдкрд░рд┐рдгрд╛рдо рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдзрд┐рдХ рд╢рдХреНрддрд┐рд╢рд╛рд▓реА рдорд╢реАрди рд▓рд░реНрдирд┐рдВрдЧ рддрдХрдиреАрдХреЛрдВ, рдЬреИрд╕реЗ рдХрд┐ рдиреНрдпреВрд░рд▓ рдиреЗрдЯрд╡рд░реНрдХреНрд╕, рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред рдпреЗ рдЕрдзрд┐рдХ рдЙрдиреНрдирдд рд╡рд┐рд╖рдп рд╣рдорд╛рд░реЗ рдЖрдЧрд╛рдореА рдЕрдзрд┐рдХ рдЙрдиреНрдирдд рдПрдЖрдИ рдХреЛрд░реНрд╕ рдХреЗ рд╡рд┐рд╖рдп рд╣реИрдВред

**рдЕрд╕реНрд╡реАрдХрд░рдг**:
рдпрд╣ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдорд╢реАрди-рдЖрдзрд╛рд░рд┐рдд рдПрдЖрдИ рдЕрдиреБрд╡рд╛рдж рд╕реЗрд╡рд╛рдУрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЕрдиреБрд╡рд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред рдЬрдмрдХрд┐ рд╣рдо рд╕рдЯреАрдХрддрд╛ рдХреЗ рд▓рд┐рдП рдкреНрд░рдпрд╛рд╕ рдХрд░рддреЗ рд╣реИрдВ, рдХреГрдкрдпрд╛ рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдЕрдиреБрд╡рд╛рджреЛрдВ рдореЗрдВ рддреНрд░реБрдЯрд┐рдпрд╛рдБ рдпрд╛ рдЕрд╢реБрджреНрдзрд┐рдпрд╛рдБ рд╣реЛ рд╕рдХрддреА рд╣реИрдВред рдЕрдкрдиреА рдореВрд▓ рднрд╛рд╖рд╛ рдореЗрдВ рдореВрд▓ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдХреЛ рдЖрдзрд┐рдХрд╛рд░рд┐рдХ рд╕реНрд░реЛрдд рдорд╛рдирд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред рдорд╣рддреНрд╡рдкреВрд░реНрдг рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП, рдкреЗрд╢реЗрд╡рд░ рдорд╛рдирд╡ рдЕрдиреБрд╡рд╛рдж рдХреА рд╕рд┐рдлрд╛рд░рд┐рд╢ рдХреА рдЬрд╛рддреА рд╣реИред рдЗрд╕ рдЕрдиреБрд╡рд╛рдж рдХреЗ рдЙрдкрдпреЛрдЧ рд╕реЗ рдЙрддреНрдкрдиреНрди рдХрд┐рд╕реА рднреА рдЧрд▓рддрдлрд╣рдореА рдпрд╛ рдЧрд▓рдд рд╡реНрдпрд╛рдЦреНрдпрд╛ рдХреЗ рд▓рд┐рдП рд╣рдо рдЙрддреНрддрд░рджрд╛рдпреА рдирд╣реАрдВ рд╣реИрдВред