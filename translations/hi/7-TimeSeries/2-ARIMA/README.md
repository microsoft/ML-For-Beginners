<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "917dbf890db71a322f306050cb284749",
  "translation_date": "2025-09-05T10:17:13+00:00",
  "source_file": "7-TimeSeries/2-ARIMA/README.md",
  "language_code": "hi"
}
-->
# ARIMA рдХреЗ рд╕рд╛рде рд╕рдордп рд╢реНрд░реГрдВрдЦрд▓рд╛ рдкреВрд░реНрд╡рд╛рдиреБрдорд╛рди

рдкрд┐рдЫрд▓реЗ рдкрд╛рда рдореЗрдВ, рдЖрдкрдиреЗ рд╕рдордп рд╢реНрд░реГрдВрдЦрд▓рд╛ рдкреВрд░реНрд╡рд╛рдиреБрдорд╛рди рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдереЛрдбрд╝рд╛ рд╕реАрдЦрд╛ рдФрд░ рдПрдХ рдбреЗрдЯрд╛ рд╕реЗрдЯ рд▓реЛрдб рдХрд┐рдпрд╛ рдЬреЛ рдПрдХ рд╕рдордп рдЕрд╡рдзрд┐ рдХреЗ рджреМрд░рд╛рди рд╡рд┐рджреНрдпреБрдд рднрд╛рд░ рдореЗрдВ рдЙрддрд╛рд░-рдЪрдврд╝рд╛рд╡ рджрд┐рдЦрд╛рддрд╛ рд╣реИред

[![ARIMA рдХрд╛ рдкрд░рд┐рдЪрдп](https://img.youtube.com/vi/IUSk-YDau10/0.jpg)](https://youtu.be/IUSk-YDau10 "ARIMA рдХрд╛ рдкрд░рд┐рдЪрдп")

> ЁЯОе рдКрдкрд░ рджреА рдЧрдИ рдЫрд╡рд┐ рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВ: ARIMA рдореЙрдбрд▓ рдХрд╛ рд╕рдВрдХреНрд╖рд┐рдкреНрдд рдкрд░рд┐рдЪрдпред рдЙрджрд╛рд╣рд░рдг R рдореЗрдВ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдЕрд╡рдзрд╛рд░рдгрд╛рдПрдВ рд╕рд╛рд░реНрд╡рднреМрдорд┐рдХ рд╣реИрдВред

## [рдкреНрд░реА-рд▓реЗрдХреНрдЪрд░ рдХреНрд╡рд┐рдЬрд╝](https://ff-quizzes.netlify.app/en/ml/)

## рдкрд░рд┐рдЪрдп

рдЗрд╕ рдкрд╛рда рдореЗрдВ, рдЖрдк [ARIMA: *A*uto*R*egressive *I*ntegrated *M*oving *A*verage](https://wikipedia.org/wiki/Autoregressive_integrated_moving_average) рдХреЗ рд╕рд╛рде рдореЙрдбрд▓ рдмрдирд╛рдиреЗ рдХрд╛ рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ рддрд░реАрдХрд╛ рдЬрд╛рдиреЗрдВрдЧреЗред ARIMA рдореЙрдбрд▓ рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ [рдЧреИрд░-рд╕реНрдерд┐рд░рддрд╛](https://wikipedia.org/wiki/Stationary_process) рджрд┐рдЦрд╛рдиреЗ рд╡рд╛рд▓реЗ рдбреЗрдЯрд╛ рдХреЛ рдлрд┐рдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреБрдХреНрдд рд╣реИрдВред

## рд╕рд╛рдорд╛рдиреНрдп рдЕрд╡рдзрд╛рд░рдгрд╛рдПрдВ

ARIMA рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдкрдХреЛ рдХреБрдЫ рдЕрд╡рдзрд╛рд░рдгрд╛рдУрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдирд╛ рд╣реЛрдЧрд╛:

- ЁЯОУ **рд╕реНрдерд┐рд░рддрд╛**ред рд╕рд╛рдВрдЦреНрдпрд┐рдХреАрдп рд╕рдВрджрд░реНрдн рдореЗрдВ, рд╕реНрдерд┐рд░рддрд╛ рдЙрд╕ рдбреЗрдЯрд╛ рдХреЛ рд╕рдВрджрд░реНрднрд┐рдд рдХрд░рддреА рд╣реИ рдЬрд┐рд╕рдХрд╛ рд╡рд┐рддрд░рдг рд╕рдордп рдореЗрдВ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рд╣реЛрдиреЗ рдкрд░ рдирд╣реАрдВ рдмрджрд▓рддрд╛ред рдЧреИрд░-рд╕реНрдерд┐рд░ рдбреЗрдЯрд╛, рдлрд┐рд░, рд░реБрдЭрд╛рдиреЛрдВ рдХреЗ рдХрд╛рд░рдг рдЙрддрд╛рд░-рдЪрдврд╝рд╛рд╡ рджрд┐рдЦрд╛рддрд╛ рд╣реИ рдЬрд┐рд╕реЗ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдмрджрд▓рдирд╛ рдЖрд╡рд╢реНрдпрдХ рд╣реИред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдореМрд╕рдореАрддрд╛ рдбреЗрдЯрд╛ рдореЗрдВ рдЙрддрд╛рд░-рдЪрдврд╝рд╛рд╡ рд▓рд╛ рд╕рдХрддреА рд╣реИ рдФрд░ рдЗрд╕реЗ 'рдореМрд╕рдореА-рдбрд┐рдлрд░реЗрдВрд╕рд┐рдВрдЧ' рдХреА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рджреНрд╡рд╛рд░рд╛ рд╕рдорд╛рдкреНрдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

- ЁЯОУ **[рдбрд┐рдлрд░реЗрдВрд╕рд┐рдВрдЧ](https://wikipedia.org/wiki/Autoregressive_integrated_moving_average#Differencing)**ред рд╕рд╛рдВрдЦреНрдпрд┐рдХреАрдп рд╕рдВрджрд░реНрдн рдореЗрдВ, рдбрд┐рдлрд░реЗрдВрд╕рд┐рдВрдЧ рдбреЗрдЯрд╛ рдХреЛ рд╕реНрдерд┐рд░ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЗрд╕реЗ рдмрджрд▓рдиреЗ рдХреА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рд╕рдВрджрд░реНрднрд┐рдд рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдЗрд╕рдХреЗ рдЧреИрд░-рд╕реНрдерд┐рд░ рд░реБрдЭрд╛рди рдХреЛ рд╣рдЯрд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред "рдбрд┐рдлрд░реЗрдВрд╕рд┐рдВрдЧ рд╕рдордп рд╢реНрд░реГрдВрдЦрд▓рд╛ рдХреЗ рд╕реНрддрд░ рдореЗрдВ рдмрджрд▓рд╛рд╡ рдХреЛ рд╣рдЯрд╛рддрд╛ рд╣реИ, рд░реБрдЭрд╛рди рдФрд░ рдореМрд╕рдореАрддрд╛ рдХреЛ рд╕рдорд╛рдкреНрдд рдХрд░рддрд╛ рд╣реИ рдФрд░ рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк рд╕рдордп рд╢реНрд░реГрдВрдЦрд▓рд╛ рдХреЗ рдФрд╕рдд рдХреЛ рд╕реНрдерд┐рд░ рдХрд░рддрд╛ рд╣реИред" [Shixiong et al рджреНрд╡рд╛рд░рд╛ рдкреЗрдкрд░](https://arxiv.org/abs/1904.07632)

## рд╕рдордп рд╢реНрд░реГрдВрдЦрд▓рд╛ рдХреЗ рд╕рдВрджрд░реНрдн рдореЗрдВ ARIMA

ARIMA рдХреЗ рднрд╛рдЧреЛрдВ рдХреЛ рдмреЗрд╣рддрд░ рдврдВрдЧ рд╕реЗ рд╕рдордЭрдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдЗрдП рдЗрд╕реЗ рд╡рд┐рд╕реНрддрд╛рд░ рд╕реЗ рджреЗрдЦреЗрдВ рдХрд┐ рдпрд╣ рд╣рдореЗрдВ рд╕рдордп рд╢реНрд░реГрдВрдЦрд▓рд╛ рдХреЛ рдореЙрдбрд▓ рдХрд░рдиреЗ рдФрд░ рдЗрд╕рдХреЗ рдЦрд┐рд▓рд╛рдл рдкреВрд░реНрд╡рд╛рдиреБрдорд╛рди рдмрдирд╛рдиреЗ рдореЗрдВ рдХреИрд╕реЗ рдорджрдж рдХрд░рддрд╛ рд╣реИред

- **AR - рдСрдЯреЛрд░реЗрдЧреНрд░реЗрд╕рд┐рд╡ рдХреЗ рд▓рд┐рдП**ред рдЬреИрд╕рд╛ рдХрд┐ рдирд╛рдо рд╕реЗ рдкрддрд╛ рдЪрд▓рддрд╛ рд╣реИ, рдСрдЯреЛрд░реЗрдЧреНрд░реЗрд╕рд┐рд╡ рдореЙрдбрд▓ рд╕рдордп рдореЗрдВ 'рдкреАрдЫреЗ' рджреЗрдЦрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рдЖрдкрдХреЗ рдбреЗрдЯрд╛ рдореЗрдВ рдкрд┐рдЫрд▓реЗ рдорд╛рдиреЛрдВ рдХрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗ рдФрд░ рдЙрдирдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдзрд╛рд░рдгрд╛рдПрдВ рдмрдирд╛рдИ рдЬрд╛ рд╕рдХреЗрдВред рдЗрди рдкрд┐рдЫрд▓реЗ рдорд╛рдиреЛрдВ рдХреЛ 'рд▓реИрдЧреНрд╕' рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИред рдПрдХ рдЙрджрд╛рд╣рд░рдг рд╣реЛрдЧрд╛ рдбреЗрдЯрд╛ рдЬреЛ рдкреЗрдВрд╕рд┐рд▓ рдХреА рдорд╛рд╕рд┐рдХ рдмрд┐рдХреНрд░реА рджрд┐рдЦрд╛рддрд╛ рд╣реИред рдкреНрд░рддреНрдпреЗрдХ рдорд╣реАрдиреЗ рдХреА рдмрд┐рдХреНрд░реА рдХреБрд▓ рдХреЛ рдбреЗрдЯрд╛ рд╕реЗрдЯ рдореЗрдВ рдПрдХ 'рд╡рд┐рдХрд╕рд┐рдд рдЪрд░' рдорд╛рдирд╛ рдЬрд╛рдПрдЧрд╛ред рдпрд╣ рдореЙрдбрд▓ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдмрдирд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ рдХрд┐ "рд░реБрдЪрд┐ рдХрд╛ рд╡рд┐рдХрд╕рд┐рдд рдЪрд░ рдЕрдкрдиреЗ рд╕реНрд╡рдпрдВ рдХреЗ рд▓реИрдЧреНрдб (рдпрд╛рдиреА, рдкрд┐рдЫрд▓реЗ) рдорд╛рдиреЛрдВ рдкрд░ рдкреБрди: рд╕реНрдерд╛рдкрд┐рдд рд╣реЛрддрд╛ рд╣реИред" [рд╡рд┐рдХрд┐рдкреАрдбрд┐рдпрд╛](https://wikipedia.org/wiki/Autoregressive_integrated_moving_average)

- **I - рдЗрдВрдЯреАрдЧреНрд░реЗрдЯреЗрдб рдХреЗ рд▓рд┐рдП**ред рд╕рдорд╛рди 'ARMA' рдореЙрдбрд▓ рдХреЗ рд╡рд┐рдкрд░реАрдд, ARIMA рдореЗрдВ 'I' рдЗрд╕рдХреЗ *[рдЗрдВрдЯреАрдЧреНрд░реЗрдЯреЗрдб](https://wikipedia.org/wiki/Order_of_integration)* рдкрд╣рд▓реВ рдХреЛ рд╕рдВрджрд░реНрднрд┐рдд рдХрд░рддрд╛ рд╣реИред рдЧреИрд░-рд╕реНрдерд┐рд░рддрд╛ рдХреЛ рд╕рдорд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдбрд┐рдлрд░реЗрдВрд╕рд┐рдВрдЧ рдЪрд░рдг рд▓рд╛рдЧреВ рд╣реЛрдиреЗ рдкрд░ рдбреЗрдЯрд╛ 'рдЗрдВрдЯреАрдЧреНрд░реЗрдЯреЗрдб' рд╣реЛрддрд╛ рд╣реИред

- **MA - рдореВрд╡рд┐рдВрдЧ рдПрд╡рд░реЗрдЬ рдХреЗ рд▓рд┐рдП**ред рдЗрд╕ рдореЙрдбрд▓ рдХрд╛ [рдореВрд╡рд┐рдВрдЧ-рдПрд╡рд░реЗрдЬ](https://wikipedia.org/wiki/Moving-average_model) рдкрд╣рд▓реВ рдЖрдЙрдЯрдкреБрдЯ рд╡реЗрд░рд┐рдПрдмрд▓ рдХреЛ рд╕рдВрджрд░реНрднрд┐рдд рдХрд░рддрд╛ рд╣реИ рдЬреЛ рд▓реИрдЧреНрд╕ рдХреЗ рд╡рд░реНрддрдорд╛рди рдФрд░ рдкрд┐рдЫрд▓реЗ рдорд╛рдиреЛрдВ рдХреЛ рджреЗрдЦрдХрд░ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

рд╕рд╛рд░рд╛рдВрд╢: ARIMA рдХрд╛ рдЙрдкрдпреЛрдЧ рд╕рдордп рд╢реНрд░реГрдВрдЦрд▓рд╛ рдбреЗрдЯрд╛ рдХреЗ рд╡рд┐рд╢реЗрд╖ рд░реВрдк рдХреЛ рдпрдерд╛рд╕рдВрднрд╡ рдХрд░реАрдм рд╕реЗ рдлрд┐рдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

## рдЕрднреНрдпрд╛рд╕ - ARIMA рдореЙрдбрд▓ рдмрдирд╛рдПрдВ

рдЗрд╕ рдкрд╛рда рдореЗрдВ [_/working_](https://github.com/microsoft/ML-For-Beginners/tree/main/7-TimeSeries/2-ARIMA/working) рдлрд╝реЛрд▓реНрдбрд░ рдЦреЛрд▓реЗрдВ рдФрд░ [_notebook.ipynb_](https://github.com/microsoft/ML-For-Beginners/blob/main/7-TimeSeries/2-ARIMA/working/notebook.ipynb) рдлрд╝рд╛рдЗрд▓ рдЦреЛрдЬреЗрдВред

1. рдиреЛрдЯрдмреБрдХ рдЪрд▓рд╛рдПрдВ рддрд╛рдХрд┐ `statsmodels` Python рд▓рд╛рдЗрдмреНрд░реЗрд░реА рд▓реЛрдб рд╣реЛ рд╕рдХреЗ; рдЖрдкрдХреЛ ARIMA рдореЙрдбрд▓ рдХреЗ рд▓рд┐рдП рдЗрд╕рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдЧреАред

1. рдЖрд╡рд╢реНрдпрдХ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рд▓реЛрдб рдХрд░реЗрдВред

1. рдЕрдм, рдбреЗрдЯрд╛ рдХреЛ рдкреНрд▓реЙрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧреА рдХрдИ рдФрд░ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рд▓реЛрдб рдХрд░реЗрдВ:

    ```python
    import os
    import warnings
    import matplotlib.pyplot as plt
    import numpy as np
    import pandas as pd
    import datetime as dt
    import math

    from pandas.plotting import autocorrelation_plot
    from statsmodels.tsa.statespace.sarimax import SARIMAX
    from sklearn.preprocessing import MinMaxScaler
    from common.utils import load_data, mape
    from IPython.display import Image

    %matplotlib inline
    pd.options.display.float_format = '{:,.2f}'.format
    np.set_printoptions(precision=2)
    warnings.filterwarnings("ignore") # specify to ignore warning messages
    ```

1. `/data/energy.csv` рдлрд╝рд╛рдЗрд▓ рд╕реЗ рдбреЗрдЯрд╛ рдХреЛ рдПрдХ Pandas рдбреЗрдЯрд╛ рдлреНрд░реЗрдо рдореЗрдВ рд▓реЛрдб рдХрд░реЗрдВ рдФрд░ рдЗрд╕реЗ рджреЗрдЦреЗрдВ:

    ```python
    energy = load_data('./data')[['load']]
    energy.head(10)
    ```

1. рдЬрдирд╡рд░реА 2012 рд╕реЗ рджрд┐рд╕рдВрдмрд░ 2014 рддрдХ рдЙрдкрд▓рдмреНрдз рдКрд░реНрдЬрд╛ рдбреЗрдЯрд╛ рдХреЛ рдкреНрд▓реЙрдЯ рдХрд░реЗрдВред рдЗрд╕рдореЗрдВ рдХреЛрдИ рдЖрд╢реНрдЪрд░реНрдп рдирд╣реАрдВ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП рдХреНрдпреЛрдВрдХрд┐ рд╣рдордиреЗ рдпрд╣ рдбреЗрдЯрд╛ рдкрд┐рдЫрд▓реЗ рдкрд╛рда рдореЗрдВ рджреЗрдЦрд╛ рдерд╛:

    ```python
    energy.plot(y='load', subplots=True, figsize=(15, 8), fontsize=12)
    plt.xlabel('timestamp', fontsize=12)
    plt.ylabel('load', fontsize=12)
    plt.show()
    ```

    рдЕрдм, рдЖрдЗрдП рдПрдХ рдореЙрдбрд▓ рдмрдирд╛рдПрдВ!

### рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдФрд░ рдкрд░реАрдХреНрд╖рдг рдбреЗрдЯрд╛ рд╕реЗрдЯ рдмрдирд╛рдПрдВ

рдЕрдм рдЖрдкрдХрд╛ рдбреЗрдЯрд╛ рд▓реЛрдб рд╣реЛ рдЧрдпрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдЖрдк рдЗрд╕реЗ рдЯреНрд░реЗрди рдФрд░ рдЯреЗрд╕реНрдЯ рд╕реЗрдЯ рдореЗрдВ рд╡рд┐рднрд╛рдЬрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдЖрдк рдЕрдкрдиреЗ рдореЙрдбрд▓ рдХреЛ рдЯреНрд░реЗрди рд╕реЗрдЯ рдкрд░ рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдХрд░реЗрдВрдЧреЗред рд╣рдореЗрд╢рд╛ рдХреА рддрд░рд╣, рдореЙрдбрд▓ рдХреЗ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рд╕рдорд╛рдкреНрдд рд╣реЛрдиреЗ рдХреЗ рдмрд╛рдж, рдЖрдк рдЯреЗрд╕реНрдЯ рд╕реЗрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЗрд╕рдХреА рд╕рдЯреАрдХрддрд╛ рдХрд╛ рдореВрд▓реНрдпрд╛рдВрдХрди рдХрд░реЗрдВрдЧреЗред рдЖрдкрдХреЛ рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдирд╛ рд╣реЛрдЧрд╛ рдХрд┐ рдЯреЗрд╕реНрдЯ рд╕реЗрдЯ рдЯреНрд░реЗрдирд┐рдВрдЧ рд╕реЗрдЯ рдХреА рддреБрд▓рдирд╛ рдореЗрдВ рд╕рдордп рдХреА рдмрд╛рдж рдХреА рдЕрд╡рдзрд┐ рдХреЛ рдХрд╡рд░ рдХрд░рддрд╛ рд╣реИ рддрд╛рдХрд┐ рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рд╣реЛ рд╕рдХреЗ рдХрд┐ рдореЙрдбрд▓ рднрд╡рд┐рд╖реНрдп рдХреА рд╕рдордп рдЕрд╡рдзрд┐ рд╕реЗ рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рд╛рдкреНрдд рди рдХрд░реЗред

1. рд╕рд┐рддрдВрдмрд░ 1 рд╕реЗ рдЕрдХреНрдЯреВрдмрд░ 31, 2014 рддрдХ рдХреА рджреЛ рдорд╣реАрдиреЗ рдХреА рдЕрд╡рдзрд┐ рдХреЛ рдЯреНрд░реЗрдирд┐рдВрдЧ рд╕реЗрдЯ рдореЗрдВ рдЖрд╡рдВрдЯрд┐рдд рдХрд░реЗрдВред рдЯреЗрд╕реНрдЯ рд╕реЗрдЯ рдореЗрдВ рдирд╡рдВрдмрд░ 1 рд╕реЗ рджрд┐рд╕рдВрдмрд░ 31, 2014 рддрдХ рдХреА рджреЛ рдорд╣реАрдиреЗ рдХреА рдЕрд╡рдзрд┐ рд╢рд╛рдорд┐рд▓ рд╣реЛрдЧреА:

    ```python
    train_start_dt = '2014-11-01 00:00:00'
    test_start_dt = '2014-12-30 00:00:00'
    ```

    рдЪреВрдВрдХрд┐ рдпрд╣ рдбреЗрдЯрд╛ рдКрд░реНрдЬрд╛ рдХреА рджреИрдирд┐рдХ рдЦрдкрдд рдХреЛ рджрд░реНрд╢рд╛рддрд╛ рд╣реИ, рдЗрд╕рдореЗрдВ рдПрдХ рдордЬрдмреВрдд рдореМрд╕рдореА рдкреИрдЯрд░реНрди рд╣реИ, рд▓реЗрдХрд┐рди рдЦрдкрдд рд╣рд╛рд▓ рдХреЗ рджрд┐рдиреЛрдВ рдХреА рдЦрдкрдд рдХреЗ рд╕рдорд╛рди рд╣реИред

1. рдЕрдВрддрд░ рдХреЛ рд╡рд┐рдЬрд╝реБрдЕрд▓рд╛рдЗрдЬрд╝ рдХрд░реЗрдВ:

    ```python
    energy[(energy.index < test_start_dt) & (energy.index >= train_start_dt)][['load']].rename(columns={'load':'train'}) \
        .join(energy[test_start_dt:][['load']].rename(columns={'load':'test'}), how='outer') \
        .plot(y=['train', 'test'], figsize=(15, 8), fontsize=12)
    plt.xlabel('timestamp', fontsize=12)
    plt.ylabel('load', fontsize=12)
    plt.show()
    ```

    ![рдЯреНрд░реЗрдирд┐рдВрдЧ рдФрд░ рдЯреЗрд╕реНрдЯрд┐рдВрдЧ рдбреЗрдЯрд╛](../../../../7-TimeSeries/2-ARIMA/images/train-test.png)

    рдЗрд╕рд▓рд┐рдП, рдбреЗрдЯрд╛ рдХреЛ рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдкреЗрдХреНрд╖рд╛рдХреГрдд рдЫреЛрдЯреЗ рд╕рдордп рд╡рд┐рдВрдбреЛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдкрд░реНрдпрд╛рдкреНрдд рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред

    > рдиреЛрдЯ: рдЪреВрдВрдХрд┐ рд╣рдо ARIMA рдореЙрдбрд▓ рдХреЛ рдлрд┐рдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рдлрд╝рдВрдХреНрд╢рди рдореЗрдВ рдлрд┐рдЯрд┐рдВрдЧ рдХреЗ рджреМрд░рд╛рди рдЗрди-рд╕реИрдВрдкрд▓ рдорд╛рдиреНрдпрддрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ, рд╣рдо рдорд╛рдиреНрдпрддрд╛ рдбреЗрдЯрд╛ рдХреЛ рдЫреЛрдбрд╝ рджреЗрдВрдЧреЗред

### рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХреЗ рд▓рд┐рдП рдбреЗрдЯрд╛ рддреИрдпрд╛рд░ рдХрд░реЗрдВ

рдЕрдм, рдЖрдкрдХреЛ рдбреЗрдЯрд╛ рдХреЛ рдлрд╝рд┐рд▓реНрдЯрд░ рдФрд░ рд╕реНрдХреЗрд▓ рдХрд░рдХреЗ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХреЗ рд▓рд┐рдП рддреИрдпрд╛рд░ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред рдЕрдкрдиреЗ рдбреЗрдЯрд╛ рд╕реЗрдЯ рдХреЛ рдХреЗрд╡рд▓ рдЖрд╡рд╢реНрдпрдХ рд╕рдордп рдЕрд╡рдзрд┐ рдФрд░ рдХреЙрд▓рдо рд╢рд╛рдорд┐рд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдлрд╝рд┐рд▓реНрдЯрд░ рдХрд░реЗрдВ, рдФрд░ рдбреЗрдЯрд╛ рдХреЛ 0,1 рдХреЗ рдЕрдВрддрд░рд╛рд▓ рдореЗрдВ рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реНрдХреЗрд▓ рдХрд░реЗрдВред

1. рдореВрд▓ рдбреЗрдЯрд╛ рд╕реЗрдЯ рдХреЛ рдХреЗрд╡рд▓ рдЙрдкрд░реЛрдХреНрдд рд╕рдордп рдЕрд╡рдзрд┐ рдкреНрд░рддрд┐ рд╕реЗрдЯ рдФрд░ рдХреЗрд╡рд▓ рдЖрд╡рд╢реНрдпрдХ рдХреЙрд▓рдо 'рд▓реЛрдб' рдФрд░ рддрд╛рд░реАрдЦ рдХреЛ рд╢рд╛рдорд┐рд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдлрд╝рд┐рд▓реНрдЯрд░ рдХрд░реЗрдВ:

    ```python
    train = energy.copy()[(energy.index >= train_start_dt) & (energy.index < test_start_dt)][['load']]
    test = energy.copy()[energy.index >= test_start_dt][['load']]

    print('Training data shape: ', train.shape)
    print('Test data shape: ', test.shape)
    ```

    рдЖрдк рдбреЗрдЯрд╛ рдХрд╛ рдЖрдХрд╛рд░ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ:

    ```output
    Training data shape:  (1416, 1)
    Test data shape:  (48, 1)
    ```

1. рдбреЗрдЯрд╛ рдХреЛ (0, 1) рдХреА рд╕реАрдорд╛ рдореЗрдВ рд╕реНрдХреЗрд▓ рдХрд░реЗрдВред

    ```python
    scaler = MinMaxScaler()
    train['load'] = scaler.fit_transform(train)
    train.head(10)
    ```

1. рдореВрд▓ рдмрдирд╛рдо рд╕реНрдХреЗрд▓ рдХрд┐рдП рдЧрдП рдбреЗрдЯрд╛ рдХреЛ рд╡рд┐рдЬрд╝реБрдЕрд▓рд╛рдЗрдЬрд╝ рдХрд░реЗрдВ:

    ```python
    energy[(energy.index >= train_start_dt) & (energy.index < test_start_dt)][['load']].rename(columns={'load':'original load'}).plot.hist(bins=100, fontsize=12)
    train.rename(columns={'load':'scaled load'}).plot.hist(bins=100, fontsize=12)
    plt.show()
    ```

    ![рдореВрд▓](../../../../7-TimeSeries/2-ARIMA/images/original.png)

    > рдореВрд▓ рдбреЗрдЯрд╛

    ![рд╕реНрдХреЗрд▓ рдХрд┐рдпрд╛ рдЧрдпрд╛](../../../../7-TimeSeries/2-ARIMA/images/scaled.png)

    > рд╕реНрдХреЗрд▓ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдбреЗрдЯрд╛

1. рдЕрдм рдЬрдм рдЖрдкрдиреЗ рд╕реНрдХреЗрд▓ рдХрд┐рдП рдЧрдП рдбреЗрдЯрд╛ рдХреЛ рдХреИрд▓рд┐рдмреНрд░реЗрдЯ рдХрд░ рд▓рд┐рдпрд╛ рд╣реИ, рддреЛ рдЖрдк рдЯреЗрд╕реНрдЯ рдбреЗрдЯрд╛ рдХреЛ рд╕реНрдХреЗрд▓ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

    ```python
    test['load'] = scaler.transform(test)
    test.head()
    ```

### ARIMA рд▓рд╛рдЧреВ рдХрд░реЗрдВ

рдЕрдм ARIMA рдХреЛ рд▓рд╛рдЧреВ рдХрд░рдиреЗ рдХрд╛ рд╕рдордп рд╣реИ! рдЖрдк рдЕрдм `statsmodels` рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗ рдЬрд┐рд╕реЗ рдЖрдкрдиреЗ рдкрд╣рд▓реЗ рдЗрдВрд╕реНрдЯреЙрд▓ рдХрд┐рдпрд╛ рдерд╛ред

рдЕрдм рдЖрдкрдХреЛ рдХрдИ рдЪрд░рдгреЛрдВ рдХрд╛ рдкрд╛рд▓рди рдХрд░рдирд╛ рд╣реЛрдЧрд╛:

   1. рдореЙрдбрд▓ рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░реЗрдВ `SARIMAX()` рдХреЛ рдХреЙрд▓ рдХрд░рдХреЗ рдФрд░ рдореЙрдбрд▓ рдкреИрд░рд╛рдореАрдЯрд░: p, d, рдФрд░ q рдкреИрд░рд╛рдореАрдЯрд░, рдФрд░ P, D, рдФрд░ Q рдкреИрд░рд╛рдореАрдЯрд░ рдкрд╛рд╕ рдХрд░реЗрдВред
   2. рдЯреНрд░реЗрдирд┐рдВрдЧ рдбреЗрдЯрд╛ рдХреЗ рд▓рд┐рдП рдореЙрдбрд▓ рддреИрдпрд╛рд░ рдХрд░реЗрдВ `fit()` рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдХреЙрд▓ рдХрд░рдХреЗред
   3. рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА рдХрд░реЗрдВ `forecast()` рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдХреЙрд▓ рдХрд░рдХреЗ рдФрд░ рдкреВрд░реНрд╡рд╛рдиреБрдорд╛рди рдХреЗ рд▓рд┐рдП рдЪрд░рдгреЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ (рд╣реЛрд░рд╛рдЗрдЬрди) рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░реЗрдВред

> ЁЯОУ рдпреЗ рд╕рднреА рдкреИрд░рд╛рдореАрдЯрд░ рдХрд┐рд╕ рд▓рд┐рдП рд╣реИрдВ? ARIMA рдореЙрдбрд▓ рдореЗрдВ 3 рдкреИрд░рд╛рдореАрдЯрд░ рд╣реЛрддреЗ рд╣реИрдВ рдЬреЛ рд╕рдордп рд╢реНрд░реГрдВрдЦрд▓рд╛ рдХреЗ рдкреНрд░рдореБрдЦ рдкрд╣рд▓реБрдУрдВ рдХреЛ рдореЙрдбрд▓ рдХрд░рдиреЗ рдореЗрдВ рдорджрдж рдХрд░рддреЗ рд╣реИрдВ: рдореМрд╕рдореАрддрд╛, рд░реБрдЭрд╛рди, рдФрд░ рд╢реЛрд░ред рдпреЗ рдкреИрд░рд╛рдореАрдЯрд░ рд╣реИрдВ:

`p`: рдореЙрдбрд▓ рдХреЗ рдСрдЯреЛ-рд░реЗрдЧреНрд░реЗрд╕рд┐рд╡ рдкрд╣рд▓реВ рд╕реЗ рдЬреБрдбрд╝рд╛ рдкреИрд░рд╛рдореАрдЯрд░, рдЬреЛ *рдкрд┐рдЫрд▓реЗ* рдорд╛рдиреЛрдВ рдХреЛ рд╢рд╛рдорд┐рд▓ рдХрд░рддрд╛ рд╣реИред
`d`: рдореЙрдбрд▓ рдХреЗ рдЗрдВрдЯреАрдЧреНрд░реЗрдЯреЗрдб рднрд╛рдЧ рд╕реЗ рдЬреБрдбрд╝рд╛ рдкреИрд░рд╛рдореАрдЯрд░, рдЬреЛ рд╕рдордп рд╢реНрд░реГрдВрдЦрд▓рд╛ рдкрд░ рд▓рд╛рдЧреВ *рдбрд┐рдлрд░реЗрдВрд╕рд┐рдВрдЧ* (ЁЯОУ рдбрд┐рдлрд░реЗрдВрд╕рд┐рдВрдЧ рдпрд╛рдж рд╣реИ ЁЯСЖ?) рдХреА рдорд╛рддреНрд░рд╛ рдХреЛ рдкреНрд░рднрд╛рд╡рд┐рдд рдХрд░рддрд╛ рд╣реИред
`q`: рдореЙрдбрд▓ рдХреЗ рдореВрд╡рд┐рдВрдЧ-рдПрд╡рд░реЗрдЬ рднрд╛рдЧ рд╕реЗ рдЬреБрдбрд╝рд╛ рдкреИрд░рд╛рдореАрдЯрд░ред

> рдиреЛрдЯ: рдпрджрд┐ рдЖрдкрдХреЗ рдбреЗрдЯрд╛ рдореЗрдВ рдореМрд╕рдореА рдкрд╣рд▓реВ рд╣реИ - рдЬреИрд╕рд╛ рдХрд┐ рдЗрд╕ рдбреЗрдЯрд╛ рдореЗрдВ рд╣реИ - рддреЛ рд╣рдо рдореМрд╕рдореА ARIMA рдореЙрдбрд▓ (SARIMA) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ рдЖрдкрдХреЛ рдкреИрд░рд╛рдореАрдЯрд░ рдХрд╛ рдПрдХ рдФрд░ рд╕реЗрдЯ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╣реЛрдЧрд╛: `P`, `D`, рдФрд░ `Q` рдЬреЛ `p`, `d`, рдФрд░ `q` рдХреЗ рд╕рдорд╛рди рд╕рдВрдШреЛрдВ рдХрд╛ рд╡рд░реНрдгрди рдХрд░рддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдореЙрдбрд▓ рдХреЗ рдореМрд╕рдореА рдШрдЯрдХреЛрдВ рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рд╣реИрдВред

1. рдЕрдкрдиреЗ рдкрд╕рдВрджреАрджрд╛ рд╣реЛрд░рд╛рдЗрдЬрди рдорд╛рди рд╕реЗрдЯ рдХрд░реЗрдВред рдЪрд▓рд┐рдП 3 рдШрдВрдЯреЗ рдЖрдЬрд╝рдорд╛рддреЗ рд╣реИрдВ:

    ```python
    # Specify the number of steps to forecast ahead
    HORIZON = 3
    print('Forecasting horizon:', HORIZON, 'hours')
    ```

    ARIMA рдореЙрдбрд▓ рдХреЗ рдкреИрд░рд╛рдореАрдЯрд░ рдХреЗ рд▓рд┐рдП рд╕рд░реНрд╡реЛрддреНрддрдо рдорд╛рди рдЪреБрдирдирд╛ рдЪреБрдиреМрддреАрдкреВрд░реНрдг рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рдХреБрдЫ рд╣рдж рддрдХ рд╡реНрдпрдХреНрддрд┐рдкрд░рдХ рдФрд░ рд╕рдордп рд▓реЗрдиреЗ рд╡рд╛рд▓рд╛ рд╣реИред рдЖрдк [`pyramid` рд▓рд╛рдЗрдмреНрд░реЗрд░реА](https://alkaline-ml.com/pmdarima/0.9.0/modules/generated/pyramid.arima.auto_arima.html) рд╕реЗ `auto_arima()` рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдкрд░ рд╡рд┐рдЪрд╛рд░ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

1. рдлрд┐рд▓рд╣рд╛рд▓ рдХреБрдЫ рдореИрдиреБрдЕрд▓ рдЪрдпрди рдЖрдЬрд╝рдорд╛рдПрдВ рддрд╛рдХрд┐ рдПрдХ рдЕрдЪреНрдЫрд╛ рдореЙрдбрд▓ рдорд┐рд▓ рд╕рдХреЗред

    ```python
    order = (4, 1, 0)
    seasonal_order = (1, 1, 0, 24)

    model = SARIMAX(endog=train, order=order, seasonal_order=seasonal_order)
    results = model.fit()

    print(results.summary())
    ```

    рдкрд░рд┐рдгрд╛рдореЛрдВ рдХреА рдПрдХ рддрд╛рд▓рд┐рдХрд╛ рдкреНрд░рд┐рдВрдЯ рдХреА рдЬрд╛рддреА рд╣реИред

рдЖрдкрдиреЗ рдЕрдкрдирд╛ рдкрд╣рд▓рд╛ рдореЙрдбрд▓ рдмрдирд╛ рд▓рд┐рдпрд╛ рд╣реИ! рдЕрдм рд╣рдореЗрдВ рдЗрд╕реЗ рдореВрд▓реНрдпрд╛рдВрдХрди рдХрд░рдиреЗ рдХрд╛ рддрд░реАрдХрд╛ рдЦреЛрдЬрдирд╛ рд╣реЛрдЧрд╛ред

### рдЕрдкрдиреЗ рдореЙрдбрд▓ рдХрд╛ рдореВрд▓реНрдпрд╛рдВрдХрди рдХрд░реЗрдВ

рдЕрдкрдиреЗ рдореЙрдбрд▓ рдХрд╛ рдореВрд▓реНрдпрд╛рдВрдХрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдк рддрдерд╛рдХрдерд┐рдд `рд╡реЙрдХ рдлреЙрд░рд╡рд░реНрдб` рдорд╛рдиреНрдпрддрд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рд╡реНрдпрд╡рд╣рд╛рд░ рдореЗрдВ, рд╕рдордп рд╢реНрд░реГрдВрдЦрд▓рд╛ рдореЙрдбрд▓ рд╣рд░ рдмрд╛рд░ рдЬрдм рдирдпрд╛ рдбреЗрдЯрд╛ рдЙрдкрд▓рдмреНрдз рд╣реЛрддрд╛ рд╣реИ рддреЛ рдкреБрдирдГ рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВред рдпрд╣ рдореЙрдбрд▓ рдХреЛ рдкреНрд░рддреНрдпреЗрдХ рд╕рдордп рдЪрд░рдг рдкрд░ рд╕рдмрд╕реЗ рдЕрдЪреНрдЫрд╛ рдкреВрд░реНрд╡рд╛рдиреБрдорд╛рди рдмрдирд╛рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред

рдЗрд╕ рддрдХрдиреАрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реБрдП рд╕рдордп рд╢реНрд░реГрдВрдЦрд▓рд╛ рдХреА рд╢реБрд░реБрдЖрдд рдореЗрдВ, рдЯреНрд░реЗрди рдбреЗрдЯрд╛ рд╕реЗрдЯ рдкрд░ рдореЙрдбрд▓ рдХреЛ рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдХрд░реЗрдВред рдлрд┐рд░ рдЕрдЧрд▓реЗ рд╕рдордп рдЪрд░рдг рдкрд░ рдПрдХ рдкреВрд░реНрд╡рд╛рдиреБрдорд╛рди рдмрдирд╛рдПрдВред рдкреВрд░реНрд╡рд╛рдиреБрдорд╛рди рдЬреНрдЮрд╛рдд рдорд╛рди рдХреЗ рдЦрд┐рд▓рд╛рдл рдореВрд▓реНрдпрд╛рдВрдХрди рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдлрд┐рд░ рдЯреНрд░реЗрдирд┐рдВрдЧ рд╕реЗрдЯ рдХреЛ рдЬреНрдЮрд╛рдд рдорд╛рди рдХреЛ рд╢рд╛рдорд┐рд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╡рд┐рд╕реНрддрд╛рд░рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рджреЛрд╣рд░рд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

> рдиреЛрдЯ: рдЕрдзрд┐рдХ рдХреБрд╢рд▓ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХреЗ рд▓рд┐рдП рдЖрдкрдХреЛ рдЯреНрд░реЗрдирд┐рдВрдЧ рд╕реЗрдЯ рд╡рд┐рдВрдбреЛ рдХреЛ рд╕реНрдерд┐рд░ рд░рдЦрдирд╛ рдЪрд╛рд╣рд┐рдП рддрд╛рдХрд┐ рд╣рд░ рдмрд╛рд░ рдЬрдм рдЖрдк рдЯреНрд░реЗрдирд┐рдВрдЧ рд╕реЗрдЯ рдореЗрдВ рдПрдХ рдирдпрд╛ рдЕрд╡рд▓реЛрдХрди рдЬреЛрдбрд╝реЗрдВ, рддреЛ рдЖрдк рд╕реЗрдЯ рдХреА рд╢реБрд░реБрдЖрдд рд╕реЗ рдЕрд╡рд▓реЛрдХрди рдХреЛ рд╣рдЯрд╛ рджреЗрдВред

рдпрд╣ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдореЙрдбрд▓ рдХреЗ рд╡реНрдпрд╡рд╣рд╛рд░рд┐рдХ рдкреНрд░рджрд░реНрд╢рди рдХрд╛ рдЕрдзрд┐рдХ рдордЬрдмреВрдд рдЕрдиреБрдорд╛рди рдкреНрд░рджрд╛рди рдХрд░рддреА рд╣реИред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдЗрддрдиреЗ рд╕рд╛рд░реЗ рдореЙрдбрд▓ рдмрдирд╛рдиреЗ рдХреА рдЧрдгрдирд╛ рд▓рд╛рдЧрдд рдЖрддреА рд╣реИред рдпрджрд┐ рдбреЗрдЯрд╛ рдЫреЛрдЯрд╛ рд╣реИ рдпрд╛ рдореЙрдбрд▓ рд╕рд░рд▓ рд╣реИ рддреЛ рдпрд╣ рд╕реНрд╡реАрдХрд╛рд░реНрдп рд╣реИ, рд▓реЗрдХрд┐рди рдмрдбрд╝реЗ рдкреИрдорд╛рдиреЗ рдкрд░ рд╕рдорд╕реНрдпрд╛ рд╣реЛ рд╕рдХрддреА рд╣реИред

рд╡реЙрдХ-рдлреЙрд░рд╡рд░реНрдб рдорд╛рдиреНрдпрддрд╛ рд╕рдордп рд╢реНрд░реГрдВрдЦрд▓рд╛ рдореЙрдбрд▓ рдореВрд▓реНрдпрд╛рдВрдХрди рдХрд╛ рд╕реНрд╡рд░реНрдг рдорд╛рдирдХ рд╣реИ рдФрд░ рдЗрд╕реЗ рдЖрдкрдХреЗ рдЕрдкрдиреЗ рдкреНрд░реЛрдЬреЗрдХреНрдЯреНрд╕ рдХреЗ рд▓рд┐рдП рдЕрдиреБрд╢рдВрд╕рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

1. рдкрд╣рд▓реЗ, рдкреНрд░рддреНрдпреЗрдХ HORIZON рдЪрд░рдг рдХреЗ рд▓рд┐рдП рдПрдХ рдЯреЗрд╕реНрдЯ рдбреЗрдЯрд╛ рдкреЙрдЗрдВрдЯ рдмрдирд╛рдПрдВред

    ```python
    test_shifted = test.copy()

    for t in range(1, HORIZON+1):
        test_shifted['load+'+str(t)] = test_shifted['load'].shift(-t, freq='H')

    test_shifted = test_shifted.dropna(how='any')
    test_shifted.head(5)
    ```

    |            |          | рд▓реЛрдб | рд▓реЛрдб+1 | рд▓реЛрдб+2 |
    | ---------- | -------- | ---- | ------ | ------ |
    | 2014-12-30 | 00:00:00 | 0.33 | 0.29   | 0.27   |
    | 2014-12-30 | 01:00:00 | 0.29 | 0.27   | 0.27   |
    | 2014-12-30 | 02:00:00 | 0.27 | 0.27   | 0.30   |
    | 2014-12-30 | 03:00:00 | 0.27 | 0.30   | 0.41   |
    | 2014-12-30 | 04:00:00 | 0.30 | 0.41   | 0.57   |

    рдбреЗрдЯрд╛ рдХреЛ рдЗрд╕рдХреЗ рд╣реЛрд░рд╛рдЗрдЬрди рдкреЙрдЗрдВрдЯ рдХреЗ рдЕрдиреБрд╕рд╛рд░ рдХреНрд╖реИрддрд┐рдЬ рд░реВрдк рд╕реЗ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

1. рд╕реНрд▓рд╛рдЗрдбрд┐рдВрдЧ рд╡рд┐рдВрдбреЛ рджреГрд╖реНрдЯрд┐рдХреЛрдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЕрдкрдиреЗ рдЯреЗрд╕реНрдЯ рдбреЗрдЯрд╛ рдкрд░ рдкреВрд░реНрд╡рд╛рдиреБрдорд╛рди рдмрдирд╛рдПрдВ, рдЬреЛ рдЯреЗрд╕реНрдЯ рдбреЗрдЯрд╛ рдХреА рд▓рдВрдмрд╛рдИ рдХреЗ рдЖрдХрд╛рд░ рдореЗрдВ рдПрдХ рд▓реВрдк рдореЗрдВ рд╣реЛ:

    ```python
    %%time
    training_window = 720 # dedicate 30 days (720 hours) for training

    train_ts = train['load']
    test_ts = test_shifted

    history = [x for x in train_ts]
    history = history[(-training_window):]

    predictions = list()

    order = (2, 1, 0)
    seasonal_order = (1, 1, 0, 24)

    for t in range(test_ts.shape[0]):
        model = SARIMAX(endog=history, order=order, seasonal_order=seasonal_order)
        model_fit = model.fit()
        yhat = model_fit.forecast(steps = HORIZON)
        predictions.append(yhat)
        obs = list(test_ts.iloc[t])
        # move the training window
        history.append(obs[0])
        history.pop(0)
        print(test_ts.index[t])
        print(t+1, ': predicted =', yhat, 'expected =', obs)
    ```

    рдЖрдк рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХреЛ рд╣реЛрддреЗ рд╣реБрдП рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ:

    ```output
    2014-12-30 00:00:00
    1 : predicted = [0.32 0.29 0.28] expected = [0.32945389435989236, 0.2900626678603402, 0.2739480752014323]

    2014-12-30 01:00:00
    2 : predicted = [0.3  0.29 0.3 ] expected = [0.2900626678603402, 0.2739480752014323, 0.26812891674127126]

    2014-12-30 02:00:00
    3 : predicted = [0.27 0.28 0.32] expected = [0.2739480752014323, 0.26812891674127126, 0.3025962399283795]
    ```

1. рдкреВрд░реНрд╡рд╛рдиреБрдорд╛рди рдХреЛ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд▓реЛрдб рд╕реЗ рддреБрд▓рдирд╛ рдХрд░реЗрдВ:

    ```python
    eval_df = pd.DataFrame(predictions, columns=['t+'+str(t) for t in range(1, HORIZON+1)])
    eval_df['timestamp'] = test.index[0:len(test.index)-HORIZON+1]
    eval_df = pd.melt(eval_df, id_vars='timestamp', value_name='prediction', var_name='h')
    eval_df['actual'] = np.array(np.transpose(test_ts)).ravel()
    eval_df[['prediction', 'actual']] = scaler.inverse_transform(eval_df[['prediction', 'actual']])
    eval_df.head()
    ```

    рдЖрдЙрдЯрдкреБрдЯ
    |     |            | рдЯрд╛рдЗрдорд╕реНрдЯреИрдореНрдк | h   | рдкреВрд░реНрд╡рд╛рдиреБрдорд╛рди | рд╡рд╛рд╕реНрддрд╡рд┐рдХ   |
    | --- | ---------- | --------- | --- | ---------- | -------- |
    | 0   | 2014-12-30 | 00:00:00  | t+1 | 3,008.74   | 3,023.00 |
    | 1   | 2014-12-30 | 01:00:00  | t+1 | 2,955.53   | 2,935.00 |
    | 2   | 2014-12-30 | 02:00:00  | t+1 | 2,900.17   | 2,899.00 |
    | 3   | 2014-12-30 | 03:00:00  | t+1 | 2,917.69   | 2,886.00 |
    | 4   | 2014-12-30 | 04:00:00  | t+1 | 2,946.99   | 2,963.00 |

    рдШрдВрдЯреЗрд╡рд╛рд░ рдбреЗрдЯрд╛ рдХреЗ рдкреВрд░реНрд╡рд╛рдиреБрдорд╛рди рдХреЛ рджреЗрдЦреЗрдВ, рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд▓реЛрдб рдХреА рддреБрд▓рдирд╛ рдореЗрдВред рдпрд╣ рдХрд┐рддрдирд╛ рд╕рдЯреАрдХ рд╣реИ?

### рдореЙрдбрд▓ рдХреА рд╕рдЯреАрдХрддрд╛ рдЬрд╛рдВрдЪреЗрдВ

рдЕрдкрдиреЗ рдореЙрдбрд▓ рдХреА рд╕рдЯреАрдХрддрд╛ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ рд╕рднреА рдкреВрд░реНрд╡рд╛рдиреБрдорд╛рдиреЛрдВ рдкрд░ рдЗрд╕рдХреЗ рдФрд╕рдд рдкреНрд░рддрд┐рд╢рдд рддреНрд░реБрдЯрд┐ (MAPE) рдХрд╛ рдкрд░реАрдХреНрд╖рдг рдХрд░рдХреЗред
> **ЁЯзо рдЧрдгрдирд╛ рдХреЛ рд╕рдордЭреЗрдВ**
>
> ![MAPE](../../../../7-TimeSeries/2-ARIMA/images/mape.png)
>
> [MAPE](https://www.linkedin.com/pulse/what-mape-mad-msd-time-series-allameh-statistics/) рдХрд╛ рдЙрдкрдпреЛрдЧ рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА рдХреА рд╕рдЯреАрдХрддрд╛ рдХреЛ рдПрдХ рдЕрдиреБрдкрд╛рдд рдХреЗ рд░реВрдк рдореЗрдВ рджрд┐рдЦрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬрд┐рд╕реЗ рдКрдкрд░ рджрд┐рдП рдЧрдП рд╕реВрддреНрд░ рджреНрд╡рд╛рд░рд╛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдФрд░ рдЕрдиреБрдорд╛рдирд┐рдд рдХреЗ рдмреАрдЪ рдХрд╛ рдЕрдВрддрд░ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд╕реЗ рд╡рд┐рднрд╛рдЬрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред  
> "рдЗрд╕ рдЧрдгрдирд╛ рдореЗрдВ рд▓рд┐рдП рдЧрдП рдкреВрд░реНрдг рдорд╛рди рдХреЛ рд╕рдордп рдХреЗ рдкреНрд░рддреНрдпреЗрдХ рдкреВрд░реНрд╡рд╛рдиреБрдорд╛рдирд┐рдд рдмрд┐рдВрджреБ рдХреЗ рд▓рд┐рдП рдЬреЛрдбрд╝рд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдлрд┐рдЯ рдХрд┐рдП рдЧрдП рдмрд┐рдВрджреБрдУрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ n рд╕реЗ рд╡рд┐рднрд╛рдЬрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред" [рд╡рд┐рдХрд┐рдкреАрдбрд┐рдпрд╛](https://wikipedia.org/wiki/Mean_absolute_percentage_error)
1. рдХреЛрдб рдореЗрдВ рд╕рдореАрдХрд░рдг рд╡реНрдпрдХреНрдд рдХрд░реЗрдВ:

    ```python
    if(HORIZON > 1):
        eval_df['APE'] = (eval_df['prediction'] - eval_df['actual']).abs() / eval_df['actual']
        print(eval_df.groupby('h')['APE'].mean())
    ```

1. рдПрдХ рдЪрд░рдг рдХрд╛ MAPE рдирд┐рдХрд╛рд▓реЗрдВ:

    ```python
    print('One step forecast MAPE: ', (mape(eval_df[eval_df['h'] == 't+1']['prediction'], eval_df[eval_df['h'] == 't+1']['actual']))*100, '%')
    ```

    рдПрдХ рдЪрд░рдг рдХрд╛ рдкреВрд░реНрд╡рд╛рдиреБрдорд╛рди MAPE:  0.5570581332313952 %

1. рдмрд╣реБ-рдЪрд░рдг рдкреВрд░реНрд╡рд╛рдиреБрдорд╛рди MAPE рдкреНрд░рд┐рдВрдЯ рдХрд░реЗрдВ:

    ```python
    print('Multi-step forecast MAPE: ', mape(eval_df['prediction'], eval_df['actual'])*100, '%')
    ```

    ```output
    Multi-step forecast MAPE:  1.1460048657704118 %
    ```

    рдПрдХ рдЕрдЪреНрдЫрд╛ рдХрдо рд╕рдВрдЦреНрдпрд╛ рдмреЗрд╣рддрд░ рд╣реИ: рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдпрджрд┐ рдХрд┐рд╕реА рдкреВрд░реНрд╡рд╛рдиреБрдорд╛рди рдХрд╛ MAPE 10 рд╣реИ, рддреЛ рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рдпрд╣ 10% рддрдХ рдЧрд▓рдд рд╣реИред

1. рд▓реЗрдХрд┐рди рд╣рдореЗрд╢рд╛ рдХреА рддрд░рд╣, рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдХреА рд╕рдЯреАрдХрддрд╛ рдорд╛рдк рдХреЛ рджреГрд╢реНрдп рд░реВрдк рдореЗрдВ рджреЗрдЦрдирд╛ рдЖрд╕рд╛рди рд╣реЛрддрд╛ рд╣реИ, рддреЛ рдЪрд▓рд┐рдП рдЗрд╕реЗ рдкреНрд▓реЙрдЯ рдХрд░рддреЗ рд╣реИрдВ:

    ```python
     if(HORIZON == 1):
        ## Plotting single step forecast
        eval_df.plot(x='timestamp', y=['actual', 'prediction'], style=['r', 'b'], figsize=(15, 8))

    else:
        ## Plotting multi step forecast
        plot_df = eval_df[(eval_df.h=='t+1')][['timestamp', 'actual']]
        for t in range(1, HORIZON+1):
            plot_df['t+'+str(t)] = eval_df[(eval_df.h=='t+'+str(t))]['prediction'].values

        fig = plt.figure(figsize=(15, 8))
        ax = plt.plot(plot_df['timestamp'], plot_df['actual'], color='red', linewidth=4.0)
        ax = fig.add_subplot(111)
        for t in range(1, HORIZON+1):
            x = plot_df['timestamp'][(t-1):]
            y = plot_df['t+'+str(t)][0:len(x)]
            ax.plot(x, y, color='blue', linewidth=4*math.pow(.9,t), alpha=math.pow(0.8,t))

        ax.legend(loc='best')

    plt.xlabel('timestamp', fontsize=12)
    plt.ylabel('load', fontsize=12)
    plt.show()
    ```

    ![рдПрдХ рдЯрд╛рдЗрдо рд╕реАрд░реАрдЬрд╝ рдореЙрдбрд▓](../../../../7-TimeSeries/2-ARIMA/images/accuracy.png)

ЁЯПЖ рдПрдХ рдмрд╣реБрдд рд╣реА рдЕрдЪреНрдЫрд╛ рдкреНрд▓реЙрдЯ, рдЬреЛ рдПрдХ рдЕрдЪреНрдЫреЗ рд╕рдЯреАрдХрддрд╛ рд╡рд╛рд▓реЗ рдореЙрдбрд▓ рдХреЛ рджрд┐рдЦрд╛рддрд╛ рд╣реИред рдмрд╣реБрдд рдмрдврд╝рд┐рдпрд╛!

---

## ЁЯЪАрдЪреБрдиреМрддреА

рдЯрд╛рдЗрдо рд╕реАрд░реАрдЬрд╝ рдореЙрдбрд▓ рдХреА рд╕рдЯреАрдХрддрд╛ рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рддрд░реАрдХреЛрдВ рдореЗрдВ рдЧрд╣рд░рд╛рдИ рд╕реЗ рдЬрд╛рдПрдВред рдЗрд╕ рдкрд╛рда рдореЗрдВ рд╣рдордиреЗ MAPE рдкрд░ рдЪрд░реНрдЪрд╛ рдХреА рд╣реИ, рд▓реЗрдХрд┐рди рдХреНрдпрд╛ рдЖрдк рдЕрдиреНрдп рддрд░реАрдХреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ? рдЙрдирдХрд╛ рд╢реЛрдз рдХрд░реЗрдВ рдФрд░ рдЙрдиреНрд╣реЗрдВ рдиреЛрдЯ рдХрд░реЗрдВред рдПрдХ рд╕рд╣рд╛рдпрдХ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ [рдпрд╣рд╛рдВ](https://otexts.com/fpp2/accuracy.html) рдкрд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

## [рдкрд╛рда рдХреЗ рдмрд╛рдж рдХреА рдХреНрд╡рд┐рдЬрд╝](https://ff-quizzes.netlify.app/en/ml/)

## рд╕рдореАрдХреНрд╖рд╛ рдФрд░ рд╕реНрд╡-рдЕрдзреНрдпрдпрди

рдпрд╣ рдкрд╛рда ARIMA рдХреЗ рд╕рд╛рде рдЯрд╛рдЗрдо рд╕реАрд░реАрдЬрд╝ рдкреВрд░реНрд╡рд╛рдиреБрдорд╛рди рдХреА рдХреЗрд╡рд▓ рдореВрд▓ рдмрд╛рддреЗрдВ рдЫреВрддрд╛ рд╣реИред [рдЗрд╕ рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА](https://microsoft.github.io/forecasting/) рдФрд░ рдЗрд╕рдХреЗ рд╡рд┐рднрд┐рдиреНрди рдореЙрдбрд▓ рдкреНрд░рдХрд╛рд░реЛрдВ рдореЗрдВ рдЧрд╣рд░рд╛рдИ рд╕реЗ рдЬрд╛рдХрд░ рдЕрдиреНрдп рддрд░реАрдХреЛрдВ рд╕реЗ рдЯрд╛рдЗрдо рд╕реАрд░реАрдЬрд╝ рдореЙрдбрд▓ рдмрдирд╛рдиреЗ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдордп рдирд┐рдХрд╛рд▓реЗрдВред

## рдЕрд╕рд╛рдЗрдирдореЗрдВрдЯ

[рдПрдХ рдирдпрд╛ ARIMA рдореЙрдбрд▓](assignment.md)

---

**рдЕрд╕реНрд╡реАрдХрд░рдг**:  
рдпрд╣ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ AI рдЕрдиреБрд╡рд╛рдж рд╕реЗрд╡рд╛ [Co-op Translator](https://github.com/Azure/co-op-translator) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЕрдиреБрд╡рд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред рдЬрдмрдХрд┐ рд╣рдо рд╕рдЯреАрдХрддрд╛ рдХреЗ рд▓рд┐рдП рдкреНрд░рдпрд╛рд╕ рдХрд░рддреЗ рд╣реИрдВ, рдХреГрдкрдпрд╛ рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдЕрдиреБрд╡рд╛рдж рдореЗрдВ рддреНрд░реБрдЯрд┐рдпрд╛рдВ рдпрд╛ рдЕрд╢реБрджреНрдзрд┐рдпрд╛рдВ рд╣реЛ рд╕рдХрддреА рд╣реИрдВред рдореВрд▓ рднрд╛рд╖рд╛ рдореЗрдВ рдЙрдкрд▓рдмреНрдз рдореВрд▓ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдХреЛ рдЖрдзрд┐рдХрд╛рд░рд┐рдХ рд╕реНрд░реЛрдд рдорд╛рдирд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред рдорд╣рддреНрд╡рдкреВрд░реНрдг рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП, рдкреЗрд╢реЗрд╡рд░ рдорд╛рдирд╡ рдЕрдиреБрд╡рд╛рдж рдХреА рд╕рд┐рдлрд╛рд░рд┐рд╢ рдХреА рдЬрд╛рддреА рд╣реИред рдЗрд╕ рдЕрдиреБрд╡рд╛рдж рдХреЗ рдЙрдкрдпреЛрдЧ рд╕реЗ рдЙрддреНрдкрдиреНрди рдХрд┐рд╕реА рднреА рдЧрд▓рддрдлрд╣рдореА рдпрд╛ рдЧрд▓рдд рд╡реНрдпрд╛рдЦреНрдпрд╛ рдХреЗ рд▓рд┐рдП рд╣рдо рдЙрддреНрддрд░рджрд╛рдпреА рдирд╣реАрдВ рд╣реИрдВред  