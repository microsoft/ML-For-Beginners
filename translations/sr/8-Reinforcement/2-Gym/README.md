<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "107d5bb29da8a562e7ae72262d251a75",
  "translation_date": "2025-09-05T13:44:51+00:00",
  "source_file": "8-Reinforcement/2-Gym/README.md",
  "language_code": "sr"
}
-->
# –ü—Ä–æ–±–ª–µ–º —Å–∞ –∫–ª–∏–∑–∞—ö–µ–º –Ω–∞ —à–∏–ø—Ü–∏

–ü—Ä–æ–±–ª–µ–º –∫–æ—ò–∏ —Å–º–æ —Ä–µ—à–∞–≤–∞–ª–∏ —É –ø—Ä–µ—Ç—Ö–æ–¥–Ω–æ—ò –ª–µ–∫—Ü–∏—ò–∏ –º–æ–∂–¥–∞ –∏–∑–≥–ª–µ–¥–∞ –∫–∞–æ –∏–≥—Ä–∞—á–∫–∞, –±–µ–∑ —Å—Ç–≤–∞—Ä–Ω–µ –ø—Ä–∏–º–µ–Ω–µ —É —Ä–µ–∞–ª–Ω–∏–º —Å—Ü–µ–Ω–∞—Ä–∏—ò–∏–º–∞. –ú–µ—í—É—Ç–∏–º, —Ç–æ –Ω–∏—ò–µ —Å–ª—É—á–∞—ò, —ò–µ—Ä –º–Ω–æ–≥–∏ –ø—Ä–æ–±–ª–µ–º–∏ –∏–∑ —Å—Ç–≤–∞—Ä–Ω–æ–≥ –∂–∏–≤–æ—Ç–∞ –¥–µ–ª–µ —Å–ª–∏—á–∞–Ω —Å—Ü–µ–Ω–∞—Ä–∏–æ ‚Äì —É–∫—ô—É—á—É—ò—É—õ–∏ –∏–≥—Ä–∞—ö–µ —à–∞—Ö–∞ –∏–ª–∏ –∏–≥—Ä–µ –ì–æ. –û–Ω–∏ —Å—É —Å–ª–∏—á–Ω–∏ —ò–µ—Ä —Ç–∞–∫–æ—í–µ –∏–º–∞–º–æ —Ç–∞–±–ª—É —Å–∞ –æ–¥—Ä–µ—í–µ–Ω–∏–º –ø—Ä–∞–≤–∏–ª–∏–º–∞ –∏ **–¥–∏—Å–∫—Ä–µ—Ç–Ω–æ —Å—Ç–∞—ö–µ**.

## [–ö–≤–∏–∑ –ø—Ä–µ –ø—Ä–µ–¥–∞–≤–∞—ö–∞](https://ff-quizzes.netlify.app/en/ml/)

## –£–≤–æ–¥

–£ –æ–≤–æ—ò –ª–µ–∫—Ü–∏—ò–∏ –ø—Ä–∏–º–µ–Ω–∏—õ–µ–º–æ –∏—Å—Ç–µ –ø—Ä–∏–Ω—Ü–∏–ø–µ Q-—É—á–µ—ö–∞ –Ω–∞ –ø—Ä–æ–±–ª–µ–º —Å–∞ **–∫–æ–Ω—Ç–∏–Ω—É–∞–ª–Ω–∏–º —Å—Ç–∞—ö–µ–º**, –æ–¥–Ω–æ—Å–Ω–æ —Å—Ç–∞—ö–µ–º –∫–æ—ò–µ —ò–µ –¥–µ—Ñ–∏–Ω–∏—Å–∞–Ω–æ —ò–µ–¥–Ω–∏–º –∏–ª–∏ –≤–∏—à–µ —Ä–µ–∞–ª–Ω–∏—Ö –±—Ä–æ—ò–µ–≤–∞. –ë–∞–≤–∏—õ–µ–º–æ —Å–µ —Å–ª–µ–¥–µ—õ–∏–º –ø—Ä–æ–±–ª–µ–º–æ–º:

> **–ü—Ä–æ–±–ª–µ–º**: –ê–∫–æ –ü–µ—Ç–∞—Ä –∂–µ–ª–∏ –¥–∞ –ø–æ–±–µ–≥–Ω–µ –æ–¥ –≤—É–∫–∞, –º–æ—Ä–∞ –±–∏—Ç–∏ —É —Å—Ç–∞—ö—É –¥–∞ —Å–µ –∫—Ä–µ—õ–µ –±—Ä–∂–µ. –í–∏–¥–µ—õ–µ–º–æ –∫–∞–∫–æ –ü–µ—Ç–∞—Ä –º–æ–∂–µ –Ω–∞—É—á–∏—Ç–∏ –¥–∞ –∫–ª–∏–∑–∞, –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ, –∫–∞–∫–æ –¥–∞ –æ–¥—Ä–∂–∞–≤–∞ —Ä–∞–≤–Ω–æ—Ç–µ–∂—É, –∫–æ—Ä–∏—Å—Ç–µ—õ–∏ Q-—É—á–µ—ö–µ.

![–í–µ–ª–∏–∫–∏ –±–µ–≥!](../../../../8-Reinforcement/2-Gym/images/escape.png)

> –ü–µ—Ç–∞—Ä –∏ —ö–µ–≥–æ–≤–∏ –ø—Ä–∏—ò–∞—Ç–µ—ô–∏ –ø–æ—Å—Ç–∞—ò—É –∫—Ä–µ–∞—Ç–∏–≤–Ω–∏ –∫–∞–∫–æ –±–∏ –ø–æ–±–µ–≥–ª–∏ –æ–¥ –≤—É–∫–∞! –°–ª–∏–∫–∞: [–è–µ–Ω –õ—É–ø–µ—Ä](https://twitter.com/jenlooper)

–ö–æ—Ä–∏—Å—Ç–∏—õ–µ–º–æ –ø–æ—ò–µ–¥–Ω–æ—Å—Ç–∞–≤—ô–µ–Ω—É –≤–µ—Ä–∑–∏—ò—É –æ–¥—Ä–∂–∞–≤–∞—ö–∞ —Ä–∞–≤–Ω–æ—Ç–µ–∂–µ –ø–æ–∑–Ω–∞—Ç—É –∫–∞–æ –ø—Ä–æ–±–ª–µ–º **CartPole**. –£ —Å–≤–µ—Ç—É CartPole-–∞ –∏–º–∞–º–æ —Ö–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª–Ω–∏ –∫–ª–∏–∑–∞—á –∫–æ—ò–∏ —Å–µ –º–æ–∂–µ –∫—Ä–µ—Ç–∞—Ç–∏ –ª–µ–≤–æ –∏–ª–∏ –¥–µ—Å–Ω–æ, –∞ —Ü–∏—ô —ò–µ –æ–¥—Ä–∂–∞—Ç–∏ –≤–µ—Ä—Ç–∏–∫–∞–ª–Ω—É —à–∏–ø–∫—É —É —Ä–∞–≤–Ω–æ—Ç–µ–∂–∏ –Ω–∞ –≤—Ä—Ö—É –∫–ª–∏–∑–∞—á–∞.

## –ü—Ä–µ–¥—É—Å–ª–æ–≤–∏

–£ –æ–≤–æ—ò –ª–µ–∫—Ü–∏—ò–∏ –∫–æ—Ä–∏—Å—Ç–∏—õ–µ–º–æ –±–∏–±–ª–∏–æ—Ç–µ–∫—É **OpenAI Gym** –∑–∞ —Å–∏–º—É–ª–∞—Ü–∏—ò—É —Ä–∞–∑–ª–∏—á–∏—Ç–∏—Ö **–æ–∫—Ä—É–∂–µ—ö–∞**. –ö–æ–¥ –æ–≤–µ –ª–µ–∫—Ü–∏—ò–µ –º–æ–∂–µ—Ç–µ –ø–æ–∫—Ä–µ–Ω—É—Ç–∏ –ª–æ–∫–∞–ª–Ω–æ (–Ω–ø—Ä. –∏–∑ Visual Studio Code-–∞), —É –∫–æ–º —Å–ª—É—á–∞—ò—É —õ–µ —Å–µ —Å–∏–º—É–ª–∞—Ü–∏—ò–∞ –æ—Ç–≤–æ—Ä–∏—Ç–∏ —É –Ω–æ–≤–æ–º –ø—Ä–æ–∑–æ—Ä—É. –ö–∞–¥–∞ –ø–æ–∫—Ä–µ—õ–µ—Ç–µ –∫–æ–¥ –æ–Ω–ª–∞—ò–Ω, –º–æ–∂–¥–∞ —õ–µ—Ç–µ –º–æ—Ä–∞—Ç–∏ –¥–∞ –Ω–∞–ø—Ä–∞–≤–∏—Ç–µ –Ω–µ–∫–µ –∏–∑–º–µ–Ω–µ —É –∫–æ–¥—É, –∫–∞–æ —à—Ç–æ —ò–µ –æ–ø–∏—Å–∞–Ω–æ [–æ–≤–¥–µ](https://towardsdatascience.com/rendering-openai-gym-envs-on-binder-and-google-colab-536f99391cc7).

## OpenAI Gym

–£ –ø—Ä–µ—Ç—Ö–æ–¥–Ω–æ—ò –ª–µ–∫—Ü–∏—ò–∏, –ø—Ä–∞–≤–∏–ª–∞ –∏–≥—Ä–µ –∏ —Å—Ç–∞—ö–µ —Å—É –±–∏–ª–∏ –¥–µ—Ñ–∏–Ω–∏—Å–∞–Ω–∏ —É–Ω—É—Ç–∞—Ä –∫–ª–∞—Å–µ `Board` –∫–æ—ò—É —Å–º–æ —Å–∞–º–∏ –∫—Ä–µ–∏—Ä–∞–ª–∏. –û–≤–¥–µ —õ–µ–º–æ –∫–æ—Ä–∏—Å—Ç–∏—Ç–∏ —Å–ø–µ—Ü–∏—ò–∞–ª–Ω–æ **—Å–∏–º—É–ª–∞—Ü–∏–æ–Ω–æ –æ–∫—Ä—É–∂–µ—ö–µ**, –∫–æ—ò–µ —õ–µ —Å–∏–º—É–ª–∏—Ä–∞—Ç–∏ —Ñ–∏–∑–∏–∫—É –∏–∑–∞ —Ä–∞–≤–Ω–æ—Ç–µ–∂–µ —à–∏–ø–∫–µ. –à–µ–¥–Ω–æ –æ–¥ –Ω–∞—ò–ø–æ–ø—É–ª–∞—Ä–Ω–∏—ò–∏—Ö —Å–∏–º—É–ª–∞—Ü–∏–æ–Ω–∏—Ö –æ–∫—Ä—É–∂–µ—ö–∞ –∑–∞ —Ç—Ä–µ–Ω–∏—Ä–∞—ö–µ –∞–ª–≥–æ—Ä–∏—Ç–∞–º–∞ –∑–∞ –ø–æ—ò–∞—á–∞–Ω–æ —É—á–µ—ö–µ —ò–µ [Gym](https://gym.openai.com/), –∫–æ—ò–∏ –æ–¥—Ä–∂–∞–≤–∞ [OpenAI](https://openai.com/). –ö–æ—Ä–∏—à—õ–µ—ö–µ–º –æ–≤–æ–≥ Gym-–∞ –º–æ–∂–µ–º–æ –∫—Ä–µ–∏—Ä–∞—Ç–∏ —Ä–∞–∑–ª–∏—á–∏—Ç–∞ **–æ–∫—Ä—É–∂–µ—ö–∞**, –æ–¥ —Å–∏–º—É–ª–∞—Ü–∏—ò–µ CartPole-–∞ –¥–æ Atari –∏–≥–∞—Ä–∞.

> **–ù–∞–ø–æ–º–µ–Ω–∞**: –û—Å—Ç–∞–ª–∞ –æ–∫—Ä—É–∂–µ—ö–∞ –¥–æ—Å—Ç—É–ø–Ω–∞ —É OpenAI Gym-—É –º–æ–∂–µ—Ç–µ –≤–∏–¥–µ—Ç–∏ [–æ–≤–¥–µ](https://gym.openai.com/envs/#classic_control).

–ü—Ä–≤–æ, –∏–Ω—Å—Ç–∞–ª–∏—Ä–∞—ò–º–æ Gym –∏ —É–≤–µ–∑–∏–º–æ –ø–æ—Ç—Ä–µ–±–Ω–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–µ (–±–ª–æ–∫ –∫–æ–¥–∞ 1):

```python
import sys
!{sys.executable} -m pip install gym 

import gym
import matplotlib.pyplot as plt
import numpy as np
import random
```

## –í–µ–∂–±–∞ ‚Äì –∏–Ω–∏—Ü–∏—ò–∞–ª–∏–∑–∞—Ü–∏—ò–∞ –æ–∫—Ä—É–∂–µ—ö–∞ CartPole

–î–∞ –±–∏—Å–º–æ —Ä–∞–¥–∏–ª–∏ —Å–∞ –ø—Ä–æ–±–ª–µ–º–æ–º —Ä–∞–≤–Ω–æ—Ç–µ–∂–µ —à–∏–ø–∫–µ, –ø–æ—Ç—Ä–µ–±–Ω–æ —ò–µ –¥–∞ –∏–Ω–∏—Ü–∏—ò–∞–ª–∏–∑—É—ò–µ–º–æ –æ–¥–≥–æ–≤–∞—Ä–∞—ò—É—õ–µ –æ–∫—Ä—É–∂–µ—ö–µ. –°–≤–∞–∫–æ –æ–∫—Ä—É–∂–µ—ö–µ —ò–µ –ø–æ–≤–µ–∑–∞–Ω–æ —Å–∞:

- **–ü—Ä–æ—Å—Ç–æ—Ä–æ–º –ø–æ—Å–º–∞—Ç—Ä–∞—ö–∞** –∫–æ—ò–∏ –¥–µ—Ñ–∏–Ω–∏—à–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—ò–∞ –∫–æ—ò–µ –¥–æ–±–∏—ò–∞–º–æ –∏–∑ –æ–∫—Ä—É–∂–µ—ö–∞. –ó–∞ –ø—Ä–æ–±–ª–µ–º CartPole-–∞, –¥–æ–±–∏—ò–∞–º–æ –ø–æ–∑–∏—Ü–∏—ò—É —à–∏–ø–∫–µ, –±—Ä–∑–∏–Ω—É –∏ –Ω–µ–∫–µ –¥—Ä—É–≥–µ –≤—Ä–µ–¥–Ω–æ—Å—Ç–∏.

- **–ü—Ä–æ—Å—Ç–æ—Ä–æ–º –∞–∫—Ü–∏—ò–∞** –∫–æ—ò–∏ –¥–µ—Ñ–∏–Ω–∏—à–µ –º–æ–≥—É—õ–µ –∞–∫—Ü–∏—ò–µ. –£ –Ω–∞—à–µ–º —Å–ª—É—á–∞—ò—É, –ø—Ä–æ—Å—Ç–æ—Ä –∞–∫—Ü–∏—ò–∞ —ò–µ –¥–∏—Å–∫—Ä–µ—Ç–∞–Ω –∏ —Å–∞—Å—Ç–æ—ò–∏ —Å–µ –æ–¥ –¥–≤–µ –∞–∫—Ü–∏—ò–µ ‚Äì **–ª–µ–≤–æ** –∏ **–¥–µ—Å–Ω–æ**. (–±–ª–æ–∫ –∫–æ–¥–∞ 2)

1. –î–∞ –±–∏—Å–º–æ –∏–Ω–∏—Ü–∏—ò–∞–ª–∏–∑–æ–≤–∞–ª–∏ –æ–∫—Ä—É–∂–µ—ö–µ, —É–∫—É—Ü–∞—ò—Ç–µ —Å–ª–µ–¥–µ—õ–∏ –∫–æ–¥:

    ```python
    env = gym.make("CartPole-v1")
    print(env.action_space)
    print(env.observation_space)
    print(env.action_space.sample())
    ```

–î–∞ –±–∏—Å–º–æ –≤–∏–¥–µ–ª–∏ –∫–∞–∫–æ –æ–∫—Ä—É–∂–µ—ö–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—à–µ, –ø–æ–∫—Ä–µ–Ω–∏–º–æ –∫—Ä–∞—Ç–∫—É —Å–∏–º—É–ª–∞—Ü–∏—ò—É –æ–¥ 100 –∫–æ—Ä–∞–∫–∞. –ù–∞ —Å–≤–∞–∫–æ–º –∫–æ—Ä–∞–∫—É, –∑–∞–¥–∞—ò–µ–º–æ —ò–µ–¥–Ω—É –æ–¥ –∞–∫—Ü–∏—ò–∞ –∫–æ—ò–µ —Ç—Ä–µ–±–∞ –ø—Ä–µ–¥—É–∑–µ—Ç–∏ ‚Äì —É –æ–≤–æ—ò —Å–∏–º—É–ª–∞—Ü–∏—ò–∏ –Ω–∞—Å—É–º–∏—á–Ω–æ –±–∏—Ä–∞–º–æ –∞–∫—Ü–∏—ò—É –∏–∑ `action_space`.

1. –ü–æ–∫—Ä–µ–Ω–∏—Ç–µ –∫–æ–¥ –∏—Å–ø–æ–¥ –∏ –≤–∏–¥–∏—Ç–µ —à—Ç–∞ —Å–µ –¥–µ—à–∞–≤–∞.

    ‚úÖ –ó–∞–ø–∞–º—Ç–∏—Ç–µ –¥–∞ —ò–µ –ø–æ–∂–µ—ô–Ω–æ –ø–æ–∫—Ä–µ–Ω—É—Ç–∏ –æ–≤–∞—ò –∫–æ–¥ –Ω–∞ –ª–æ–∫–∞–ª–Ω–æ—ò Python –∏–Ω—Å—Ç–∞–ª–∞—Ü–∏—ò–∏! (–±–ª–æ–∫ –∫–æ–¥–∞ 3)

    ```python
    env.reset()
    
    for i in range(100):
       env.render()
       env.step(env.action_space.sample())
    env.close()
    ```

    –¢—Ä–µ–±–∞–ª–æ –±–∏ –¥–∞ –≤–∏–¥–∏—Ç–µ –Ω–µ—à—Ç–æ —Å–ª–∏—á–Ω–æ –æ–≤–æ—ò —Å–ª–∏—Ü–∏:

    ![—à–∏–ø–∫–∞ –±–µ–∑ —Ä–∞–≤–Ω–æ—Ç–µ–∂–µ](../../../../8-Reinforcement/2-Gym/images/cartpole-nobalance.gif)

1. –¢–æ–∫–æ–º —Å–∏–º—É–ª–∞—Ü–∏—ò–µ, –ø–æ—Ç—Ä–µ–±–Ω–æ —ò–µ –¥–∞ –¥–æ–±–∏—ò–µ–º–æ –ø–æ—Å–º–∞—Ç—Ä–∞—ö–∞ –∫–∞–∫–æ –±–∏—Å–º–æ –æ–¥–ª—É—á–∏–ª–∏ –∫–∞–∫–æ –¥–∞ –¥–µ–ª—É—ò–µ–º–æ. –£ —Å—Ç–≤–∞—Ä–∏, —Ñ—É–Ω–∫—Ü–∏—ò–∞ `step` –≤—Ä–∞—õ–∞ —Ç—Ä–µ–Ω—É—Ç–Ω–∞ –ø–æ—Å–º–∞—Ç—Ä–∞—ö–∞, —Ñ—É–Ω–∫—Ü–∏—ò—É –Ω–∞–≥—Ä–∞–¥–µ –∏ –∑–∞—Å—Ç–∞–≤–∏—Ü—É `done` –∫–æ—ò–∞ —É–∫–∞–∑—É—ò–µ –¥–∞ –ª–∏ –∏–º–∞ —Å–º–∏—Å–ª–∞ –Ω–∞—Å—Ç–∞–≤–∏—Ç–∏ —Å–∏–º—É–ª–∞—Ü–∏—ò—É –∏–ª–∏ –Ω–µ: (–±–ª–æ–∫ –∫–æ–¥–∞ 4)

    ```python
    env.reset()
    
    done = False
    while not done:
       env.render()
       obs, rew, done, info = env.step(env.action_space.sample())
       print(f"{obs} -> {rew}")
    env.close()
    ```

    –£ –∏–∑–ª–∞–∑—É —É –±–µ–ª–µ–∂–Ω–∏—Ü–∏ —Ç—Ä–µ–±–∞–ª–æ –±–∏ –¥–∞ –≤–∏–¥–∏—Ç–µ –Ω–µ—à—Ç–æ –æ–≤–∞–∫–æ:

    ```text
    [ 0.03403272 -0.24301182  0.02669811  0.2895829 ] -> 1.0
    [ 0.02917248 -0.04828055  0.03248977  0.00543839] -> 1.0
    [ 0.02820687  0.14636075  0.03259854 -0.27681916] -> 1.0
    [ 0.03113408  0.34100283  0.02706215 -0.55904489] -> 1.0
    [ 0.03795414  0.53573468  0.01588125 -0.84308041] -> 1.0
    ...
    [ 0.17299878  0.15868546 -0.20754175 -0.55975453] -> 1.0
    [ 0.17617249  0.35602306 -0.21873684 -0.90998894] -> 1.0
    ```

    –í–µ–∫—Ç–æ—Ä –ø–æ—Å–º–∞—Ç—Ä–∞—ö–∞ –∫–æ—ò–∏ —Å–µ –≤—Ä–∞—õ–∞ –Ω–∞ —Å–≤–∞–∫–æ–º –∫–æ—Ä–∞–∫—É —Å–∏–º—É–ª–∞—Ü–∏—ò–µ —Å–∞–¥—Ä–∂–∏ —Å–ª–µ–¥–µ—õ–µ –≤—Ä–µ–¥–Ω–æ—Å—Ç–∏:
    - –ü–æ–∑–∏—Ü–∏—ò–∞ –∫–æ–ª–∏—Ü–∞
    - –ë—Ä–∑–∏–Ω–∞ –∫–æ–ª–∏—Ü–∞
    - –£–≥–∞–æ —à–∏–ø–∫–µ
    - –ë—Ä–∑–∏–Ω–∞ —Ä–æ—Ç–∞—Ü–∏—ò–µ —à–∏–ø–∫–µ

1. –î–æ–±–∏—ò—Ç–µ –º–∏–Ω–∏–º–∞–ª–Ω—É –∏ –º–∞–∫—Å–∏–º–∞–ª–Ω—É –≤—Ä–µ–¥–Ω–æ—Å—Ç –æ–≤–∏—Ö –±—Ä–æ—ò–µ–≤–∞: (–±–ª–æ–∫ –∫–æ–¥–∞ 5)

    ```python
    print(env.observation_space.low)
    print(env.observation_space.high)
    ```

    –¢–∞–∫–æ—í–µ –º–æ–∂–µ—Ç–µ –ø—Ä–∏–º–µ—Ç–∏—Ç–∏ –¥–∞ —ò–µ –≤—Ä–µ–¥–Ω–æ—Å—Ç –Ω–∞–≥—Ä–∞–¥–µ –Ω–∞ —Å–≤–∞–∫–æ–º –∫–æ—Ä–∞–∫—É —Å–∏–º—É–ª–∞—Ü–∏—ò–µ —É–≤–µ–∫ 1. –¢–æ —ò–µ –∑–∞—Ç–æ —à—Ç–æ —ò–µ –Ω–∞—à —Ü–∏—ô –¥–∞ –ø—Ä–µ–∂–∏–≤–∏–º–æ —à—Ç–æ —ò–µ –¥—É–∂–µ –º–æ–≥—É—õ–µ, –æ–¥–Ω–æ—Å–Ω–æ –¥–∞ –æ–¥—Ä–∂–∏–º–æ —à–∏–ø–∫—É —É —Ä–∞–∑—É–º–Ω–æ –≤–µ—Ä—Ç–∏–∫–∞–ª–Ω–æ–º –ø–æ–ª–æ–∂–∞—ò—É —à—Ç–æ –¥—É–∂–µ.

    ‚úÖ –£ —Å—Ç–≤–∞—Ä–∏, —Å–∏–º—É–ª–∞—Ü–∏—ò–∞ CartPole-–∞ —Å–µ —Å–º–∞—Ç—Ä–∞ —Ä–µ—à–µ–Ω–æ–º –∞–∫–æ —É—Å–ø–µ–º–æ –¥–∞ –¥–æ–±–∏—ò–µ–º–æ –ø—Ä–æ—Å–µ—á–Ω—É –Ω–∞–≥—Ä–∞–¥—É –æ–¥ 195 —Ç–æ–∫–æ–º 100 —É–∑–∞—Å—Ç–æ–ø–Ω–∏—Ö –ø–æ–∫—É—à–∞—ò–∞.

## –î–∏—Å–∫—Ä–µ—Ç–∏–∑–∞—Ü–∏—ò–∞ —Å—Ç–∞—ö–∞

–£ Q-—É—á–µ—ö—É, –ø–æ—Ç—Ä–µ–±–Ω–æ —ò–µ –∏–∑–≥—Ä–∞–¥–∏—Ç–∏ Q-—Ç–∞–±–µ–ª—É –∫–æ—ò–∞ –¥–µ—Ñ–∏–Ω–∏—à–µ —à—Ç–∞ —Ä–∞–¥–∏—Ç–∏ —É —Å–≤–∞–∫–æ–º —Å—Ç–∞—ö—É. –î–∞ –±–∏—Å–º–æ —Ç–æ —É—Ä–∞–¥–∏–ª–∏, —Å—Ç–∞—ö–µ –º–æ—Ä–∞ –±–∏—Ç–∏ **–¥–∏—Å–∫—Ä–µ—Ç–Ω–æ**, –ø—Ä–µ—Ü–∏–∑–Ω–∏—ò–µ, –º–æ—Ä–∞ —Å–∞–¥—Ä–∂–∞—Ç–∏ –∫–æ–Ω–∞—á–∞–Ω –±—Ä–æ—ò –¥–∏—Å–∫—Ä–µ—Ç–Ω–∏—Ö –≤—Ä–µ–¥–Ω–æ—Å—Ç–∏. –ó–±–æ–≥ —Ç–æ–≥–∞ —ò–µ –ø–æ—Ç—Ä–µ–±–Ω–æ –Ω–µ–∫–∞–∫–æ **–¥–∏—Å–∫—Ä–µ—Ç–∏–∑–æ–≤–∞—Ç–∏** –Ω–∞—à–∞ –ø–æ—Å–º–∞—Ç—Ä–∞—ö–∞, –º–∞–ø–∏—Ä–∞—ò—É—õ–∏ –∏—Ö –Ω–∞ –∫–æ–Ω–∞—á–∞–Ω —Å–∫—É–ø —Å—Ç–∞—ö–∞.

–ü–æ—Å—Ç–æ—ò–∏ –Ω–µ–∫–æ–ª–∏–∫–æ –Ω–∞—á–∏–Ω–∞ –¥–∞ —Å–µ —Ç–æ —É—Ä–∞–¥–∏:

- **–ü–æ–¥–µ–ª–∞ –Ω–∞ –∏–Ω—Ç–µ—Ä–≤–∞–ª–µ**. –ê–∫–æ –∑–Ω–∞–º–æ –∏–Ω—Ç–µ—Ä–≤–∞–ª –æ–¥—Ä–µ—í–µ–Ω–µ –≤—Ä–µ–¥–Ω–æ—Å—Ç–∏, –º–æ–∂–µ–º–æ –ø–æ–¥–µ–ª–∏—Ç–∏ —Ç–∞—ò –∏–Ω—Ç–µ—Ä–≤–∞–ª –Ω–∞ –æ–¥—Ä–µ—í–µ–Ω–∏ –±—Ä–æ—ò **–∏–Ω—Ç–µ—Ä–≤–∞–ª–∞**, –∞ –∑–∞—Ç–∏–º –∑–∞–º–µ–Ω–∏—Ç–∏ –≤—Ä–µ–¥–Ω–æ—Å—Ç –±—Ä–æ—ò–µ–º –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞ –∫–æ–º–µ –ø—Ä–∏–ø–∞–¥–∞. –û–≤–æ —Å–µ –º–æ–∂–µ —É—Ä–∞–¥–∏—Ç–∏ –ø–æ–º–æ—õ—É numpy –º–µ—Ç–æ–¥–µ [`digitize`](https://numpy.org/doc/stable/reference/generated/numpy.digitize.html). –£ –æ–≤–æ–º —Å–ª—É—á–∞—ò—É, —Ç–∞—á–Ω–æ —õ–µ–º–æ –∑–Ω–∞—Ç–∏ –≤–µ–ª–∏—á–∏–Ω—É —Å—Ç–∞—ö–∞, —ò–µ—Ä —õ–µ –∑–∞–≤–∏—Å–∏—Ç–∏ –æ–¥ –±—Ä–æ—ò–∞ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞ –∫–æ—ò–µ –∏–∑–∞–±–µ—Ä–µ–º–æ –∑–∞ –¥–∏–≥–∏—Ç–∞–ª–∏–∑–∞—Ü–∏—ò—É.

‚úÖ –ú–æ–∂–µ–º–æ –∫–æ—Ä–∏—Å—Ç–∏—Ç–∏ –ª–∏–Ω–µ–∞—Ä–Ω—É –∏–Ω—Ç–µ—Ä–ø–æ–ª–∞—Ü–∏—ò—É –¥–∞ –¥–æ–≤–µ–¥–µ–º–æ –≤—Ä–µ–¥–Ω–æ—Å—Ç–∏ —É –Ω–µ–∫–∏ –∫–æ–Ω–∞—á–∞–Ω –∏–Ω—Ç–µ—Ä–≤–∞–ª (—Ä–µ—Ü–∏–º–æ, –æ–¥ -20 –¥–æ 20), –∞ –∑–∞—Ç–∏–º –ø—Ä–µ—Ç–≤–æ—Ä–∏—Ç–∏ –±—Ä–æ—ò–µ–≤–µ —É —Ü–µ–ª–µ –±—Ä–æ—ò–µ–≤–µ –∑–∞–æ–∫—Ä—É–∂–∏–≤–∞—ö–µ–º. –û–≤–æ –Ω–∞–º –¥–∞—ò–µ –Ω–µ—à—Ç–æ –º–∞—ö—É –∫–æ–Ω—Ç—Ä–æ–ª—É –Ω–∞–¥ –≤–µ–ª–∏—á–∏–Ω–æ–º —Å—Ç–∞—ö–∞, –ø–æ—Å–µ–±–Ω–æ –∞–∫–æ –Ω–µ –∑–Ω–∞–º–æ —Ç–∞—á–Ω–µ –æ–ø—Å–µ–≥–µ —É–ª–∞–∑–Ω–∏—Ö –≤—Ä–µ–¥–Ω–æ—Å—Ç–∏. –ù–∞ –ø—Ä–∏–º–µ—Ä, —É –Ω–∞—à–µ–º —Å–ª—É—á–∞—ò—É 2 –æ–¥ 4 –≤—Ä–µ–¥–Ω–æ—Å—Ç–∏ –Ω–µ–º–∞—ò—É –≥–æ—Ä—ö–µ/–¥–æ—ö–µ –≥—Ä–∞–Ω–∏—Ü–µ, —à—Ç–æ –º–æ–∂–µ —Ä–µ–∑—É–ª—Ç–∏—Ä–∞—Ç–∏ –±–µ—Å–∫–æ–Ω–∞—á–Ω–∏–º –±—Ä–æ—ò–µ–º —Å—Ç–∞—ö–∞.

–£ –Ω–∞—à–µ–º –ø—Ä–∏–º–µ—Ä—É, –∫–æ—Ä–∏—Å—Ç–∏—õ–µ–º–æ –¥—Ä—É–≥–∏ –ø—Ä–∏—Å—Ç—É–ø. –ö–∞–∫–æ —õ–µ—Ç–µ –∫–∞—Å–Ω–∏—ò–µ –ø—Ä–∏–º–µ—Ç–∏—Ç–∏, —É–ø—Ä–∫–æ—Å –Ω–µ–æ–¥—Ä–µ—í–µ–Ω–∏–º –≥–æ—Ä—ö–∏–º/–¥–æ—ö–∏–º –≥—Ä–∞–Ω–∏—Ü–∞–º–∞, —Ç–µ –≤—Ä–µ–¥–Ω–æ—Å—Ç–∏ —Ä–µ—Ç–∫–æ –ø—Ä–µ–ª–∞–∑–µ –æ–¥—Ä–µ—í–µ–Ω–µ –∫–æ–Ω–∞—á–Ω–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª–µ, —Ç–∞–∫–æ –¥–∞ —õ–µ —Ç–∞ —Å—Ç–∞—ö–∞ —Å–∞ –µ–∫—Å—Ç—Ä–µ–º–Ω–∏–º –≤—Ä–µ–¥–Ω–æ—Å—Ç–∏–º–∞ –±–∏—Ç–∏ –≤–µ–æ–º–∞ —Ä–µ—Ç–∫–∞.

1. –ï–≤–æ —Ñ—É–Ω–∫—Ü–∏—ò–µ –∫–æ—ò–∞ —õ–µ —É–∑–µ—Ç–∏ –ø–æ—Å–º–∞—Ç—Ä–∞—ö–µ –∏–∑ –Ω–∞—à–µ–≥ –º–æ–¥–µ–ª–∞ –∏ –ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏ —á–µ—Ç–≤–æ—Ä–∫—É —Ü–µ–ª–∏—Ö –±—Ä–æ—ò–µ–≤–∞: (–±–ª–æ–∫ –∫–æ–¥–∞ 6)

    ```python
    def discretize(x):
        return tuple((x/np.array([0.25, 0.25, 0.01, 0.1])).astype(np.int))
    ```

1. –¢–∞–∫–æ—í–µ –∏—Å—Ç—Ä–∞–∂–∏–º–æ –¥—Ä—É–≥–∏ –º–µ—Ç–æ–¥ –¥–∏—Å–∫—Ä–µ—Ç–∏–∑–∞—Ü–∏—ò–µ –∫–æ—Ä–∏—Å—Ç–µ—õ–∏ –∏–Ω—Ç–µ—Ä–≤–∞–ª–µ: (–±–ª–æ–∫ –∫–æ–¥–∞ 7)

    ```python
    def create_bins(i,num):
        return np.arange(num+1)*(i[1]-i[0])/num+i[0]
    
    print("Sample bins for interval (-5,5) with 10 bins\n",create_bins((-5,5),10))
    
    ints = [(-5,5),(-2,2),(-0.5,0.5),(-2,2)] # intervals of values for each parameter
    nbins = [20,20,10,10] # number of bins for each parameter
    bins = [create_bins(ints[i],nbins[i]) for i in range(4)]
    
    def discretize_bins(x):
        return tuple(np.digitize(x[i],bins[i]) for i in range(4))
    ```

1. –°–∞–¥–∞ –ø–æ–∫—Ä–µ–Ω–∏–º–æ –∫—Ä–∞—Ç–∫—É —Å–∏–º—É–ª–∞—Ü–∏—ò—É –∏ –ø–æ—Å–º–∞—Ç—Ä–∞—ò–º–æ —Ç–µ –¥–∏—Å–∫—Ä–µ—Ç–Ω–µ –≤—Ä–µ–¥–Ω–æ—Å—Ç–∏ –æ–∫—Ä—É–∂–µ—ö–∞. –°–ª–æ–±–æ–¥–Ω–æ –∏—Å–ø—Ä–æ–±–∞—ò—Ç–µ –∏ `discretize` –∏ `discretize_bins` –∏ –≤–∏–¥–∏—Ç–µ –¥–∞ –ª–∏ –ø–æ—Å—Ç–æ—ò–∏ —Ä–∞–∑–ª–∏–∫–∞.

    ‚úÖ `discretize_bins` –≤—Ä–∞—õ–∞ –±—Ä–æ—ò –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞, –∫–æ—ò–∏ –ø–æ—á–∏—ö–µ –æ–¥ 0. –î–∞–∫–ª–µ, –∑–∞ –≤—Ä–µ–¥–Ω–æ—Å—Ç–∏ —É–ª–∞–∑–Ω–µ –ø—Ä–æ–º–µ–Ω—ô–∏–≤–µ –æ–∫–æ 0 –≤—Ä–∞—õ–∞ –±—Ä–æ—ò –∏–∑ —Å—Ä–µ–¥–∏–Ω–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞ (10). –£ `discretize`, –Ω–∏—Å–º–æ —Å–µ –±—Ä–∏–Ω—É–ª–∏ –æ –æ–ø—Å–µ–≥—É –∏–∑–ª–∞–∑–Ω–∏—Ö –≤—Ä–µ–¥–Ω–æ—Å—Ç–∏, –¥–æ–∑–≤–æ—ô–∞–≤–∞—ò—É—õ–∏ –∏–º –¥–∞ –±—É–¥—É –Ω–µ–≥–∞—Ç–∏–≤–Ω–µ, —Ç–∞–∫–æ –¥–∞ –≤—Ä–µ–¥–Ω–æ—Å—Ç–∏ —Å—Ç–∞—ö–∞ –Ω–∏—Å—É –ø–æ–º–µ—Ä–µ–Ω–µ, –∞ 0 –æ–¥–≥–æ–≤–∞—Ä–∞ 0. (–±–ª–æ–∫ –∫–æ–¥–∞ 8)

    ```python
    env.reset()
    
    done = False
    while not done:
       #env.render()
       obs, rew, done, info = env.step(env.action_space.sample())
       #print(discretize_bins(obs))
       print(discretize(obs))
    env.close()
    ```

    ‚úÖ –†–∞—Å–∫–æ–º–µ–Ω—Ç–∞—Ä–∏—à–∏—Ç–µ –ª–∏–Ω–∏—ò—É –∫–æ—ò–∞ –ø–æ—á–∏—ö–µ —Å–∞ `env.render` –∞–∫–æ –∂–µ–ª–∏—Ç–µ –¥–∞ –≤–∏–¥–∏—Ç–µ –∫–∞–∫–æ —Å–µ –æ–∫—Ä—É–∂–µ—ö–µ –∏–∑–≤—Ä—à–∞–≤–∞. –£ —Å—É–ø—Ä–æ—Ç–Ω–æ–º, –º–æ–∂–µ—Ç–µ –≥–∞ –∏–∑–≤—Ä—à–∏—Ç–∏ —É –ø–æ–∑–∞–¥–∏–Ω–∏, —à—Ç–æ —ò–µ –±—Ä–∂–µ. –û–≤–æ "–Ω–µ–≤–∏–¥—ô–∏–≤–æ" –∏–∑–≤—Ä—à–∞–≤–∞—ö–µ —õ–µ–º–æ –∫–æ—Ä–∏—Å—Ç–∏—Ç–∏ —Ç–æ–∫–æ–º –ø—Ä–æ—Ü–µ—Å–∞ Q-—É—á–µ—ö–∞.

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ Q-—Ç–∞–±–µ–ª–µ

–£ –ø—Ä–µ—Ç—Ö–æ–¥–Ω–æ—ò –ª–µ–∫—Ü–∏—ò–∏, —Å—Ç–∞—ö–µ —ò–µ –±–∏–ª–æ —ò–µ–¥–Ω–æ—Å—Ç–∞–≤–∞–Ω –ø–∞—Ä –±—Ä–æ—ò–µ–≤–∞ –æ–¥ 0 –¥–æ 8, –∏ —Å—Ç–æ–≥–∞ —ò–µ –±–∏–ª–æ –∑–≥–æ–¥–Ω–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç–∏ Q-—Ç–∞–±–µ–ª—É –ø–æ–º–æ—õ—É numpy —Ç–µ–Ω–∑–æ—Ä–∞ –æ–±–ª–∏–∫–∞ 8x8x2. –ê–∫–æ –∫–æ—Ä–∏—Å—Ç–∏–º–æ –¥–∏—Å–∫—Ä–µ—Ç–∏–∑–∞—Ü–∏—ò—É –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞, –≤–µ–ª–∏—á–∏–Ω–∞ –Ω–∞—à–µ–≥ –≤–µ–∫—Ç–æ—Ä—Å–∫–æ–≥ —Å—Ç–∞—ö–∞ —ò–µ —Ç–∞–∫–æ—í–µ –ø–æ–∑–Ω–∞—Ç–∞, —Ç–∞–∫–æ –¥–∞ –º–æ–∂–µ–º–æ –∫–æ—Ä–∏—Å—Ç–∏—Ç–∏ –∏—Å—Ç–∏ –ø—Ä–∏—Å—Ç—É–ø –∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç–∏ —Å—Ç–∞—ö–µ –Ω–∏–∑–æ–º –æ–±–ª–∏–∫–∞ 20x20x10x10x2 (–æ–≤–¥–µ —ò–µ 2 –¥–∏–º–µ–Ω–∑–∏—ò–∞ –ø—Ä–æ—Å—Ç–æ—Ä–∞ –∞–∫—Ü–∏—ò–∞, –∞ –ø—Ä–≤–µ –¥–∏–º–µ–Ω–∑–∏—ò–µ –æ–¥–≥–æ–≤–∞—Ä–∞—ò—É –±—Ä–æ—ò—É –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞ –∫–æ—ò–µ —Å–º–æ –∏–∑–∞–±—Ä–∞–ª–∏ –∑–∞ —Å–≤–∞–∫—É –æ–¥ –ø–∞—Ä–∞–º–µ—Ç–∞—Ä–∞ —É –ø—Ä–æ—Å—Ç–æ—Ä—É –ø–æ—Å–º–∞—Ç—Ä–∞—ö–∞).

–ú–µ—í—É—Ç–∏–º, –ø–æ–Ω–µ–∫–∞–¥ –ø—Ä–µ—Ü–∏–∑–Ω–µ –¥–∏–º–µ–Ω–∑–∏—ò–µ –ø—Ä–æ—Å—Ç–æ—Ä–∞ –ø–æ—Å–º–∞—Ç—Ä–∞—ö–∞ –Ω–∏—Å—É –ø–æ–∑–Ω–∞—Ç–µ. –£ —Å–ª—É—á–∞—ò—É —Ñ—É–Ω–∫—Ü–∏—ò–µ `discretize`, –Ω–∏–∫–∞–¥–∞ –Ω–µ –º–æ–∂–µ–º–æ –±–∏—Ç–∏ —Å–∏–≥—É—Ä–Ω–∏ –¥–∞ –Ω–∞—à–µ —Å—Ç–∞—ö–µ –æ—Å—Ç–∞—ò–µ —É–Ω—É—Ç–∞—Ä –æ–¥—Ä–µ—í–µ–Ω–∏—Ö –≥—Ä–∞–Ω–∏—Ü–∞, —ò–µ—Ä –Ω–µ–∫–µ –æ–¥ –æ—Ä–∏–≥–∏–Ω–∞–ª–Ω–∏—Ö –≤—Ä–µ–¥–Ω–æ—Å—Ç–∏ –Ω–∏—Å—É –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–µ. –ó–±–æ–≥ —Ç–æ–≥–∞ —õ–µ–º–æ –∫–æ—Ä–∏—Å—Ç–∏—Ç–∏ –º–∞–ª–æ –¥—Ä—É–≥–∞—á–∏—ò–∏ –ø—Ä–∏—Å—Ç—É–ø –∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç–∏ Q-—Ç–∞–±–µ–ª—É –ø–æ–º–æ—õ—É —Ä–µ—á–Ω–∏–∫–∞.

1. –ö–æ—Ä–∏—Å—Ç–∏—Ç–µ –ø–∞—Ä *(state, action)* –∫–∞–æ –∫—ô—É—á —Ä–µ—á–Ω–∏–∫–∞, –∞ –≤—Ä–µ–¥–Ω–æ—Å—Ç –±–∏ –æ–¥–≥–æ–≤–∞—Ä–∞–ª–∞ –≤—Ä–µ–¥–Ω–æ—Å—Ç–∏ —É–Ω–æ—Å–∞ Q-—Ç–∞–±–µ–ª–µ. (–±–ª–æ–∫ –∫–æ–¥–∞ 9)

    ```python
    Q = {}
    actions = (0,1)
    
    def qvalues(state):
        return [Q.get((state,a),0) for a in actions]
    ```

    –û–≤–¥–µ —Ç–∞–∫–æ—í–µ –¥–µ—Ñ–∏–Ω–∏—à–µ–º–æ —Ñ—É–Ω–∫—Ü–∏—ò—É `qvalues()`, –∫–æ—ò–∞ –≤—Ä–∞—õ–∞ –ª–∏—Å—Ç—É –≤—Ä–µ–¥–Ω–æ—Å—Ç–∏ Q-—Ç–∞–±–µ–ª–µ –∑–∞ –¥–∞—Ç–æ —Å—Ç–∞—ö–µ –∫–æ—ò–µ –æ–¥–≥–æ–≤–∞—Ä–∞—ò—É —Å–≤–∏–º –º–æ–≥—É—õ–∏–º –∞–∫—Ü–∏—ò–∞–º–∞. –ê–∫–æ —É–Ω–æ—Å –Ω–∏—ò–µ –ø—Ä–∏—Å—É—Ç–∞–Ω —É Q-—Ç–∞–±–µ–ª–∏, –≤—Ä–∞—Ç–∏—õ–µ–º–æ 0 –∫–∞–æ –ø–æ–¥—Ä–∞–∑—É–º–µ–≤–∞–Ω—É –≤—Ä–µ–¥–Ω–æ—Å—Ç.

## –ü–æ—á–Ω–∏–º–æ —Å–∞ Q-—É—á–µ—ö–µ–º

–°–∞–¥–∞ —Å–º–æ —Å–ø—Ä–µ–º–Ω–∏ –¥–∞ –Ω–∞—É—á–∏–º–æ –ü–µ—Ç—Ä–∞ –∫–∞–∫–æ –¥–∞ –æ–¥—Ä–∂–∞–≤–∞ —Ä–∞–≤–Ω–æ—Ç–µ–∂—É!

1. –ü—Ä–≤–æ, –ø–æ–¥–µ—Å–∏–º–æ –Ω–µ–∫–µ —Ö–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–µ: (–±–ª–æ–∫ –∫–æ–¥–∞ 10)

    ```python
    # hyperparameters
    alpha = 0.3
    gamma = 0.9
    epsilon = 0.90
    ```

    –û–≤–¥–µ —ò–µ `alpha` **—Å—Ç–æ–ø–∞ —É—á–µ—ö–∞** –∫–æ—ò–∞ –¥–µ—Ñ–∏–Ω–∏—à–µ —É –∫–æ—ò–æ—ò –º–µ—Ä–∏ —Ç—Ä–µ–±–∞ –¥–∞ –ø—Ä–∏–ª–∞–≥–æ–¥–∏–º–æ —Ç—Ä–µ–Ω—É—Ç–Ω–µ –≤—Ä–µ–¥–Ω–æ—Å—Ç–∏ Q-—Ç–∞–±–µ–ª–µ –Ω–∞ —Å–≤–∞–∫–æ–º –∫–æ—Ä–∞–∫—É. –£ –ø—Ä–µ—Ç—Ö–æ–¥–Ω–æ—ò –ª–µ–∫—Ü–∏—ò–∏ –ø–æ—á–µ–ª–∏ —Å–º–æ —Å–∞ 1, –∞ –∑–∞—Ç–∏–º —Å–º–∞—ö–∏–ª–∏ `alpha` –Ω–∞ –Ω–∏–∂–µ –≤—Ä–µ–¥–Ω–æ—Å—Ç–∏ —Ç–æ–∫–æ–º —Ç—Ä–µ–Ω–∏–Ω–≥–∞. –£ –æ–≤–æ–º –ø—Ä–∏–º–µ—Ä—É —õ–µ–º–æ –≥–∞ –¥—Ä–∂–∞—Ç–∏ –∫–æ–Ω—Å—Ç–∞–Ω—Ç–Ω–∏–º —Ä–∞–¥–∏ —ò–µ–¥–Ω–æ—Å—Ç–∞–≤–Ω–æ—Å—Ç–∏, –∞ –≤–∏ –º–æ–∂–µ—Ç–µ –µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏—Å–∞—Ç–∏ —Å–∞ –ø—Ä–∏–ª–∞–≥–æ—í–∞–≤–∞—ö–µ–º –≤—Ä–µ–¥–Ω–æ—Å—Ç–∏ `alpha` –∫–∞—Å–Ω–∏—ò–µ.

    `gamma` —ò–µ **—Ñ–∞–∫—Ç–æ—Ä –ø–æ–ø—É—Å—Ç–∞** –∫–æ—ò–∏ –ø–æ–∫–∞–∑—É—ò–µ —É –∫–æ—ò–æ—ò –º–µ—Ä–∏ —Ç—Ä–µ–±–∞ –¥–∞ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –¥–∞–º–æ –±—É–¥—É—õ–æ—ò –Ω–∞–≥—Ä–∞–¥–∏ —É –æ–¥–Ω–æ—Å—É –Ω–∞ —Ç—Ä–µ–Ω—É—Ç–Ω—É –Ω–∞–≥—Ä–∞–¥—É.

    `epsilon` —ò–µ **—Ñ–∞–∫—Ç–æ—Ä –∏—Å—Ç—Ä–∞–∂–∏–≤–∞—ö–∞/–µ–∫—Å–ø–ª–æ–∞—Ç–∞—Ü–∏—ò–µ** –∫–æ—ò–∏ –æ–¥—Ä–µ—í—É—ò–µ –¥–∞ –ª–∏ —Ç—Ä–µ–±–∞ –¥–∞ –ø—Ä–µ—Ñ–µ—Ä–∏—Ä–∞–º–æ –∏—Å—Ç—Ä–∞–∂–∏–≤–∞—ö–µ —É –æ–¥–Ω–æ—Å—É –Ω–∞ –µ–∫—Å–ø–ª–æ–∞—Ç–∞—Ü–∏—ò—É –∏–ª–∏ –æ–±—Ä–Ω—É—Ç–æ. –£ –Ω–∞—à–µ–º –∞–ª–≥–æ—Ä–∏—Ç–º—É, —É `epsilon` –ø—Ä–æ—Ü–µ–Ω—Ç—É —Å–ª—É—á–∞—ò–µ–≤–∞ –∏–∑–∞–±—Ä–∞—õ–µ–º–æ —Å–ª–µ–¥–µ—õ—É –∞–∫—Ü–∏—ò—É –ø—Ä–µ–º–∞ –≤—Ä–µ–¥–Ω–æ—Å—Ç–∏–º–∞ Q-—Ç–∞–±–µ–ª–µ, –∞ —É –ø—Ä–µ–æ—Å—Ç–∞–ª–æ–º –±—Ä–æ—ò—É —Å–ª—É—á–∞—ò–µ–≤–∞ –∏–∑–≤—Ä—à–∏—õ–µ–º–æ –Ω–∞—Å—É–º–∏—á–Ω—É –∞–∫—Ü–∏—ò—É. –û–≤–æ —õ–µ –Ω–∞–º –æ–º–æ–≥—É—õ–∏—Ç–∏ –¥–∞ –∏—Å—Ç—Ä–∞–∂–∏–º–æ –æ–±–ª–∞—Å—Ç–∏ –ø—Ä–µ—Ç—Ä–∞–∂–∏–≤–∞—á–∫–æ–≥ –ø—Ä–æ—Å—Ç–æ—Ä–∞ –∫–æ—ò–µ —Ä–∞–Ω–∏—ò–µ –Ω–∏—Å–º–æ –≤–∏–¥–µ–ª–∏.

    ‚úÖ –£ —Å–º–∏—Å–ª—É —Ä–∞–≤–Ω–æ—Ç–µ–∂–µ ‚Äì –æ–¥–∞–±–∏—Ä –Ω–∞—Å—É–º–∏—á–Ω–µ –∞–∫—Ü–∏—ò–µ (–∏—Å—Ç—Ä–∞–∂–∏–≤–∞—ö–µ) –¥–µ–ª–æ–≤–∞–æ –±–∏ –∫–∞–æ –Ω–∞—Å—É–º–∏—á–∞–Ω —É–¥–∞—Ä–∞—Ü —É –ø–æ–≥—Ä–µ—à–Ω–æ–º —Å–º–µ—Ä—É, –∞ —à–∏–ø–∫–∞ –±–∏ –º–æ—Ä–∞–ª–∞ –¥–∞ –Ω–∞—É—á–∏ –∫–∞–∫–æ –¥–∞ –ø–æ–≤—Ä–∞—Ç–∏ —Ä–∞–≤–Ω–æ—Ç–µ–∂—É –∏–∑ —Ç–∏—Ö "–≥—Ä–µ—à–∞–∫–∞".

### –ü–æ–±–æ—ô—à–∞—ö–µ –∞–ª–≥–æ—Ä–∏—Ç–º–∞

–ú–æ–∂–µ–º–æ –Ω–∞–ø—Ä–∞–≤–∏—Ç–∏ –¥–≤–∞ –ø–æ–±–æ—ô—à–∞—ö–∞ –Ω–∞—à–µ–≥ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –∏–∑ –ø—Ä–µ—Ç—Ö–æ–¥–Ω–µ –ª–µ–∫—Ü–∏—ò–µ:

- **–ò–∑—Ä–∞—á—É–Ω–∞—ò—Ç–µ –ø—Ä–æ—Å–µ—á–Ω—É –∫—É–º—É–ª–∞—Ç–∏–≤–Ω—É –Ω–∞–≥—Ä–∞–¥—É**, —Ç–æ–∫–æ–º –æ–¥—Ä–µ—í–µ–Ω–æ–≥ –±—Ä–æ—ò–∞ —Å–∏–º—É–ª–∞—Ü–∏—ò–∞. –®—Ç–∞–º–ø–∞—õ–µ–º–æ –Ω–∞–ø—Ä–µ–¥–∞–∫ —Å–≤–∞–∫–∏—Ö 5000 –∏—Ç–µ—Ä–∞—Ü–∏—ò–∞ –∏ –ø—Ä–æ—Å–µ—á–∏—Ç–∏ –Ω–∞—à—É –∫—É–º—É–ª–∞—Ç–∏–≤–Ω—É –Ω–∞–≥—Ä–∞–¥—É —Ç–æ–∫–æ–º —Ç–æ–≥ –ø–µ—Ä–∏–æ–¥–∞. –¢–æ –∑–Ω–∞—á–∏ –¥–∞ –∞–∫–æ –¥–æ–±–∏—ò–µ–º–æ –≤–∏—à–µ –æ–¥ 195 –ø–æ–µ–Ω–∞ ‚Äì –º–æ–∂–µ–º–æ —Å–º–∞—Ç—Ä–∞—Ç–∏ –¥–∞ —ò–µ –ø—Ä–æ–±–ª–µ–º —Ä–µ—à–µ–Ω, –∏ —Ç–æ —Å–∞ —ò–æ—à –≤–µ—õ–∏–º –∫–≤–∞–ª–∏—Ç–µ—Ç–æ–º –Ω–µ–≥–æ —à—Ç–æ —ò–µ –ø–æ—Ç—Ä–µ–±–Ω–æ.

- **–ò–∑—Ä–∞—á—É–Ω–∞—ò—Ç–µ –º–∞–∫—Å–∏–º–∞–ª–Ω–∏ –ø—Ä–æ—Å–µ—á–Ω–∏ –∫—É–º—É–ª–∞—Ç–∏–≤–Ω–∏ —Ä–µ–∑—É–ª—Ç–∞—Ç**, `Qmax`, –∏ —Å–∞—á—É–≤–∞—õ–µ–º–æ Q-—Ç–∞–±–µ–ª—É –∫–æ—ò–∞ –æ–¥–≥–æ–≤–∞—Ä–∞ —Ç–æ–º —Ä–µ–∑—É–ª—Ç–∞—Ç—É. –ö–∞–¥–∞ –ø–æ–∫—Ä–µ–Ω–µ—Ç–µ —Ç—Ä–µ–Ω–∏–Ω–≥, –ø—Ä–∏–º–µ—Ç–∏—õ–µ—Ç–µ –¥–∞ –ø–æ–Ω–µ–∫–∞–¥ –ø—Ä–æ—Å–µ—á–Ω–∏ –∫—É–º—É–ª–∞—Ç–∏–≤–Ω–∏ —Ä–µ–∑—É–ª—Ç–∞—Ç –ø–æ—á–∏—ö–µ –¥–∞ –æ–ø–∞–¥–∞, –∏ –∂–µ–ª–∏–º–æ –¥–∞ –∑–∞–¥—Ä–∂–∏–º–æ –≤—Ä–µ–¥–Ω–æ—Å—Ç–∏ Q-—Ç–∞–±–µ–ª–µ –∫–æ—ò–µ –æ–¥–≥–æ–≤–∞—Ä–∞—ò—É –Ω–∞—ò–±–æ—ô–µ–º –º–æ–¥–µ–ª—É –ø–æ—Å–º–∞—Ç—Ä–∞–Ω–æ–º —Ç–æ–∫–æ–º —Ç—Ä–µ–Ω–∏–Ω–≥–∞.

1. –°–∞–∫—É–ø–∏—Ç–µ —Å–≤–µ –∫—É–º—É–ª–∞—Ç–∏–≤–Ω–µ –Ω–∞–≥—Ä–∞–¥–µ —É —Å–≤–∞–∫–æ—ò —Å–∏–º—É–ª–∞—Ü–∏—ò–∏ —É –≤–µ–∫—Ç–æ—Ä—É `rewards` –∑–∞ –¥–∞—ô–µ –≥—Ä–∞—Ñ–∏—á–∫–æ –ø—Ä–∏–∫–∞–∑–∏–≤–∞—ö–µ. (–±–ª–æ–∫ –∫–æ–¥–∞ 11)

    ```python
    def probs(v,eps=1e-4):
        v = v-v.min()+eps
        v = v/v.sum()
        return v
    
    Qmax = 0
    cum_rewards = []
    rewards = []
    for epoch in range(100000):
        obs = env.reset()
        done = False
        cum_reward=0
        # == do the simulation ==
        while not done:
            s = discretize(obs)
            if random.random()<epsilon:
                # exploitation - chose the action according to Q-Table probabilities
                v = probs(np.array(qvalues(s)))
                a = random.choices(actions,weights=v)[0]
            else:
                # exploration - randomly chose the action
                a = np.random.randint(env.action_space.n)
    
            obs, rew, done, info = env.step(a)
            cum_reward+=rew
            ns = discretize(obs)
            Q[(s,a)] = (1 - alpha) * Q.get((s,a),0) + alpha * (rew + gamma * max(qvalues(ns)))
        cum_rewards.append(cum_reward)
        rewards.append(cum_reward)
        # == Periodically print results and calculate average reward ==
        if epoch%5000==0:
            print(f"{epoch}: {np.average(cum_rewards)}, alpha={alpha}, epsilon={epsilon}")
            if np.average(cum_rewards) > Qmax:
                Qmax = np.average(cum_rewards)
                Qbest = Q
            cum_rewards=[]
    ```

–®—Ç–∞ –º–æ–∂–µ—Ç–µ –ø—Ä–∏–º–µ—Ç–∏—Ç–∏ –∏–∑ –æ–≤–∏—Ö —Ä–µ–∑—É–ª—Ç–∞—Ç–∞:

- **–ë–ª–∏–∑—É –Ω–∞—à–µ–≥ —Ü–∏—ô–∞**. –í–µ–æ–º–∞ —Å–º–æ –±–ª–∏–∑—É –ø–æ—Å—Ç–∏–∑–∞—ö–∞ —Ü–∏—ô–∞ –æ–¥ 195 –∫—É–º—É–ª–∞—Ç–∏–≤–Ω–∏—Ö –Ω–∞–≥—Ä–∞–¥–∞ —Ç–æ–∫–æ–º 100+ —É–∑–∞—Å—Ç–æ–ø–Ω–∏—Ö –ø–æ–∫—É—à–∞—ò–∞ —Å–∏–º—É–ª–∞—Ü–∏—ò–µ, –∏–ª–∏ —Å–º–æ –≥–∞ –º–æ–∂–¥–∞ –≤–µ—õ –ø–æ—Å—Ç–∏–≥–ª–∏! –ß–∞–∫ –∏ –∞–∫–æ –¥–æ–±–∏—ò–µ–º–æ –º–∞—ö–µ –±—Ä–æ—ò–µ–≤–µ, –∏ –¥–∞—ô–µ –Ω–µ –∑–Ω–∞–º–æ, —ò–µ—Ä –ø—Ä–æ—Å–µ—á–∏–º–æ –ø—Ä–µ–∫–æ 5000 –ø–æ–∫—É—à–∞—ò–∞, –∞ —Å–∞–º–æ 100 –ø–æ–∫—É—à–∞—ò–∞ —ò–µ –ø–æ—Ç—Ä–µ–±–Ω–æ –ø—Ä–µ–º–∞ —Ñ–æ—Ä–º–∞–ª–Ω–∏–º –∫—Ä–∏—Ç–µ—Ä–∏—ò—É–º–∏–º–∞.

- **–ù–∞–≥—Ä–∞–¥–∞ –ø–æ—á–∏—ö–µ –¥–∞ –æ–ø–∞–¥–∞**. –ü–æ–Ω–µ–∫–∞–¥ –Ω–∞–≥—Ä–∞–¥–∞ –ø–æ—á–∏—ö–µ –¥–∞ –æ–ø–∞–¥–∞, —à—Ç–æ –∑–Ω–∞—á–∏ –¥–∞ –º–æ–∂–µ–º–æ "—É–Ω–∏—à—Ç–∞–≤–∞—Ç–∏" –≤–µ—õ –Ω–∞—É—á–µ–Ω–µ –≤—Ä–µ–¥–Ω–æ—Å—Ç–∏ —É Q-—Ç–∞–±–µ–ª–∏ —Å–∞ –æ–Ω–∏–º–∞ –∫–æ—ò–µ –ø–æ–≥–æ—Ä—à–∞–≤–∞—ò—É —Å–∏—Ç—É–∞—Ü–∏—ò—É.

–û–≤–æ –∑–∞–ø–∞–∂–∞—ö–µ —ò–µ —ò–∞—Å–Ω–∏—ò–µ –≤–∏–¥—ô–∏–≤–æ –∞–∫–æ –≥—Ä–∞—Ñ–∏—á–∫–∏ –ø—Ä–∏–∫–∞–∂–µ–º–æ –Ω–∞–ø—Ä–µ–¥–∞–∫ —Ç—Ä–µ–Ω–∏–Ω–≥–∞.

## –ì—Ä–∞—Ñ–∏—á–∫–∏ –ø—Ä–∏–∫–∞–∑ –Ω–∞–ø—Ä–µ—Ç–∫–∞ —Ç—Ä–µ–Ω–∏–Ω–≥–∞

–¢–æ–∫–æ–º —Ç—Ä–µ–Ω–∏–Ω–≥–∞, —Å–∞–∫—É–ø–∏–ª–∏ —Å–º–æ –≤—Ä–µ–¥–Ω–æ—Å—Ç –∫—É–º—É–ª–∞—Ç–∏–≤–Ω–µ –Ω–∞–≥—Ä–∞–¥–µ —É —Å–≤–∞–∫–æ—ò –æ–¥ –∏—Ç–µ—Ä–∞—Ü–∏—ò–∞ —É –≤–µ–∫—Ç–æ—Ä—É `rewards`. –ï–≤–æ –∫–∞–∫–æ –∏–∑–≥–ª–µ–¥–∞ –∫–∞–¥–∞ –≥–∞ –≥—Ä–∞—Ñ–∏—á–∫–∏ –ø—Ä–∏–∫–∞–∂–µ–º–æ —É –æ–¥–Ω–æ—Å—É –Ω–∞ –±—Ä–æ—ò –∏—Ç–µ—Ä–∞—Ü–∏—ò–∞:

```python
plt.plot(rewards)
```

![–Ω–µ–æ–±—Ä–∞—í–µ–Ω –Ω–∞–ø—Ä–µ–¥–∞–∫](../../../../8-Reinforcement/2-Gym/images/train_progress_raw.png)

–ò–∑ –æ–≤–æ–≥ –≥—Ä–∞—Ñ–∏–∫–∞ –Ω–∏—ò–µ –º–æ–≥—É—õ–µ –∑–∞–∫—ô—É—á–∏—Ç–∏ –Ω–∏—à—Ç–∞, —ò–µ—Ä –∑–±–æ–≥ –ø—Ä–∏—Ä–æ–¥–µ —Å—Ç–æ—Ö–∞—Å—Ç–∏—á–∫–æ–≥ –ø—Ä–æ—Ü–µ—Å–∞ —Ç—Ä–µ–Ω–∏–Ω–≥–∞ –¥—É–∂–∏–Ω–∞ —Å–µ—Å–∏—ò–∞ —Ç—Ä–µ–Ω–∏–Ω–≥–∞ –≤–∞—Ä–∏—Ä–∞ —É –≤–µ–ª–∏–∫–æ—ò –º–µ—Ä–∏. –î–∞ –±–∏—Å–º–æ –æ–≤–∞—ò –≥—Ä–∞—Ñ–∏–∫ —É—á–∏–Ω–∏–ª–∏ —Å–º–∏—Å–ª–µ–Ω–∏—ò–∏–º, –º–æ–∂–µ–º–æ –∏–∑—Ä–∞—á—É–Ω–∞—Ç–∏ **–ø–æ–∫—Ä–µ—Ç–Ω–∏ –ø—Ä–æ—Å–µ–∫** —Ç–æ–∫–æ–º —Å–µ—Ä–∏—ò–µ –µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω–∞—Ç–∞, —Ä–µ—Ü–∏–º–æ 100. –û–≤–æ —Å–µ –º–æ–∂–µ –∑–≥–æ–¥–Ω–æ —É—Ä–∞–¥–∏—Ç–∏ –ø–æ–º–æ—õ—É `np.convolve`: (–±–ª–æ–∫ –∫–æ–¥–∞ 12)

```python
def running_average(x,window):
    return np.convolve(x,np.ones(window)/window,mode='valid')

plt.plot(running_average(rewards,100))
```

![–Ω–∞–ø—Ä–µ–¥–∞–∫ —Ç—Ä–µ–Ω–∏–Ω–≥–∞](../../../../8-Reinforcement/2-Gym/images/train_progress_runav.png)

## –ü—Ä–æ–º–µ–Ω—ô–∏–≤–∏ —Ö–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–∏

–î–∞ –±–∏ —É—á–µ—ö–µ –±–∏–ª–æ —Å—Ç–∞–±–∏–ª–Ω–∏—ò–µ, –∏–º–∞ —Å–º–∏—Å–ª–∞ –ø—Ä–∏–ª–∞–≥–æ–¥–∏—Ç–∏ –Ω–µ–∫–µ –æ–¥ –Ω–∞—à–∏—Ö —Ö–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç–∞—Ä–∞ —Ç–æ–∫–æ–º —Ç—Ä–µ–Ω–∏–Ω–≥–∞. –ö–æ–Ω–∫—Ä–µ—Ç–Ω–æ:

- **–ó–∞ —Å—Ç–æ–ø—É —É—á–µ—ö–∞**, `alpha`, –º–æ–∂–µ–º–æ –ø–æ—á–µ—Ç–∏ —Å–∞ –≤—Ä–µ–¥–Ω–æ—Å—Ç–∏–º–∞ –±–ª–∏—Å–∫–∏–º 1, –∞ –∑–∞—Ç–∏–º –ø–æ—Å—Ç–µ–ø–µ–Ω–æ —Å–º–∞—ö–∏–≤–∞—Ç–∏ –ø–∞—Ä–∞–º–µ—Ç–∞—Ä. –í—Ä–µ–º–µ–Ω–æ–º —õ–µ–º–æ –¥–æ–±–∏—ò–∞—Ç–∏ –¥–æ–±—Ä–µ –≤—Ä–µ–¥–Ω–æ—Å—Ç–∏ –≤–µ—Ä–æ–≤–∞—Ç–Ω–æ—õ–µ —É Q-—Ç–∞–±–µ–ª–∏, –∏ —Å—Ç–æ–≥–∞ –±–∏—Å–º–æ –∏—Ö —Ç—Ä–µ–±–∞–ª–∏ –±–ª–∞–≥–æ –ø—Ä–∏–ª–∞–≥–æ—í–∞–≤–∞—Ç–∏, –∞ –Ω–µ –ø–æ—Ç–ø—É–Ω–æ –ø—Ä–µ–ø–∏—Å–∏–≤–∞—Ç–∏ –Ω–æ–≤–∏–º –≤—Ä–µ–¥–Ω–æ—Å—Ç–∏–º–∞.

- **–ü–æ–≤–µ—õ–∞—ò—Ç–µ epsilon**. –ú–æ–∂–¥–∞ —õ
> **–ó–∞–¥–∞—Ç–∞–∫ 1**: –ò—Å–ø—Ä–æ–±–∞—ò—Ç–µ —Ä–∞–∑–ª–∏—á–∏—Ç–µ –≤—Ä–µ–¥–Ω–æ—Å—Ç–∏ —Ö–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç–∞—Ä–∞ –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç–µ –¥–∞ –ª–∏ –º–æ–∂–µ—Ç–µ –ø–æ—Å—Ç–∏—õ–∏ –≤–µ—õ–∏ –∫—É–º—É–ª–∞—Ç–∏–≤–Ω–∏ –Ω–∞–≥—Ä–∞–¥–Ω–∏ —Ä–µ–∑—É–ª—Ç–∞—Ç. –î–∞ –ª–∏ –¥–æ–±–∏—ò–∞—Ç–µ —Ä–µ–∑—É–ª—Ç–∞—Ç –∏–∑–Ω–∞–¥ 195?
> **–ó–∞–¥–∞—Ç–∞–∫ 2**: –î–∞ –±–∏—Å—Ç–µ —Ñ–æ—Ä–º–∞–ª–Ω–æ —Ä–µ—à–∏–ª–∏ –ø—Ä–æ–±–ª–µ–º, –ø–æ—Ç—Ä–µ–±–Ω–æ —ò–µ –¥–∞ –ø–æ—Å—Ç–∏–≥–Ω–µ—Ç–µ –ø—Ä–æ—Å–µ—á–Ω—É –Ω–∞–≥—Ä–∞–¥—É –æ–¥ 195 —Ç–æ–∫–æ–º 100 —É–∑–∞—Å—Ç–æ–ø–Ω–∏—Ö –ø–æ–∫—Ä–µ—Ç–∞—ö–∞. –ú–µ—Ä–∏—Ç–µ —Ç–æ —Ç–æ–∫–æ–º —Ç—Ä–µ–Ω–∏–Ω–≥–∞ –∏ —É–≤–µ—Ä–∏—Ç–µ —Å–µ –¥–∞ —Å—Ç–µ —Ñ–æ—Ä–º–∞–ª–Ω–æ —Ä–µ—à–∏–ª–∏ –ø—Ä–æ–±–ª–µ–º!

## –ì–ª–µ–¥–∞—ö–µ —Ä–µ–∑—É–ª—Ç–∞—Ç–∞ —É –ø—Ä–∞–∫—Å–∏

–ë–∏–ª–æ –±–∏ –∑–∞–Ω–∏–º—ô–∏–≤–æ –≤–∏–¥–µ—Ç–∏ –∫–∞–∫–æ —Å–µ –æ–±—É—á–µ–Ω–∏ –º–æ–¥–µ–ª –ø–æ–Ω–∞—à–∞. –ü–æ–∫—Ä–µ–Ω–∏–º–æ —Å–∏–º—É–ª–∞—Ü–∏—ò—É –∏ –ø—Ä–∞—Ç–∏–º–æ –∏—Å—Ç—É —Å—Ç—Ä–∞—Ç–µ–≥–∏—ò—É –∏–∑–±–æ—Ä–∞ –∞–∫—Ü–∏—ò–∞ –∫–∞–æ —Ç–æ–∫–æ–º —Ç—Ä–µ–Ω–∏–Ω–≥–∞, —É–∑–æ—Ä–∫—É—ò—É—õ–∏ –ø—Ä–µ–º–∞ —Ä–∞—Å–ø–æ–¥–µ–ª–∏ –≤–µ—Ä–æ–≤–∞—Ç–Ω–æ—õ–µ —É Q-—Ç–∞–±–µ–ª–∏: (–±–ª–æ–∫ –∫–æ–¥–∞ 13)

```python
obs = env.reset()
done = False
while not done:
   s = discretize(obs)
   env.render()
   v = probs(np.array(qvalues(s)))
   a = random.choices(actions,weights=v)[0]
   obs,_,done,_ = env.step(a)
env.close()
```

–¢—Ä–µ–±–∞–ª–æ –±–∏ –¥–∞ –≤–∏–¥–∏—Ç–µ –Ω–µ—à—Ç–æ –æ–≤–∞–∫–æ:

![a balancing cartpole](../../../../8-Reinforcement/2-Gym/images/cartpole-balance.gif)

---

## üöÄ–ò–∑–∞–∑–æ–≤

> **–ó–∞–¥–∞—Ç–∞–∫ 3**: –û–≤–¥–µ —Å–º–æ –∫–æ—Ä–∏—Å—Ç–∏–ª–∏ —Ñ–∏–Ω–∞–ª–Ω—É –∫–æ–ø–∏—ò—É Q-—Ç–∞–±–µ–ª–µ, –∫–æ—ò–∞ –º–æ–∂–¥–∞ –Ω–∏—ò–µ –Ω–∞—ò–±–æ—ô–∞. –ó–∞–ø–∞–º—Ç–∏—Ç–µ –¥–∞ —Å–º–æ —Å–∞—á—É–≤–∞–ª–∏ –Ω–∞—ò–±–æ—ô–µ –ø–µ—Ä—Ñ–æ—Ä–º–∞–Ω—Ç–Ω—É Q-—Ç–∞–±–µ–ª—É —É –ø—Ä–æ–º–µ–Ω—ô–∏–≤—É `Qbest`! –ü—Ä–æ–±–∞—ò—Ç–µ –∏—Å—Ç–∏ –ø—Ä–∏–º–µ—Ä —Å–∞ –Ω–∞—ò–±–æ—ô–æ–º Q-—Ç–∞–±–µ–ª–æ–º —Ç–∞–∫–æ —à—Ç–æ —õ–µ—Ç–µ –∫–æ–ø–∏—Ä–∞—Ç–∏ `Qbest` —É `Q` –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç–µ –¥–∞ –ª–∏ –ø—Ä–∏–º–µ—õ—É—ò–µ—Ç–µ —Ä–∞–∑–ª–∏–∫—É.

> **–ó–∞–¥–∞—Ç–∞–∫ 4**: –û–≤–¥–µ –Ω–∏—Å–º–æ –±–∏—Ä–∞–ª–∏ –Ω–∞—ò–±–æ—ô—É –∞–∫—Ü–∏—ò—É —É —Å–≤–∞–∫–æ–º –∫–æ—Ä–∞–∫—É, –≤–µ—õ —Å–º–æ —É–∑–æ—Ä–∫–æ–≤–∞–ª–∏ –ø—Ä–µ–º–∞ –æ–¥–≥–æ–≤–∞—Ä–∞—ò—É—õ–æ—ò —Ä–∞—Å–ø–æ–¥–µ–ª–∏ –≤–µ—Ä–æ–≤–∞—Ç–Ω–æ—õ–µ. –î–∞ –ª–∏ –±–∏ –∏–º–∞–ª–æ –≤–∏—à–µ —Å–º–∏—Å–ª–∞ —É–≤–µ–∫ –±–∏—Ä–∞—Ç–∏ –Ω–∞—ò–±–æ—ô—É –∞–∫—Ü–∏—ò—É, —Å–∞ –Ω–∞—ò–≤–∏—à–æ–º –≤—Ä–µ–¥–Ω–æ—à—õ—É —É Q-—Ç–∞–±–µ–ª–∏? –û–≤–æ —Å–µ –º–æ–∂–µ —É—Ä–∞–¥–∏—Ç–∏ –∫–æ—Ä–∏—à—õ–µ—ö–µ–º —Ñ—É–Ω–∫—Ü–∏—ò–µ `np.argmax` –¥–∞ —Å–µ –ø—Ä–æ–Ω–∞—í–µ –±—Ä–æ—ò –∞–∫—Ü–∏—ò–µ –∫–æ—ò–∏ –æ–¥–≥–æ–≤–∞—Ä–∞ –Ω–∞—ò–≤–∏—à–æ—ò –≤—Ä–µ–¥–Ω–æ—Å—Ç–∏ —É Q-—Ç–∞–±–µ–ª–∏. –ò–º–ø–ª–µ–º–µ–Ω—Ç–∏—Ä–∞—ò—Ç–µ –æ–≤—É —Å—Ç—Ä–∞—Ç–µ–≥–∏—ò—É –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç–µ –¥–∞ –ª–∏ –ø–æ–±–æ—ô—à–∞–≤–∞ –±–∞–ª–∞–Ω—Å–∏—Ä–∞—ö–µ.

## [–ö–≤–∏–∑ –Ω–∞–∫–æ–Ω –ø—Ä–µ–¥–∞–≤–∞—ö–∞](https://ff-quizzes.netlify.app/en/ml/)

## –ó–∞–¥–∞—Ç–∞–∫
[–¢—Ä–µ–Ω–∏—Ä–∞—ò—Ç–µ Mountain Car](assignment.md)

## –ó–∞–∫—ô—É—á–∞–∫

–°–∞–¥–∞ —Å–º–æ –Ω–∞—É—á–∏–ª–∏ –∫–∞–∫–æ –¥–∞ –æ–±—É—á–∏–º–æ –∞–≥–µ–Ω—Ç–µ –¥–∞ –ø–æ—Å—Ç–∏–≥–Ω—É –¥–æ–±—Ä–µ —Ä–µ–∑—É–ª—Ç–∞—Ç–µ —Å–∞–º–æ –ø—Ä—É–∂–∞—ö–µ–º —Ñ—É–Ω–∫—Ü–∏—ò–µ –Ω–∞–≥—Ä–∞–¥–µ –∫–æ—ò–∞ –¥–µ—Ñ–∏–Ω–∏—à–µ –∂–µ—ô–µ–Ω–æ —Å—Ç–∞—ö–µ –∏–≥—Ä–µ –∏ –¥–∞–≤–∞—ö–µ–º –º–æ–≥—É—õ–Ω–æ—Å—Ç–∏ –¥–∞ –∏–Ω—Ç–µ–ª–∏–≥–µ–Ω—Ç–Ω–æ –∏—Å—Ç—Ä–∞–∂—É—ò—É –ø—Ä–æ—Å—Ç–æ—Ä –ø—Ä–µ—Ç—Ä–∞–≥–µ. –£—Å–ø–µ—à–Ω–æ —Å–º–æ –ø—Ä–∏–º–µ–Ω–∏–ª–∏ Q-Learning –∞–ª–≥–æ—Ä–∏—Ç–∞–º —É —Å–ª—É—á–∞—ò–µ–≤–∏–º–∞ –¥–∏—Å–∫—Ä–µ—Ç–Ω–∏—Ö –∏ –∫–æ–Ω—Ç–∏–Ω—É–∞–ª–Ω–∏—Ö –æ–∫—Ä—É–∂–µ—ö–∞, –∞–ª–∏ —Å–∞ –¥–∏—Å–∫—Ä–µ—Ç–Ω–∏–º –∞–∫—Ü–∏—ò–∞–º–∞.

–í–∞–∂–Ω–æ —ò–µ —Ç–∞–∫–æ—í–µ –ø—Ä–æ—É—á–∏—Ç–∏ —Å–∏—Ç—É–∞—Ü–∏—ò–µ —É –∫–æ—ò–∏–º–∞ —ò–µ –ø—Ä–æ—Å—Ç–æ—Ä –∞–∫—Ü–∏—ò–∞ —Ç–∞–∫–æ—í–µ –∫–æ–Ω—Ç–∏–Ω—É–∞–ª–∞–Ω, –∫–∞–æ –∏ –∫–∞–¥–∞ —ò–µ –ø—Ä–æ—Å—Ç–æ—Ä –ø–æ—Å–º–∞—Ç—Ä–∞—ö–∞ –º–Ω–æ–≥–æ —Å–ª–æ–∂–µ–Ω–∏—ò–∏, –ø–æ–ø—É—Ç —Å–ª–∏–∫–µ —Å–∞ –µ–∫—Ä–∞–Ω–∞ Atari –∏–≥—Ä–µ. –£ —Ç–∏–º –ø—Ä–æ–±–ª–µ–º–∏–º–∞ —á–µ—Å—Ç–æ —ò–µ –ø–æ—Ç—Ä–µ–±–Ω–æ –∫–æ—Ä–∏—Å—Ç–∏—Ç–∏ –º–æ—õ–Ω–∏—ò–µ —Ç–µ—Ö–Ω–∏–∫–µ –º–∞—à–∏–Ω—Å–∫–æ–≥ —É—á–µ—ö–∞, –∫–∞–æ —à—Ç–æ —Å—É –Ω–µ—É—Ä–æ–Ω—Å–∫–µ –º—Ä–µ–∂–µ, –∫–∞–∫–æ –±–∏ —Å–µ –ø–æ—Å—Ç–∏–≥–ª–∏ –¥–æ–±—Ä–∏ —Ä–µ–∑—É–ª—Ç–∞—Ç–∏. –¢–µ –Ω–∞–ø—Ä–µ–¥–Ω–∏—ò–µ —Ç–µ–º–µ –±–∏—õ–µ –ø—Ä–µ–¥–º–µ—Ç –Ω–∞—à–µ–≥ –Ω–∞—Ä–µ–¥–Ω–æ–≥, –Ω–∞–ø—Ä–µ–¥–Ω–∏—ò–µ–≥ –∫—É—Ä—Å–∞ –æ –≤–µ—à—Ç–∞—á–∫–æ—ò –∏–Ω—Ç–µ–ª–∏–≥–µ–Ω—Ü–∏—ò–∏.

---

**–û–¥—Ä–∏—Ü–∞—ö–µ –æ–¥ –æ–¥–≥–æ–≤–æ—Ä–Ω–æ—Å—Ç–∏**:  
–û–≤–∞—ò –¥–æ–∫—É–º–µ–Ω—Ç —ò–µ –ø—Ä–µ–≤–µ–¥–µ–Ω –∫–æ—Ä–∏—à—õ–µ—ö–µ–º —É—Å–ª—É–≥–µ –∑–∞ –ø—Ä–µ–≤–æ—í–µ—ö–µ –ø–æ–º–æ—õ—É –≤–µ—à—Ç–∞—á–∫–µ –∏–Ω—Ç–µ–ª–∏–≥–µ–Ω—Ü–∏—ò–µ [Co-op Translator](https://github.com/Azure/co-op-translator). –ò–∞–∫–æ –Ω–∞—Å—Ç–æ—ò–∏–º–æ –¥–∞ –æ–±–µ–∑–±–µ–¥–∏–º–æ —Ç–∞—á–Ω–æ—Å—Ç, –º–æ–ª–∏–º–æ –≤–∞—Å –¥–∞ –∏–º–∞—Ç–µ —É –≤–∏–¥—É –¥–∞ –∞—É—Ç–æ–º–∞—Ç—Å–∫–∏ –ø—Ä–µ–≤–æ–¥–∏ –º–æ–≥—É —Å–∞–¥—Ä–∂–∞—Ç–∏ –≥—Ä–µ—à–∫–µ –∏–ª–∏ –Ω–µ—Ç–∞—á–Ω–æ—Å—Ç–∏. –û—Ä–∏–≥–∏–Ω–∞–ª–Ω–∏ –¥–æ–∫—É–º–µ–Ω—Ç –Ω–∞ –∏–∑–≤–æ—Ä–Ω–æ–º —ò–µ–∑–∏–∫—É —Ç—Ä–µ–±–∞ —Å–º–∞—Ç—Ä–∞—Ç–∏ –∞—É—Ç–æ—Ä–∏—Ç–∞—Ç–∏–≤–Ω–∏–º –∏–∑–≤–æ—Ä–æ–º. –ó–∞ –∫—Ä–∏—Ç–∏—á–Ω–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—ò–µ –ø—Ä–µ–ø–æ—Ä—É—á—É—ò–µ —Å–µ –ø—Ä–æ—Ñ–µ—Å–∏–æ–Ω–∞–ª–Ω–∏ –ø—Ä–µ–≤–æ–¥ –æ–¥ —Å—Ç—Ä–∞–Ω–µ —ô—É–¥–∏. –ù–µ —Å–Ω–æ—Å–∏–º–æ –æ–¥–≥–æ–≤–æ—Ä–Ω–æ—Å—Ç –∑–∞ –±–∏–ª–æ –∫–∞–∫–≤–∞ –ø–æ–≥—Ä–µ—à–Ω–∞ —Ç—É–º–∞—á–µ—ö–∞ –∏–ª–∏ –Ω–µ—Å–ø–æ—Ä–∞–∑—É–º–µ –∫–æ—ò–∏ –º–æ–≥—É –ø—Ä–æ–∏–∑–∞—õ–∏ –∏–∑ –∫–æ—Ä–∏—à—õ–µ—ö–∞ –æ–≤–æ–≥ –ø—Ä–µ–≤–æ–¥–∞.