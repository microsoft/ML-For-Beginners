<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "911efd5e595089000cb3c16fce1beab8",
  "translation_date": "2025-09-05T13:34:18+00:00",
  "source_file": "8-Reinforcement/1-QLearning/README.md",
  "language_code": "sr"
}
-->
# –£–≤–æ–¥ —É —É—á–µ—ö–µ –ø–æ—ò–∞—á–∞—ö–µ–º –∏ Q-—É—á–µ—ö–µ

![–†–µ–∑–∏–º–µ —É—á–µ—ö–∞ –ø–æ—ò–∞—á–∞—ö–µ–º —É –º–∞—à–∏–Ω—Å–∫–æ–º —É—á–µ—ö—É —É –≤–∏–¥—É —Å–∫–∏—Ü–µ](../../../../sketchnotes/ml-reinforcement.png)
> –°–∫–∏—Ü–∞ –æ–¥ [Tomomi Imura](https://www.twitter.com/girlie_mac)

–£—á–µ—ö–µ –ø–æ—ò–∞—á–∞—ö–µ–º —É–∫—ô—É—á—É—ò–µ —Ç—Ä–∏ –≤–∞–∂–Ω–∞ –∫–æ–Ω—Ü–µ–ø—Ç–∞: –∞–≥–µ–Ω—Ç–∞, –Ω–µ–∫–∞ —Å—Ç–∞—ö–∞ –∏ —Å–∫—É–ø –∞–∫—Ü–∏—ò–∞ –∑–∞ —Å–≤–∞–∫–æ —Å—Ç–∞—ö–µ. –ò–∑–≤—Ä—à–∞–≤–∞—ö–µ–º –∞–∫—Ü–∏—ò–µ —É –æ–¥—Ä–µ—í–µ–Ω–æ–º —Å—Ç–∞—ö—É, –∞–≥–µ–Ω—Ç –¥–æ–±–∏—ò–∞ –Ω–∞–≥—Ä–∞–¥—É. –ó–∞–º–∏—Å–ª–∏—Ç–µ –ø–æ–Ω–æ–≤–æ –∫–æ–º–ø—ò—É—Ç–µ—Ä—Å–∫—É –∏–≥—Ä—É –°—É–ø–µ—Ä –ú–∞—Ä–∏–æ. –í–∏ —Å—Ç–µ –ú–∞—Ä–∏–æ, –Ω–∞–ª–∞–∑–∏—Ç–µ —Å–µ –Ω–∞ –Ω–∏–≤–æ—É –∏–≥—Ä–µ, —Å—Ç–æ—ò–∏—Ç–µ –ø–æ—Ä–µ–¥ –∏–≤–∏—Ü–µ –ª–∏—Ç–∏—Ü–µ. –ò–∑–Ω–∞–¥ –≤–∞—Å —ò–µ –Ω–æ–≤—á–∏—õ. –í–∏ —Å—Ç–µ –ú–∞—Ä–∏–æ, –Ω–∞ –Ω–∏–≤–æ—É –∏–≥—Ä–µ, –Ω–∞ –æ–¥—Ä–µ—í–µ–Ω–æ—ò –ø–æ–∑–∏—Ü–∏—ò–∏ ... —Ç–æ —ò–µ –≤–∞—à–µ —Å—Ç–∞—ö–µ. –ü–æ–º–µ—Ä–∞—ö–µ —ò–µ–¥–∞–Ω –∫–æ—Ä–∞–∫ —É–¥–µ—Å–Ω–æ (–∞–∫—Ü–∏—ò–∞) –æ–¥–≤–µ—à—õ–µ –≤–∞—Å –ø—Ä–µ–∫–æ –∏–≤–∏—Ü–µ, —à—Ç–æ –±–∏ –≤–∞–º –¥–æ–Ω–µ–ª–æ –Ω–∏–∑–∞–∫ –Ω—É–º–µ—Ä–∏—á–∫–∏ —Ä–µ–∑—É–ª—Ç–∞—Ç. –ú–µ—í—É—Ç–∏–º, –ø—Ä–∏—Ç–∏—Å–∫–æ–º –Ω–∞ –¥—É–≥–º–µ –∑–∞ —Å–∫–æ–∫ –¥–æ–±–∏–ª–∏ –±–∏—Å—Ç–µ –ø–æ–µ–Ω –∏ –æ—Å—Ç–∞–ª–∏ –±–∏—Å—Ç–µ –∂–∏–≤–∏. –¢–æ —ò–µ –ø–æ–∑–∏—Ç–∏–≤–∞–Ω –∏—Å—Ö–æ–¥ –∏ —Ç—Ä–µ–±–∞–ª–æ –±–∏ –¥–∞ –≤–∞–º –¥–æ–Ω–µ—Å–µ –ø–æ–∑–∏—Ç–∏–≤–∞–Ω –Ω—É–º–µ—Ä–∏—á–∫–∏ —Ä–µ–∑—É–ª—Ç–∞—Ç.

–ö–æ—Ä–∏—à—õ–µ—ö–µ–º —É—á–µ—ö–∞ –ø–æ—ò–∞—á–∞—ö–µ–º –∏ —Å–∏–º—É–ª–∞—Ç–æ—Ä–∞ (–∏–≥—Ä–µ), –º–æ–∂–µ—Ç–µ –Ω–∞—É—á–∏—Ç–∏ –∫–∞–∫–æ –¥–∞ –∏–≥—Ä–∞—Ç–µ –∏–≥—Ä—É –∫–∞–∫–æ –±–∏—Å—Ç–µ –º–∞–∫—Å–∏–º–∏–∑–æ–≤–∞–ª–∏ –Ω–∞–≥—Ä–∞–¥—É, —à—Ç–æ —ò–µ —É –æ–≤–æ–º —Å–ª—É—á–∞—ò—É –ø—Ä–µ–∂–∏–≤—ô–∞–≤–∞—ö–µ –∏ –æ—Å–≤–∞—ò–∞—ö–µ —à—Ç–æ –≤–∏—à–µ –ø–æ–µ–Ω–∞.

[![–£–≤–æ–¥ —É —É—á–µ—ö–µ –ø–æ—ò–∞—á–∞—ö–µ–º](https://img.youtube.com/vi/lDq_en8RNOo/0.jpg)](https://www.youtube.com/watch?v=lDq_en8RNOo)

> üé• –ö–ª–∏–∫–Ω–∏—Ç–µ –Ω–∞ —Å–ª–∏–∫—É –∏–∑–Ω–∞–¥ –¥–∞ —á—É—ò–µ—Ç–µ –î–º–∏—Ç—Ä–∏—ò–∞ –∫–∞–∫–æ –≥–æ–≤–æ—Ä–∏ –æ —É—á–µ—ö—É –ø–æ—ò–∞—á–∞—ö–µ–º

## [–ö–≤–∏–∑ –ø—Ä–µ –ø—Ä–µ–¥–∞–≤–∞—ö–∞](https://ff-quizzes.netlify.app/en/ml/)

## –ü—Ä–µ–¥—É—Å–ª–æ–≤–∏ –∏ –ø–æ–¥–µ—à–∞–≤–∞—ö–µ

–£ –æ–≤–æ—ò –ª–µ–∫—Ü–∏—ò–∏ —õ–µ–º–æ –µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏—Å–∞—Ç–∏ —Å–∞ –∫–æ–¥–æ–º —É –ü–∞—ò—Ç–æ–Ω—É. –¢—Ä–µ–±–∞–ª–æ –±–∏ –¥–∞ –±—É–¥–µ—Ç–µ —É –º–æ–≥—É—õ–Ω–æ—Å—Ç–∏ –¥–∞ –ø–æ–∫—Ä–µ–Ω–µ—Ç–µ –∫–æ–¥ –∏–∑ –à—É–ø–∏—Ç–µ—Ä –±–µ–ª–µ–∂–Ω–∏—Ü–µ –∏–∑ –æ–≤–µ –ª–µ–∫—Ü–∏—ò–µ, –±–∏–ª–æ –Ω–∞ –≤–∞—à–µ–º —Ä–∞—á—É–Ω–∞—Ä—É –∏–ª–∏ –Ω–µ–≥–¥–µ —É –æ–±–ª–∞–∫—É.

–ú–æ–∂–µ—Ç–µ –æ—Ç–≤–æ—Ä–∏—Ç–∏ [–±–µ–ª–µ–∂–Ω–∏—Ü—É –ª–µ–∫—Ü–∏—ò–µ](https://github.com/microsoft/ML-For-Beginners/blob/main/8-Reinforcement/1-QLearning/notebook.ipynb) –∏ –ø—Ä–∞—Ç–∏—Ç–∏ –æ–≤—É –ª–µ–∫—Ü–∏—ò—É –∫–∞–∫–æ –±–∏—Å—Ç–µ —ò–µ –∏–∑–≥—Ä–∞–¥–∏–ª–∏.

> **–ù–∞–ø–æ–º–µ–Ω–∞:** –ê–∫–æ –æ—Ç–≤–∞—Ä–∞—Ç–µ –æ–≤–∞—ò –∫–æ–¥ –∏–∑ –æ–±–ª–∞–∫–∞, —Ç–∞–∫–æ—í–µ —Ç—Ä–µ–±–∞ –¥–∞ –ø—Ä–µ—É–∑–º–µ—Ç–µ –¥–∞—Ç–æ—Ç–µ–∫—É [`rlboard.py`](https://github.com/microsoft/ML-For-Beginners/blob/main/8-Reinforcement/1-QLearning/rlboard.py), –∫–æ—ò–∞ —Å–µ –∫–æ—Ä–∏—Å—Ç–∏ —É –∫–æ–¥—É –±–µ–ª–µ–∂–Ω–∏—Ü–µ. –î–æ–¥–∞—ò—Ç–µ —ò–µ —É –∏—Å—Ç–∏ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—ò—É–º –∫–∞–æ –∏ –±–µ–ª–µ–∂–Ω–∏—Ü—É.

## –£–≤–æ–¥

–£ –æ–≤–æ—ò –ª–µ–∫—Ü–∏—ò–∏ –∏—Å—Ç—Ä–∞–∂–∏—õ–µ–º–æ —Å–≤–µ—Ç **[–ü–µ—Ç—Ä–∞ –∏ –≤—É–∫–∞](https://en.wikipedia.org/wiki/Peter_and_the_Wolf)**, –∏–Ω—Å–ø–∏—Ä–∏—Å–∞–Ω –º—É–∑–∏—á–∫–æ–º –±–∞—ò–∫–æ–º —Ä—É—Å–∫–æ–≥ –∫–æ–º–ø–æ–∑–∏—Ç–æ—Ä–∞ [–°–µ—Ä–≥–µ—ò–∞ –ü—Ä–æ–∫–æ—Ñ—ò–µ–≤–∞](https://en.wikipedia.org/wiki/Sergei_Prokofiev). –ö–æ—Ä–∏—Å—Ç–∏—õ–µ–º–æ **—É—á–µ—ö–µ –ø–æ—ò–∞—á–∞—ö–µ–º** –∫–∞–∫–æ –±–∏—Å–º–æ –æ–º–æ–≥—É—õ–∏–ª–∏ –ü–µ—Ç—Ä—É –¥–∞ –∏—Å—Ç—Ä–∞–∂—É—ò–µ —Å–≤–æ—ò–µ –æ–∫—Ä—É–∂–µ—ö–µ, —Å–∞–∫—É–ø—ô–∞ —É–∫—É—Å–Ω–µ —ò–∞–±—É–∫–µ –∏ –∏–∑–±–µ–≥–∞–≤–∞ —Å—É—Å—Ä–µ—Ç —Å–∞ –≤—É–∫–æ–º.

**–£—á–µ—ö–µ –ø–æ—ò–∞—á–∞—ö–µ–º** (RL) —ò–µ —Ç–µ—Ö–Ω–∏–∫–∞ —É—á–µ—ö–∞ –∫–æ—ò–∞ –Ω–∞–º –æ–º–æ–≥—É—õ–∞–≤–∞ –¥–∞ –Ω–∞—É—á–∏–º–æ –æ–ø—Ç–∏–º–∞–ª–Ω–æ –ø–æ–Ω–∞—à–∞—ö–µ **–∞–≥–µ–Ω—Ç–∞** —É –Ω–µ–∫–æ–º **–æ–∫—Ä—É–∂–µ—ö—É** –∏–∑–≤–æ—í–µ—ö–µ–º –º–Ω–æ–≥–∏—Ö –µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω–∞—Ç–∞. –ê–≥–µ–Ω—Ç —É –æ–≤–æ–º –æ–∫—Ä—É–∂–µ—ö—É —Ç—Ä–µ–±–∞ –¥–∞ –∏–º–∞ –Ω–µ–∫–∏ **—Ü–∏—ô**, –¥–µ—Ñ–∏–Ω–∏—Å–∞–Ω **—Ñ—É–Ω–∫—Ü–∏—ò–æ–º –Ω–∞–≥—Ä–∞–¥–µ**.

## –û–∫—Ä—É–∂–µ—ö–µ

–†–∞–¥–∏ —ò–µ–¥–Ω–æ—Å—Ç–∞–≤–Ω–æ—Å—Ç–∏, –∑–∞–º–∏—Å–ª–∏–º–æ –ü–µ—Ç—Ä–æ–≤ —Å–≤–µ—Ç –∫–∞–æ –∫–≤–∞–¥—Ä–∞—Ç–Ω—É —Ç–∞–±–ª—É –≤–µ–ª–∏—á–∏–Ω–µ `—à–∏—Ä–∏–Ω–∞` x `–≤–∏—Å–∏–Ω–∞`, –æ–≤–∞–∫–æ:

![–ü–µ—Ç—Ä–æ–≤–æ –æ–∫—Ä—É–∂–µ—ö–µ](../../../../8-Reinforcement/1-QLearning/images/environment.png)

–°–≤–∞–∫–∞ —õ–µ–ª–∏—ò–∞ –Ω–∞ –æ–≤–æ—ò —Ç–∞–±–ª–∏ –º–æ–∂–µ –±–∏—Ç–∏:

* **—Ç–ª–æ**, –ø–æ –∫–æ–º–µ –ü–µ—Ç–∞—Ä –∏ –¥—Ä—É–≥–∞ —Å—Ç–≤–æ—Ä–µ—ö–∞ –º–æ–≥—É —Ö–æ–¥–∞—Ç–∏.
* **–≤–æ–¥–∞**, –ø–æ –∫–æ—ò–æ—ò –æ—á–∏–≥–ª–µ–¥–Ω–æ –Ω–µ –º–æ–∂–µ—Ç–µ —Ö–æ–¥–∞—Ç–∏.
* **–¥—Ä–≤–æ** –∏–ª–∏ **—Ç—Ä–∞–≤–∞**, –º–µ—Å—Ç–æ –≥–¥–µ –º–æ–∂–µ—Ç–µ –æ–¥–º–æ—Ä–∏—Ç–∏.
* **—ò–∞–±—É–∫–∞**, –∫–æ—ò–∞ –ø—Ä–µ–¥—Å—Ç–∞–≤—ô–∞ –Ω–µ—à—Ç–æ —à—Ç–æ –±–∏ –ü–µ—Ç–∞—Ä —Ä–∞–¥–æ –ø—Ä–æ–Ω–∞—à–∞–æ –∫–∞–∫–æ –±–∏ —Å–µ –Ω–∞—Ö—Ä–∞–Ω–∏–æ.
* **–≤—É–∫**, –∫–æ—ò–∏ —ò–µ –æ–ø–∞—Å–∞–Ω –∏ —Ç—Ä–µ–±–∞ –≥–∞ –∏–∑–±–µ–≥–∞–≤–∞—Ç–∏.

–ü–æ—Å—Ç–æ—ò–∏ –ø–æ—Å–µ–±–∞–Ω –ü–∞—ò—Ç–æ–Ω –º–æ–¥—É–ª, [`rlboard.py`](https://github.com/microsoft/ML-For-Beginners/blob/main/8-Reinforcement/1-QLearning/rlboard.py), –∫–æ—ò–∏ —Å–∞–¥—Ä–∂–∏ –∫–æ–¥ –∑–∞ —Ä–∞–¥ —Å–∞ –æ–≤–∏–º –æ–∫—Ä—É–∂–µ—ö–µ–º. –ü–æ—à—Ç–æ –æ–≤–∞—ò –∫–æ–¥ –Ω–∏—ò–µ –≤–∞–∂–∞–Ω –∑–∞ —Ä–∞–∑—É–º–µ–≤–∞—ö–µ –Ω–∞—à–∏—Ö –∫–æ–Ω—Ü–µ–ø–∞—Ç–∞, —É–≤–µ—à—õ–µ–º–æ –º–æ–¥—É–ª –∏ –∫–æ—Ä–∏—Å—Ç–∏—Ç–∏ –≥–∞ –∑–∞ –∫—Ä–µ–∏—Ä–∞—ö–µ —É–∑–æ—Ä–∫–∞ —Ç–∞–±–ª–µ (–±–ª–æ–∫ –∫–æ–¥–∞ 1):

```python
from rlboard import *

width, height = 8,8
m = Board(width,height)
m.randomize(seed=13)
m.plot()
```

–û–≤–∞—ò –∫–æ–¥ –±–∏ —Ç—Ä–µ–±–∞–ª–æ –¥–∞ –∏—Å–ø–∏—à–µ —Å–ª–∏–∫—É –æ–∫—Ä—É–∂–µ—ö–∞ —Å–ª–∏—á–Ω—É –æ–Ω–æ—ò –∏–∑–Ω–∞–¥.

## –ê–∫—Ü–∏—ò–µ –∏ –ø–æ–ª–∏—Ç–∏–∫–∞

–£ –Ω–∞—à–µ–º –ø—Ä–∏–º–µ—Ä—É, –ü–µ—Ç—Ä–æ–≤ —Ü–∏—ô –±–∏ –±–∏–æ –¥–∞ –ø—Ä–æ–Ω–∞—í–µ —ò–∞–±—É–∫—É, –∏–∑–±–µ–≥–∞–≤–∞—ò—É—õ–∏ –≤—É–∫–∞ –∏ –¥—Ä—É–≥–µ –ø—Ä–µ–ø—Ä–µ–∫–µ. –î–∞ –±–∏ —Ç–æ —É—Ä–∞–¥–∏–æ, –æ–Ω –º–æ–∂–µ —Å—É—à—Ç–∏–Ω—Å–∫–∏ —Ö–æ–¥–∞—Ç–∏ –¥–æ–∫ –Ω–µ –ø—Ä–æ–Ω–∞—í–µ —ò–∞–±—É–∫—É.

–î–∞–∫–ª–µ, –Ω–∞ –±–∏–ª–æ –∫–æ—ò–æ—ò –ø–æ–∑–∏—Ü–∏—ò–∏, –æ–Ω –º–æ–∂–µ –∏–∑–∞–±—Ä–∞—Ç–∏ —ò–µ–¥–Ω—É –æ–¥ —Å–ª–µ–¥–µ—õ–∏—Ö –∞–∫—Ü–∏—ò–∞: –≥–æ—Ä–µ, –¥–æ–ª–µ, –ª–µ–≤–æ –∏ –¥–µ—Å–Ω–æ.

–î–µ—Ñ–∏–Ω–∏—Å–∞—õ–µ–º–æ —Ç–µ –∞–∫—Ü–∏—ò–µ –∫–∞–æ —Ä–µ—á–Ω–∏–∫ –∏ –º–∞–ø–∏—Ä–∞—Ç–∏ –∏—Ö –Ω–∞ –ø–∞—Ä–æ–≤–µ –æ–¥–≥–æ–≤–∞—Ä–∞—ò—É—õ–∏—Ö –ø—Ä–æ–º–µ–Ω–∞ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞. –ù–∞ –ø—Ä–∏–º–µ—Ä, –ø–æ–º–µ—Ä–∞—ö–µ —É–¥–µ—Å–Ω–æ (`R`) –æ–¥–≥–æ–≤–∞—Ä–∞–ª–æ –±–∏ –ø–∞—Ä—É `(1,0)`. (–±–ª–æ–∫ –∫–æ–¥–∞ 2):

```python
actions = { "U" : (0,-1), "D" : (0,1), "L" : (-1,0), "R" : (1,0) }
action_idx = { a : i for i,a in enumerate(actions.keys()) }
```

–î–∞ —Ä–µ–∑–∏–º–∏—Ä–∞–º–æ, —Å—Ç—Ä–∞—Ç–µ–≥–∏—ò–∞ –∏ —Ü–∏—ô –æ–≤–æ–≥ —Å—Ü–µ–Ω–∞—Ä–∏—ò–∞ —Å—É —Å–ª–µ–¥–µ—õ–∏:

- **–°—Ç—Ä–∞—Ç–µ–≥–∏—ò–∞** –Ω–∞—à–µ–≥ –∞–≥–µ–Ω—Ç–∞ (–ü–µ—Ç—Ä–∞) –¥–µ—Ñ–∏–Ω–∏—Å–∞–Ω–∞ —ò–µ —Ç–∞–∫–æ–∑–≤–∞–Ω–æ–º **–ø–æ–ª–∏—Ç–∏–∫–æ–º**. –ü–æ–ª–∏—Ç–∏–∫–∞ —ò–µ —Ñ—É–Ω–∫—Ü–∏—ò–∞ –∫–æ—ò–∞ –≤—Ä–∞—õ–∞ –∞–∫—Ü–∏—ò—É —É –±–∏–ª–æ –∫–æ–º –¥–∞—Ç–æ–º —Å—Ç–∞—ö—É. –£ –Ω–∞—à–µ–º —Å–ª—É—á–∞—ò—É, —Å—Ç–∞—ö–µ –ø—Ä–æ–±–ª–µ–º–∞ –ø—Ä–µ–¥—Å—Ç–∞–≤—ô–∞ —Ç–∞–±–ª–∞, —É–∫—ô—É—á—É—ò—É—õ–∏ —Ç—Ä–µ–Ω—É—Ç–Ω—É –ø–æ–∑–∏—Ü–∏—ò—É –∏–≥—Ä–∞—á–∞.

- **–¶–∏—ô** —É—á–µ—ö–∞ –ø–æ—ò–∞—á–∞—ö–µ–º —ò–µ –¥–∞ –Ω–∞ –∫—Ä–∞—ò—É –Ω–∞—É—á–∏–º–æ –¥–æ–±—Ä—É –ø–æ–ª–∏—Ç–∏–∫—É –∫–æ—ò–∞ —õ–µ –Ω–∞–º –æ–º–æ–≥—É—õ–∏—Ç–∏ –¥–∞ –µ—Ñ–∏–∫–∞—Å–Ω–æ —Ä–µ—à–∏–º–æ –ø—Ä–æ–±–ª–µ–º. –ú–µ—í—É—Ç–∏–º, –∫–∞–æ –æ—Å–Ω–æ–≤–Ω—É –ª–∏–Ω–∏—ò—É, —Ä–∞–∑–º–æ—Ç—Ä–∏–º–æ –Ω–∞—ò—ò–µ–¥–Ω–æ—Å—Ç–∞–≤–Ω–∏—ò—É –ø–æ–ª–∏—Ç–∏–∫—É –∑–≤–∞–Ω—É **—Å–ª—É—á–∞—ò–Ω–æ —Ö–æ–¥–∞—ö–µ**.

## –°–ª—É—á–∞—ò–Ω–æ —Ö–æ–¥–∞—ö–µ

–ü—Ä–≤–æ —õ–µ–º–æ —Ä–µ—à–∏—Ç–∏ –Ω–∞—à –ø—Ä–æ–±–ª–µ–º –∏–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—ò–æ–º —Å—Ç—Ä–∞—Ç–µ–≥–∏—ò–µ —Å–ª—É—á–∞—ò–Ω–æ–≥ —Ö–æ–¥–∞—ö–∞. –°–∞ —Å–ª—É—á–∞—ò–Ω–∏–º —Ö–æ–¥–∞—ö–µ–º, –Ω–∞—Å—É–º–∏—á–Ω–æ —õ–µ–º–æ –±–∏—Ä–∞—Ç–∏ —Å–ª–µ–¥–µ—õ—É –∞–∫—Ü–∏—ò—É –∏–∑ –¥–æ–∑–≤–æ—ô–µ–Ω–∏—Ö –∞–∫—Ü–∏—ò–∞, –¥–æ–∫ –Ω–µ —Å—Ç–∏–≥–Ω–µ–º–æ –¥–æ —ò–∞–±—É–∫–µ (–±–ª–æ–∫ –∫–æ–¥–∞ 3).

1. –ò–º–ø–ª–µ–º–µ–Ω—Ç–∏—Ä–∞—ò—Ç–µ —Å–ª—É—á–∞—ò–Ω–æ —Ö–æ–¥–∞—ö–µ –ø–æ–º–æ—õ—É –∫–æ–¥–∞ –∏—Å–ø–æ–¥:

    ```python
    def random_policy(m):
        return random.choice(list(actions))
    
    def walk(m,policy,start_position=None):
        n = 0 # number of steps
        # set initial position
        if start_position:
            m.human = start_position 
        else:
            m.random_start()
        while True:
            if m.at() == Board.Cell.apple:
                return n # success!
            if m.at() in [Board.Cell.wolf, Board.Cell.water]:
                return -1 # eaten by wolf or drowned
            while True:
                a = actions[policy(m)]
                new_pos = m.move_pos(m.human,a)
                if m.is_valid(new_pos) and m.at(new_pos)!=Board.Cell.water:
                    m.move(a) # do the actual move
                    break
            n+=1
    
    walk(m,random_policy)
    ```

    –ü–æ–∑–∏–≤ —Ñ—É–Ω–∫—Ü–∏—ò–µ `walk` —Ç—Ä–µ–±–∞ –¥–∞ –≤—Ä–∞—Ç–∏ –¥—É–∂–∏–Ω—É –æ–¥–≥–æ–≤–∞—Ä–∞—ò—É—õ–µ –ø—É—Ç–∞—ö–µ, –∫–æ—ò–∞ –º–æ–∂–µ –≤–∞—Ä–∏—Ä–∞—Ç–∏ –æ–¥ —ò–µ–¥–Ω–æ–≥ –ø–æ–∫—Ä–µ—Ç–∞—ö–∞ –¥–æ –¥—Ä—É–≥–æ–≥.

1. –ü–æ–∫—Ä–µ–Ω–∏—Ç–µ –µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç —Ö–æ–¥–∞—ö–∞ –≤–∏—à–µ –ø—É—Ç–∞ (—Ä–µ—Ü–∏–º–æ, 100) –∏ –∏—Å–ø–∏—à–∏—Ç–µ —Ä–µ–∑—É–ª—Ç—É—ò—É—õ—É —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É (–±–ª–æ–∫ –∫–æ–¥–∞ 4):

    ```python
    def print_statistics(policy):
        s,w,n = 0,0,0
        for _ in range(100):
            z = walk(m,policy)
            if z<0:
                w+=1
            else:
                s += z
                n += 1
        print(f"Average path length = {s/n}, eaten by wolf: {w} times")
    
    print_statistics(random_policy)
    ```

    –ü—Ä–∏–º–µ—Ç–∏—Ç–µ –¥–∞ —ò–µ –ø—Ä–æ—Å–µ—á–Ω–∞ –¥—É–∂–∏–Ω–∞ –ø—É—Ç–∞—ö–µ –æ–∫–æ 30-40 –∫–æ—Ä–∞–∫–∞, —à—Ç–æ —ò–µ –ø—Ä–∏–ª–∏—á–Ω–æ –º–Ω–æ–≥–æ, —Å –æ–±–∑–∏—Ä–æ–º –Ω–∞ —Ç–æ –¥–∞ —ò–µ –ø—Ä–æ—Å–µ—á–Ω–∞ —É–¥–∞—ô–µ–Ω–æ—Å—Ç –¥–æ –Ω–∞—ò–±–ª–∏–∂–µ —ò–∞–±—É–∫–µ –æ–∫–æ 5-6 –∫–æ—Ä–∞–∫–∞.

    –¢–∞–∫–æ—í–µ –º–æ–∂–µ—Ç–µ –≤–∏–¥–µ—Ç–∏ –∫–∞–∫–æ –∏–∑–≥–ª–µ–¥–∞ –ü–µ—Ç—Ä–æ–≤–æ –∫—Ä–µ—Ç–∞—ö–µ —Ç–æ–∫–æ–º —Å–ª—É—á–∞—ò–Ω–æ–≥ —Ö–æ–¥–∞—ö–∞:

    ![–ü–µ—Ç—Ä–æ–≤–æ —Å–ª—É—á–∞—ò–Ω–æ —Ö–æ–¥–∞—ö–µ](../../../../8-Reinforcement/1-QLearning/images/random_walk.gif)

## –§—É–Ω–∫—Ü–∏—ò–∞ –Ω–∞–≥—Ä–∞–¥–µ

–î–∞ –±–∏—Å–º–æ –Ω–∞—à—É –ø–æ–ª–∏—Ç–∏–∫—É —É—á–∏–Ω–∏–ª–∏ –∏–Ω—Ç–µ–ª–∏–≥–µ–Ω—Ç–Ω–∏—ò–æ–º, –º–æ—Ä–∞–º–æ —Ä–∞–∑—É–º–µ—Ç–∏ –∫–æ—ò–∏ –ø–æ—Ç–µ–∑–∏ —Å—É "–±–æ—ô–∏" –æ–¥ –¥—Ä—É–≥–∏—Ö. –î–∞ –±–∏—Å–º–æ —Ç–æ —É—Ä–∞–¥–∏–ª–∏, –º–æ—Ä–∞–º–æ –¥–µ—Ñ–∏–Ω–∏—Å–∞—Ç–∏ –Ω–∞—à —Ü–∏—ô.

–¶–∏—ô —Å–µ –º–æ–∂–µ –¥–µ—Ñ–∏–Ω–∏—Å–∞—Ç–∏ —É —Å–º–∏—Å–ª—É **—Ñ—É–Ω–∫—Ü–∏—ò–µ –Ω–∞–≥—Ä–∞–¥–µ**, –∫–æ—ò–∞ —õ–µ –≤—Ä–∞—õ–∞—Ç–∏ –Ω–µ–∫—É –≤—Ä–µ–¥–Ω–æ—Å—Ç —Ä–µ–∑—É–ª—Ç–∞—Ç–∞ –∑–∞ —Å–≤–∞–∫–æ —Å—Ç–∞—ö–µ. –®—Ç–æ —ò–µ –±—Ä–æ—ò –≤–µ—õ–∏, —Ç–æ —ò–µ –±–æ—ô–∞ —Ñ—É–Ω–∫—Ü–∏—ò–∞ –Ω–∞–≥—Ä–∞–¥–µ. (–±–ª–æ–∫ –∫–æ–¥–∞ 5)

```python
move_reward = -0.1
goal_reward = 10
end_reward = -10

def reward(m,pos=None):
    pos = pos or m.human
    if not m.is_valid(pos):
        return end_reward
    x = m.at(pos)
    if x==Board.Cell.water or x == Board.Cell.wolf:
        return end_reward
    if x==Board.Cell.apple:
        return goal_reward
    return move_reward
```

–ò–Ω—Ç–µ—Ä–µ—Å–∞–Ω—Ç–Ω–∞ —Å—Ç–≤–∞—Ä –∫–æ–¥ —Ñ—É–Ω–∫—Ü–∏—ò–∞ –Ω–∞–≥—Ä–∞–¥–µ —ò–µ –¥–∞ —É –≤–µ—õ–∏–Ω–∏ —Å–ª—É—á–∞—ò–µ–≤–∞ *–¥–æ–±–∏—ò–∞–º–æ –∑–Ω–∞—á–∞—ò–Ω—É –Ω–∞–≥—Ä–∞–¥—É —Ç–µ–∫ –Ω–∞ –∫—Ä–∞—ò—É –∏–≥—Ä–µ*. –¢–æ –∑–Ω–∞—á–∏ –¥–∞ –Ω–∞—à –∞–ª–≥–æ—Ä–∏—Ç–∞–º —Ç—Ä–µ–±–∞ –Ω–µ–∫–∞–∫–æ –¥–∞ –∑–∞–ø–∞–º—Ç–∏ "–¥–æ–±—Ä–µ" –∫–æ—Ä–∞–∫–µ –∫–æ—ò–∏ –≤–æ–¥–µ –¥–æ –ø–æ–∑–∏—Ç–∏–≤–Ω–µ –Ω–∞–≥—Ä–∞–¥–µ –Ω–∞ –∫—Ä–∞—ò—É –∏ –ø–æ–≤–µ—õ–∞ —ö–∏—Ö–æ–≤ –∑–Ω–∞—á–∞—ò. –°–ª–∏—á–Ω–æ —Ç–æ–º–µ, —Å–≤–∏ –ø–æ—Ç–µ–∑–∏ –∫–æ—ò–∏ –≤–æ–¥–µ –¥–æ –ª–æ—à–∏—Ö —Ä–µ–∑—É–ª—Ç–∞—Ç–∞ —Ç—Ä–µ–±–∞ –¥–∞ –±—É–¥—É –æ–±–µ—Å—Ö—Ä–∞–±—Ä–µ–Ω–∏.

## Q-—É—á–µ—ö–µ

–ê–ª–≥–æ—Ä–∏—Ç–∞–º –∫–æ—ò–∏ —õ–µ–º–æ –æ–≤–¥–µ —Ä–∞–∑–º–æ—Ç—Ä–∏—Ç–∏ –∑–æ–≤–µ —Å–µ **Q-—É—á–µ—ö–µ**. –£ –æ–≤–æ–º –∞–ª–≥–æ—Ä–∏—Ç–º—É, –ø–æ–ª–∏—Ç–∏–∫–∞ —ò–µ –¥–µ—Ñ–∏–Ω–∏—Å–∞–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—ò–æ–º (–∏–ª–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–º –ø–æ–¥–∞—Ç–∞–∫–∞) –∫–æ—ò–∞ —Å–µ –∑–æ–≤–µ **Q-—Ç–∞–±–µ–ª–∞**. –û–Ω–∞ –±–µ–ª–µ–∂–∏ "–∫–≤–∞–ª–∏—Ç–µ—Ç" —Å–≤–∞–∫–µ –æ–¥ –∞–∫—Ü–∏—ò–∞ —É –¥–∞—Ç–æ–º —Å—Ç–∞—ö—É.

–ó–æ–≤–µ —Å–µ Q-—Ç–∞–±–µ–ª–∞ —ò–µ—Ä —ò–µ —á–µ—Å—Ç–æ –∑–≥–æ–¥–Ω–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç–∏ —ò–µ –∫–∞–æ —Ç–∞–±–µ–ª—É –∏–ª–∏ –≤–∏—à–µ–¥–∏–º–µ–Ω–∑–∏–æ–Ω–∞–ª–Ω–∏ –Ω–∏–∑. –ü–æ—à—Ç–æ –Ω–∞—à–∞ —Ç–∞–±–ª–∞ –∏–º–∞ –¥–∏–º–µ–Ω–∑–∏—ò–µ `—à–∏—Ä–∏–Ω–∞` x `–≤–∏—Å–∏–Ω–∞`, –º–æ–∂–µ–º–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç–∏ Q-—Ç–∞–±–µ–ª—É –∫–æ—Ä–∏—Å—Ç–µ—õ–∏ numpy –Ω–∏–∑ –æ–±–ª–∏–∫–∞ `—à–∏—Ä–∏–Ω–∞` x `–≤–∏—Å–∏–Ω–∞` x `len(actions)`: (–±–ª–æ–∫ –∫–æ–¥–∞ 6)

```python
Q = np.ones((width,height,len(actions)),dtype=np.float)*1.0/len(actions)
```

–ü—Ä–∏–º–µ—Ç–∏—Ç–µ –¥–∞ –∏–Ω–∏—Ü–∏—ò–∞–ª–∏–∑—É—ò–µ–º–æ —Å–≤–µ –≤—Ä–µ–¥–Ω–æ—Å—Ç–∏ Q-—Ç–∞–±–µ–ª–µ —ò–µ–¥–Ω–∞–∫–æ–º –≤—Ä–µ–¥–Ω–æ—à—õ—É, —É –Ω–∞—à–µ–º —Å–ª—É—á–∞—ò—É - 0.25. –û–≤–æ –æ–¥–≥–æ–≤–∞—Ä–∞ –ø–æ–ª–∏—Ç–∏—Ü–∏ "—Å–ª—É—á–∞—ò–Ω–æ–≥ —Ö–æ–¥–∞—ö–∞", —ò–µ—Ä —Å—É —Å–≤–∏ –ø–æ—Ç–µ–∑–∏ —É —Å–≤–∞–∫–æ–º —Å—Ç–∞—ö—É –ø–æ–¥—ò–µ–¥–Ω–∞–∫–æ –¥–æ–±—Ä–∏. –ú–æ–∂–µ–º–æ –ø—Ä–æ—Å–ª–µ–¥–∏—Ç–∏ Q-—Ç–∞–±–µ–ª—É —Ñ—É–Ω–∫—Ü–∏—ò–∏ `plot` –∫–∞–∫–æ –±–∏—Å–º–æ –≤–∏–∑—É–∞–ª–∏–∑–æ–≤–∞–ª–∏ —Ç–∞–±–µ–ª—É –Ω–∞ —Ç–∞–±–ª–∏: `m.plot(Q)`.

![–ü–µ—Ç—Ä–æ–≤–æ –æ–∫—Ä—É–∂–µ—ö–µ](../../../../8-Reinforcement/1-QLearning/images/env_init.png)

–£ —Ü–µ–Ω—Ç—Ä—É —Å–≤–∞–∫–µ —õ–µ–ª–∏—ò–µ –Ω–∞–ª–∞–∑–∏ —Å–µ "—Å—Ç—Ä–µ–ª–∏—Ü–∞" –∫–æ—ò–∞ —É–∫–∞–∑—É—ò–µ –Ω–∞ –ø–æ–∂–µ—ô–∞–Ω –ø—Ä–∞–≤–∞—Ü –∫—Ä–µ—Ç–∞—ö–∞. –ü–æ—à—Ç–æ —Å—É —Å–≤–∏ –ø—Ä–∞–≤—Ü–∏ —ò–µ–¥–Ω–∞–∫–∏, –ø—Ä–∏–∫–∞–∑—É—ò–µ —Å–µ —Ç–∞—á–∫–∞.

–°–∞–¥–∞ —Ç—Ä–µ–±–∞ –¥–∞ –ø–æ–∫—Ä–µ–Ω–µ–º–æ —Å–∏–º—É–ª–∞—Ü–∏—ò—É, –∏—Å—Ç—Ä–∞–∂–∏–º–æ –Ω–∞—à–µ –æ–∫—Ä—É–∂–µ—ö–µ –∏ –Ω–∞—É—á–∏–º–æ –±–æ—ô—É —Ä–∞—Å–ø–æ–¥–µ–ª—É –≤—Ä–µ–¥–Ω–æ—Å—Ç–∏ Q-—Ç–∞–±–µ–ª–µ, —à—Ç–æ —õ–µ –Ω–∞–º –æ–º–æ–≥—É—õ–∏—Ç–∏ –¥–∞ –º–Ω–æ–≥–æ –±—Ä–∂–µ –ø—Ä–æ–Ω–∞—í–µ–º–æ –ø—É—Ç –¥–æ —ò–∞–±—É–∫–µ.

## –°—É—à—Ç–∏–Ω–∞ Q-—É—á–µ—ö–∞: –ë–µ–ª–º–∞–Ω–æ–≤–∞ —ò–µ–¥–Ω–∞—á–∏–Ω–∞

–ö–∞–¥–∞ –ø–æ—á–Ω–µ–º–æ –¥–∞ —Å–µ –∫—Ä–µ—õ–µ–º–æ, —Å–≤–∞–∫–∞ –∞–∫—Ü–∏—ò–∞ —õ–µ –∏–º–∞—Ç–∏ –æ–¥–≥–æ–≤–∞—Ä–∞—ò—É—õ—É –Ω–∞–≥—Ä–∞–¥—É, —Ç—ò. —Ç–µ–æ—Ä–µ—Ç—Å–∫–∏ –º–æ–∂–µ–º–æ –∏–∑–∞–±—Ä–∞—Ç–∏ —Å–ª–µ–¥–µ—õ—É –∞–∫—Ü–∏—ò—É –Ω–∞ –æ—Å–Ω–æ–≤—É –Ω–∞—ò–≤–∏—à–µ –Ω–µ–ø–æ—Å—Ä–µ–¥–Ω–µ –Ω–∞–≥—Ä–∞–¥–µ. –ú–µ—í—É—Ç–∏–º, —É –≤–µ—õ–∏–Ω–∏ —Å—Ç–∞—ö–∞, –ø–æ—Ç–µ–∑ –Ω–µ—õ–µ –ø–æ—Å—Ç–∏—õ–∏ –Ω–∞—à —Ü–∏—ô –¥–æ—Å—Ç–∏–∑–∞—ö–∞ —ò–∞–±—É–∫–µ, –∏ —Å—Ç–æ–≥–∞ –Ω–µ –º–æ–∂–µ–º–æ –æ–¥–º–∞—Ö –æ–¥–ª—É—á–∏—Ç–∏ –∫–æ—ò–∏ —ò–µ –ø—Ä–∞–≤–∞—Ü –±–æ—ô–∏.

> –ó–∞–ø–∞–º—Ç–∏—Ç–µ –¥–∞ –Ω–∏—ò–µ –±–∏—Ç–∞–Ω –Ω–µ–ø–æ—Å—Ä–µ–¥–∞–Ω —Ä–µ–∑—É–ª—Ç–∞—Ç, –≤–µ—õ –∫–æ–Ω–∞—á–Ω–∏ —Ä–µ–∑—É–ª—Ç–∞—Ç, –∫–æ—ò–∏ —õ–µ–º–æ –¥–æ–±–∏—Ç–∏ –Ω–∞ –∫—Ä–∞—ò—É —Å–∏–º—É–ª–∞—Ü–∏—ò–µ.

–î–∞ –±–∏—Å–º–æ —É–∑–µ–ª–∏ —É –æ–±–∑–∏—Ä –æ–≤—É –æ–¥–ª–æ–∂–µ–Ω—É –Ω–∞–≥—Ä–∞–¥—É, –º–æ—Ä–∞–º–æ –∫–æ—Ä–∏—Å—Ç–∏—Ç–∏ –ø—Ä–∏–Ω—Ü–∏–ø–µ **[–¥–∏–Ω–∞–º–∏—á–∫–æ–≥ –ø—Ä–æ–≥—Ä–∞–º–∏—Ä–∞—ö–∞](https://en.wikipedia.org/wiki/Dynamic_programming)**, –∫–æ—ò–∏ –Ω–∞–º –æ–º–æ–≥—É—õ–∞–≤–∞—ò—É –¥–∞ —Ä–∞–∑–º–∏—à—ô–∞–º–æ –æ –ø—Ä–æ–±–ª–µ–º—É —Ä–µ–∫—É—Ä–∑–∏–≤–Ω–æ.

–ü—Ä–µ—Ç–ø–æ—Å—Ç–∞–≤–∏–º–æ –¥–∞ —Å–µ —Å–∞–¥–∞ –Ω–∞–ª–∞–∑–∏–º–æ —É —Å—Ç–∞—ö—É *s*, –∏ –∂–µ–ª–∏–º–æ –¥–∞ –ø—Ä–µ—í–µ–º–æ —É —Å–ª–µ–¥–µ—õ–µ —Å—Ç–∞—ö–µ *s'*. –¢–∏–º–µ —õ–µ–º–æ –¥–æ–±–∏—Ç–∏ –Ω–µ–ø–æ—Å—Ä–µ–¥–Ω—É –Ω–∞–≥—Ä–∞–¥—É *r(s,a)*, –¥–µ—Ñ–∏–Ω–∏—Å–∞–Ω—É —Ñ—É–Ω–∫—Ü–∏—ò–æ–º –Ω–∞–≥—Ä–∞–¥–µ, –ø–ª—É—Å –Ω–µ–∫—É –±—É–¥—É—õ—É –Ω–∞–≥—Ä–∞–¥—É. –ê–∫–æ –ø—Ä–µ—Ç–ø–æ—Å—Ç–∞–≤–∏–º–æ –¥–∞ –Ω–∞—à–∞ Q-—Ç–∞–±–µ–ª–∞ —Ç–∞—á–Ω–æ –æ–¥—Ä–∞–∂–∞–≤–∞ "–∞—Ç—Ä–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç" —Å–≤–∞–∫–µ –∞–∫—Ü–∏—ò–µ, –æ–Ω–¥–∞ —õ–µ–º–æ —É —Å—Ç–∞—ö—É *s'* –∏–∑–∞–±—Ä–∞—Ç–∏ –∞–∫—Ü–∏—ò—É *a* –∫–æ—ò–∞ –æ–¥–≥–æ–≤–∞—Ä–∞ –º–∞–∫—Å–∏–º–∞–ª–Ω–æ—ò –≤—Ä–µ–¥–Ω–æ—Å—Ç–∏ *Q(s',a')*. –¢–∞–∫–æ —õ–µ –Ω–∞—ò–±–æ—ô–∞ –º–æ–≥—É—õ–∞ –±—É–¥—É—õ–∞ –Ω–∞–≥—Ä–∞–¥–∞ –∫–æ—ò—É –±–∏—Å–º–æ –º–æ–≥–ª–∏ –¥–æ–±–∏—Ç–∏ —É —Å—Ç–∞—ö—É *s* –±–∏—Ç–∏ –¥–µ—Ñ–∏–Ω–∏—Å–∞–Ω–∞ –∫–∞–æ `max` *Q(s',a')* (–º–∞–∫—Å–∏–º—É–º —Å–µ –æ–≤–¥–µ —Ä–∞—á—É–Ω–∞ –ø—Ä–µ–∫–æ —Å–≤–∏—Ö –º–æ–≥—É—õ–∏—Ö –∞–∫—Ü–∏—ò–∞ *a'* —É —Å—Ç–∞—ö—É *s'*).

–û–≤–æ –Ω–∞–º –¥–∞—ò–µ **–ë–µ–ª–º–∞–Ω–æ–≤—É —Ñ–æ—Ä–º—É–ª—É** –∑–∞ –∏–∑—Ä–∞—á—É–Ω–∞–≤–∞—ö–µ –≤—Ä–µ–¥–Ω–æ—Å—Ç–∏ Q-—Ç–∞–±–µ–ª–µ —É —Å—Ç–∞—ö—É *s*, –∑–∞ –¥–∞—Ç—É –∞–∫—Ü–∏—ò—É *a*:

## –ü—Ä–æ–≤–µ—Ä–∞ –ø–æ–ª–∏—Ç–∏–∫–µ

–ü–æ—à—Ç–æ Q-—Ç–∞–±–µ–ª–∞ –ø—Ä–∏–∫–∞–∑—É—ò–µ "–∞—Ç—Ä–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç" —Å–≤–∞–∫–µ –∞–∫—Ü–∏—ò–µ —É —Å–≤–∞–∫–æ–º —Å—Ç–∞—ö—É, –ø—Ä–∏–ª–∏—á–Ω–æ —ò–µ —ò–µ–¥–Ω–æ—Å—Ç–∞–≤–Ω–æ –∫–æ—Ä–∏—Å—Ç–∏—Ç–∏ —ò–µ –∑–∞ –¥–µ—Ñ–∏–Ω–∏—Å–∞—ö–µ –µ—Ñ–∏–∫–∞—Å–Ω–µ –Ω–∞–≤–∏–≥–∞—Ü–∏—ò–µ —É –Ω–∞—à–µ–º —Å–≤–µ—Ç—É. –£ –Ω–∞—ò—ò–µ–¥–Ω–æ—Å—Ç–∞–≤–Ω–∏—ò–µ–º —Å–ª—É—á–∞—ò—É, –º–æ–∂–µ–º–æ –∏–∑–∞–±—Ä–∞—Ç–∏ –∞–∫—Ü–∏—ò—É –∫–æ—ò–∞ –æ–¥–≥–æ–≤–∞—Ä–∞ –Ω–∞—ò–≤–∏—à–æ—ò –≤—Ä–µ–¥–Ω–æ—Å—Ç–∏ —É Q-—Ç–∞–±–µ–ª–∏: (–∫–æ–¥ –±–ª–æ–∫ 9)

```python
def qpolicy_strict(m):
        x,y = m.human
        v = probs(Q[x,y])
        a = list(actions)[np.argmax(v)]
        return a

walk(m,qpolicy_strict)
```

> –ê–∫–æ –ø—Ä–æ–±–∞—Ç–µ –∫–æ–¥ –∏–∑–Ω–∞–¥ –Ω–µ–∫–æ–ª–∏–∫–æ –ø—É—Ç–∞, –º–æ–∂–¥–∞ —õ–µ—Ç–µ –ø—Ä–∏–º–µ—Ç–∏—Ç–∏ –¥–∞ –ø–æ–Ω–µ–∫–∞–¥ "–∑–∞–≥–ª–∞–≤–∏", –∏ –º–æ—Ä–∞—õ–µ—Ç–µ –¥–∞ –ø—Ä–∏—Ç–∏—Å–Ω–µ—Ç–µ –¥—É–≥–º–µ STOP —É –±–µ–ª–µ–∂–Ω–∏—Ü–∏ –¥–∞ –±–∏—Å—Ç–µ –≥–∞ –ø—Ä–µ–∫–∏–Ω—É–ª–∏. –û–≤–æ —Å–µ –¥–µ—à–∞–≤–∞ —ò–µ—Ä –º–æ–≥—É –ø–æ—Å—Ç–æ—ò–∞—Ç–∏ —Å–∏—Ç—É–∞—Ü–∏—ò–µ –∫–∞–¥–∞ –¥–≤–∞ —Å—Ç–∞—ö–∞ "—É–ø—É—õ—É—ò—É" —ò–µ–¥–Ω–æ –Ω–∞ –¥—Ä—É–≥–æ —É —Å–º–∏—Å–ª—É –æ–ø—Ç–∏–º–∞–ª–Ω–µ Q-–≤—Ä–µ–¥–Ω–æ—Å—Ç–∏, —É –∫–æ–º —Å–ª—É—á–∞—ò—É –∞–≥–µ–Ω—Ç –∑–∞–≤—Ä—à–∞–≤–∞ —Ç–∞–∫–æ —à—Ç–æ —Å–µ –±–µ—Å–∫–æ–Ω–∞—á–Ω–æ –∫—Ä–µ—õ–µ –∏–∑–º–µ—í—É —Ç–∏—Ö —Å—Ç–∞—ö–∞.

## üöÄ–ò–∑–∞–∑–æ–≤

> **–ó–∞–¥–∞—Ç–∞–∫ 1:** –ò–∑–º–µ–Ω–∏—Ç–µ —Ñ—É–Ω–∫—Ü–∏—ò—É `walk` –¥–∞ –æ–≥—Ä–∞–Ω–∏—á–∏—Ç–µ –º–∞–∫—Å–∏–º–∞–ª–Ω—É –¥—É–∂–∏–Ω—É –ø—É—Ç–∞ –Ω–∞ –æ–¥—Ä–µ—í–µ–Ω–∏ –±—Ä–æ—ò –∫–æ—Ä–∞–∫–∞ (—Ä–µ—Ü–∏–º–æ, 100), –∏ –ø–æ—Å–º–∞—Ç—Ä–∞—ò—Ç–µ –∫–∞–∫–æ –∫–æ–¥ –∏–∑–Ω–∞–¥ –≤—Ä–∞—õ–∞ –æ–≤—É –≤—Ä–µ–¥–Ω–æ—Å—Ç —Å –≤—Ä–µ–º–µ–Ω–∞ –Ω–∞ –≤—Ä–µ–º–µ.

> **–ó–∞–¥–∞—Ç–∞–∫ 2:** –ò–∑–º–µ–Ω–∏—Ç–µ —Ñ—É–Ω–∫—Ü–∏—ò—É `walk` —Ç–∞–∫–æ –¥–∞ —Å–µ –Ω–µ –≤—Ä–∞—õ–∞ –Ω–∞ –º–µ—Å—Ç–∞ –Ω–∞ –∫–æ—ò–∏–º–∞ —ò–µ –≤–µ—õ –±–∏–æ. –û–≤–æ —õ–µ —Å–ø—Ä–µ—á–∏—Ç–∏ `walk` –¥–∞ —É—í–µ —É –ø–µ—Ç—ô—É, –∞–ª–∏ –∞–≥–µ–Ω—Ç –∏ –¥–∞—ô–µ –º–æ–∂–µ –∑–∞–≤—Ä—à–∏—Ç–∏ "–∑–∞—Ä–æ–±—ô–µ–Ω" –Ω–∞ –ª–æ–∫–∞—Ü–∏—ò–∏ —Å–∞ –∫–æ—ò–µ –Ω–µ –º–æ–∂–µ –ø–æ–±–µ—õ–∏.

## –ù–∞–≤–∏–≥–∞—Ü–∏—ò–∞

–ë–æ—ô–∞ –ø–æ–ª–∏—Ç–∏–∫–∞ –Ω–∞–≤–∏–≥–∞—Ü–∏—ò–µ –±–∏–ª–∞ –±–∏ –æ–Ω–∞ –∫–æ—ò—É —Å–º–æ –∫–æ—Ä–∏—Å—Ç–∏–ª–∏ —Ç–æ–∫–æ–º —Ç—Ä–µ–Ω–∏–Ω–≥–∞, –∫–æ—ò–∞ –∫–æ–º–±–∏–Ω—É—ò–µ –µ–∫—Å–ø–ª–æ–∞—Ç–∞—Ü–∏—ò—É –∏ –∏—Å—Ç—Ä–∞–∂–∏–≤–∞—ö–µ. –£ –æ–≤–æ—ò –ø–æ–ª–∏—Ç–∏—Ü–∏, –∏–∑–∞–±—Ä–∞—õ–µ–º–æ —Å–≤–∞–∫—É –∞–∫—Ü–∏—ò—É —Å–∞ –æ–¥—Ä–µ—í–µ–Ω–æ–º –≤–µ—Ä–æ–≤–∞—Ç–Ω–æ—õ–æ–º, –ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª–Ω–æ –≤—Ä–µ–¥–Ω–æ—Å—Ç–∏–º–∞ —É Q-—Ç–∞–±–µ–ª–∏. –û–≤–∞ —Å—Ç—Ä–∞—Ç–µ–≥–∏—ò–∞ –º–æ–∂–µ –∏ –¥–∞—ô–µ –¥–æ–≤–µ—Å—Ç–∏ –¥–æ —Ç–æ–≥–∞ –¥–∞ —Å–µ –∞–≥–µ–Ω—Ç –≤—Ä–∞—Ç–∏ –Ω–∞ –ø–æ–∑–∏—Ü–∏—ò—É –∫–æ—ò—É —ò–µ –≤–µ—õ –∏—Å—Ç—Ä–∞–∂–∏–æ, –∞–ª–∏, –∫–∞–æ —à—Ç–æ –º–æ–∂–µ—Ç–µ –≤–∏–¥–µ—Ç–∏ –∏–∑ –∫–æ–¥–∞ –∏—Å–ø–æ–¥, —Ä–µ–∑—É–ª—Ç–∏—Ä–∞ –≤–µ–æ–º–∞ –∫—Ä–∞—Ç–∫–æ–º –ø—Ä–æ—Å–µ—á–Ω–æ–º –¥—É–∂–∏–Ω–æ–º –ø—É—Ç–∞ –¥–æ –∂–µ—ô–µ–Ω–µ –ª–æ–∫–∞—Ü–∏—ò–µ (—Å–µ—Ç–∏—Ç–µ —Å–µ –¥–∞ `print_statistics` –ø–æ–∫—Ä–µ—õ–µ —Å–∏–º—É–ª–∞—Ü–∏—ò—É 100 –ø—É—Ç–∞): (–∫–æ–¥ –±–ª–æ–∫ 10)

```python
def qpolicy(m):
        x,y = m.human
        v = probs(Q[x,y])
        a = random.choices(list(actions),weights=v)[0]
        return a

print_statistics(qpolicy)
```

–ù–∞–∫–æ–Ω –ø–æ–∫—Ä–µ—Ç–∞—ö–∞ –æ–≤–æ–≥ –∫–æ–¥–∞, —Ç—Ä–µ–±–∞–ª–æ –±–∏ –¥–∞ –¥–æ–±–∏—ò–µ—Ç–µ –º–Ω–æ–≥–æ –º–∞—ö—É –ø—Ä–æ—Å–µ—á–Ω—É –¥—É–∂–∏–Ω—É –ø—É—Ç–∞ –Ω–µ–≥–æ —Ä–∞–Ω–∏—ò–µ, —É —Ä–∞—Å–ø–æ–Ω—É –æ–¥ 3-6.

## –ò—Å—Ç—Ä–∞–∂–∏–≤–∞—ö–µ –ø—Ä–æ—Ü–µ—Å–∞ —É—á–µ—ö–∞

–ö–∞–æ —à—Ç–æ —Å–º–æ –ø–æ–º–µ–Ω—É–ª–∏, –ø—Ä–æ—Ü–µ—Å —É—á–µ—ö–∞ —ò–µ –±–∞–ª–∞–Ω—Å –∏–∑–º–µ—í—É –∏—Å—Ç—Ä–∞–∂–∏–≤–∞—ö–∞ –∏ –µ–∫—Å–ø–ª–æ–∞—Ç–∞—Ü–∏—ò–µ —Å—Ç–µ—á–µ–Ω–æ–≥ –∑–Ω–∞—ö–∞ –æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ –ø—Ä–æ—Å—Ç–æ—Ä–∞ –ø—Ä–æ–±–ª–µ–º–∞. –í–∏–¥–µ–ª–∏ —Å–º–æ –¥–∞ —Å—É —Ä–µ–∑—É–ª—Ç–∞—Ç–∏ —É—á–µ—ö–∞ (—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç –¥–∞ —Å–µ –∞–≥–µ–Ω—Ç—É –ø–æ–º–æ–≥–Ω–µ –¥–∞ –ø—Ä–æ–Ω–∞—í–µ –∫—Ä–∞—Ç–∞–∫ –ø—É—Ç –¥–æ —Ü–∏—ô–∞) –ø–æ–±–æ—ô—à–∞–Ω–∏, –∞–ª–∏ —ò–µ —Ç–∞–∫–æ—í–µ –∑–∞–Ω–∏–º—ô–∏–≤–æ –ø–æ—Å–º–∞—Ç—Ä–∞—Ç–∏ –∫–∞–∫–æ —Å–µ –ø—Ä–æ—Å–µ—á–Ω–∞ –¥—É–∂–∏–Ω–∞ –ø—É—Ç–∞—ö–∞ –ø–æ–Ω–∞—à–∞ —Ç–æ–∫–æ–º –ø—Ä–æ—Ü–µ—Å–∞ —É—á–µ—ö–∞:

## –°–∞–∂–µ—Ç–∞–∫ —É—á–µ—ö–∞:

- **–ü—Ä–æ—Å–µ—á–Ω–∞ –¥—É–∂–∏–Ω–∞ –ø—É—Ç–∞ —Å–µ –ø–æ–≤–µ—õ–∞–≤–∞**. –û–Ω–æ —à—Ç–æ –æ–≤–¥–µ –≤–∏–¥–∏–º–æ —ò–µ –¥–∞ —Å–µ –Ω–∞ –ø–æ—á–µ—Ç–∫—É –ø—Ä–æ—Å–µ—á–Ω–∞ –¥—É–∂–∏–Ω–∞ –ø—É—Ç–∞ –ø–æ–≤–µ—õ–∞–≤–∞. –û–≤–æ —ò–µ –≤–µ—Ä–æ–≤–∞—Ç–Ω–æ –∑–±–æ–≥ —á–∏—ö–µ–Ω–∏—Ü–µ –¥–∞ –∫–∞–¥–∞ –Ω–∏—à—Ç–∞ –Ω–µ –∑–Ω–∞–º–æ –æ –æ–∫—Ä—É–∂–µ—ö—É, –≤–µ—Ä–æ–≤–∞—Ç–Ω–æ —õ–µ–º–æ —Å–µ –∑–∞–≥–ª–∞–≤–∏—Ç–∏ —É –ª–æ—à–∏–º —Å—Ç–∞—ö–∏–º–∞, –≤–æ–¥–∏ –∏–ª–∏ –∫–æ–¥ –≤—É–∫–∞. –ö–∞–∫–æ –≤–∏—à–µ —É—á–∏–º–æ –∏ –ø–æ—á–Ω–µ–º–æ –¥–∞ –∫–æ—Ä–∏—Å—Ç–∏–º–æ —Ç–æ –∑–Ω–∞—ö–µ, –º–æ–∂–µ–º–æ –¥—É–∂–µ –∏—Å—Ç—Ä–∞–∂–∏–≤–∞—Ç–∏ –æ–∫—Ä—É–∂–µ—ö–µ, –∞–ª–∏ —ò–æ—à —É–≤–µ–∫ –Ω–µ –∑–Ω–∞–º–æ –¥–æ–±—Ä–æ –≥–¥–µ —Å–µ –Ω–∞–ª–∞–∑–µ —ò–∞–±—É–∫–µ.

- **–î—É–∂–∏–Ω–∞ –ø—É—Ç–∞ —Å–µ —Å–º–∞—ö—É—ò–µ –∫–∞–∫–æ –≤–∏—à–µ —É—á–∏–º–æ**. –ö–∞–¥–∞ –¥–æ–≤–æ—ô–Ω–æ –Ω–∞—É—á–∏–º–æ, –ø–æ—Å—Ç–∞—ò–µ –ª–∞–∫—à–µ –∞–≥–µ–Ω—Ç—É –¥–∞ –ø–æ—Å—Ç–∏–≥–Ω–µ —Ü–∏—ô, –∏ –¥—É–∂–∏–Ω–∞ –ø—É—Ç–∞ –ø–æ—á–∏—ö–µ –¥–∞ —Å–µ —Å–º–∞—ö—É—ò–µ. –ú–µ—í—É—Ç–∏–º, —ò–æ—à —É–≤–µ–∫ —Å–º–æ –æ—Ç–≤–æ—Ä–µ–Ω–∏ –∑–∞ –∏—Å—Ç—Ä–∞–∂–∏–≤–∞—ö–µ, –ø–∞ —á–µ—Å—Ç–æ –æ–¥—Å—Ç—É–ø–∞–º–æ –æ–¥ –Ω–∞—ò–±–æ—ô–µ–≥ –ø—É—Ç–∞ –∏ –∏—Å—Ç—Ä–∞–∂—É—ò–µ–º–æ –Ω–æ–≤–µ –æ–ø—Ü–∏—ò–µ, —á–∏–Ω–µ—õ–∏ –ø—É—Ç –¥—É–∂–∏–º –æ–¥ –æ–ø—Ç–∏–º–∞–ª–Ω–æ–≥.

- **–î—É–∂–∏–Ω–∞ —Å–µ –Ω–∞–≥–ª–æ –ø–æ–≤–µ—õ–∞–≤–∞**. –û–Ω–æ —à—Ç–æ —Ç–∞–∫–æ—í–µ –ø—Ä–∏–º–µ—õ—É—ò–µ–º–æ –Ω–∞ –æ–≤–æ–º –≥—Ä–∞—Ñ–∏–∫—É —ò–µ –¥–∞ —Å–µ —É —ò–µ–¥–Ω–æ–º —Ç—Ä–µ–Ω—É—Ç–∫—É –¥—É–∂–∏–Ω–∞ –Ω–∞–≥–ª–æ –ø–æ–≤–µ—õ–∞–ª–∞. –û–≤–æ —É–∫–∞–∑—É—ò–µ –Ω–∞ —Å—Ç–æ—Ö–∞—Å—Ç–∏—á–∫—É –ø—Ä–∏—Ä–æ–¥—É –ø—Ä–æ—Ü–µ—Å–∞, –∏ –¥–∞ —É —ò–µ–¥–Ω–æ–º —Ç—Ä–µ–Ω—É—Ç–∫—É –º–æ–∂–µ–º–æ "–ø–æ–∫–≤–∞—Ä–∏—Ç–∏" –∫–æ–µ—Ñ–∏—Ü–∏—ò–µ–Ω—Ç–µ —É Q-—Ç–∞–±–µ–ª–∏ —Ç–∞–∫–æ —à—Ç–æ –∏—Ö –ø—Ä–µ–ø–∏—à–µ–º–æ –Ω–æ–≤–∏–º –≤—Ä–µ–¥–Ω–æ—Å—Ç–∏–º–∞. –û–≤–æ –±–∏ –∏–¥–µ–∞–ª–Ω–æ —Ç—Ä–µ–±–∞–ª–æ –º–∏–Ω–∏–º–∏–∑–∏—Ä–∞—Ç–∏ —Å–º–∞—ö–µ—ö–µ–º —Å—Ç–æ–ø–µ —É—á–µ—ö–∞ (–Ω–∞ –ø—Ä–∏–º–µ—Ä, –ø—Ä–µ–¥ –∫—Ä–∞—ò —Ç—Ä–µ–Ω–∏–Ω–≥–∞, –≤—Ä–µ–¥–Ω–æ—Å—Ç–∏ —É Q-—Ç–∞–±–µ–ª–∏ –ø—Ä–∏–ª–∞–≥–æ—í–∞–≤–∞–º–æ —Å–∞–º–æ –º–∞–ª–∏–º –∏–∑–Ω–æ—Å–æ–º).

–£–æ–ø—à—Ç–µ–Ω–æ, –≤–∞–∂–Ω–æ —ò–µ –∑–∞–ø–∞–º—Ç–∏—Ç–∏ –¥–∞ —É—Å–ø–µ—Ö –∏ –∫–≤–∞–ª–∏—Ç–µ—Ç –ø—Ä–æ—Ü–µ—Å–∞ —É—á–µ—ö–∞ –∑–Ω–∞—á–∞—ò–Ω–æ –∑–∞–≤–∏—Å–µ –æ–¥ –ø–∞—Ä–∞–º–µ—Ç–∞—Ä–∞, –∫–∞–æ —à—Ç–æ —Å—É —Å—Ç–æ–ø–∞ —É—á–µ—ö–∞, –æ–ø–∞–¥–∞—ö–µ —Å—Ç–æ–ø–µ —É—á–µ—ö–∞ –∏ —Ñ–∞–∫—Ç–æ—Ä –¥–∏—Å–∫–æ–Ω—Ç–æ–≤–∞—ö–∞. –û–≤–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ —Å–µ —á–µ—Å—Ç–æ –Ω–∞–∑–∏–≤–∞—ò—É **—Ö–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–∏**, –∫–∞–∫–æ –±–∏ —Å–µ —Ä–∞–∑–ª–∏–∫–æ–≤–∞–ª–∏ –æ–¥ **–ø–∞—Ä–∞–º–µ—Ç–∞—Ä–∞**, –∫–æ—ò–µ –æ–ø—Ç–∏–º–∏–∑—É—ò–µ–º–æ —Ç–æ–∫–æ–º —Ç—Ä–µ–Ω–∏–Ω–≥–∞ (–Ω–∞ –ø—Ä–∏–º–µ—Ä, –∫–æ–µ—Ñ–∏—Ü–∏—ò–µ–Ω—Ç–∏ —É Q-—Ç–∞–±–µ–ª–∏). –ü—Ä–æ—Ü–µ—Å –ø—Ä–æ–Ω–∞–ª–∞–∂–µ—ö–∞ –Ω–∞—ò–±–æ—ô–∏—Ö –≤—Ä–µ–¥–Ω–æ—Å—Ç–∏ —Ö–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç–∞—Ä–∞ –Ω–∞–∑–∏–≤–∞ —Å–µ **–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—ò–∞ —Ö–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç–∞—Ä–∞**, –∏ –∑–∞—Å–ª—É–∂—É—ò–µ –ø–æ—Å–µ–±–Ω—É —Ç–µ–º—É.

## [–ö–≤–∏–∑ –Ω–∞–∫–æ–Ω –ø—Ä–µ–¥–∞–≤–∞—ö–∞](https://ff-quizzes.netlify.app/en/ml/)

## –ó–∞–¥–∞—Ç–∞–∫ 
[–†–µ–∞–ª–Ω–∏—ò–∏ —Å–≤–µ—Ç](assignment.md)

---

**–û–¥—Ä–∏—Ü–∞—ö–µ –æ–¥ –æ–¥–≥–æ–≤–æ—Ä–Ω–æ—Å—Ç–∏**:  
–û–≤–∞—ò –¥–æ–∫—É–º–µ–Ω—Ç —ò–µ –ø—Ä–µ–≤–µ–¥–µ–Ω –∫–æ—Ä–∏—à—õ–µ—ö–µ–º —É—Å–ª—É–≥–µ –∑–∞ –ø—Ä–µ–≤–æ—í–µ—ö–µ –ø–æ–º–æ—õ—É –≤–µ—à—Ç–∞—á–∫–µ –∏–Ω—Ç–µ–ª–∏–≥–µ–Ω—Ü–∏—ò–µ [Co-op Translator](https://github.com/Azure/co-op-translator). –ò–∞–∫–æ —Å–µ —Ç—Ä—É–¥–∏–º–æ –¥–∞ –æ–±–µ–∑–±–µ–¥–∏–º–æ —Ç–∞—á–Ω–æ—Å—Ç, –º–æ–ª–∏–º–æ –≤–∞—Å –¥–∞ –∏–º–∞—Ç–µ —É –≤–∏–¥—É –¥–∞ –∞—É—Ç–æ–º–∞—Ç–∏–∑–æ–≤–∞–Ω–∏ –ø—Ä–µ–≤–æ–¥–∏ –º–æ–≥—É —Å–∞–¥—Ä–∂–∞—Ç–∏ –≥—Ä–µ—à–∫–µ –∏–ª–∏ –Ω–µ—Ç–∞—á–Ω–æ—Å—Ç–∏. –û—Ä–∏–≥–∏–Ω–∞–ª–Ω–∏ –¥–æ–∫—É–º–µ–Ω—Ç –Ω–∞ —ö–µ–≥–æ–≤–æ–º –∏–∑–≤–æ—Ä–Ω–æ–º —ò–µ–∑–∏–∫—É —Ç—Ä–µ–±–∞ —Å–º–∞—Ç—Ä–∞—Ç–∏ –∞—É—Ç–æ—Ä–∏—Ç–∞—Ç–∏–≤–Ω–∏–º –∏–∑–≤–æ—Ä–æ–º. –ó–∞ –∫—Ä–∏—Ç–∏—á–Ω–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—ò–µ –ø—Ä–µ–ø–æ—Ä—É—á—É—ò–µ —Å–µ –ø—Ä–æ—Ñ–µ—Å–∏–æ–Ω–∞–ª–Ω–∏ –ø—Ä–µ–≤–æ–¥ –æ–¥ —Å—Ç—Ä–∞–Ω–µ —ô—É–¥–∏. –ù–µ –ø—Ä–µ—É–∑–∏–º–∞–º–æ –æ–¥–≥–æ–≤–æ—Ä–Ω–æ—Å—Ç –∑–∞ –±–∏–ª–æ –∫–∞–∫–≤–∞ –ø–æ–≥—Ä–µ—à–Ω–∞ —Ç—É–º–∞—á–µ—ö–∞ –∏–ª–∏ –Ω–µ—Å–ø–æ—Ä–∞–∑—É–º–µ –∫–æ—ò–∏ –º–æ–≥—É –Ω–∞—Å—Ç–∞—Ç–∏ —É—Å–ª–µ–¥ –∫–æ—Ä–∏—à—õ–µ—ö–∞ –æ–≤–æ–≥ –ø—Ä–µ–≤–æ–¥–∞.