<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "917dbf890db71a322f306050cb284749",
  "translation_date": "2025-09-05T11:50:36+00:00",
  "source_file": "7-TimeSeries/2-ARIMA/README.md",
  "language_code": "sr"
}
-->
# –ü—Ä–æ–≥–Ω–æ–∑–∏—Ä–∞—ö–µ –≤—Ä–µ–º–µ–Ω—Å–∫–∏—Ö —Å–µ—Ä–∏—ò–∞ –ø–æ–º–æ—õ—É ARIMA –º–æ–¥–µ–ª–∞

–£ –ø—Ä–µ—Ç—Ö–æ–¥–Ω–æ—ò –ª–µ–∫—Ü–∏—ò–∏, –Ω–∞—É—á–∏–ª–∏ —Å—Ç–µ –Ω–µ—à—Ç–æ –æ –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–∞—ö—É –≤—Ä–µ–º–µ–Ω—Å–∫–∏—Ö —Å–µ—Ä–∏—ò–∞ –∏ —É—á–∏—Ç–∞–ª–∏ —Å–∫—É–ø –ø–æ–¥–∞—Ç–∞–∫–∞ –∫–æ—ò–∏ –ø—Ä–∏–∫–∞–∑—É—ò–µ —Ñ–ª—É–∫—Ç—É–∞—Ü–∏—ò–µ –µ–ª–µ–∫—Ç—Ä–∏—á–Ω–æ–≥ –æ–ø—Ç–µ—Ä–µ—õ–µ—ö–∞ —Ç–æ–∫–æ–º –æ–¥—Ä–µ—í–µ–Ω–æ–≥ –≤—Ä–µ–º–µ–Ω—Å–∫–æ–≥ –ø–µ—Ä–∏–æ–¥–∞.

[![–£–≤–æ–¥ —É ARIMA](https://img.youtube.com/vi/IUSk-YDau10/0.jpg)](https://youtu.be/IUSk-YDau10 "–£–≤–æ–¥ —É ARIMA")

> üé• –ö–ª–∏–∫–Ω–∏—Ç–µ –Ω–∞ —Å–ª–∏–∫—É –∏–∑–Ω–∞–¥ –∑–∞ –≤–∏–¥–µ–æ: –ö—Ä–∞—Ç–∞–∫ —É–≤–æ–¥ —É ARIMA –º–æ–¥–µ–ª–µ. –ü—Ä–∏–º–µ—Ä —ò–µ —É—Ä–∞—í–µ–Ω —É R —ò–µ–∑–∏–∫—É, –∞–ª–∏ —Å—É –∫–æ–Ω—Ü–µ–ø—Ç–∏ —É–Ω–∏–≤–µ—Ä–∑–∞–ª–Ω–∏.

## [–ö–≤–∏–∑ –ø—Ä–µ –ø—Ä–µ–¥–∞–≤–∞—ö–∞](https://ff-quizzes.netlify.app/en/ml/)

## –£–≤–æ–¥

–£ –æ–≤–æ—ò –ª–µ–∫—Ü–∏—ò–∏, –æ—Ç–∫—Ä–∏—õ–µ—Ç–µ —Å–ø–µ—Ü–∏—Ñ–∏—á–∞–Ω –Ω–∞—á–∏–Ω –∑–∞ –∏–∑–≥—Ä–∞–¥—ö—É –º–æ–¥–µ–ª–∞ –ø–æ–º–æ—õ—É [ARIMA: *A*uto*R*egressive *I*ntegrated *M*oving *A*verage](https://wikipedia.org/wiki/Autoregressive_integrated_moving_average). ARIMA –º–æ–¥–µ–ª–∏ —Å—É –ø–æ—Å–µ–±–Ω–æ –ø–æ–≥–æ–¥–Ω–∏ –∑–∞ –ø–æ–¥–∞—Ç–∫–µ –∫–æ—ò–∏ –ø–æ–∫–∞–∑—É—ò—É [–Ω–µ–∫–æ–Ω—Å—Ç–∞–Ω—Ç–Ω–æ—Å—Ç](https://wikipedia.org/wiki/Stationary_process).

## –û–ø—à—Ç–∏ –∫–æ–Ω—Ü–µ–ø—Ç–∏

–î–∞ –±–∏—Å—Ç–µ –º–æ–≥–ª–∏ –¥–∞ —Ä–∞–¥–∏—Ç–µ —Å–∞ ARIMA –º–æ–¥–µ–ª–∏–º–∞, –ø–æ—Ç—Ä–µ–±–Ω–æ —ò–µ –¥–∞ —Ä–∞–∑—É–º–µ—Ç–µ –Ω–µ–∫–µ –æ—Å–Ω–æ–≤–Ω–µ –∫–æ–Ω—Ü–µ–ø—Ç–µ:

- üéì **–°—Ç–∞—Ü–∏–æ–Ω–∞—Ä–Ω–æ—Å—Ç**. –£ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–∫–æ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç—É, —Å—Ç–∞—Ü–∏–æ–Ω–∞—Ä–Ω–æ—Å—Ç —Å–µ –æ–¥–Ω–æ—Å–∏ –Ω–∞ –ø–æ–¥–∞—Ç–∫–µ —á–∏—ò–∞ —Å–µ –¥–∏—Å—Ç—Ä–∏–±—É—Ü–∏—ò–∞ –Ω–µ –º–µ—ö–∞ –∫–∞–¥–∞ —Å–µ –ø–æ–º–µ—Ä–∏ —É –≤—Ä–µ–º–µ–Ω—É. –ù–µ–∫–æ–Ω—Å—Ç–∞–Ω—Ç–Ω–∏ –ø–æ–¥–∞—Ü–∏ –ø–æ–∫–∞–∑—É—ò—É —Ñ–ª—É–∫—Ç—É–∞—Ü–∏—ò–µ —É—Å–ª–µ–¥ —Ç—Ä–µ–Ω–¥–æ–≤–∞ –∫–æ—ò–∏ –º–æ—Ä–∞—ò—É –±–∏—Ç–∏ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∏—Å–∞–Ω–∏ –∫–∞–∫–æ –±–∏ —Å–µ –∞–Ω–∞–ª–∏–∑–∏—Ä–∞–ª–∏. –ù–∞ –ø—Ä–∏–º–µ—Ä, —Å–µ–∑–æ–Ω–∞–ª–Ω–æ—Å—Ç –º–æ–∂–µ —É–Ω–µ—Ç–∏ —Ñ–ª—É–∫—Ç—É–∞—Ü–∏—ò–µ —É –ø–æ–¥–∞—Ç–∫–µ –∏ –º–æ–∂–µ —Å–µ –µ–ª–∏–º–∏–Ω–∏—Å–∞—Ç–∏ –ø—Ä–æ—Ü–µ—Å–æ–º '—Å–µ–∑–æ–Ω—Å–∫–æ–≥ —Ä–∞–∑–ª–∏–∫–æ–≤–∞—ö–∞'.

- üéì **[–†–∞–∑–ª–∏–∫–æ–≤–∞—ö–µ](https://wikipedia.org/wiki/Autoregressive_integrated_moving_average#Differencing)**. –†–∞–∑–ª–∏–∫–æ–≤–∞—ö–µ –ø–æ–¥–∞—Ç–∞–∫–∞, —É —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–∫–æ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç—É, –æ–¥–Ω–æ—Å–∏ —Å–µ –Ω–∞ –ø—Ä–æ—Ü–µ—Å —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∏—Å–∞—ö–∞ –Ω–µ–∫–æ–Ω—Å—Ç–∞–Ω—Ç–Ω–∏—Ö –ø–æ–¥–∞—Ç–∞–∫–∞ —É –∫–æ–Ω—Å—Ç–∞–Ω—Ç–Ω–µ —É–∫–ª–∞—ö–∞—ö–µ–º —ö–∏—Ö–æ–≤–æ–≥ –Ω–µ–∫–æ–Ω—Å—Ç–∞–Ω—Ç–Ω–æ–≥ —Ç—Ä–µ–Ω–¥–∞. "–†–∞–∑–ª–∏–∫–æ–≤–∞—ö–µ —É–∫–ª–∞—ö–∞ –ø—Ä–æ–º–µ–Ω–µ —É –Ω–∏–≤–æ—É –≤—Ä–µ–º–µ–Ω—Å–∫–µ —Å–µ—Ä–∏—ò–µ, –µ–ª–∏–º–∏–Ω–∏—à–µ —Ç—Ä–µ–Ω–¥ –∏ —Å–µ–∑–æ–Ω–∞–ª–Ω–æ—Å—Ç –∏ —Ç–∏–º–µ —Å—Ç–∞–±–∏–ª–∏–∑—É—ò–µ —Å—Ä–µ–¥—ö—É –≤—Ä–µ–¥–Ω–æ—Å—Ç –≤—Ä–µ–º–µ–Ω—Å–∫–µ —Å–µ—Ä–∏—ò–µ." [–†–∞–¥ –®–∏–∫—Å–∏–æ–Ω–≥–∞ –∏ —Å–∞—Ä–∞–¥–Ω–∏–∫–∞](https://arxiv.org/abs/1904.07632)

## ARIMA —É –∫–æ–Ω—Ç–µ–∫—Å—Ç—É –≤—Ä–µ–º–µ–Ω—Å–∫–∏—Ö —Å–µ—Ä–∏—ò–∞

–•–∞—ò–¥–µ –¥–∞ —Ä–∞–∑–ª–æ–∂–∏–º–æ –¥–µ–ª–æ–≤–µ ARIMA –º–æ–¥–µ–ª–∞ –∫–∞–∫–æ –±–∏—Å–º–æ –±–æ—ô–µ —Ä–∞–∑—É–º–µ–ª–∏ –∫–∞–∫–æ –Ω–∞–º –ø–æ–º–∞–∂–µ —É –º–æ–¥–µ–ª–∏—Ä–∞—ö—É –≤—Ä–µ–º–µ–Ω—Å–∫–∏—Ö —Å–µ—Ä–∏—ò–∞ –∏ –ø—Ä–∞–≤—ô–µ—ö—É –ø—Ä–µ–¥–≤–∏—í–∞—ö–∞.

- **AR - –ê—É—Ç–æ–†–µ–≥—Ä–µ—Å–∏–≤–Ω–æ**. –ê—É—Ç–æ—Ä–µ–≥—Ä–µ—Å–∏–≤–Ω–∏ –º–æ–¥–µ–ª–∏, –∫–∞–∫–æ –∏ —Å–∞–º–æ –∏–º–µ –∫–∞–∂–µ, –≥–ª–µ–¥–∞—ò—É '—É–Ω–∞–∑–∞–¥' —É –≤—Ä–µ–º–µ–Ω—É –∫–∞–∫–æ –±–∏ –∞–Ω–∞–ª–∏–∑–∏—Ä–∞–ª–∏ –ø—Ä–µ—Ç—Ö–æ–¥–Ω–µ –≤—Ä–µ–¥–Ω–æ—Å—Ç–∏ —É –≤–∞—à–∏–º –ø–æ–¥–∞—Ü–∏–º–∞ –∏ –Ω–∞–ø—Ä–∞–≤–∏–ª–∏ –ø—Ä–µ—Ç–ø–æ—Å—Ç–∞–≤–∫–µ –æ —ö–∏–º–∞. –¢–µ –ø—Ä–µ—Ç—Ö–æ–¥–Ω–µ –≤—Ä–µ–¥–Ω–æ—Å—Ç–∏ —Å–µ –Ω–∞–∑–∏–≤–∞—ò—É '–∑–∞–∫–∞—à—ö–µ—ö–∞'. –ü—Ä–∏–º–µ—Ä –±–∏ –±–∏–ª–∏ –ø–æ–¥–∞—Ü–∏ –∫–æ—ò–∏ –ø—Ä–∏–∫–∞–∑—É—ò—É –º–µ—Å–µ—á–Ω—É –ø—Ä–æ–¥–∞—ò—É –æ–ª–æ–≤–∞–∫–∞. –£–∫—É–ø–Ω–∞ –ø—Ä–æ–¥–∞—ò–∞ —Å–≤–∞–∫–æ–≥ –º–µ—Å–µ—Ü–∞ –±–∏ —Å–µ —Å–º–∞—Ç—Ä–∞–ª–∞ '–ø—Ä–æ–º–µ–Ω—ô–∏–≤–æ–º –∫–æ—ò–∞ —Å–µ —Ä–∞–∑–≤–∏—ò–∞' —É —Å–∫—É–ø—É –ø–æ–¥–∞—Ç–∞–∫–∞. –û–≤–∞—ò –º–æ–¥–µ–ª —Å–µ –≥—Ä–∞–¥–∏ —Ç–∞–∫–æ —à—Ç–æ —Å–µ "–ø—Ä–æ–º–µ–Ω—ô–∏–≤–∞ –∫–æ—ò–∞ –Ω–∞—Å –∑–∞–Ω–∏–º–∞ —Ä–µ–≥—Ä–µ—Å–∏—Ä–∞ –Ω–∞ —Å–≤–æ—ò–µ –∑–∞–∫–∞—à—ö–µ–ª–µ (—Ç—ò. –ø—Ä–µ—Ç—Ö–æ–¥–Ω–µ) –≤—Ä–µ–¥–Ω–æ—Å—Ç–∏." [–≤–∏–∫–∏–ø–µ–¥–∏—ò–∞](https://wikipedia.org/wiki/Autoregressive_integrated_moving_average)

- **I - –ò–Ω—Ç–µ–≥—Ä–∏—Å–∞–Ω–æ**. –ó–∞ —Ä–∞–∑–ª–∏–∫—É –æ–¥ —Å–ª–∏—á–Ω–∏—Ö 'ARMA' –º–æ–¥–µ–ª–∞, 'I' —É ARIMA —Å–µ –æ–¥–Ω–æ—Å–∏ –Ω–∞ —ö–µ–≥–æ–≤ *[–∏–Ω—Ç–µ–≥—Ä–∏—Å–∞–Ω–∏](https://wikipedia.org/wiki/Order_of_integration)* –∞—Å–ø–µ–∫—Ç. –ü–æ–¥–∞—Ü–∏ —Å–µ '–∏–Ω—Ç–µ–≥—Ä–∏—à—É' –∫–∞–¥–∞ —Å–µ –ø—Ä–∏–º–µ—ö—É—ò—É –∫–æ—Ä–∞—Ü–∏ —Ä–∞–∑–ª–∏–∫–æ–≤–∞—ö–∞ –∫–∞–∫–æ –±–∏ —Å–µ –µ–ª–∏–º–∏–Ω–∏—Å–∞–ª–∞ –Ω–µ–∫–æ–Ω—Å—Ç–∞–Ω—Ç–Ω–æ—Å—Ç.

- **MA - –ü–æ–∫—Ä–µ—Ç–Ω–∏ –ü—Ä–æ—Å–µ–∫**. –ê—Å–ø–µ–∫—Ç [–ø–æ–∫—Ä–µ—Ç–Ω–æ–≥ –ø—Ä–æ—Å–µ–∫–∞](https://wikipedia.org/wiki/Moving-average_model) –æ–≤–æ–≥ –º–æ–¥–µ–ª–∞ –æ–¥–Ω–æ—Å–∏ —Å–µ –Ω–∞ –∏–∑–ª–∞–∑–Ω—É –ø—Ä–æ–º–µ–Ω—ô–∏–≤—É –∫–æ—ò–∞ —Å–µ –æ–¥—Ä–µ—í—É—ò–µ –ø–æ—Å–º–∞—Ç—Ä–∞—ö–µ–º —Ç—Ä–µ–Ω—É—Ç–Ω–∏—Ö –∏ –ø—Ä–µ—Ç—Ö–æ–¥–Ω–∏—Ö –≤—Ä–µ–¥–Ω–æ—Å—Ç–∏ –∑–∞–∫–∞—à—ö–µ—ö–∞.

–°—É—à—Ç–∏–Ω–∞: ARIMA —Å–µ –∫–æ—Ä–∏—Å—Ç–∏ –∑–∞ –ø—Ä–∞–≤—ô–µ—ö–µ –º–æ–¥–µ–ª–∞ –∫–æ—ò–∏ —à—Ç–æ –±–æ—ô–µ –æ–¥–≥–æ–≤–∞—Ä–∞ —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω–æ–º –æ–±–ª–∏–∫—É –ø–æ–¥–∞—Ç–∞–∫–∞ –≤—Ä–µ–º–µ–Ω—Å–∫–∏—Ö —Å–µ—Ä–∏—ò–∞.

## –í–µ–∂–±–∞ - –∏–∑–≥—Ä–∞–¥—ö–∞ ARIMA –º–æ–¥–µ–ª–∞

–û—Ç–≤–æ—Ä–∏—Ç–µ [_/working_](https://github.com/microsoft/ML-For-Beginners/tree/main/7-TimeSeries/2-ARIMA/working) —Ñ–∞—Å—Ü–∏–∫–ª—É —É –æ–≤–æ—ò –ª–µ–∫—Ü–∏—ò–∏ –∏ –ø—Ä–æ–Ω–∞—í–∏—Ç–µ [_notebook.ipynb_](https://github.com/microsoft/ML-For-Beginners/blob/main/7-TimeSeries/2-ARIMA/working/notebook.ipynb) –¥–∞—Ç–æ—Ç–µ–∫—É.

1. –ü–æ–∫—Ä–µ–Ω–∏—Ç–µ –±–µ–ª–µ–∂–Ω–∏—Ü—É –¥–∞ —É—á–∏—Ç–∞—Ç–µ Python –±–∏–±–ª–∏–æ—Ç–µ–∫—É `statsmodels`; –±–∏—õ–µ –≤–∞–º –ø–æ—Ç—Ä–µ–±–Ω–∞ –∑–∞ ARIMA –º–æ–¥–µ–ª–µ.

1. –£—á–∏—Ç–∞—ò—Ç–µ –Ω–µ–æ–ø—Ö–æ–¥–Ω–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–µ.

1. –°–∞–¥–∞ —É—á–∏—Ç–∞—ò—Ç–µ —ò–æ—à –Ω–µ–∫–æ–ª–∏–∫–æ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –∫–æ—Ä–∏—Å–Ω–∏—Ö –∑–∞ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—ò—É –ø–æ–¥–∞—Ç–∞–∫–∞:

    ```python
    import os
    import warnings
    import matplotlib.pyplot as plt
    import numpy as np
    import pandas as pd
    import datetime as dt
    import math

    from pandas.plotting import autocorrelation_plot
    from statsmodels.tsa.statespace.sarimax import SARIMAX
    from sklearn.preprocessing import MinMaxScaler
    from common.utils import load_data, mape
    from IPython.display import Image

    %matplotlib inline
    pd.options.display.float_format = '{:,.2f}'.format
    np.set_printoptions(precision=2)
    warnings.filterwarnings("ignore") # specify to ignore warning messages
    ```

1. –£—á–∏—Ç–∞—ò—Ç–µ –ø–æ–¥–∞—Ç–∫–µ –∏–∑ `/data/energy.csv` –¥–∞—Ç–æ—Ç–µ–∫–µ —É Pandas dataframe –∏ –ø–æ–≥–ª–µ–¥–∞—ò—Ç–µ –∏—Ö:

    ```python
    energy = load_data('./data')[['load']]
    energy.head(10)
    ```

1. –ü—Ä–∏–∫–∞–∂–∏—Ç–µ —Å–≤–µ –¥–æ—Å—Ç—É–ø–Ω–µ –ø–æ–¥–∞—Ç–∫–µ –æ –µ–Ω–µ—Ä–≥–∏—ò–∏ –æ–¥ —ò–∞–Ω—É–∞—Ä–∞ 2012. –¥–æ –¥–µ—Ü–µ–º–±—Ä–∞ 2014. –ù–µ –±–∏ —Ç—Ä–µ–±–∞–ª–æ –¥–∞ –±—É–¥–µ –∏–∑–Ω–µ–Ω–∞—í–µ—ö–∞ —ò–µ—Ä —Å–º–æ –æ–≤–µ –ø–æ–¥–∞—Ç–∫–µ –≤–∏–¥–µ–ª–∏ —É –ø—Ä–µ—Ç—Ö–æ–¥–Ω–æ—ò –ª–µ–∫—Ü–∏—ò–∏:

    ```python
    energy.plot(y='load', subplots=True, figsize=(15, 8), fontsize=12)
    plt.xlabel('timestamp', fontsize=12)
    plt.ylabel('load', fontsize=12)
    plt.show()
    ```

    –°–∞–¥–∞, —Ö–∞—ò–¥–µ –¥–∞ –∏–∑–≥—Ä–∞–¥–∏–º–æ –º–æ–¥–µ–ª!

### –ö—Ä–µ–∏—Ä–∞—ö–µ —Å–∫—É–ø–æ–≤–∞ –∑–∞ –æ–±—É–∫—É –∏ —Ç–µ—Å—Ç–∏—Ä–∞—ö–µ

–°–∞–¥–∞ –∫–∞–¥–∞ —Å—É –≤–∞—à–∏ –ø–æ–¥–∞—Ü–∏ —É—á–∏—Ç–∞–Ω–∏, –º–æ–∂–µ—Ç–µ –∏—Ö –ø–æ–¥–µ–ª–∏—Ç–∏ –Ω–∞ —Å–∫—É–ø–æ–≤–µ –∑–∞ –æ–±—É–∫—É –∏ —Ç–µ—Å—Ç–∏—Ä–∞—ö–µ. –ú–æ–¥–µ–ª —õ–µ—Ç–µ –æ–±—É—á–∞–≤–∞—Ç–∏ –Ω–∞ —Å–∫—É–ø—É –∑–∞ –æ–±—É–∫—É. –ö–∞–æ –∏ –æ–±–∏—á–Ω–æ, –Ω–∞–∫–æ–Ω —à—Ç–æ –º–æ–¥–µ–ª –∑–∞–≤—Ä—à–∏ –æ–±—É–∫—É, –ø—Ä–æ—Ü–µ–Ω–∏—õ–µ—Ç–µ —ö–µ–≥–æ–≤—É —Ç–∞—á–Ω–æ—Å—Ç –∫–æ—Ä–∏—Å—Ç–µ—õ–∏ —Å–∫—É–ø –∑–∞ —Ç–µ—Å—Ç–∏—Ä–∞—ö–µ. –ú–æ—Ä–∞—Ç–µ –æ—Å–∏–≥—É—Ä–∞—Ç–∏ –¥–∞ —Å–∫—É–ø –∑–∞ —Ç–µ—Å—Ç–∏—Ä–∞—ö–µ –ø–æ–∫—Ä–∏–≤–∞ –∫–∞—Å–Ω–∏—ò–∏ –≤—Ä–µ–º–µ–Ω—Å–∫–∏ –ø–µ—Ä–∏–æ–¥ —É –æ–¥–Ω–æ—Å—É –Ω–∞ —Å–∫—É–ø –∑–∞ –æ–±—É–∫—É –∫–∞–∫–æ –±–∏—Å—Ç–µ –±–∏–ª–∏ —Å–∏–≥—É—Ä–Ω–∏ –¥–∞ –º–æ–¥–µ–ª –Ω–µ –¥–æ–±–∏—ò–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—ò–µ –∏–∑ –±—É–¥—É—õ–∏—Ö –≤—Ä–µ–º–µ–Ω—Å–∫–∏—Ö –ø–µ—Ä–∏–æ–¥–∞.

1. –î–æ–¥–µ–ª–∏—Ç–µ –¥–≤–æ–º–µ—Å–µ—á–Ω–∏ –ø–µ—Ä–∏–æ–¥ –æ–¥ 1. —Å–µ–ø—Ç–µ–º–±—Ä–∞ –¥–æ 31. –æ–∫—Ç–æ–±—Ä–∞ 2014. —Å–∫—É–ø—É –∑–∞ –æ–±—É–∫—É. –°–∫—É–ø –∑–∞ —Ç–µ—Å—Ç–∏—Ä–∞—ö–µ —õ–µ —É–∫—ô—É—á–∏–≤–∞—Ç–∏ –¥–≤–æ–º–µ—Å–µ—á–Ω–∏ –ø–µ—Ä–∏–æ–¥ –æ–¥ 1. –Ω–æ–≤–µ–º–±—Ä–∞ –¥–æ 31. –¥–µ—Ü–µ–º–±—Ä–∞ 2014:

    ```python
    train_start_dt = '2014-11-01 00:00:00'
    test_start_dt = '2014-12-30 00:00:00'
    ```

    –ü–æ—à—Ç–æ –æ–≤–∏ –ø–æ–¥–∞—Ü–∏ –æ–¥—Ä–∞–∂–∞–≤–∞—ò—É –¥–Ω–µ–≤–Ω—É –ø–æ—Ç—Ä–æ—à—ö—É –µ–Ω–µ—Ä–≥–∏—ò–µ, –ø–æ—Å—Ç–æ—ò–∏ —Å–Ω–∞–∂–∞–Ω —Å–µ–∑–æ–Ω—Å–∫–∏ –æ–±—Ä–∞–∑–∞—Ü, –∞–ª–∏ —ò–µ –ø–æ—Ç—Ä–æ—à—ö–∞ –Ω–∞—ò—Å–ª–∏—á–Ω–∏—ò–∞ –ø–æ—Ç—Ä–æ—à—ö–∏ —É –ø–æ—Å–ª–µ–¥—ö–∏–º –¥–∞–Ω–∏–º–∞.

1. –í–∏–∑—É–µ–ª–∏–∑—É—ò—Ç–µ —Ä–∞–∑–ª–∏–∫–µ:

    ```python
    energy[(energy.index < test_start_dt) & (energy.index >= train_start_dt)][['load']].rename(columns={'load':'train'}) \
        .join(energy[test_start_dt:][['load']].rename(columns={'load':'test'}), how='outer') \
        .plot(y=['train', 'test'], figsize=(15, 8), fontsize=12)
    plt.xlabel('timestamp', fontsize=12)
    plt.ylabel('load', fontsize=12)
    plt.show()
    ```

    ![–ø–æ–¥–∞—Ü–∏ –∑–∞ –æ–±—É–∫—É –∏ —Ç–µ—Å—Ç–∏—Ä–∞—ö–µ](../../../../7-TimeSeries/2-ARIMA/images/train-test.png)

    –î–∞–∫–ª–µ, –∫–æ—Ä–∏—à—õ–µ—ö–µ —Ä–µ–ª–∞—Ç–∏–≤–Ω–æ –º–∞–ª–æ–≥ –≤—Ä–µ–º–µ–Ω—Å–∫–æ–≥ –ø—Ä–æ–∑–æ—Ä–∞ –∑–∞ –æ–±—É–∫—É –ø–æ–¥–∞—Ç–∞–∫–∞ —Ç—Ä–µ–±–∞–ª–æ –±–∏ –¥–∞ –±—É–¥–µ –¥–æ–≤–æ—ô–Ω–æ.

    > –ù–∞–ø–æ–º–µ–Ω–∞: –ü–æ—à—Ç–æ —Ñ—É–Ω–∫—Ü–∏—ò–∞ –∫–æ—ò—É –∫–æ—Ä–∏—Å—Ç–∏–º–æ –∑–∞ –ø—Ä–∏–ª–∞–≥–æ—í–∞–≤–∞—ö–µ ARIMA –º–æ–¥–µ–ª–∞ –∫–æ—Ä–∏—Å—Ç–∏ —É–Ω—É—Ç–∞—Ä-—É–∑–æ—Ä–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—ò—É —Ç–æ–∫–æ–º –ø—Ä–∏–ª–∞–≥–æ—í–∞–≤–∞—ö–∞, –∏–∑–æ—Å—Ç–∞–≤–∏—õ–µ–º–æ –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–µ –ø–æ–¥–∞—Ç–∫–µ.

### –ü—Ä–∏–ø—Ä–µ–º–∞ –ø–æ–¥–∞—Ç–∞–∫–∞ –∑–∞ –æ–±—É–∫—É

–°–∞–¥–∞ —Ç—Ä–µ–±–∞ –¥–∞ –ø—Ä–∏–ø—Ä–µ–º–∏—Ç–µ –ø–æ–¥–∞—Ç–∫–µ –∑–∞ –æ–±—É–∫—É —Ç–∞–∫–æ —à—Ç–æ —õ–µ—Ç–µ –∏–∑–≤—Ä—à–∏—Ç–∏ —Ñ–∏–ª—Ç—Ä–∏—Ä–∞—ö–µ –∏ —Å–∫–∞–ª–∏—Ä–∞—ö–µ –ø–æ–¥–∞—Ç–∞–∫–∞. –§–∏–ª—Ç—Ä–∏—Ä–∞—ò—Ç–µ —Å–≤–æ—ò —Å–∫—É–ø –ø–æ–¥–∞—Ç–∞–∫–∞ —Ç–∞–∫–æ –¥–∞ —É–∫—ô—É—á—É—ò–µ —Å–∞–º–æ –ø–æ—Ç—Ä–µ–±–Ω–µ –≤—Ä–µ–º–µ–Ω—Å–∫–µ –ø–µ—Ä–∏–æ–¥–µ –∏ –∫–æ–ª–æ–Ω–µ, –∞ –∑–∞—Ç–∏–º –∏–∑–≤—Ä—à–∏—Ç–µ —Å–∫–∞–ª–∏—Ä–∞—ö–µ –∫–∞–∫–æ –±–∏ –ø–æ–¥–∞—Ü–∏ –±–∏–ª–∏ —É –∏–Ω—Ç–µ—Ä–≤–∞–ª—É 0,1.

1. –§–∏–ª—Ç—Ä–∏—Ä–∞—ò—Ç–µ –æ—Ä–∏–≥–∏–Ω–∞–ª–Ω–∏ —Å–∫—É–ø –ø–æ–¥–∞—Ç–∞–∫–∞ —Ç–∞–∫–æ –¥–∞ —É–∫—ô—É—á—É—ò–µ —Å–∞–º–æ –ø—Ä–µ—Ç—Ö–æ–¥–Ω–æ –Ω–∞–≤–µ–¥–µ–Ω–µ –≤—Ä–µ–º–µ–Ω—Å–∫–µ –ø–µ—Ä–∏–æ–¥–µ –ø–æ —Å–∫—É–ø—É –∏ —Å–∞–º–æ –ø–æ—Ç—Ä–µ–±–Ω—É –∫–æ–ª–æ–Ω—É 'load' –ø–ª—É—Å –¥–∞—Ç—É–º:

    ```python
    train = energy.copy()[(energy.index >= train_start_dt) & (energy.index < test_start_dt)][['load']]
    test = energy.copy()[energy.index >= test_start_dt][['load']]

    print('Training data shape: ', train.shape)
    print('Test data shape: ', test.shape)
    ```

    –ú–æ–∂–µ—Ç–µ –≤–∏–¥–µ—Ç–∏ –æ–±–ª–∏–∫ –ø–æ–¥–∞—Ç–∞–∫–∞:

    ```output
    Training data shape:  (1416, 1)
    Test data shape:  (48, 1)
    ```

1. –°–∫–∞–ª–∏—Ä–∞—ò—Ç–µ –ø–æ–¥–∞—Ç–∫–µ —Ç–∞–∫–æ –¥–∞ –±—É–¥—É —É –æ–ø—Å–µ–≥—É (0, 1).

    ```python
    scaler = MinMaxScaler()
    train['load'] = scaler.fit_transform(train)
    train.head(10)
    ```

1. –í–∏–∑—É–µ–ª–∏–∑—É—ò—Ç–µ –æ—Ä–∏–≥–∏–Ω–∞–ª–Ω–µ –∏ —Å–∫–∞–ª–∏—Ä–∞–Ω–µ –ø–æ–¥–∞—Ç–∫–µ:

    ```python
    energy[(energy.index >= train_start_dt) & (energy.index < test_start_dt)][['load']].rename(columns={'load':'original load'}).plot.hist(bins=100, fontsize=12)
    train.rename(columns={'load':'scaled load'}).plot.hist(bins=100, fontsize=12)
    plt.show()
    ```

    ![–æ—Ä–∏–≥–∏–Ω–∞–ª–Ω–∏](../../../../7-TimeSeries/2-ARIMA/images/original.png)

    > –û—Ä–∏–≥–∏–Ω–∞–ª–Ω–∏ –ø–æ–¥–∞—Ü–∏

    ![—Å–∫–∞–ª–∏—Ä–∞–Ω–∏](../../../../7-TimeSeries/2-ARIMA/images/scaled.png)

    > –°–∫–∞–ª–∏—Ä–∞–Ω–∏ –ø–æ–¥–∞—Ü–∏

1. –°–∞–¥–∞ –∫–∞–¥–∞ —Å—Ç–µ –∫–∞–ª–∏–±—Ä–∏—Å–∞–ª–∏ —Å–∫–∞–ª–∏—Ä–∞–Ω–µ –ø–æ–¥–∞—Ç–∫–µ, –º–æ–∂–µ—Ç–µ —Å–∫–∞–ª–∏—Ä–∞—Ç–∏ –∏ —Ç–µ—Å—Ç –ø–æ–¥–∞—Ç–∫–µ:

    ```python
    test['load'] = scaler.transform(test)
    test.head()
    ```

### –ò–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—ò–∞ ARIMA –º–æ–¥–µ–ª–∞

–í—Ä–µ–º–µ —ò–µ –¥–∞ –∏–º–ø–ª–µ–º–µ–Ω—Ç–∏—Ä–∞—Ç–µ ARIMA –º–æ–¥–µ–ª! –°–∞–¥–∞ —õ–µ—Ç–µ –∫–æ—Ä–∏—Å—Ç–∏—Ç–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫—É `statsmodels` –∫–æ—ò—É —Å—Ç–µ —Ä–∞–Ω–∏—ò–µ –∏–Ω—Å—Ç–∞–ª–∏—Ä–∞–ª–∏.

–°–∞–¥–∞ —Ç—Ä–µ–±–∞ –¥–∞ —Å–ª–µ–¥–∏—Ç–µ –Ω–µ–∫–æ–ª–∏–∫–æ –∫–æ—Ä–∞–∫–∞:

   1. –î–µ—Ñ–∏–Ω–∏—à–∏—Ç–µ –º–æ–¥–µ–ª –ø–æ–∑–∏–≤–∞—ö–µ–º `SARIMAX()` –∏ –ø—Ä–æ—Å–ª–µ—í–∏–≤–∞—ö–µ–º –ø–∞—Ä–∞–º–µ—Ç–∞—Ä–∞ –º–æ–¥–µ–ª–∞: p, d, –∏ q –ø–∞—Ä–∞–º–µ—Ç–∞—Ä–∞, –∫–∞–æ –∏ P, D, –∏ Q –ø–∞—Ä–∞–º–µ—Ç–∞—Ä–∞.
   2. –ü—Ä–∏–ø—Ä–µ–º–∏—Ç–µ –º–æ–¥–µ–ª –∑–∞ —Å–∫—É–ø –ø–æ–¥–∞—Ç–∞–∫–∞ –∑–∞ –æ–±—É–∫—É –ø–æ–∑–∏–≤–∞—ö–µ–º —Ñ—É–Ω–∫—Ü–∏—ò–µ `fit()`.
   3. –ù–∞–ø—Ä–∞–≤–∏—Ç–µ –ø—Ä–µ–¥–≤–∏—í–∞—ö–∞ –ø–æ–∑–∏–≤–∞—ö–µ–º —Ñ—É–Ω–∫—Ü–∏—ò–µ `forecast()` –∏ —Å–ø–µ—Ü–∏—Ñ–∏—Ü–∏—Ä–∞—ö–µ–º –±—Ä–æ—ò–∞ –∫–æ—Ä–∞–∫–∞ (—Ö–æ—Ä–∏–∑–æ–Ω—Ç–∞) –∑–∞ –ø—Ä–µ–¥–≤–∏—í–∞—ö–µ.

> üéì –®—Ç–∞ –∑–Ω–∞—á–µ —Å–≤–∏ –æ–≤–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏? –£ ARIMA –º–æ–¥–µ–ª—É –ø–æ—Å—Ç–æ—ò–µ 3 –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –∫–æ—ò–∞ —Å–µ –∫–æ—Ä–∏—Å—Ç–µ –∑–∞ –º–æ–¥–µ–ª–∏—Ä–∞—ö–µ –≥–ª–∞–≤–Ω–∏—Ö –∞—Å–ø–µ–∫–∞—Ç–∞ –≤—Ä–µ–º–µ–Ω—Å–∫–µ —Å–µ—Ä–∏—ò–µ: —Å–µ–∑–æ–Ω–∞–ª–Ω–æ—Å—Ç, —Ç—Ä–µ–Ω–¥ –∏ —à—É–º. –û–≤–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ —Å—É:

`p`: –ø–∞—Ä–∞–º–µ—Ç–∞—Ä –ø–æ–≤–µ–∑–∞–Ω —Å–∞ –∞—É—Ç–æ—Ä–µ–≥—Ä–µ—Å–∏–≤–Ω–∏–º –∞—Å–ø–µ–∫—Ç–æ–º –º–æ–¥–µ–ª–∞, –∫–æ—ò–∏ —É–∫—ô—É—á—É—ò–µ *–ø—Ä–æ—à–ª–µ* –≤—Ä–µ–¥–Ω–æ—Å—Ç–∏.  
`d`: –ø–∞—Ä–∞–º–µ—Ç–∞—Ä –ø–æ–≤–µ–∑–∞–Ω —Å–∞ –∏–Ω—Ç–µ–≥—Ä–∏—Å–∞–Ω–∏–º –¥–µ–ª–æ–º –º–æ–¥–µ–ª–∞, –∫–æ—ò–∏ —É—Ç–∏—á–µ –Ω–∞ –∫–æ–ª–∏—á–∏–Ω—É *—Ä–∞–∑–ª–∏–∫–æ–≤–∞—ö–∞* (üéì —Å–µ—õ–∞—Ç–µ —Å–µ —Ä–∞–∑–ª–∏–∫–æ–≤–∞—ö–∞ üëÜ?) –∫–æ—ò–∞ —Å–µ –ø—Ä–∏–º–µ—ö—É—ò–µ –Ω–∞ –≤—Ä–µ–º–µ–Ω—Å–∫—É —Å–µ—Ä–∏—ò—É.  
`q`: –ø–∞—Ä–∞–º–µ—Ç–∞—Ä –ø–æ–≤–µ–∑–∞–Ω —Å–∞ –¥–µ–ª–æ–º –º–æ–¥–µ–ª–∞ –∫–æ—ò–∏ —Å–µ –æ–¥–Ω–æ—Å–∏ –Ω–∞ –ø–æ–∫—Ä–µ—Ç–Ω–∏ –ø—Ä–æ—Å–µ–∫.

> –ù–∞–ø–æ–º–µ–Ω–∞: –ê–∫–æ –≤–∞—à–∏ –ø–æ–¥–∞—Ü–∏ –∏–º–∞—ò—É —Å–µ–∑–æ–Ω—Å–∫–∏ –∞—Å–ø–µ–∫—Ç - —à—Ç–æ —ò–µ –æ–≤–¥–µ —Å–ª—É—á–∞—ò - –∫–æ—Ä–∏—Å—Ç–∏–º–æ —Å–µ–∑–æ–Ω—Å–∫–∏ ARIMA –º–æ–¥–µ–ª (SARIMA). –£ —Ç–æ–º —Å–ª—É—á–∞—ò—É —Ç—Ä–µ–±–∞ –¥–∞ –∫–æ—Ä–∏—Å—Ç–∏—Ç–µ —ò–æ—à —ò–µ–¥–∞–Ω —Å–µ—Ç –ø–∞—Ä–∞–º–µ—Ç–∞—Ä–∞: `P`, `D`, –∏ `Q` –∫–æ—ò–∏ –æ–ø–∏—Å—É—ò—É –∏—Å—Ç–µ –∞—Å–æ—Ü–∏—ò–∞—Ü–∏—ò–µ –∫–∞–æ `p`, `d`, –∏ `q`, –∞–ª–∏ —Å–µ –æ–¥–Ω–æ—Å–µ –Ω–∞ —Å–µ–∑–æ–Ω—Å–∫–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ –º–æ–¥–µ–ª–∞.

1. –ü–æ—á–Ω–∏—Ç–µ —Ç–∞–∫–æ —à—Ç–æ —õ–µ—Ç–µ –ø–æ–¥–µ—Å–∏—Ç–∏ –≤—Ä–µ–¥–Ω–æ—Å—Ç —Ö–æ—Ä–∏–∑–æ–Ω—Ç–∞. –ü—Ä–æ–±–∞—ò–º–æ 3 —Å–∞—Ç–∞:

    ```python
    # Specify the number of steps to forecast ahead
    HORIZON = 3
    print('Forecasting horizon:', HORIZON, 'hours')
    ```

    –û–¥–∞–±–∏—Ä –Ω–∞—ò–±–æ—ô–∏—Ö –≤—Ä–µ–¥–Ω–æ—Å—Ç–∏ –∑–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–µ ARIMA –º–æ–¥–µ–ª–∞ –º–æ–∂–µ –±–∏—Ç–∏ –∏–∑–∞–∑–æ–≤–∞–Ω —ò–µ—Ä —ò–µ –¥–æ–Ω–µ–∫–ª–µ —Å—É–±—ò–µ–∫—Ç–∏–≤–∞–Ω –∏ –≤—Ä–µ–º–µ–Ω—Å–∫–∏ –∑–∞—Ö—Ç–µ–≤–∞–Ω. –ú–æ–∂–µ—Ç–µ —Ä–∞–∑–º–æ—Ç—Ä–∏—Ç–∏ –∫–æ—Ä–∏—à—õ–µ—ö–µ —Ñ—É–Ω–∫—Ü–∏—ò–µ `auto_arima()` –∏–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫–µ [`pyramid`](https://alkaline-ml.com/pmdarima/0.9.0/modules/generated/pyramid.arima.auto_arima.html).

1. –ó–∞ —Å–∞–¥–∞ –ø—Ä–æ–±–∞—ò—Ç–µ –Ω–µ–∫–µ —Ä—É—á–Ω–µ –∏–∑–±–æ—Ä–µ –∫–∞–∫–æ –±–∏—Å—Ç–µ –ø—Ä–æ–Ω–∞—à–ª–∏ –¥–æ–±–∞—Ä –º–æ–¥–µ–ª.

    ```python
    order = (4, 1, 0)
    seasonal_order = (1, 1, 0, 24)

    model = SARIMAX(endog=train, order=order, seasonal_order=seasonal_order)
    results = model.fit()

    print(results.summary())
    ```

    –ò—Å–ø–∏—Å—É—ò–µ —Å–µ —Ç–∞–±–µ–ª–∞ —Ä–µ–∑—É–ª—Ç–∞—Ç–∞.

–ù–∞–ø—Ä–∞–≤–∏–ª–∏ —Å—Ç–µ —Å–≤–æ—ò –ø—Ä–≤–∏ –º–æ–¥–µ–ª! –°–∞–¥–∞ —Ç—Ä–µ–±–∞ –¥–∞ –ø—Ä–æ–Ω–∞—í–µ–º–æ –Ω–∞—á–∏–Ω –¥–∞ –≥–∞ –µ–≤–∞–ª—É–∏—Ä–∞–º–æ.

### –ï–≤–∞–ª—É–∞—Ü–∏—ò–∞ –≤–∞—à–µ–≥ –º–æ–¥–µ–ª–∞

–î–∞ –±–∏—Å—Ç–µ –µ–≤–∞–ª—É–∏—Ä–∞–ª–∏ —Å–≤–æ—ò –º–æ–¥–µ–ª, –º–æ–∂–µ—Ç–µ –∏–∑–≤—Ä—à–∏—Ç–∏ —Ç–∞–∫–æ–∑–≤–∞–Ω—É `walk forward` –≤–∞–ª–∏–¥–∞—Ü–∏—ò—É. –£ –ø—Ä–∞–∫—Å–∏, –º–æ–¥–µ–ª–∏ –≤—Ä–µ–º–µ–Ω—Å–∫–∏—Ö —Å–µ—Ä–∏—ò–∞ —Å–µ –ø–æ–Ω–æ–≤–æ –æ–±—É—á–∞–≤–∞—ò—É —Å–≤–∞–∫–∏ –ø—É—Ç –∫–∞–¥–∞ –Ω–æ–≤–∏ –ø–æ–¥–∞—Ü–∏ –ø–æ—Å—Ç–∞–Ω—É –¥–æ—Å—Ç—É–ø–Ω–∏. –û–≤–æ –æ–º–æ–≥—É—õ–∞–≤–∞ –º–æ–¥–µ–ª—É –¥–∞ –Ω–∞–ø—Ä–∞–≤–∏ –Ω–∞—ò–±–æ—ô—É –ø—Ä–æ–≥–Ω–æ–∑—É —É —Å–≤–∞–∫–æ–º –≤—Ä–µ–º–µ–Ω—Å–∫–æ–º –∫–æ—Ä–∞–∫—É.

–ü–æ—á–µ–≤—à–∏ –æ–¥ –ø–æ—á–µ—Ç–∫–∞ –≤—Ä–µ–º–µ–Ω—Å–∫–µ —Å–µ—Ä–∏—ò–µ, –∫–æ—Ä–∏—Å—Ç–µ—õ–∏ –æ–≤—É —Ç–µ—Ö–Ω–∏–∫—É, –æ–±—É—á–∏—Ç–µ –º–æ–¥–µ–ª –Ω–∞ —Å–∫—É–ø—É –ø–æ–¥–∞—Ç–∞–∫–∞ –∑–∞ –æ–±—É–∫—É. –ó–∞—Ç–∏–º –Ω–∞–ø—Ä–∞–≤–∏—Ç–µ –ø—Ä–µ–¥–≤–∏—í–∞—ö–µ –∑–∞ —Å–ª–µ–¥–µ—õ–∏ –≤—Ä–µ–º–µ–Ω—Å–∫–∏ –∫–æ—Ä–∞–∫. –ü—Ä–µ–¥–≤–∏—í–∞—ö–µ —Å–µ –µ–≤–∞–ª—É–∏—Ä–∞ —É –æ–¥–Ω–æ—Å—É –Ω–∞ –ø–æ–∑–Ω–∞—Ç—É –≤—Ä–µ–¥–Ω–æ—Å—Ç. –°–∫—É–ø –∑–∞ –æ–±—É–∫—É —Å–µ –∑–∞—Ç–∏–º –ø—Ä–æ—à–∏—Ä—É—ò–µ —Ç–∞–∫–æ –¥–∞ —É–∫—ô—É—á—É—ò–µ –ø–æ–∑–Ω–∞—Ç—É –≤—Ä–µ–¥–Ω–æ—Å—Ç –∏ –ø—Ä–æ—Ü–µ—Å —Å–µ –ø–æ–Ω–∞–≤—ô–∞.

> –ù–∞–ø–æ–º–µ–Ω–∞: –¢—Ä–µ–±–∞–ª–æ –±–∏ –¥–∞ –∑–∞–¥—Ä–∂–∏—Ç–µ –ø—Ä–æ–∑–æ—Ä —Å–∫—É–ø–∞ –∑–∞ –æ–±—É–∫—É —Ñ–∏–∫—Å–Ω–∏–º —Ä–∞–¥–∏ –µ—Ñ–∏–∫–∞—Å–Ω–∏—ò–µ –æ–±—É–∫–µ, —Ç–∞–∫–æ –¥–∞ —Å–≤–∞–∫–∏ –ø—É—Ç –∫–∞–¥–∞ –¥–æ–¥–∞—Ç–µ –Ω–æ–≤—É –æ–ø—Å–µ—Ä–≤–∞—Ü–∏—ò—É —É —Å–∫—É–ø –∑–∞ –æ–±—É–∫—É, —É–∫–ª–æ–Ω–∏—Ç–µ –æ–ø—Å–µ—Ä–≤–∞—Ü–∏—ò—É —Å–∞ –ø–æ—á–µ—Ç–∫–∞ —Å–∫—É–ø–∞.

–û–≤–∞—ò –ø—Ä–æ—Ü–µ—Å –ø—Ä—É–∂–∞ —Ä–æ–±—É—Å–Ω–∏—ò—É –ø—Ä–æ—Ü–µ–Ω—É –∫–∞–∫–æ —õ–µ –º–æ–¥–µ–ª —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Å–∞—Ç–∏ —É –ø—Ä–∞–∫—Å–∏. –ú–µ—í—É—Ç–∏–º, –¥–æ–ª–∞–∑–∏ —Å–∞ —Ä–∞—á—É–Ω–∞—Ä—Å–∫–∏–º —Ç—Ä–æ—à–∫–æ–≤–∏–º–∞ –∫—Ä–µ–∏—Ä–∞—ö–∞ —Ç–æ–ª–∏–∫–æ –º–æ–¥–µ–ª–∞. –û–≤–æ —ò–µ –ø—Ä–∏—Ö–≤–∞—Ç—ô–∏–≤–æ –∞–∫–æ —Å—É –ø–æ–¥–∞—Ü–∏ –º–∞–ª–∏ –∏–ª–∏ –∞–∫–æ —ò–µ –º–æ–¥–µ–ª —ò–µ–¥–Ω–æ—Å—Ç–∞–≤–∞–Ω, –∞–ª–∏ –º–æ–∂–µ –±–∏—Ç–∏ –ø—Ä–æ–±–ª–µ–º –Ω–∞ –≤–µ—õ–µ–º –æ–±–∏–º—É.

`Walk-forward` –≤–∞–ª–∏–¥–∞—Ü–∏—ò–∞ —ò–µ –∑–ª–∞—Ç–Ω–∏ —Å—Ç–∞–Ω–¥–∞—Ä–¥ –∑–∞ –µ–≤–∞–ª—É–∞—Ü–∏—ò—É –º–æ–¥–µ–ª–∞ –≤—Ä–µ–º–µ–Ω—Å–∫–∏—Ö —Å–µ—Ä–∏—ò–∞ –∏ –ø—Ä–µ–ø–æ—Ä—É—á—É—ò–µ —Å–µ –∑–∞ –≤–∞—à–µ –ø—Ä–æ—ò–µ–∫—Ç–µ.

1. –ü—Ä–≤–æ, –∫—Ä–µ–∏—Ä–∞—ò—Ç–µ —Ç–µ—Å—Ç–Ω—É —Ç–∞—á–∫—É –ø–æ–¥–∞—Ç–∞–∫–∞ –∑–∞ —Å–≤–∞–∫–∏ –∫–æ—Ä–∞–∫ –•–û–†–ò–ó–û–ù–¢–ê.

    ```python
    test_shifted = test.copy()

    for t in range(1, HORIZON+1):
        test_shifted['load+'+str(t)] = test_shifted['load'].shift(-t, freq='H')

    test_shifted = test_shifted.dropna(how='any')
    test_shifted.head(5)
    ```

    |            |          | load | load+1 | load+2 |
    | ---------- | -------- | ---- | ------ | ------ |
    | 2014-12-30 | 00:00:00 | 0.33 | 0.29   | 0.27   |
    | 2014-12-30 | 01:00:00 | 0.29 | 0.27   | 0.27   |
    | 2014-12-30 | 02:00:00 | 0.27 | 0.27   | 0.30   |
    | 2014-12-30 | 03:00:00 | 0.27 | 0.30   | 0.41   |
    | 2014-12-30 | 04:00:00 | 0.30 | 0.41   | 0.57   |

    –ü–æ–¥–∞—Ü–∏ —Å–µ –ø–æ–º–µ—Ä–∞—ò—É —Ö–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª–Ω–æ —É —Å–∫–ª–∞–¥—É —Å–∞ —Ç–∞—á–∫–æ–º —Ö–æ—Ä–∏–∑–æ–Ω—Ç–∞.

1. –ù–∞–ø—Ä–∞–≤–∏—Ç–µ –ø—Ä–µ–¥–≤–∏—í–∞—ö–∞ –∑–∞ —Ç–µ—Å—Ç –ø–æ–¥–∞—Ç–∫–µ –∫–æ—Ä–∏—Å—Ç–µ—õ–∏ –æ–≤–∞—ò –ø—Ä–∏—Å—Ç—É–ø –∫–ª–∏–∑–Ω–æ–≥ –ø—Ä–æ–∑–æ—Ä–∞ —É –ø–µ—Ç—ô–∏ –≤–µ–ª–∏—á–∏–Ω–µ —Å–∫—É–ø–∞ —Ç–µ—Å—Ç –ø–æ–¥–∞—Ç–∞–∫–∞:

    ```python
    %%time
    training_window = 720 # dedicate 30 days (720 hours) for training

    train_ts = train['load']
    test_ts = test_shifted

    history = [x for x in train_ts]
    history = history[(-training_window):]

    predictions = list()

    order = (2, 1, 0)
    seasonal_order = (1, 1, 0, 24)

    for t in range(test_ts.shape[0]):
        model = SARIMAX(endog=history, order=order, seasonal_order=seasonal_order)
        model_fit = model.fit()
        yhat = model_fit.forecast(steps = HORIZON)
        predictions.append(yhat)
        obs = list(test_ts.iloc[t])
        # move the training window
        history.append(obs[0])
        history.pop(0)
        print(test_ts.index[t])
        print(t+1, ': predicted =', yhat, 'expected =', obs)
    ```

    –ú–æ–∂–µ—Ç–µ –ø—Ä–∞—Ç–∏—Ç–∏ –ø—Ä–æ—Ü–µ—Å –æ–±—É–∫–µ:

    ```output
    2014-12-30 00:00:00
    1 : predicted = [0.32 0.29 0.28] expected = [0.32945389435989236, 0.2900626678603402, 0.2739480752014323]

    2014-12-30 01:00:00
    2 : predicted = [0.3  0.29 0.3 ] expected = [0.2900626678603402, 0.2739480752014323, 0.26812891674127126]

    2014-12-30 02:00:00
    3 : predicted = [0.27 0.28 0.32] expected = [0.2739480752014323, 0.26812891674127126, 0.3025962399283795]
    ```

1. –£–ø–æ—Ä–µ–¥–∏—Ç–µ –ø—Ä–µ–¥–≤–∏—í–∞—ö–∞ —Å–∞ —Å—Ç–≤–∞—Ä–Ω–∏–º –æ–ø—Ç–µ—Ä–µ—õ–µ—ö–µ–º:

    ```python
    eval_df = pd.DataFrame(predictions, columns=['t+'+str(t) for t in range(1, HORIZON+1)])
    eval_df['timestamp'] = test.index[0:len(test.index)-HORIZON+1]
    eval_df = pd.melt(eval_df, id_vars='timestamp', value_name='prediction', var_name='h')
    eval_df['actual'] = np.array(np.transpose(test_ts)).ravel()
    eval_df[['prediction', 'actual']] = scaler.inverse_transform(eval_df[['prediction', 'actual']])
    eval_df.head()
    ```

    –ò–∑–ª–∞–∑
    |     |            | timestamp | h   | prediction | actual   |
    | --- | ---------- | --------- | --- | ---------- | -------- |
    | 0   | 2014-12-30 | 00:00:00  | t+1 | 3,008.74   | 3,023.00 |
    | 1   | 2014-12-30 | 01:00:00  | t+1 | 2,955.53   | 2,935.00 |
    | 2   | 2014-12-30 | 02:00:00  | t+1 | 2,900.17   | 2,899.00 |
    | 3   | 2014-12-30 | 03:00:00  | t+1 | 2,917.69   | 2,886.00 |
    | 4   | 2014-12-30 | 04:00:00  | t+1 | 2,946.99   | 2,963.00 |

    –ü–æ—Å–º–∞—Ç—Ä–∞—ò—Ç–µ –ø—Ä–µ–¥–≤–∏—í–∞—ö–∞ –ø–æ–¥–∞—Ç–∞–∫–∞ –Ω–∞ —Å–∞—Ç–Ω–æ–º –Ω–∏–≤–æ—É —É –ø–æ—Ä–µ—í–µ—ö—É —Å–∞ —Å—Ç–≤–∞—Ä–Ω–∏–º –æ–ø—Ç–µ—Ä–µ—õ–µ—ö–µ–º. –ö–æ–ª–∏–∫–æ —ò–µ —Ç–∞—á–Ω–æ?

### –ü—Ä–æ–≤–µ—Ä–∞ —Ç–∞—á–Ω–æ—Å—Ç–∏ –º–æ–¥–µ–ª–∞

–ü—Ä–æ–≤–µ—Ä–∏—Ç–µ —Ç–∞—á–Ω–æ—Å—Ç –≤–∞—à–µ–≥ –º–æ–¥–µ–ª–∞ —Ç–µ—Å—Ç–∏—Ä–∞—ö–µ–º —ö–µ–≥–æ–≤–µ —Å—Ä–µ–¥—ö–µ –∞–ø—Å–æ–ª—É—Ç–Ω–µ –ø—Ä–æ—Ü–µ–Ω—Ç—É–∞–ª–Ω–µ –≥—Ä–µ—à–∫–µ (MAPE) –∑–∞ —Å–≤–∞ –ø—Ä–µ–¥–≤–∏—í–∞—ö–∞.
> **üßÆ –ü–æ–∫–∞–∂–∏—Ç–µ –º–∏ –º–∞—Ç–µ–º–∞—Ç–∏–∫—É**
>
> ![MAPE](../../../../7-TimeSeries/2-ARIMA/images/mape.png)
>
> [MAPE](https://www.linkedin.com/pulse/what-mape-mad-msd-time-series-allameh-statistics/) —Å–µ –∫–æ—Ä–∏—Å—Ç–∏ –∑–∞ –ø—Ä–∏–∫–∞–∑–∏–≤–∞—ö–µ —Ç–∞—á–Ω–æ—Å—Ç–∏ –ø—Ä–µ–¥–≤–∏—í–∞—ö–∞ –∫–∞–æ –æ–¥–Ω–æ—Å–∞ –¥–µ—Ñ–∏–Ω–∏—Å–∞–Ω–æ–≥ –≥–æ—Ä—ö–æ–º —Ñ–æ—Ä–º—É–ª–æ–º. –†–∞–∑–ª–∏–∫–∞ –∏–∑–º–µ—í—É —Å—Ç–≤–∞—Ä–Ω–µ –∏ –ø—Ä–µ–¥–≤–∏—í–µ–Ω–µ –≤—Ä–µ–¥–Ω–æ—Å—Ç–∏ –¥–µ–ª–∏ —Å–µ —Å–∞ —Å—Ç–≤–∞—Ä–Ω–æ–º –≤—Ä–µ–¥–Ω–æ—à—õ—É. "–ê–ø—Å–æ–ª—É—Ç–Ω–∞ –≤—Ä–µ–¥–Ω–æ—Å—Ç —É –æ–≤–æ–º –∏–∑—Ä–∞—á—É–Ω–∞–≤–∞—ö—É —Å–µ —Å–∞–±–∏—Ä–∞ –∑–∞ —Å–≤–∞–∫—É –ø—Ä–µ–¥–≤–∏—í–µ–Ω—É —Ç–∞—á–∫—É —É –≤—Ä–µ–º–µ–Ω—É –∏ –¥–µ–ª–∏ —Å–∞ –±—Ä–æ—ò–µ–º –ø—Ä–∏–ª–∞–≥–æ—í–µ–Ω–∏—Ö —Ç–∞—á–∞–∫–∞ n." [–≤–∏–∫–∏–ø–µ–¥–∏—ò–∞](https://wikipedia.org/wiki/Mean_absolute_percentage_error)
1. –ò–∑—Ä–∞–∑–∏—Ç–µ —ò–µ–¥–Ω–∞—á–∏–Ω—É —É –∫–æ–¥—É:

    ```python
    if(HORIZON > 1):
        eval_df['APE'] = (eval_df['prediction'] - eval_df['actual']).abs() / eval_df['actual']
        print(eval_df.groupby('h')['APE'].mean())
    ```

1. –ò–∑—Ä–∞—á—É–Ω–∞—ò—Ç–µ MAPE –∑–∞ —ò–µ–¥–∞–Ω –∫–æ—Ä–∞–∫:

    ```python
    print('One step forecast MAPE: ', (mape(eval_df[eval_df['h'] == 't+1']['prediction'], eval_df[eval_df['h'] == 't+1']['actual']))*100, '%')
    ```

    MAPE –∑–∞ –ø—Ä–æ–≥–Ω–æ–∑—É —ò–µ–¥–Ω–æ–≥ –∫–æ—Ä–∞–∫–∞:  0.5570581332313952 %

1. –ò—Å–ø–∏—à–∏—Ç–µ MAPE –∑–∞ –ø—Ä–æ–≥–Ω–æ–∑—É –≤–∏—à–µ –∫–æ—Ä–∞–∫–∞:

    ```python
    print('Multi-step forecast MAPE: ', mape(eval_df['prediction'], eval_df['actual'])*100, '%')
    ```

    ```output
    Multi-step forecast MAPE:  1.1460048657704118 %
    ```

    –î–æ–±–∞—Ä –Ω–∏–∑–∞–∫ –±—Ä–æ—ò —ò–µ –Ω–∞—ò–±–æ—ô–∏: —É–∑–º–∏—Ç–µ —É –æ–±–∑–∏—Ä –¥–∞ —ò–µ –ø—Ä–æ–≥–Ω–æ–∑–∞ —Å–∞ MAPE –æ–¥ 10 –ø–æ–≥—Ä–µ—à–Ω–∞ –∑–∞ 10%.

1. –ê–ª–∏ –∫–∞–æ –∏ —É–≤–µ–∫, –ª–∞–∫—à–µ —ò–µ –≤–∏–¥–µ—Ç–∏ –æ–≤–∞–∫–≤—É –≤—Ä—Å—Ç—É –º–µ—Ä–µ—ö–∞ —Ç–∞—á–Ω–æ—Å—Ç–∏ –≤–∏–∑—É–µ–ª–Ω–æ, –ø–∞ —Ö–∞—ò–¥–µ –¥–∞ —Ç–æ –ø—Ä–∏–∫–∞–∂–µ–º–æ –≥—Ä–∞—Ñ–∏—á–∫–∏:

    ```python
     if(HORIZON == 1):
        ## Plotting single step forecast
        eval_df.plot(x='timestamp', y=['actual', 'prediction'], style=['r', 'b'], figsize=(15, 8))

    else:
        ## Plotting multi step forecast
        plot_df = eval_df[(eval_df.h=='t+1')][['timestamp', 'actual']]
        for t in range(1, HORIZON+1):
            plot_df['t+'+str(t)] = eval_df[(eval_df.h=='t+'+str(t))]['prediction'].values

        fig = plt.figure(figsize=(15, 8))
        ax = plt.plot(plot_df['timestamp'], plot_df['actual'], color='red', linewidth=4.0)
        ax = fig.add_subplot(111)
        for t in range(1, HORIZON+1):
            x = plot_df['timestamp'][(t-1):]
            y = plot_df['t+'+str(t)][0:len(x)]
            ax.plot(x, y, color='blue', linewidth=4*math.pow(.9,t), alpha=math.pow(0.8,t))

        ax.legend(loc='best')

    plt.xlabel('timestamp', fontsize=12)
    plt.ylabel('load', fontsize=12)
    plt.show()
    ```

    ![–º–æ–¥–µ–ª –≤—Ä–µ–º–µ–Ω—Å–∫–µ —Å–µ—Ä–∏—ò–µ](../../../../7-TimeSeries/2-ARIMA/images/accuracy.png)

üèÜ –í–µ–æ–º–∞ –ª–µ–ø –≥—Ä–∞—Ñ–∏–∫–æ–Ω, –∫–æ—ò–∏ –ø—Ä–∏–∫–∞–∑—É—ò–µ –º–æ–¥–µ–ª —Å–∞ –¥–æ–±—Ä–æ–º —Ç–∞—á–Ω–æ—à—õ—É. –û–¥–ª–∏—á–∞–Ω –ø–æ—Å–∞–æ!

---

## üöÄ–ò–∑–∞–∑–æ–≤

–ò—Å—Ç—Ä–∞–∂–∏—Ç–µ –Ω–∞—á–∏–Ω–µ –∑–∞ —Ç–µ—Å—Ç–∏—Ä–∞—ö–µ —Ç–∞—á–Ω–æ—Å—Ç–∏ –º–æ–¥–µ–ª–∞ –≤—Ä–µ–º–µ–Ω—Å–∫–µ —Å–µ—Ä–∏—ò–µ. –£ –æ–≤–æ—ò –ª–µ–∫—Ü–∏—ò–∏ —Å–º–æ —Å–µ –¥–æ—Ç–∞–∫–ª–∏ MAPE-–∞, –∞–ª–∏ –¥–∞ –ª–∏ –ø–æ—Å—Ç–æ—ò–µ –¥—Ä—É–≥–∏ –º–µ—Ç–æ–¥–∏ –∫–æ—ò–µ –±–∏—Å—Ç–µ –º–æ–≥–ª–∏ –∫–æ—Ä–∏—Å—Ç–∏—Ç–∏? –ò—Å—Ç—Ä–∞–∂–∏—Ç–µ –∏—Ö –∏ –¥–æ–¥–∞—ò—Ç–µ –±–µ–ª–µ—à–∫–µ. –ö–æ—Ä–∏—Å–Ω–∏ –¥–æ–∫—É–º–µ–Ω—Ç –º–æ–∂–µ—Ç–µ –ø—Ä–æ–Ω–∞—õ–∏ [–æ–≤–¥–µ](https://otexts.com/fpp2/accuracy.html)

## [–ö–≤–∏–∑ –Ω–∞–∫–æ–Ω –ø—Ä–µ–¥–∞–≤–∞—ö–∞](https://ff-quizzes.netlify.app/en/ml/)

## –ü—Ä–µ–≥–ª–µ–¥ –∏ —Å–∞–º–æ—Å—Ç–∞–ª–Ω–æ —É—á–µ—ö–µ

–û–≤–∞ –ª–µ–∫—Ü–∏—ò–∞ –ø–æ–∫—Ä–∏–≤–∞ —Å–∞–º–æ –æ—Å–Ω–æ–≤–µ –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–∞—ö–∞ –≤—Ä–µ–º–µ–Ω—Å–∫–∏—Ö —Å–µ—Ä–∏—ò–∞ —Å–∞ ARIMA –º–æ–¥–µ–ª–æ–º. –û–¥–≤–æ—ò–∏—Ç–µ –≤—Ä–µ–º–µ –¥–∞ –ø—Ä–æ–¥—É–±–∏—Ç–µ —Å–≤–æ—ò–µ –∑–Ω–∞—ö–µ –∏—Å—Ç—Ä–∞–∂—É—ò—É—õ–∏ [–æ–≤–∞—ò —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—ò—É–º](https://microsoft.github.io/forecasting/) –∏ —ö–µ–≥–æ–≤–µ —Ä–∞–∑–ª–∏—á–∏—Ç–µ —Ç–∏–ø–æ–≤–µ –º–æ–¥–µ–ª–∞ –∫–∞–∫–æ –±–∏—Å—Ç–µ –Ω–∞—É—á–∏–ª–∏ –¥—Ä—É–≥–µ –Ω–∞—á–∏–Ω–µ –∑–∞ –∫—Ä–µ–∏—Ä–∞—ö–µ –º–æ–¥–µ–ª–∞ –≤—Ä–µ–º–µ–Ω—Å–∫–∏—Ö —Å–µ—Ä–∏—ò–∞.

## –ó–∞–¥–∞—Ç–∞–∫

[–ù–æ–≤–∏ ARIMA –º–æ–¥–µ–ª](assignment.md)

---

**–û–¥—Ä–∏—Ü–∞—ö–µ –æ–¥ –æ–¥–≥–æ–≤–æ—Ä–Ω–æ—Å—Ç–∏**:  
–û–≤–∞—ò –¥–æ–∫—É–º–µ–Ω—Ç —ò–µ –ø—Ä–µ–≤–µ–¥–µ–Ω –∫–æ—Ä–∏—à—õ–µ—ö–µ–º —É—Å–ª—É–≥–µ –∑–∞ –ø—Ä–µ–≤–æ—í–µ—ö–µ –ø–æ–º–æ—õ—É –≤–µ—à—Ç–∞—á–∫–µ –∏–Ω—Ç–µ–ª–∏–≥–µ–Ω—Ü–∏—ò–µ [Co-op Translator](https://github.com/Azure/co-op-translator). –ò–∞–∫–æ —Ç–µ–∂–∏–º–æ —Ç–∞—á–Ω–æ—Å—Ç–∏, –º–æ–ª–∏–º–æ –≤–∞—Å –¥–∞ –∏–º–∞—Ç–µ —É –≤–∏–¥—É –¥–∞ –∞—É—Ç–æ–º–∞—Ç—Å–∫–∏ –ø—Ä–µ–≤–æ–¥–∏ –º–æ–≥—É —Å–∞–¥—Ä–∂–∞—Ç–∏ –≥—Ä–µ—à–∫–µ –∏–ª–∏ –Ω–µ—Ç–∞—á–Ω–æ—Å—Ç–∏. –û—Ä–∏–≥–∏–Ω–∞–ª–Ω–∏ –¥–æ–∫—É–º–µ–Ω—Ç –Ω–∞ –∏–∑–≤–æ—Ä–Ω–æ–º —ò–µ–∑–∏–∫—É —Ç—Ä–µ–±–∞ —Å–º–∞—Ç—Ä–∞—Ç–∏ –∞—É—Ç–æ—Ä–∏—Ç–∞—Ç–∏–≤–Ω–∏–º –∏–∑–≤–æ—Ä–æ–º. –ó–∞ –∫—Ä–∏—Ç–∏—á–Ω–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—ò–µ –ø—Ä–µ–ø–æ—Ä—É—á—É—ò–µ —Å–µ –ø—Ä–æ—Ñ–µ—Å–∏–æ–Ω–∞–ª–Ω–∏ –ø—Ä–µ–≤–æ–¥ –æ–¥ —Å—Ç—Ä–∞–Ω–µ —ô—É–¥–∏. –ù–µ —Å–Ω–æ—Å–∏–º–æ –æ–¥–≥–æ–≤–æ—Ä–Ω–æ—Å—Ç –∑–∞ –±–∏–ª–æ –∫–∞–∫–≤–∞ –Ω–µ—Å–ø–æ—Ä–∞–∑—É–º–µ–≤–∞—ö–∞ –∏–ª–∏ –ø–æ–≥—Ä–µ—à–Ω–∞ —Ç—É–º–∞—á–µ—ö–∞ –∫–æ—ò–∞ –º–æ–≥—É –ø—Ä–æ–∏–∑–∞—õ–∏ –∏–∑ –∫–æ—Ä–∏—à—õ–µ—ö–∞ –æ–≤–æ–≥ –ø—Ä–µ–≤–æ–¥–∞.