<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "917dbf890db71a322f306050cb284749",
  "translation_date": "2025-09-06T06:07:48+00:00",
  "source_file": "7-TimeSeries/2-ARIMA/README.md",
  "language_code": "mr"
}
-->
# ARIMA рд╡рд╛рдкрд░реВрди рдЯрд╛рдЗрдо рд╕рд┐рд░реАрдЬ рдЕрдВрджрд╛рдЬ

рдорд╛рдЧреАрд▓ рдзрдбреНрдпрд╛рдд, рддреБрдореНрд╣реА рдЯрд╛рдЗрдо рд╕рд┐рд░реАрдЬ рдЕрдВрджрд╛рдЬрд╛рдмрджреНрджрд▓ рдереЛрдбрдВ рд╢рд┐рдХрд▓рд╛ рдЖрдгрд┐ рдПрдХрд╛ рдХрд╛рд▓рд╛рд╡рдзреАрдд рд╡рд┐рджреНрдпреБрдд рд▓реЛрдбрдЪреНрдпрд╛ рдЪрдв-рдЙрддрд╛рд░рд╛рдВрдЪреЗ рдбреЗрдЯрд╛ рд╕реЗрдЯ рд▓реЛрдб рдХреЗрд▓реЗ.

[![ARIMA рдЪреА рдУрд│рдЦ](https://img.youtube.com/vi/IUSk-YDau10/0.jpg)](https://youtu.be/IUSk-YDau10 "ARIMA рдЪреА рдУрд│рдЦ")

> ЁЯОе рд╡рд░реАрд▓ рдкреНрд░рддрд┐рдореЗрд╡рд░ рдХреНрд▓рд┐рдХ рдХрд░рд╛: ARIMA рдореЙрдбреЗрд▓реНрд╕рдЪреА рд╕рдВрдХреНрд╖рд┐рдкреНрдд рдУрд│рдЦ. рдЙрджрд╛рд╣рд░рдг R рдордзреНрдпреЗ рдХреЗрд▓реЗ рдЖрд╣реЗ, рдкрд░рдВрддреБ рд╕рдВрдХрд▓реНрдкрдирд╛ рд╕рд╛рд░реНрд╡рддреНрд░рд┐рдХ рдЖрд╣реЗрдд.

## [рдкреВрд░реНрд╡-рд╡реНрдпрд╛рдЦреНрдпрд╛рди рдХреНрд╡рд┐рдЭ](https://ff-quizzes.netlify.app/en/ml/)

## рдкрд░рд┐рдЪрдп

рдпрд╛ рдзрдбреНрдпрд╛рдд, рддреБрдореНрд╣реА [ARIMA: *A*uto*R*egressive *I*ntegrated *M*oving *A*verage](https://wikipedia.org/wiki/Autoregressive_integrated_moving_average) рд╡рд╛рдкрд░реВрди рдореЙрдбреЗрд▓реНрд╕ рддрдпрд╛рд░ рдХрд░рдгреНрдпрд╛рдЪрд╛ рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдорд╛рд░реНрдЧ рд╢реЛрдзрд╛рд▓. ARIMA рдореЙрдбреЗрд▓реНрд╕ рд╡рд┐рд╢реЗрд╖рддрдГ [non-stationarity](https://wikipedia.org/wiki/Stationary_process) рджрд░реНрд╢рд╡рд┐рдгрд╛рд▒реНрдпрд╛ рдбреЗрдЯрд╛рд╕рд╛рдареА рдЙрдкрдпреБрдХреНрдд рдЖрд╣реЗрдд.

## рд╕рд╛рдорд╛рдиреНрдп рд╕рдВрдХрд▓реНрдкрдирд╛

ARIMA рд╡рд╛рдкрд░рдгреНрдпрд╛рд╕рд╛рдареА, рддреБрдореНрд╣рд╛рд▓рд╛ рдХрд╛рд╣реА рд╕рдВрдХрд▓реНрдкрдирд╛ рдорд╛рд╣рд┐рдд рдЕрд╕рдгреЗ рдЖрд╡рд╢реНрдпрдХ рдЖрд╣реЗ:

- ЁЯОУ **рд╕реНрдЯреЗрд╢рдиреЕрд░рд┐рдЯреА**. рд╕рд╛рдВрдЦреНрдпрд┐рдХреА рд╕рдВрджрд░реНрднрд╛рдд, рд╕реНрдЯреЗрд╢рдиреЕрд░рд┐рдЯреА рдореНрд╣рдгрдЬреЗ рдбреЗрдЯрд╛ рдЬреНрдпрд╛рдЪреЗ рд╡рд┐рддрд░рдг рд╡реЗрд│реЗрдд рдмрджрд▓рд▓реНрдпрд╛рд╡рд░ рдмрджрд▓рдд рдирд╛рд╣реА. рдиреЙрди-рд╕реНрдЯреЗрд╢рдирд░реА рдбреЗрдЯрд╛, рдордЧ, рдЯреНрд░реЗрдВрдбрдореБрд│реЗ рдЪрдв-рдЙрддрд╛рд░ рджрд░реНрд╢рд╡рддреЛ рдЬреНрдпрд╛рдЪреЗ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░рдгреНрдпрд╛рд╕рд╛рдареА рддреНрдпрд╛рдЪреЗ рд░реВрдкрд╛рдВрддрд░ рдХрд░рдгреЗ рдЖрд╡рд╢реНрдпрдХ рдЖрд╣реЗ. рдЙрджрд╛рд╣рд░рдгрд╛рд░реНрде, рд╣рдВрдЧрд╛рдореА рдмрджрд▓ рдбреЗрдЯрд╛ рдордзреНрдпреЗ рдЪрдв-рдЙрддрд╛рд░ рдЖрдгреВ рд╢рдХрддреЛ рдЖрдгрд┐ 'рд╣рдВрдЧрд╛рдореА-рдбрд┐рдлрд░рдиреНрд╕рд┐рдВрдЧ' рдкреНрд░рдХреНрд░рд┐рдпреЗрджреНрд╡рд╛рд░реЗ рдХрд╛рдвреВрди рдЯрд╛рдХрд▓рд╛ рдЬрд╛рдК рд╢рдХрддреЛ.

- ЁЯОУ **[рдбрд┐рдлрд░рдиреНрд╕рд┐рдВрдЧ](https://wikipedia.org/wiki/Autoregressive_integrated_moving_average#Differencing)**. рд╕рд╛рдВрдЦреНрдпрд┐рдХреА рд╕рдВрджрд░реНрднрд╛рдд, рдбрд┐рдлрд░рдиреНрд╕рд┐рдВрдЧ рдореНрд╣рдгрдЬреЗ рдиреЙрди-рд╕реНрдЯреЗрд╢рдирд░реА рдбреЗрдЯрд╛ рд░реВрдкрд╛рдВрддрд░рд┐рдд рдХрд░реВрди рддреНрдпрд╛рдЪрд╛ рдиреЙрди-рдХреЙрдиреНрд╕реНрдЯрдВрдЯ рдЯреНрд░реЗрдВрдб рдХрд╛рдвреВрди рдЯрд╛рдХрдгреЗ. "рдбрд┐рдлрд░рдиреНрд╕рд┐рдВрдЧ рдЯрд╛рдЗрдо рд╕рд┐рд░реАрдЬрдЪреНрдпрд╛ рдкрд╛рддрд│реАрддреАрд▓ рдмрджрд▓ рдХрд╛рдвреВрди рдЯрд╛рдХрддреЗ, рдЯреНрд░реЗрдВрдб рдЖрдгрд┐ рд╣рдВрдЧрд╛рдореА рдмрджрд▓ рдХрд╛рдвреВрди рдЯрд╛рдХрддреЗ рдЖрдгрд┐ рдкрд░рд┐рдгрд╛рдореА рдЯрд╛рдЗрдо рд╕рд┐рд░реАрдЬрдЪрд╛ рд╕рд░рд╛рд╕рд░реА рд╕реНрдерд┐рд░ рдХрд░рддреЗ." [Shixiong et al рдпрд╛рдВрдЪреЗ рдкреЗрдкрд░](https://arxiv.org/abs/1904.07632)

## рдЯрд╛рдЗрдо рд╕рд┐рд░реАрдЬрдЪреНрдпрд╛ рд╕рдВрджрд░реНрднрд╛рдд ARIMA

ARIMA рдЪреНрдпрд╛ рднрд╛рдЧрд╛рдВрдЪреЗ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░реВрди рдЖрдкрдг рдХрд╕реЗ рдЯрд╛рдЗрдо рд╕рд┐рд░реАрдЬ рдореЙрдбреЗрд▓ рдХрд░реВ рд╢рдХрддреЛ рдЖрдгрд┐ рддреНрдпрд╛рд╡рд░ рдЕрдВрджрд╛рдЬ рдХрд╕рд╛ рд▓рд╛рд╡реВ рд╢рдХрддреЛ рд╣реЗ рд╕рдордЬреВрди рдШреЗрдКрдпрд╛.

- **AR - рдСрдЯреЛрд░реЗрдЧреНрд░реЗрд╕рд┐рд╡реНрд╣рд╕рд╛рдареА**. рдСрдЯреЛрд░реЗрдЧреНрд░реЗрд╕рд┐рд╡реНрд╣ рдореЙрдбреЗрд▓реНрд╕, рдирд╛рд╡рд╛рдкреНрд░рдорд╛рдгреЗрдЪ, рддреБрдордЪреНрдпрд╛ рдбреЗрдЯрд╛рдордзреАрд▓ рдорд╛рдЧреАрд▓ рдореВрд▓реНрдпрд╛рдВрдЪреЗ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░рдгреНрдпрд╛рд╕рд╛рдареА 'рдорд╛рдЧреЗ' рдкрд╛рд╣рддрд╛рдд рдЖрдгрд┐ рддреНрдпрд╛рдВрдЪреНрдпрд╛рдмрджреНрджрд▓ рдЧреГрд╣рд┐рддрдХреЗ рддрдпрд╛рд░ рдХрд░рддрд╛рдд. рдпрд╛ рдорд╛рдЧреАрд▓ рдореВрд▓реНрдпрд╛рдВрдирд╛ 'рд▓реЕрдЧреНрд╕' рдореНрд╣рдгрддрд╛рдд. рдЙрджрд╛рд╣рд░рдгрд╛рд░реНрде, рдорд╛рд╕рд┐рдХ рдкреЗрдиреНрд╕рд┐рд▓ рд╡рд┐рдХреНрд░реА рджрд░реНрд╢рд╡рд┐рдгрд╛рд░рд╛ рдбреЗрдЯрд╛. рдкреНрд░рддреНрдпреЗрдХ рдорд╣рд┐рдиреНрдпрд╛рдЪреА рд╡рд┐рдХреНрд░реА рдПрдХ 'рдЗрд╡реНрд╣реЙрд▓реНрд╡рд┐рдВрдЧ рд╡реНрд╣реЗрд░рд┐рдПрдмрд▓' рдорд╛рдирд▓реА рдЬрд╛рдИрд▓. рд╣реЗ рдореЙрдбреЗрд▓ рдЕрд╕реЗ рддрдпрд╛рд░ рдХреЗрд▓реЗ рдЬрд╛рддреЗ рдХреА "рдЗрд╡реНрд╣реЙрд▓реНрд╡рд┐рдВрдЧ рд╡реНрд╣реЗрд░рд┐рдПрдмрд▓ рдСрдл рдЗрдВрдЯрд░реЗрд╕реНрдЯ рддреНрдпрд╛рдЪреНрдпрд╛ рд╕реНрд╡рддрдГрдЪреНрдпрд╛ рд▓реЕрдЧреНрдб (рдореНрд╣рдгрдЬреЗ, рдкреВрд░реНрд╡реАрдЪреНрдпрд╛) рдореВрд▓реНрдпрд╛рдВрд╡рд░ рд░рд┐рдЧреНрд░реЗрд╕ рдХреЗрд▓реЗ рдЬрд╛рддреЗ." [wikipedia](https://wikipedia.org/wiki/Autoregressive_integrated_moving_average)

- **I - рдЗрдВрдЯрд┐рдЧреНрд░реЗрдЯреЗрдбрд╕рд╛рдареА**. 'ARMA' рдореЙрдбреЗрд▓реНрд╕рд╕рд╛рд░рдЦреЗрдЪ, ARIMA рдордзреАрд▓ 'I' рддреНрдпрд╛рдЪреНрдпрд╛ *[рдЗрдВрдЯрд┐рдЧреНрд░реЗрдЯреЗрдб](https://wikipedia.org/wiki/Order_of_integration)* рдкреИрд▓реВрд▓рд╛ рд╕рдВрджрд░реНрднрд┐рдд рдХрд░рддреЗ. рдиреЙрди-рд╕реНрдЯреЗрд╢рдиреЕрд░рд┐рдЯреА рдХрд╛рдвреВрди рдЯрд╛рдХрдгреНрдпрд╛рд╕рд╛рдареА рдбрд┐рдлрд░рдиреНрд╕рд┐рдВрдЧ рд╕реНрдЯреЗрдкреНрд╕ рд▓рд╛рдЧреВ рдХреЗрд▓реНрдпрд╛рд╡рд░ рдбреЗрдЯрд╛ 'рдЗрдВрдЯрд┐рдЧреНрд░реЗрдЯреЗрдб' рд╣реЛрддреЛ.

- **MA - рдореВрд╡реНрд╣рд┐рдВрдЧ рдЕреЕрд╡реНрд╣рд░реЗрдЬрд╕рд╛рдареА**. рдпрд╛ рдореЙрдбреЗрд▓рдЪрд╛ [рдореВрд╡реНрд╣рд┐рдВрдЧ-рдЕреЕрд╡реНрд╣рд░реЗрдЬ](https://wikipedia.org/wiki/Moving-average_model) рдкреИрд▓реВ рд╕рдзреНрдпрд╛рдЪреНрдпрд╛ рдЖрдгрд┐ рдорд╛рдЧреАрд▓ рд▓реЕрдЧреНрд╕рдЪреНрдпрд╛ рдореВрд▓реНрдпрд╛рдВрдЪреЗ рдирд┐рд░реАрдХреНрд╖рдг рдХрд░реВрди рдард░рд╡рд▓реЗрд▓реНрдпрд╛ рдЖрдЙрдЯрдкреБрдЯ рд╡реНрд╣реЗрд░рд┐рдПрдмрд▓рд▓рд╛ рд╕рдВрджрд░реНрднрд┐рдд рдХрд░рддреЛ.

рдереЛрдбрдХреНрдпрд╛рдд: ARIMA рдЯрд╛рдЗрдо рд╕рд┐рд░реАрдЬ рдбреЗрдЯрд╛рдЪреНрдпрд╛ рд╡рд┐рд╢реЗрд╖ рд╕реНрд╡рд░реВрдкрд╛рд╢реА рд╢рдХреНрдп рддрд┐рддрдХреЗ рдЬрд╡рд│реВрди рдЬреБрд│рдгрд╛рд░реЗ рдореЙрдбреЗрд▓ рддрдпрд╛рд░ рдХрд░рдгреНрдпрд╛рд╕рд╛рдареА рд╡рд╛рдкрд░рд▓реЗ рдЬрд╛рддреЗ.

## рд╡реНрдпрд╛рдпрд╛рдо - ARIMA рдореЙрдбреЗрд▓ рддрдпрд╛рд░ рдХрд░рд╛

рдпрд╛ рдзрдбреНрдпрд╛рдЪреНрдпрд╛ [_/working_](https://github.com/microsoft/ML-For-Beginners/tree/main/7-TimeSeries/2-ARIMA/working) рдлреЛрд▓реНрдбрд░рдордзреНрдпреЗ рдЬрд╛ рдЖрдгрд┐ [_notebook.ipynb_](https://github.com/microsoft/ML-For-Beginners/blob/main/7-TimeSeries/2-ARIMA/working/notebook.ipynb) рдлрд╛рдЗрд▓ рд╢реЛрдзрд╛.

1. `statsmodels` Python рд▓рд╛рдпрдмреНрд░рд░реА рд▓реЛрдб рдХрд░рдгреНрдпрд╛рд╕рд╛рдареА рдиреЛрдЯрдмреБрдХ рдЪрд╛рд▓рд╡рд╛; рддреБрдореНрд╣рд╛рд▓рд╛ ARIMA рдореЙрдбреЗрд▓реНрд╕рд╕рд╛рдареА рдпрд╛рдЪреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдЕрд╕реЗрд▓.

1. рдЖрд╡рд╢реНрдпрдХ рд▓рд╛рдпрдмреНрд░рд░реА рд▓реЛрдб рдХрд░рд╛

1. рдЖрддрд╛, рдбреЗрдЯрд╛ рдкреНрд▓реЙрдЯ рдХрд░рдгреНрдпрд╛рд╕рд╛рдареА рдЙрдкрдпреБрдХреНрдд рдЖрдгрдЦреА рдХрд╛рд╣реА рд▓рд╛рдпрдмреНрд░рд░реА рд▓реЛрдб рдХрд░рд╛:

    ```python
    import os
    import warnings
    import matplotlib.pyplot as plt
    import numpy as np
    import pandas as pd
    import datetime as dt
    import math

    from pandas.plotting import autocorrelation_plot
    from statsmodels.tsa.statespace.sarimax import SARIMAX
    from sklearn.preprocessing import MinMaxScaler
    from common.utils import load_data, mape
    from IPython.display import Image

    %matplotlib inline
    pd.options.display.float_format = '{:,.2f}'.format
    np.set_printoptions(precision=2)
    warnings.filterwarnings("ignore") # specify to ignore warning messages
    ```

1. `/data/energy.csv` рдлрд╛рдЗрд▓рдордзреВрди рдбреЗрдЯрд╛ Pandas dataframe рдордзреНрдпреЗ рд▓реЛрдб рдХрд░рд╛ рдЖрдгрд┐ рддреНрдпрд╛рд╡рд░ рдирдЬрд░ рдЯрд╛рдХрд╛:

    ```python
    energy = load_data('./data')[['load']]
    energy.head(10)
    ```

1. рдЬрд╛рдиреЗрд╡рд╛рд░реА 2012 рддреЗ рдбрд┐рд╕реЗрдВрдмрд░ 2014 рдкрд░реНрдпрдВрдд рдЙрдкрд▓рдмреНрдз рдКрд░реНрдЬрд╛ рдбреЗрдЯрд╛ рдкреНрд▓реЙрдЯ рдХрд░рд╛. рдорд╛рдЧреАрд▓ рдзрдбреНрдпрд╛рдд рдЖрдкрдг рд╣рд╛ рдбреЗрдЯрд╛ рдкрд╛рд╣рд┐рд▓рд╛ рдЕрд╕рд▓реНрдпрд╛рдиреЗ рдпрд╛рдд рдХрд╛рд╣реА рдЖрд╢реНрдЪрд░реНрдп рд╡рд╛рдЯрдгрд╛рд░ рдирд╛рд╣реА:

    ```python
    energy.plot(y='load', subplots=True, figsize=(15, 8), fontsize=12)
    plt.xlabel('timestamp', fontsize=12)
    plt.ylabel('load', fontsize=12)
    plt.show()
    ```

    рдЖрддрд╛, рдореЙрдбреЗрд▓ рддрдпрд╛рд░ рдХрд░реВрдпрд╛!

### рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдЖрдгрд┐ рдЪрд╛рдЪрдгреА рдбреЗрдЯрд╛рд╕реЗрдЯ рддрдпрд╛рд░ рдХрд░рд╛

рдЖрддрд╛ рддреБрдордЪрд╛ рдбреЗрдЯрд╛ рд▓реЛрдб рдЭрд╛рд▓рд╛ рдЖрд╣реЗ, рддреНрдпрд╛рдореБрд│реЗ рддреБрдореНрд╣реА рддреЛ рдЯреНрд░реЗрди рдЖрдгрд┐ рдЯреЗрд╕реНрдЯ рд╕реЗрдЯрдордзреНрдпреЗ рд╡рд┐рднрд╛рдЬрд┐рдд рдХрд░реВ рд╢рдХрддрд╛. рддреБрдореНрд╣реА рддреБрдордЪреНрдпрд╛ рдЯреНрд░реЗрди рд╕реЗрдЯрд╡рд░ рддреБрдордЪреЗ рдореЙрдбреЗрд▓ рдЯреНрд░реЗрди рдХрд░рд╛рд▓. рдиреЗрд╣рдореАрдкреНрд░рдорд╛рдгреЗ, рдореЙрдбреЗрд▓ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдкреВрд░реНрдг рдЭрд╛рд▓реНрдпрд╛рдирдВрддрд░, рддреБрдореНрд╣реА рдЯреЗрд╕реНрдЯ рд╕реЗрдЯ рд╡рд╛рдкрд░реВрди рддреНрдпрд╛рдЪреА рдЕрдЪреВрдХрддрд╛ рдореВрд▓реНрдпрд╛рдВрдХрди рдХрд░рд╛рд▓. рдЯреНрд░реЗрдирд┐рдВрдЧ рд╕реЗрдЯрдордзреВрди рдЯреЗрд╕реНрдЯ рд╕реЗрдЯ рдирдВрддрд░рдЪреНрдпрд╛ рдХрд╛рд▓рд╛рд╡рдзреАрдЪрд╛ рд╕рдорд╛рд╡реЗрд╢ рдХрд░рддреЛ рдпрд╛рдЪреА рдЦрд╛рддреНрд░реА рдХрд░рдгреЗ рдЖрд╡рд╢реНрдпрдХ рдЖрд╣реЗ рдЬреЗрдгреЗрдХрд░реВрди рдореЙрдбреЗрд▓рд▓рд╛ рднрд╡рд┐рд╖реНрдпрд╛рддреАрд▓ рдХрд╛рд▓рд╛рд╡рдзреАрдЪреА рдорд╛рд╣рд┐рддреА рдорд┐рд│рдгрд╛рд░ рдирд╛рд╣реА.

1. 1 рд╕рдкреНрдЯреЗрдВрдмрд░ рддреЗ 31 рдСрдХреНрдЯреЛрдмрд░ 2014 рдкрд░реНрдпрдВрддрдЪрд╛ рджреЛрди рдорд╣рд┐рдиреНрдпрд╛рдВрдЪрд╛ рдХрд╛рд▓рд╛рд╡рдзреА рдЯреНрд░реЗрдирд┐рдВрдЧ рд╕реЗрдЯрд╕рд╛рдареА рд╡рд╛рдЯрдк рдХрд░рд╛. рдЯреЗрд╕реНрдЯ рд╕реЗрдЯрдордзреНрдпреЗ 1 рдиреЛрд╡реНрд╣реЗрдВрдмрд░ рддреЗ 31 рдбрд┐рд╕реЗрдВрдмрд░ 2014 рдкрд░реНрдпрдВрддрдЪрд╛ рджреЛрди рдорд╣рд┐рдиреНрдпрд╛рдВрдЪрд╛ рдХрд╛рд▓рд╛рд╡рдзреА рд╕рдорд╛рд╡рд┐рд╖реНрдЯ рдЕрд╕реЗрд▓:

    ```python
    train_start_dt = '2014-11-01 00:00:00'
    test_start_dt = '2014-12-30 00:00:00'
    ```

    рд╣рд╛ рдбреЗрдЯрд╛ рдКрд░реНрдЬрд╛ рд╡рд╛рдкрд░рд╛рдЪрд╛ рджреИрдирд┐рдХ рдЙрдкрднреЛрдЧ рджрд░реНрд╢рд╡рд┐рдд рдЕрд╕рд▓реНрдпрд╛рдиреЗ, рдПрдХ рдордЬрдмреВрдд рд╣рдВрдЧрд╛рдореА рдирдореБрдирд╛ рдЖрд╣реЗ, рдкрд░рдВрддреБ рдЙрдкрднреЛрдЧ рдЕрд▓реАрдХрдбреАрд▓ рджрд┐рд╡рд╕рд╛рдВрдЪреНрдпрд╛ рдЙрдкрднреЛрдЧрд╛рд╢реА рд╕рд░реНрд╡рд╛рдзрд┐рдХ рд╕рдорд╛рди рдЖрд╣реЗ.

1. рдлрд░рдХрд╛рдВрдЪреЗ рд╡реНрд╣рд┐рдЬреНрдпреБрдЕрд▓рд╛рдпрдЭреЗрд╢рди рдХрд░рд╛:

    ```python
    energy[(energy.index < test_start_dt) & (energy.index >= train_start_dt)][['load']].rename(columns={'load':'train'}) \
        .join(energy[test_start_dt:][['load']].rename(columns={'load':'test'}), how='outer') \
        .plot(y=['train', 'test'], figsize=(15, 8), fontsize=12)
    plt.xlabel('timestamp', fontsize=12)
    plt.ylabel('load', fontsize=12)
    plt.show()
    ```

    ![рдЯреНрд░реЗрдирд┐рдВрдЧ рдЖрдгрд┐ рдЯреЗрд╕реНрдЯрд┐рдВрдЧ рдбреЗрдЯрд╛](../../../../7-TimeSeries/2-ARIMA/images/train-test.png)

    рддреНрдпрд╛рдореБрд│реЗ, рдбреЗрдЯрд╛ рдЯреНрд░реЗрдирд┐рдВрдЧрд╕рд╛рдареА рддреБрд▓рдиреЗрдиреЗ рдЫреЛрдЯреНрдпрд╛ рд╡рд┐рдВрдбреЛрдЪрд╛ рд╡рд╛рдкрд░ рдкреБрд░реЗрд╕рд╛ рдЕрд╕рд╛рд╡рд╛.

    > рдЯреАрдк: рдЖрдореНрд╣реА ARIMA рдореЙрдбреЗрд▓ рдлрд┐рдЯ рдХрд░рдгреНрдпрд╛рд╕рд╛рдареА рд╡рд╛рдкрд░рдд рдЕрд╕рд▓реЗрд▓реНрдпрд╛ рдлрдВрдХреНрд╢рдирдордзреНрдпреЗ рдлрд┐рдЯрд┐рдВрдЧ рджрд░рдореНрдпрд╛рди рдЗрди-рд╕реЕрдореНрдкрд▓ рд╡реНрд╣реЕрд▓рд┐рдбреЗрд╢рди рд╡рд╛рдкрд░рд▓реЗ рдЬрд╛рддреЗ, рддреНрдпрд╛рдореБрд│реЗ рдЖрдореНрд╣реА рд╡реНрд╣реЕрд▓рд┐рдбреЗрд╢рди рдбреЗрдЯрд╛ рд╡рдЧрд│реВ.

### рдкреНрд░рд╢рд┐рдХреНрд╖рдгрд╛рд╕рд╛рдареА рдбреЗрдЯрд╛ рддрдпрд╛рд░ рдХрд░рд╛

рдЖрддрд╛, рддреБрдореНрд╣рд╛рд▓рд╛ рддреБрдордЪрд╛ рдбреЗрдЯрд╛ рдкреНрд░рд╢рд┐рдХреНрд╖рдгрд╛рд╕рд╛рдареА рддрдпрд╛рд░ рдХрд░рдгреНрдпрд╛рд╕рд╛рдареА рдлрд┐рд▓реНрдЯрд░рд┐рдВрдЧ рдЖрдгрд┐ рд╕реНрдХреЗрд▓рд┐рдВрдЧ рдХрд░рдгреЗ рдЖрд╡рд╢реНрдпрдХ рдЖрд╣реЗ. рддреБрдордЪреНрдпрд╛ рдбреЗрдЯрд╛рд╕реЗрдЯрд▓рд╛ рдлрдХреНрдд рдЖрд╡рд╢реНрдпрдХ рдХрд╛рд▓рд╛рд╡рдзреА рдЖрдгрд┐ рдХреЙрд▓рдо рд╕рдорд╛рд╡рд┐рд╖реНрдЯ рдХрд░рдгреНрдпрд╛рд╕рд╛рдареА рдлрд┐рд▓реНрдЯрд░ рдХрд░рд╛ рдЖрдгрд┐ рдбреЗрдЯрд╛ 0,1 рдЕрдВрддрд░рд╛рдд рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдХрд░рдгреНрдпрд╛рд╕рд╛рдареА рд╕реНрдХреЗрд▓рд┐рдВрдЧ рдХрд░рд╛.

1. рдореВрд│ рдбреЗрдЯрд╛рд╕реЗрдЯрд▓рд╛ рдлрдХреНрдд рд╡рд░реАрд▓ рдирдореВрдж рдХрд╛рд▓рд╛рд╡рдзреА рдкреНрд░рддрд┐ рд╕реЗрдЯ рдЖрдгрд┐ рдлрдХреНрдд рдЖрд╡рд╢реНрдпрдХ рдХреЙрд▓рдо 'load' рдЖрдгрд┐ рддрд╛рд░реАрдЦ рд╕рдорд╛рд╡рд┐рд╖реНрдЯ рдХрд░рдгреНрдпрд╛рд╕рд╛рдареА рдлрд┐рд▓реНрдЯрд░ рдХрд░рд╛:

    ```python
    train = energy.copy()[(energy.index >= train_start_dt) & (energy.index < test_start_dt)][['load']]
    test = energy.copy()[energy.index >= test_start_dt][['load']]

    print('Training data shape: ', train.shape)
    print('Test data shape: ', test.shape)
    ```

    рддреБрдореНрд╣реА рдбреЗрдЯрд╛рдЪрд╛ рдЖрдХрд╛рд░ рдкрд╛рд╣реВ рд╢рдХрддрд╛:

    ```output
    Training data shape:  (1416, 1)
    Test data shape:  (48, 1)
    ```

1. рдбреЗрдЯрд╛ (0, 1) рд╢реНрд░реЗрдгреАрдд рд╕реНрдХреЗрд▓ рдХрд░рд╛.

    ```python
    scaler = MinMaxScaler()
    train['load'] = scaler.fit_transform(train)
    train.head(10)
    ```

1. рдореВрд│ рдбреЗрдЯрд╛ рдЖрдгрд┐ рд╕реНрдХреЗрд▓ рдХреЗрд▓реЗрд▓рд╛ рдбреЗрдЯрд╛ рд╡реНрд╣рд┐рдЬреНрдпреБрдЕрд▓рд╛рдпрдЭреЗрд╢рди рдХрд░рд╛:

    ```python
    energy[(energy.index >= train_start_dt) & (energy.index < test_start_dt)][['load']].rename(columns={'load':'original load'}).plot.hist(bins=100, fontsize=12)
    train.rename(columns={'load':'scaled load'}).plot.hist(bins=100, fontsize=12)
    plt.show()
    ```

    ![рдореВрд│](../../../../7-TimeSeries/2-ARIMA/images/original.png)

    > рдореВрд│ рдбреЗрдЯрд╛

    ![рд╕реНрдХреЗрд▓ рдХреЗрд▓реЗрд▓рд╛](../../../../7-TimeSeries/2-ARIMA/images/scaled.png)

    > рд╕реНрдХреЗрд▓ рдХреЗрд▓реЗрд▓рд╛ рдбреЗрдЯрд╛

1. рдЖрддрд╛ рддреБрдореНрд╣реА рд╕реНрдХреЗрд▓ рдХреЗрд▓реЗрд▓рд╛ рдбреЗрдЯрд╛ рдХреЕрд▓рд┐рдмреНрд░реЗрдЯ рдХреЗрд▓рд╛ рдЖрд╣реЗ, рддреБрдореНрд╣реА рдЯреЗрд╕реНрдЯ рдбреЗрдЯрд╛ рд╕реНрдХреЗрд▓ рдХрд░реВ рд╢рдХрддрд╛:

    ```python
    test['load'] = scaler.transform(test)
    test.head()
    ```

### ARIMA рд▓рд╛рдЧреВ рдХрд░рд╛

рдЖрддрд╛ ARIMA рд▓рд╛рдЧреВ рдХрд░рдгреНрдпрд╛рдЪреА рд╡реЗрд│ рдЖрд▓реА рдЖрд╣реЗ! рддреБрдореНрд╣реА рдпрд╛рдкреВрд░реНрд╡реА рд╕реНрдерд╛рдкрд┐рдд рдХреЗрд▓реЗрд▓реНрдпрд╛ `statsmodels` рд▓рд╛рдпрдмреНрд░рд░реАрдЪрд╛ рд╡рд╛рдкрд░ рдХрд░рд╛рд▓.

рдЖрддрд╛ рддреБрдореНрд╣рд╛рд▓рд╛ рдХрд╛рд╣реА рдкрд╛рдпрд▒реНрдпрд╛ рдлреЙрд▓реЛ рдХрд░рд╛рд╡реНрдпрд╛ рд▓рд╛рдЧрддреАрд▓:

   1. `SARIMAX()` рдХреЙрд▓ рдХрд░реВрди рдЖрдгрд┐ рдореЙрдбреЗрд▓ рдкреЕрд░рд╛рдореАрдЯрд░реНрд╕: p, d, рдЖрдгрд┐ q рдкреЕрд░рд╛рдореАрдЯрд░реНрд╕, рддрд╕реЗрдЪ P, D, рдЖрдгрд┐ Q рдкреЕрд░рд╛рдореАрдЯрд░реНрд╕ рдкрд╛рд╕ рдХрд░реВрди рдореЙрдбреЗрд▓ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рд╛.
   2. `fit()` рдлрдВрдХреНрд╢рди рдХреЙрд▓ рдХрд░реВрди рдЯреНрд░реЗрдирд┐рдВрдЧ рдбреЗрдЯрд╛рд╕рд╛рдареА рдореЙрдбреЗрд▓ рддрдпрд╛рд░ рдХрд░рд╛.
   3. `forecast()` рдлрдВрдХреНрд╢рди рдХреЙрд▓ рдХрд░реВрди рдЖрдгрд┐ рдЕрдВрджрд╛рдЬ рд▓рд╛рд╡рдгреНрдпрд╛рд╕рд╛рдареА рд╕реНрдЯреЗрдкреНрд╕ (рд╣реЛрд░рд╛рдпрдЭрди) рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░реВрди рдЕрдВрджрд╛рдЬ рддрдпрд╛рд░ рдХрд░рд╛.

> ЁЯОУ рд╣реЗ рд╕рд░реНрд╡ рдкреЕрд░рд╛рдореАрдЯрд░реНрд╕ рдХрд╢рд╛рд╕рд╛рдареА рдЖрд╣реЗрдд? ARIMA рдореЙрдбреЗрд▓рдордзреНрдпреЗ 3 рдкреЕрд░рд╛рдореАрдЯрд░реНрд╕ рдЕрд╕рддрд╛рдд рдЬреЗ рдЯрд╛рдЗрдо рд╕рд┐рд░реАрдЬрдЪреЗ рдореБрдЦреНрдп рдкреИрд▓реВ рдореЙрдбреЗрд▓ рдХрд░рдгреНрдпрд╛рдд рдорджрдд рдХрд░рддрд╛рдд: рд╣рдВрдЧрд╛рдореА рдмрджрд▓, рдЯреНрд░реЗрдВрдб, рдЖрдгрд┐ рдЖрд╡рд╛рдЬ. рд╣реЗ рдкреЕрд░рд╛рдореАрдЯрд░реНрд╕ рдЖрд╣реЗрдд:

`p`: рдореЙрдбреЗрд▓рдЪреНрдпрд╛ рдСрдЯреЛ-рд░реЗрдЧреНрд░реЗрд╕рд┐рд╡реНрд╣ рдкреИрд▓реВрд╕рд╛рдареА рд╕рдВрдмрдВрдзрд┐рдд рдкреЕрд░рд╛рдореАрдЯрд░, рдЬреЛ *рдорд╛рдЧреАрд▓* рдореВрд▓реНрдпрд╛рдВрдЪрд╛ рд╕рдорд╛рд╡реЗрд╢ рдХрд░рддреЛ.
`d`: рдореЙрдбреЗрд▓рдЪреНрдпрд╛ рдЗрдВрдЯрд┐рдЧреНрд░реЗрдЯреЗрдб рднрд╛рдЧрд╛рд╢реА рд╕рдВрдмрдВрдзрд┐рдд рдкреЕрд░рд╛рдореАрдЯрд░, рдЬреЛ рдЯрд╛рдЗрдо рд╕рд┐рд░реАрдЬрд╡рд░ *рдбрд┐рдлрд░рдиреНрд╕рд┐рдВрдЧ* (ЁЯОУ рдбрд┐рдлрд░рдиреНрд╕рд┐рдВрдЧ рд▓рдХреНрд╖рд╛рдд рдареЗрд╡рд╛ ЁЯСЖ?) рд▓рд╛рдЧреВ рдХрд░рдгреНрдпрд╛рдЪреНрдпрд╛ рдкреНрд░рдорд╛рдгрд╛рд╡рд░ рдкрд░рд┐рдгрд╛рдо рдХрд░рддреЛ.
`q`: рдореЙрдбреЗрд▓рдЪреНрдпрд╛ рдореВрд╡реНрд╣рд┐рдВрдЧ-рдЕреЕрд╡реНрд╣рд░реЗрдЬ рднрд╛рдЧрд╛рд╢реА рд╕рдВрдмрдВрдзрд┐рдд рдкреЕрд░рд╛рдореАрдЯрд░.

> рдЯреАрдк: рдЬрд░ рддреБрдордЪреНрдпрд╛ рдбреЗрдЯрд╛рдордзреНрдпреЗ рд╣рдВрдЧрд╛рдореА рдкреИрд▓реВ рдЕрд╕реЗрд▓ - рдЬреЛ рдпрд╛ рдбреЗрдЯрд╛рдордзреНрдпреЗ рдЖрд╣реЗ - , рдЖрдкрдг рд╣рдВрдЧрд╛рдореА ARIMA рдореЙрдбреЗрд▓ (SARIMA) рд╡рд╛рдкрд░рддреЛ. рдЕрд╢рд╛ рдкрд░рд┐рд╕реНрдерд┐рддреАрдд рддреБрдореНрд╣рд╛рд▓рд╛ рдЖрдгрдЦреА рдПрдХ рдкреЕрд░рд╛рдореАрдЯрд░реНрд╕ рд╕реЗрдЯ рд╡рд╛рдкрд░рд╛рд╡реЗ рд▓рд╛рдЧреЗрд▓: `P`, `D`, рдЖрдгрд┐ `Q` рдЬреЗ `p`, `d`, рдЖрдгрд┐ `q` рд╕рд╛рд░рдЦреНрдпрд╛ рдЕрд╕реЛрд╕рд┐рдПрд╢рдиреНрд╕рдЪреЗ рд╡рд░реНрдгрди рдХрд░рддрд╛рдд, рдкрд░рдВрддреБ рдореЙрдбреЗрд▓рдЪреНрдпрд╛ рд╣рдВрдЧрд╛рдореА рдШрдЯрдХрд╛рдВрд╢реА рд╕рдВрдмрдВрдзрд┐рдд рдЖрд╣реЗрдд.

1. рддреБрдордЪреА рдкреНрд░рд╛рдзрд╛рдиреНрдп рд╣реЛрд░рд╛рдпрдЭрди рд╡реНрд╣реЕрд▓реНрдпреВ рд╕реЗрдЯ рдХрд░рд╛. рдЪрд▓рд╛ 3 рддрд╛рд╕рд╛рдВрдЪрд╛ рдкреНрд░рдпрддреНрди рдХрд░реВрдпрд╛:

    ```python
    # Specify the number of steps to forecast ahead
    HORIZON = 3
    print('Forecasting horizon:', HORIZON, 'hours')
    ```

    ARIMA рдореЙрдбреЗрд▓рдЪреНрдпрд╛ рдкреЕрд░рд╛рдореАрдЯрд░реНрд╕рд╕рд╛рдареА рд╕рд░реНрд╡реЛрддреНрддрдо рдореВрд▓реНрдпреЗ рдирд┐рд╡рдбрдгреЗ рдЖрд╡реНрд╣рд╛рдирд╛рддреНрдордХ рдЕрд╕реВ рд╢рдХрддреЗ рдХрд╛рд░рдг рддреЗ рдХрд╛рд╣реАрд╕реЗ рд╡реНрдпрдХреНрддрд┐рдирд┐рд╖реНрда рдЖрдгрд┐ рд╡реЗрд│рдЦрд╛рдК рдЖрд╣реЗ. рддреБрдореНрд╣реА [`pyramid` рд▓рд╛рдпрдмреНрд░рд░реА](https://alkaline-ml.com/pmdarima/0.9.0/modules/generated/pyramid.arima.auto_arima.html) рдордзреАрд▓ `auto_arima()` рдлрдВрдХреНрд╢рди рд╡рд╛рдкрд░рдгреНрдпрд╛рдЪрд╛ рд╡рд┐рдЪрд╛рд░ рдХрд░реВ рд╢рдХрддрд╛.

1. рд╕рдзреНрдпрд╛ рдХрд╛рд╣реА рдореЕрдиреНрдпреБрдЕрд▓ рдирд┐рд╡рдбреА рдХрд░реВрди рдЪрд╛рдВрдЧрд▓реЗ рдореЙрдбреЗрд▓ рд╢реЛрдзрдгреНрдпрд╛рдЪрд╛ рдкреНрд░рдпрддреНрди рдХрд░рд╛.

    ```python
    order = (4, 1, 0)
    seasonal_order = (1, 1, 0, 24)

    model = SARIMAX(endog=train, order=order, seasonal_order=seasonal_order)
    results = model.fit()

    print(results.summary())
    ```

    рдирд┐рдХрд╛рд▓рд╛рдВрдЪреА рдПрдХ рдЯреЗрдмрд▓ рдкреНрд░рд┐рдВрдЯ рдХреЗрд▓реА рдЬрд╛рддреЗ.

рддреБрдореНрд╣реА рддреБрдордЪреЗ рдкрд╣рд┐рд▓реЗ рдореЙрдбреЗрд▓ рддрдпрд╛рд░ рдХреЗрд▓реЗ рдЖрд╣реЗ! рдЖрддрд╛ рдЖрдореНрд╣рд╛рд▓рд╛ рддреНрдпрд╛рдЪреЗ рдореВрд▓реНрдпрд╛рдВрдХрди рдХрд░рдгреНрдпрд╛рдЪрд╛ рдорд╛рд░реНрдЧ рд╢реЛрдзрд╛рд╡рд╛ рд▓рд╛рдЧреЗрд▓.

### рддреБрдордЪреЗ рдореЙрдбреЗрд▓ рдореВрд▓реНрдпрд╛рдВрдХрди рдХрд░рд╛

рддреБрдордЪреЗ рдореЙрдбреЗрд▓ рдореВрд▓реНрдпрд╛рдВрдХрди рдХрд░рдгреНрдпрд╛рд╕рд╛рдареА, рддреБрдореНрд╣реА рддрдерд╛рдХрдерд┐рдд `walk forward` рд╡реНрд╣реЕрд▓рд┐рдбреЗрд╢рди рдХрд░реВ рд╢рдХрддрд╛. рдкреНрд░рддреНрдпрдХреНрд╖рд╛рдд, рдЯрд╛рдЗрдо рд╕рд┐рд░реАрдЬ рдореЙрдбреЗрд▓реНрд╕ рдкреНрд░рддреНрдпреЗрдХ рд╡реЗрд│реА рдирд╡реАрди рдбреЗрдЯрд╛ рдЙрдкрд▓рдмреНрдз рдЭрд╛рд▓реНрдпрд╛рд╡рд░ рдкреБрдиреНрд╣рд╛ рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдХреЗрд▓реЗ рдЬрд╛рддрд╛рдд. рд╣реЗ рдореЙрдбреЗрд▓рд▓рд╛ рдкреНрд░рддреНрдпреЗрдХ рд╡реЗрд│реЗрдЪреНрдпрд╛ рдЯрдкреНрдкреНрдпрд╛рд╡рд░ рд╕рд░реНрд╡реЛрддреНрддрдо рдЕрдВрджрд╛рдЬ рд▓рд╛рд╡рдгреНрдпрд╛рд╕ рдЕрдиреБрдорддреА рджреЗрддреЗ.

рдЯрд╛рдЗрдо рд╕рд┐рд░реАрдЬрдЪреНрдпрд╛ рд╕реБрд░реБрд╡рд╛рддреАрдкрд╛рд╕реВрди рдпрд╛ рддрдВрддреНрд░рд╛рдЪрд╛ рд╡рд╛рдкрд░ рдХрд░реВрди, рдЯреНрд░реЗрдирд┐рдВрдЧ рдбреЗрдЯрд╛рд╕реЗрдЯрд╡рд░ рдореЙрдбреЗрд▓ рдЯреНрд░реЗрди рдХрд░рд╛. рдордЧ рдкреБрдвреАрд▓ рд╡реЗрд│реЗрдЪреНрдпрд╛ рдЯрдкреНрдкреНрдпрд╛рд╡рд░ рдЕрдВрджрд╛рдЬ рддрдпрд╛рд░ рдХрд░рд╛. рдЕрдВрджрд╛рдЬ рдЬреНрдЮрд╛рдд рдореВрд▓реНрдпрд╛рдЪреНрдпрд╛ рд╡рд┐рд░реБрджреНрдз рдореВрд▓реНрдпрд╛рдВрдХрди рдХреЗрд▓рд╛ рдЬрд╛рддреЛ. рдЯреНрд░реЗрдирд┐рдВрдЧ рд╕реЗрдЯ рдирдВрддрд░ рдЬреНрдЮрд╛рдд рдореВрд▓реНрдп рд╕рдорд╛рд╡рд┐рд╖реНрдЯ рдХрд░рдгреНрдпрд╛рд╕рд╛рдареА рд╡рд┐рд╕реНрддрд╛рд░рд┐рдд рдХреЗрд▓рд╛ рдЬрд╛рддреЛ рдЖрдгрд┐ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдкреБрдиреНрд╣рд╛ рдХреЗрд▓реА рдЬрд╛рддреЗ.

> рдЯреАрдк: рдЕрдзрд┐рдХ рдХрд╛рд░реНрдпрдХреНрд╖рдо рдкреНрд░рд╢рд┐рдХреНрд╖рдгрд╛рд╕рд╛рдареА рддреБрдореНрд╣реА рдЯреНрд░реЗрдирд┐рдВрдЧ рд╕реЗрдЯ рд╡рд┐рдВрдбреЛ рдирд┐рд╢реНрдЪрд┐рдд рдареЗрд╡рд╛рд╡реА рдЬреЗрдгреЗрдХрд░реВрди рдкреНрд░рддреНрдпреЗрдХ рд╡реЗрд│реА рддреБрдореНрд╣реА рдЯреНрд░реЗрдирд┐рдВрдЧ рд╕реЗрдЯрдордзреНрдпреЗ рдирд╡реАрди рдирд┐рд░реАрдХреНрд╖рдг рдЬреЛрдбрддрд╛, рддреБрдореНрд╣реА рд╕реЗрдЯрдЪреНрдпрд╛ рд╕реБрд░реБрд╡рд╛рддреАрдкрд╛рд╕реВрди рдирд┐рд░реАрдХреНрд╖рдг рдХрд╛рдвреВрди рдЯрд╛рдХрддрд╛.

рд╣реА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдореЙрдбреЗрд▓ рдкреНрд░рддреНрдпрдХреНрд╖рд╛рдд рдХрд╕рд╛ рдХрд╛рд░реНрдп рдХрд░реЗрд▓ рдпрд╛рдЪреЗ рдЕрдзрд┐рдХ рдордЬрдмреВрдд рдЕрдВрджрд╛рдЬ рдкреНрд░рджрд╛рди рдХрд░рддреЗ. рддрдерд╛рдкрд┐, рдЗрддрдХреА рдореЙрдбреЗрд▓реНрд╕ рддрдпрд╛рд░ рдХрд░рдгреНрдпрд╛рдЪреНрдпрд╛ рд╕рдВрдЧрдгрдХреАрдп рдЦрд░реНрдЪрд╛рд╕рд╣ рдпреЗрддреЗ. рдЬрд░ рдбреЗрдЯрд╛ рд▓рд╣рд╛рди рдЕрд╕реЗрд▓ рдХрд┐рдВрд╡рд╛ рдореЙрдбреЗрд▓ рд╕реЛрдкреЗ рдЕрд╕реЗрд▓ рддрд░ рд╣реЗ рд╕реНрд╡реАрдХрд╛рд░реНрдп рдЖрд╣реЗ, рдкрд░рдВрддреБ рдореЛрдареНрдпрд╛ рдкреНрд░рдорд╛рдгрд╛рд╡рд░ рд╕рдорд╕реНрдпрд╛ рд╣реЛрдК рд╢рдХрддреЗ.

рд╡реЙрдХ-рдлреЙрд░рд╡рд░реНрдб рд╡реНрд╣реЕрд▓рд┐рдбреЗрд╢рди рдЯрд╛рдЗрдо рд╕рд┐рд░реАрдЬ рдореЙрдбреЗрд▓ рдореВрд▓реНрдпрд╛рдВрдХрдирд╛рдЪрд╛ рд╕реБрд╡рд░реНрдг рдорд╛рдирдХ рдЖрд╣реЗ рдЖрдгрд┐ рддреБрдордЪреНрдпрд╛ рд╕реНрд╡рддрдГрдЪреНрдпрд╛ рдкреНрд░рдХрд▓реНрдкрд╛рдВрд╕рд╛рдареА рд╢рд┐рдлрд╛рд░рд╕ рдХреЗрд▓реА рдЬрд╛рддреЗ.

1. рдкреНрд░рддреНрдпреЗрдХ HORIZON рд╕реНрдЯреЗрдкрд╕рд╛рдареА рдЯреЗрд╕реНрдЯ рдбреЗрдЯрд╛ рдкреЙрдЗрдВрдЯ рддрдпрд╛рд░ рдХрд░рд╛.

    ```python
    test_shifted = test.copy()

    for t in range(1, HORIZON+1):
        test_shifted['load+'+str(t)] = test_shifted['load'].shift(-t, freq='H')

    test_shifted = test_shifted.dropna(how='any')
    test_shifted.head(5)
    ```

    |            |          | load | load+1 | load+2 |
    | ---------- | -------- | ---- | ------ | ------ |
    | 2014-12-30 | 00:00:00 | 0.33 | 0.29   | 0.27   |
    | 2014-12-30 | 01:00:00 | 0.29 | 0.27   | 0.27   |
    | 2014-12-30 | 02:00:00 | 0.27 | 0.27   | 0.30   |
    | 2014-12-30 | 03:00:00 | 0.27 | 0.30   | 0.41   |
    | 2014-12-30 | 04:00:00 | 0.30 | 0.41   | 0.57   |

    рдбреЗрдЯрд╛ рддреНрдпрд╛рдЪреНрдпрд╛ рд╣реЛрд░рд╛рдпрдЭрди рдкреЙрдЗрдВрдЯрдиреБрд╕рд╛рд░ рдЖрдбрд╡реНрдпрд╛ рджрд┐рд╢реЗрдиреЗ рд╢рд┐рдлреНрдЯ рдХреЗрд▓рд╛ рдЬрд╛рддреЛ.

1. рд╕реНрд▓рд╛рдпрдбрд┐рдВрдЧ рд╡рд┐рдВрдбреЛ рджреГрд╖реНрдЯрд┐рдХреЛрди рд╡рд╛рдкрд░реВрди рдЯреЗрд╕реНрдЯ рдбреЗрдЯрд╛рд╡рд░ рдЕрдВрджрд╛рдЬ рддрдпрд╛рд░ рдХрд░рд╛, рдЯреЗрд╕реНрдЯ рдбреЗрдЯрд╛рдЪреНрдпрд╛ рд▓рд╛рдВрдмреАрдЪреНрдпрд╛ рдЖрдХрд╛рд░рд╛рдд рд▓реВрдкрдордзреНрдпреЗ:

    ```python
    %%time
    training_window = 720 # dedicate 30 days (720 hours) for training

    train_ts = train['load']
    test_ts = test_shifted

    history = [x for x in train_ts]
    history = history[(-training_window):]

    predictions = list()

    order = (2, 1, 0)
    seasonal_order = (1, 1, 0, 24)

    for t in range(test_ts.shape[0]):
        model = SARIMAX(endog=history, order=order, seasonal_order=seasonal_order)
        model_fit = model.fit()
        yhat = model_fit.forecast(steps = HORIZON)
        predictions.append(yhat)
        obs = list(test_ts.iloc[t])
        # move the training window
        history.append(obs[0])
        history.pop(0)
        print(test_ts.index[t])
        print(t+1, ': predicted =', yhat, 'expected =', obs)
    ```

    рддреБрдореНрд╣реА рдкреНрд░рд╢рд┐рдХреНрд╖рдг рд╣реЛрддрд╛рдирд╛ рдкрд╛рд╣реВ рд╢рдХрддрд╛:

    ```output
    2014-12-30 00:00:00
    1 : predicted = [0.32 0.29 0.28] expected = [0.32945389435989236, 0.2900626678603402, 0.2739480752014323]

    2014-12-30 01:00:00
    2 : predicted = [0.3  0.29 0.3 ] expected = [0.2900626678603402, 0.2739480752014323, 0.26812891674127126]

    2014-12-30 02:00:00
    3 : predicted = [0.27 0.28 0.32] expected = [0.2739480752014323, 0.26812891674127126, 0.3025962399283795]
    ```

1. рдЕрдВрджрд╛рдЬ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд▓реЛрдбрд╢реА рддреБрд▓рдирд╛ рдХрд░рд╛:

    ```python
    eval_df = pd.DataFrame(predictions, columns=['t+'+str(t) for t in range(1, HORIZON+1)])
    eval_df['timestamp'] = test.index[0:len(test.index)-HORIZON+1]
    eval_df = pd.melt(eval_df, id_vars='timestamp', value_name='prediction', var_name='h')
    eval_df['actual'] = np.array(np.transpose(test_ts)).ravel()
    eval_df[['prediction', 'actual']] = scaler.inverse_transform(eval_df[['prediction', 'actual']])
    eval_df.head()
    ```

    рдЖрдЙрдЯрдкреБрдЯ
    |     |            | timestamp | h   | prediction | actual   |
    | --- | ---------- | --------- | --- | ---------- | -------- |
    | 0   | 2014-12-30 | 00:00:00  | t+1 | 3,008.74   | 3,023.00 |
    | 1   | 2014-12-30 | 01:00:00  | t+1 | 2,955.53   | 2,935.00 |
    | 2   | 2014-12-30 | 02:00:00  | t+1 | 2,900.17   | 2,899.00 |
    | 3   | 2014-12-30 | 03:00:00  | t+1 | 2,917.69   | 2,886.00 |
    | 4   | 2014-12-30 | 04:00:00  | t+1 | 2,946.99   | 2,963.00 |

    рддрд╛рд╕рд╛рдЪреНрдпрд╛ рдбреЗрдЯрд╛рдЪрд╛ рдЕрдВрджрд╛рдЬ, рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд▓реЛрдбрд╢реА рддреБрд▓рдирд╛ рдХрд░рд╛. рд╣реЗ рдХрд┐рддреА рдЕрдЪреВрдХ рдЖрд╣реЗ?

### рдореЙрдбреЗрд▓ рдЕрдЪреВрдХрддрд╛ рддрдкрд╛рд╕рд╛

рддреБрдордЪреНрдпрд╛ рд╕рд░реНрд╡ рдЕрдВрджрд╛рдЬрд╛рдВрд╡рд░ рдореЙрдбреЗрд▓рдЪреА mean absolute percentage error (MAPE) рддрдкрд╛рд╕реВрди рддреНрдпрд╛рдЪреА рдЕрдЪреВрдХрддрд╛ рддрдкрд╛рд╕рд╛.
> **ЁЯзо рдЧрдгрд┐рдд рджрд╛рдЦрд╡рд╛**
>
> ![MAPE](../../../../7-TimeSeries/2-ARIMA/images/mape.png)
>
> [MAPE](https://www.linkedin.com/pulse/what-mape-mad-msd-time-series-allameh-statistics/) рд╣рд╛ рд╡рд░реАрд▓ рд╕реВрддреНрд░рд╛рджреНрд╡рд╛рд░реЗ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХреЗрд▓реЗрд▓реНрдпрд╛ рдЧреБрдгреЛрддреНрддрд░рд╛рдЪреНрдпрд╛ рд╕реНрд╡рд░реВрдкрд╛рдд рдЕрдВрджрд╛рдЬ рдЕрдЪреВрдХрддрд╛ рджрд░реНрд╢рд╡рд┐рдгреНрдпрд╛рд╕рд╛рдареА рд╡рд╛рдкрд░рд▓рд╛ рдЬрд╛рддреЛ. рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдЖрдгрд┐ рдЕрдВрджрд╛рдЬрд┐рдд рдпрд╛рдордзреАрд▓ рдлрд░рдХ рд╡рд╛рд╕реНрддрд╡рд┐рдХрд╛рдиреЗ рд╡рд┐рднрд╛рдЧрд▓рд╛ рдЬрд╛рддреЛ.
>
> "рдпрд╛ рдЧрдгрдиреЗрддреАрд▓ рдкрд░рд┐рдорд╛рдгрд╛рддреНрдордХ рдореВрд▓реНрдп рдкреНрд░рддреНрдпреЗрдХ рдЕрдВрджрд╛рдЬрд┐рдд рд╡реЗрд│реЗрдЪреНрдпрд╛ рдмрд┐рдВрджреВрд╕рд╛рдареА рдПрдХрддреНрд░рд┐рдд рдХреЗрд▓реЗ рдЬрд╛рддреЗ рдЖрдгрд┐ рдмрд╕рд╡рд▓реЗрд▓реНрдпрд╛ рдмрд┐рдВрджреВрдВрдЪреНрдпрд╛ рд╕рдВрдЦреНрдпреЗрдиреЗ n рдиреЗ рд╡рд┐рднрд╛рдЧрд▓реЗ рдЬрд╛рддреЗ." [wikipedia](https://wikipedia.org/wiki/Mean_absolute_percentage_error)
1. рдХреЛрдбрдордзреНрдпреЗ рд╕рдореАрдХрд░рдг рд╡реНрдпрдХреНрдд рдХрд░рд╛:

    ```python
    if(HORIZON > 1):
        eval_df['APE'] = (eval_df['prediction'] - eval_df['actual']).abs() / eval_df['actual']
        print(eval_df.groupby('h')['APE'].mean())
    ```

1. рдПрдХрд╛ рдкрд╛рдпрд░реАрдЪрд╛ MAPE рдХрд╛рдврд╛:

    ```python
    print('One step forecast MAPE: ', (mape(eval_df[eval_df['h'] == 't+1']['prediction'], eval_df[eval_df['h'] == 't+1']['actual']))*100, '%')
    ```

    рдПрдХрд╛ рдкрд╛рдпрд░реАрдЪрд╛ рдЕрдВрджрд╛рдЬ MAPE:  0.5570581332313952 %

1. рдмрд╣реБ-рдкрд╛рдпрд░реА рдЕрдВрджрд╛рдЬрд╛рдЪрд╛ MAPE рдкреНрд░рд┐рдВрдЯ рдХрд░рд╛:

    ```python
    print('Multi-step forecast MAPE: ', mape(eval_df['prediction'], eval_df['actual'])*100, '%')
    ```

    ```output
    Multi-step forecast MAPE:  1.1460048657704118 %
    ```

    рдПрдХ рдЪрд╛рдВрдЧрд▓рд╛ рдХрдореА рдЖрдХрдбрд╛ рд╕рд░реНрд╡реЛрддреНрддрдо рдЖрд╣реЗ: рд╡рд┐рдЪрд╛рд░ рдХрд░рд╛ рдХреА рдЬрд░ рдЕрдВрджрд╛рдЬрд╛рдЪрд╛ MAPE 10 рдЕрд╕реЗрд▓, рддрд░ рддреЛ 10% рдиреЗ рдЪреБрдХреАрдЪрд╛ рдЖрд╣реЗ.

1. рдкрдг рдиреЗрд╣рдореАрдкреНрд░рдорд╛рдгреЗ, рдЕрд╢рд╛ рдкреНрд░рдХрд╛рд░рдЪреЗ рдЕрдЪреВрдХрддрд╛ рдореЛрдЬрдорд╛рдк рджреГрд╢реНрдп рд╕реНрд╡рд░реВрдкрд╛рдд рдкрд╛рд╣рдгреЗ рд╕реЛрдкреЗ рдЕрд╕рддреЗ, рдореНрд╣рдгреВрди рдЪрд▓рд╛ рддреЗ рдкреНрд▓реЙрдЯ рдХрд░реВрдпрд╛:

    ```python
     if(HORIZON == 1):
        ## Plotting single step forecast
        eval_df.plot(x='timestamp', y=['actual', 'prediction'], style=['r', 'b'], figsize=(15, 8))

    else:
        ## Plotting multi step forecast
        plot_df = eval_df[(eval_df.h=='t+1')][['timestamp', 'actual']]
        for t in range(1, HORIZON+1):
            plot_df['t+'+str(t)] = eval_df[(eval_df.h=='t+'+str(t))]['prediction'].values

        fig = plt.figure(figsize=(15, 8))
        ax = plt.plot(plot_df['timestamp'], plot_df['actual'], color='red', linewidth=4.0)
        ax = fig.add_subplot(111)
        for t in range(1, HORIZON+1):
            x = plot_df['timestamp'][(t-1):]
            y = plot_df['t+'+str(t)][0:len(x)]
            ax.plot(x, y, color='blue', linewidth=4*math.pow(.9,t), alpha=math.pow(0.8,t))

        ax.legend(loc='best')

    plt.xlabel('timestamp', fontsize=12)
    plt.ylabel('load', fontsize=12)
    plt.show()
    ```

    ![рдПрдХ рдЯрд╛рдЗрдо рд╕рд┐рд░реАрдЬ рдореЙрдбреЗрд▓](../../../../7-TimeSeries/2-ARIMA/images/accuracy.png)

ЁЯПЖ рдПрдХ рдЕрддрд┐рд╢рдп рдЫрд╛рди рдкреНрд▓реЙрдЯ, рдЬреЛ рдЪрд╛рдВрдЧрд▓реНрдпрд╛ рдЕрдЪреВрдХрддреЗрд╕рд╣ рдореЙрдбреЗрд▓ рджрд░реНрд╢рд╡рддреЛ. рдЦреВрдк рдЫрд╛рди!

---

## ЁЯЪАрдЪреЕрд▓реЗрдВрдЬ

рдЯрд╛рдЗрдо рд╕рд┐рд░реАрдЬ рдореЙрдбреЗрд▓рдЪреА рдЕрдЪреВрдХрддрд╛ рддрдкрд╛рд╕рдгреНрдпрд╛рдЪреЗ рд╡рд┐рд╡рд┐рдз рдорд╛рд░реНрдЧ рд╢реЛрдзрд╛. рдпрд╛ рдзрдбреНрдпрд╛рдд рдЖрдкрдг MAPE рд╡рд░ рдЪрд░реНрдЪрд╛ рдХреЗрд▓реА рдЖрд╣реЗ, рдкрдг рддреБрдореНрд╣реА рд╡рд╛рдкрд░реВ рд╢рдХрдгрд╛рд▒реНрдпрд╛ рдЗрддрд░ рдкрджреНрдзрддреА рдЖрд╣реЗрдд рдХрд╛? рддреНрдпрд╛рдВрдЪрд╛ рд╢реЛрдз рдШреНрдпрд╛ рдЖрдгрд┐ рддреНрдпрд╛рдВрдЪреЗ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░рд╛. рдПрдХ рдЙрдкрдпреБрдХреНрдд рджрд╕реНрддрдРрд╡рдЬ [рдЗрдереЗ](https://otexts.com/fpp2/accuracy.html) рд╕рд╛рдкрдбреВ рд╢рдХрддреЛ.

## [рдкрд╛рдард╛рдирдВрддрд░рдЪрд╛ рдХреНрд╡рд┐рдЭ](https://ff-quizzes.netlify.app/en/ml/)

## рдкреБрдирд░рд╛рд╡рд▓реЛрдХрди рдЖрдгрд┐ рд╕реНрд╡-рдЕрднреНрдпрд╛рд╕

рдпрд╛ рдзрдбреНрдпрд╛рдд ARIMA рд╕рд╣ рдЯрд╛рдЗрдо рд╕рд┐рд░реАрдЬ рдЕрдВрджрд╛рдЬрд╛рдЪреЗ рдлрдХреНрдд рдореВрд▓рднреВрдд рдЧреЛрд╖реНрдЯреАрдВрдЪрд╛ рдЙрд▓реНрд▓реЗрдЦ рдХреЗрд▓рд╛ рдЖрд╣реЗ. [рдпрд╛ рд░рд┐рдкреЙрдЭрд┐рдЯрд░реА](https://microsoft.github.io/forecasting/) рдЖрдгрд┐ рддреНрдпрд╛рддреАрд▓ рд╡рд┐рд╡рд┐рдз рдореЙрдбреЗрд▓ рдкреНрд░рдХрд╛рд░рд╛рдВрдЪрд╛ рдЕрднреНрдпрд╛рд╕ рдХрд░реВрди рдЯрд╛рдЗрдо рд╕рд┐рд░реАрдЬ рдореЙрдбреЗрд▓ рддрдпрд╛рд░ рдХрд░рдгреНрдпрд╛рдЪреЗ рдЗрддрд░ рдорд╛рд░реНрдЧ рд╢рд┐рдХрдгреНрдпрд╛рд╕рд╛рдареА рддреБрдордЪреЗ рдЬреНрдЮрд╛рди рд╡рд╛рдврд╡рд╛.

## рдЕрд╕рд╛рдЗрдирдореЗрдВрдЯ

[рдПрдХ рдирд╡реАрди ARIMA рдореЙрдбреЗрд▓](assignment.md)

---

**рдЕрд╕реНрд╡реАрдХрд░рдг**:  
рд╣рд╛ рджрд╕реНрддрдРрд╡рдЬ AI рднрд╛рд╖рд╛рдВрддрд░ рд╕реЗрд╡рд╛ [Co-op Translator](https://github.com/Azure/co-op-translator) рд╡рд╛рдкрд░реВрди рднрд╛рд╖рд╛рдВрддрд░рд┐рдд рдХрд░рдгреНрдпрд╛рдд рдЖрд▓рд╛ рдЖрд╣реЗ. рдЖрдореНрд╣реА рдЕрдЪреВрдХрддреЗрд╕рд╛рдареА рдкреНрд░рдпрддреНрдирд╢реАрд▓ рдЕрд╕рд▓реЛ рддрд░реА рдХреГрдкрдпрд╛ рд▓рдХреНрд╖рд╛рдд рдареЗрд╡рд╛ рдХреА рд╕реНрд╡рдпрдВрдЪрд▓рд┐рдд рднрд╛рд╖рд╛рдВрддрд░рд╛рдВрдордзреНрдпреЗ рддреНрд░реБрдЯреА рдХрд┐рдВрд╡рд╛ рдЕрдЪреВрдХрддреЗрдЪрд╛ рдЕрднрд╛рд╡ рдЕрд╕реВ рд╢рдХрддреЛ. рдореВрд│ рднрд╛рд╖реЗрддреАрд▓ рджрд╕реНрддрдРрд╡рдЬ рд╣рд╛ рдЕрдзрд┐рдХреГрдд рд╕реНрд░реЛрдд рдорд╛рдирд▓рд╛ рдЬрд╛рд╡рд╛. рдорд╣рддреНрддреНрд╡рд╛рдЪреНрдпрд╛ рдорд╛рд╣рд┐рддреАрд╕рд╛рдареА рд╡реНрдпрд╛рд╡рд╕рд╛рдпрд┐рдХ рдорд╛рдирд╡реА рднрд╛рд╖рд╛рдВрддрд░рд╛рдЪреА рд╢рд┐рдлрд╛рд░рд╕ рдХреЗрд▓реА рдЬрд╛рддреЗ. рдпрд╛ рднрд╛рд╖рд╛рдВрддрд░рд╛рдЪрд╛ рд╡рд╛рдкрд░ рдХрд░реВрди рдирд┐рд░реНрдорд╛рдг рд╣реЛрдгрд╛рд▒реНрдпрд╛ рдХреЛрдгрддреНрдпрд╛рд╣реА рдЧреИрд░рд╕рдордЬ рдХрд┐рдВрд╡рд╛ рдЪреБрдХреАрдЪреНрдпрд╛ рдЕрд░реНрдерд╛рд╕рд╛рдареА рдЖрдореНрд╣реА рдЬрдмрд╛рдмрджрд╛рд░ рд░рд╛рд╣рдгрд╛рд░ рдирд╛рд╣реА.