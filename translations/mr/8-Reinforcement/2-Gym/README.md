<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "9660fbd80845c59c15715cb418cd6e23",
  "translation_date": "2025-08-29T18:14:26+00:00",
  "source_file": "8-Reinforcement/2-Gym/README.md",
  "language_code": "mr"
}
-->
## рдкреВрд░реНрд╡рдЕрдЯ

рдпрд╛ рдзрдбреНрдпрд╛рдд, рдЖрдореНрд╣реА **OpenAI Gym** рдирд╛рд╡рд╛рдЪреНрдпрд╛ рд▓рд╛рдпрдмреНрд░рд░реАрдЪрд╛ рд╡рд╛рдкрд░ рд╡рд┐рд╡рд┐рдз **рдкрд░рд┐рд╕рд░рд╛рдВрдЪреЗ** рдЕрдиреБрдХрд░рдг рдХрд░рдгреНрдпрд╛рд╕рд╛рдареА рдХрд░рдгрд╛рд░ рдЖрд╣реЛрдд. рддреБрдореНрд╣реА рд╣рд╛ рдзрдбрд╛ рд╕реНрдерд╛рдирд┐рдХрд░рд┐рддреНрдпрд╛ (рдЙрджрд╛. Visual Studio Code рдордзреВрди) рдЪрд╛рд▓рд╡реВ рд╢рдХрддрд╛, рдЕрд╢рд╛ рд╡реЗрд│реА рдЕрдиреБрдХрд░рдг рдПрдХрд╛ рдирд╡реАрди рд╡рд┐рдВрдбреЛрдордзреНрдпреЗ рдЙрдШрдбреЗрд▓. рдСрдирд▓рд╛рдЗрди рдХреЛрдб рдЪрд╛рд▓рд╡рддрд╛рдирд╛, рддреБрдореНрд╣рд╛рд▓рд╛ рдХреЛрдбрдордзреНрдпреЗ рдХрд╛рд╣реА рдмрджрд▓ рдХрд░рд╛рд╡реЗ рд▓рд╛рдЧреВ рд╢рдХрддрд╛рдд, рдЬрд╕реЗ [рдпреЗрдереЗ](https://towardsdatascience.com/rendering-openai-gym-envs-on-binder-and-google-colab-536f99391cc7) рд╡рд░реНрдгрди рдХреЗрд▓реЗ рдЖрд╣реЗ.

## OpenAI Gym

рдорд╛рдЧреАрд▓ рдзрдбреНрдпрд╛рдд, рдЦреЗрд│рд╛рдЪреЗ рдирд┐рдпрдо рдЖрдгрд┐ рд╕реНрдерд┐рддреА рдЖрдореНрд╣реА рд╕реНрд╡рддрдГ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХреЗрд▓реЗрд▓реНрдпрд╛ `Board` рд╡рд░реНрдЧрд╛рджреНрд╡рд╛рд░реЗ рджрд┐рд▓реЗ рд╣реЛрддреЗ. рдпреЗрдереЗ рдЖрдореНрд╣реА рдПрдХ рд╡рд┐рд╢реЗрд╖ **рдЕрдиреБрдХрд░рдг рд╡рд╛рддрд╛рд╡рд░рдг** рд╡рд╛рдкрд░рдгрд╛рд░ рдЖрд╣реЛрдд, рдЬреЗ рд╕рдВрддреБрд▓рди рд░рд╛рдЦрдгрд╛рд▒реНрдпрд╛ рдЦрд╛рдВрдмрд╛рдЪреНрдпрд╛ рднреМрддрд┐рдХрд╢рд╛рд╕реНрддреНрд░рд╛рдЪреЗ рдЕрдиреБрдХрд░рдг рдХрд░реЗрд▓. reinforcement learning рдЕрд▓реНрдЧреЛрд░рд┐рджрдо рдкреНрд░рд╢рд┐рдХреНрд╖рдгрд╛рд╕рд╛рдареА рд╕рд░реНрд╡рд╛рдд рд▓реЛрдХрдкреНрд░рд┐рдп рдЕрдиреБрдХрд░рдг рд╡рд╛рддрд╛рд╡рд░рдгрд╛рдВрдкреИрдХреА рдПрдХ [Gym](https://gym.openai.com/) рдЖрд╣реЗ, рдЬреНрдпрд╛рдЪреЗ рд╡реНрдпрд╡рд╕реНрдерд╛рдкрди [OpenAI](https://openai.com/) рдХрд░рддреЗ. рдпрд╛ рдЬрд┐рдордЪрд╛ рд╡рд╛рдкрд░ рдХрд░реВрди рдЖрдореНрд╣реА cartpole рдЕрдиреБрдХрд░рдгрд╛рдкрд╛рд╕реВрди Atari рдЧреЗрдореНрд╕рдкрд░реНрдпрдВрдд рд╡рд┐рд╡рд┐рдз **рдкрд░рд┐рд╕рд░** рддрдпрд╛рд░ рдХрд░реВ рд╢рдХрддреЛ.

> **рдЯреАрдк**: OpenAI Gym рдордзреАрд▓ рдЗрддрд░ рдЙрдкрд▓рдмреНрдз рд╡рд╛рддрд╛рд╡рд░рдг рддреБрдореНрд╣реА [рдпреЗрдереЗ](https://gym.openai.com/envs/#classic_control) рдкрд╛рд╣реВ рд╢рдХрддрд╛.

рд╕реБрд░реБрд╡рд╛рддреАрд▓рд╛, рдЬрд┐рдо рд╕реНрдерд╛рдкрд┐рдд рдХрд░реВрдпрд╛ рдЖрдгрд┐ рдЖрд╡рд╢реНрдпрдХ рд▓рд╛рдпрдмреНрд░рд░реА рдЖрдпрд╛рдд рдХрд░реВрдпрд╛ (рдХреЛрдб рдмреНрд▓реЙрдХ 1):

```python
import sys
!{sys.executable} -m pip install gym 

import gym
import matplotlib.pyplot as plt
import numpy as np
import random
```

## рд╡реНрдпрд╛рдпрд╛рдо - cartpole рд╡рд╛рддрд╛рд╡рд░рдг рдкреНрд░рд╛рд░рдВрдн рдХрд░рд╛

cartpole рд╕рдВрддреБрд▓рди рд╕рдорд╕реНрдпреЗрд╕рд╛рдареА рдХрд╛рдо рдХрд░рдгреНрдпрд╛рд╕рд╛рдареА, рдЖрдкрд▓реНрдпрд╛рд▓рд╛ рд╕рдВрдмрдВрдзрд┐рдд рд╡рд╛рддрд╛рд╡рд░рдг рдкреНрд░рд╛рд░рдВрдн рдХрд░рдгреЗ рдЖрд╡рд╢реНрдпрдХ рдЖрд╣реЗ. рдкреНрд░рддреНрдпреЗрдХ рд╡рд╛рддрд╛рд╡рд░рдгрд╛рд╢реА рд╕рдВрдмрдВрдзрд┐рдд рдЕрд╕рддреЗ:

- **Observation space** рдЬреЗ рд╡рд╛рддрд╛рд╡рд░рдгрд╛рдХрдбреВрди рдорд┐рд│рдгрд╛рд▒реНрдпрд╛ рдорд╛рд╣рд┐рддреАрдЪреА рд░рдЪрдирд╛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рддреЗ. cartpole рд╕рдорд╕реНрдпреЗрд╕рд╛рдареА, рдЖрдкрд▓реНрдпрд╛рд▓рд╛ рдЦрд╛рдВрдмрд╛рдЪреА рд╕реНрдерд┐рддреА, рд╡реЗрдЧ рдЖрдгрд┐ рдЗрддрд░ рдХрд╛рд╣реА рдореВрд▓реНрдпреЗ рдорд┐рд│рддрд╛рдд.

- **Action space** рдЬреЗ рд╕рдВрднрд╛рд╡реНрдп рдХреНрд░рд┐рдпрд╛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рддреЗ. рдЖрдкрд▓реНрдпрд╛ рдкреНрд░рдХрд░рдгрд╛рдд action space discrete рдЖрд╣реЗ рдЖрдгрд┐ рджреЛрди рдХреНрд░рд┐рдпрд╛ рдЖрд╣реЗрдд - **рдбрд╛рд╡реАрдХрдбреЗ** рдЖрдгрд┐ **рдЙрдЬрд╡реАрдХрдбреЗ**. (рдХреЛрдб рдмреНрд▓реЙрдХ 2)

1. рдкреНрд░рд╛рд░рдВрдн рдХрд░рдгреНрдпрд╛рд╕рд╛рдареА, рдЦрд╛рд▓реАрд▓ рдХреЛрдб рдЯрд╛рдЗрдк рдХрд░рд╛:

    ```python
    env = gym.make("CartPole-v1")
    print(env.action_space)
    print(env.observation_space)
    print(env.action_space.sample())
    ```

рд╡рд╛рддрд╛рд╡рд░рдг рдХрд╕реЗ рдХрд╛рд░реНрдп рдХрд░рддреЗ рд╣реЗ рдкрд╛рд╣рдгреНрдпрд╛рд╕рд╛рдареА, 100 рдЯрдкреНрдкреНрдпрд╛рдВрд╕рд╛рдареА рдПрдХ рд▓рд╣рд╛рди рдЕрдиреБрдХрд░рдг рдЪрд╛рд▓рд╡реВрдпрд╛. рдкреНрд░рддреНрдпреЗрдХ рдЯрдкреНрдкреНрдпрд╛рд╡рд░, рдЖрдореНрд╣реА рдШреЗрдгреНрдпрд╛рдЪреА рдХреНрд░рд┐рдпрд╛ рдкреНрд░рджрд╛рди рдХрд░рддреЛ - рдпрд╛ рдЕрдиреБрдХрд░рдгрд╛рдд рдЖрдореНрд╣реА `action_space` рдордзреВрди рдпрд╛рджреГрдЪреНрдЫрд┐рдХрдкрдгреЗ рдПрдХ рдХреНрд░рд┐рдпрд╛ рдирд┐рд╡рдбрддреЛ.

1. рдЦрд╛рд▓реАрд▓ рдХреЛрдб рдЪрд╛рд▓рд╡рд╛ рдЖрдгрд┐ рддреНрдпрд╛рдЪрд╛ рдкрд░рд┐рдгрд╛рдо рдкрд╣рд╛.

    тЬЕ рд▓рдХреНрд╖рд╛рдд рдареЗрд╡рд╛ рдХреА рд╣рд╛ рдХреЛрдб рд╕реНрдерд╛рдирд┐рдХ Python рдЗрдВрд╕реНрдЯреЙрд▓реЗрд╢рдирд╡рд░ рдЪрд╛рд▓рд╡рдгреЗ рдЕрдзрд┐рдХ рдпреЛрдЧреНрдп рдЖрд╣реЗ! (рдХреЛрдб рдмреНрд▓реЙрдХ 3)

    ```python
    env.reset()
    
    for i in range(100):
       env.render()
       env.step(env.action_space.sample())
    env.close()
    ```

    рддреБрдореНрд╣рд╛рд▓рд╛ рдЦрд╛рд▓реАрд▓ рдкреНрд░рддрд┐рдореЗрд╕рд╛рд░рдЦреЗ рдХрд╛рд╣реАрддрд░реА рджрд┐рд╕реЗрд▓:

    ![non-balancing cartpole](../../../../8-Reinforcement/2-Gym/images/cartpole-nobalance.gif)

1. рдЕрдиреБрдХрд░рдгрд╛рджрд░рдореНрдпрд╛рди, рдЖрдкрд▓реНрдпрд╛рд▓рд╛ рдХрд╕реЗ рдХрд╛рд░реНрдп рдХрд░рд╛рд╡реЗ рд╣реЗ рдард░рд╡рдгреНрдпрд╛рд╕рд╛рдареА рдирд┐рд░реАрдХреНрд╖рдгреЗ рдорд┐рд│рд╡рдгреЗ рдЖрд╡рд╢реНрдпрдХ рдЖрд╣реЗ. рдкреНрд░рддреНрдпрдХреНрд╖рд╛рдд, step рдлрдВрдХреНрд╢рди рд╡рд░реНрддрдорд╛рди рдирд┐рд░реАрдХреНрд╖рдгреЗ, рдПрдХ reward рдлрдВрдХреНрд╢рди, рдЖрдгрд┐ done рдлреНрд▓реЕрдЧ рдкрд░рдд рдХрд░рддреЗ, рдЬреЗ рдЕрдиреБрдХрд░рдг рд╕реБрд░реВ рдареЗрд╡рдгреНрдпрд╛рд╕рд╛рд░рдЦреЗ рдЖрд╣реЗ рдХреА рдирд╛рд╣реА рд╣реЗ рд╕реВрдЪрд┐рдд рдХрд░рддреЗ: (рдХреЛрдб рдмреНрд▓реЙрдХ 4)

    ```python
    env.reset()
    
    done = False
    while not done:
       env.render()
       obs, rew, done, info = env.step(env.action_space.sample())
       print(f"{obs} -> {rew}")
    env.close()
    ```

    рддреБрдореНрд╣рд╛рд▓рд╛ рдиреЛрдЯрдмреБрдХ рдЖрдЙрдЯрдкреБрдЯрдордзреНрдпреЗ рдЦрд╛рд▓реАрд▓рдкреНрд░рдорд╛рдгреЗ рдХрд╛рд╣реАрддрд░реА рджрд┐рд╕реЗрд▓:

    ```text
    [ 0.03403272 -0.24301182  0.02669811  0.2895829 ] -> 1.0
    [ 0.02917248 -0.04828055  0.03248977  0.00543839] -> 1.0
    [ 0.02820687  0.14636075  0.03259854 -0.27681916] -> 1.0
    [ 0.03113408  0.34100283  0.02706215 -0.55904489] -> 1.0
    [ 0.03795414  0.53573468  0.01588125 -0.84308041] -> 1.0
    ...
    [ 0.17299878  0.15868546 -0.20754175 -0.55975453] -> 1.0
    [ 0.17617249  0.35602306 -0.21873684 -0.90998894] -> 1.0
    ```

    рдЕрдиреБрдХрд░рдгрд╛рдЪреНрдпрд╛ рдкреНрд░рддреНрдпреЗрдХ рдЯрдкреНрдкреНрдпрд╛рд╡рд░ рдкрд░рдд рдХреЗрд▓реЗрд▓рд╛ observation vector рдЦрд╛рд▓реАрд▓ рдореВрд▓реНрдпреЗ рд╕рдорд╛рд╡рд┐рд╖реНрдЯ рдХрд░рддреЛ:
    - рдЧрд╛рдбреАрдЪреА рд╕реНрдерд┐рддреА
    - рдЧрд╛рдбреАрдЪрд╛ рд╡реЗрдЧ
    - рдЦрд╛рдВрдмрд╛рдЪрд╛ рдХреЛрди
    - рдЦрд╛рдВрдмрд╛рдЪрд╛ рдлрд┐рд░рдгреНрдпрд╛рдЪрд╛ рджрд░

1. рддреНрдпрд╛ рд╕рдВрдЦреНрдпрд╛рдВрдЪреЗ рдХрд┐рдорд╛рди рдЖрдгрд┐ рдЬрд╛рд╕реНрддреАрдд рдЬрд╛рд╕реНрдд рдореВрд▓реНрдп рдорд┐рд│рд╡рд╛: (рдХреЛрдб рдмреНрд▓реЙрдХ 5)

    ```python
    print(env.observation_space.low)
    print(env.observation_space.high)
    ```

    рддреБрдореНрд╣реА рд╣реЗ рджреЗрдЦреАрд▓ рд▓рдХреНрд╖рд╛рдд рдШреЗрдК рд╢рдХрддрд╛ рдХреА рдкреНрд░рддреНрдпреЗрдХ рдЕрдиреБрдХрд░рдг рдЯрдкреНрдкреНрдпрд╛рд╡рд░ reward рдореВрд▓реНрдп рдиреЗрд╣рдореА 1 рдЕрд╕рддреЗ. рдХрд╛рд░рдг рдЖрдкрд▓реЗ рдзреНрдпреЗрдп рд╢рдХреНрдп рддрд┐рддрдХреНрдпрд╛ рд╡реЗрд│рд╛ рдЯрд┐рдХреВрди рд░рд╛рд╣рдгреЗ рдЖрд╣реЗ, рдореНрд╣рдгрдЬреЗ рдЦрд╛рдВрдмрд╛рд▓рд╛ рд╢рдХреНрдп рддрд┐рддрдХреНрдпрд╛ рд╡реЗрд│реЗрд╕ рд╕рд░рд│ рд╕реНрдерд┐рддреАрдд рдареЗрд╡рдгреЗ.

    тЬЕ рдкреНрд░рддреНрдпрдХреНрд╖рд╛рдд, CartPole рдЕрдиреБрдХрд░рдг рд╕реЛрдбрд╡рд▓реЗ рдЬрд╛рддреЗ рдЬрд░ рдЖрдкрдг 100 рд╕рд▓рдЧ рдЪрд╛рдЪрдгреНрдпрд╛рдВрдордзреНрдпреЗ рд╕рд░рд╛рд╕рд░реА 195 reward рдорд┐рд│рд╡реВ рд╢рдХрд▓реЛ.

## рд╕реНрдерд┐рддреАрдЪреЗ discretization

Q-Learning рдордзреНрдпреЗ, рдЖрдкрд▓реНрдпрд╛рд▓рд╛ Q-Table рддрдпрд╛рд░ рдХрд░рдгреЗ рдЖрд╡рд╢реНрдпрдХ рдЖрд╣реЗ рдЬреЗ рдкреНрд░рддреНрдпреЗрдХ рд╕реНрдерд┐рддреАрдд рдХрд╛рдп рдХрд░рд╛рд╡реЗ рд╣реЗ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рддреЗ. рд╣реЗ рдХрд░рдгреНрдпрд╛рд╕рд╛рдареА, рд╕реНрдерд┐рддреА **discreet** рдЕрд╕рдгреЗ рдЖрд╡рд╢реНрдпрдХ рдЖрд╣реЗ, рдЕрдзрд┐рдХ рд╕реНрдкрд╖реНрдЯрдкрдгреЗ, рддреНрдпрд╛рдд рдорд░реНрдпрд╛рджрд┐рдд рд╕рдВрдЦреНрдпреЗрдиреЗ discrete рдореВрд▓реНрдпреЗ рдЕрд╕рд╛рд╡реАрдд. рдореНрд╣рдгреВрди, рдЖрдкрд▓реНрдпрд╛рд▓рд╛ рдХрд╛рд╣реАрддрд░реА рдХрд░реВрди рдЖрдкрд▓реА рдирд┐рд░реАрдХреНрд╖рдгреЗ **discretize** рдХрд░рдгреЗ рдЖрд╡рд╢реНрдпрдХ рдЖрд╣реЗ, рддреНрдпрд╛рдВрдирд╛ рдорд░реНрдпрд╛рджрд┐рдд рд╕реНрдерд┐рддреАрдВрдЪреНрдпрд╛ рд╕рдВрдЪрд╛рд╢реА рдирдХрд╛рд╢рд┐рдд рдХрд░рдгреЗ.

рд╣реЗ рдХрд░рдгреНрдпрд╛рдЪреЗ рдХрд╛рд╣реА рдорд╛рд░реНрдЧ рдЖрд╣реЗрдд:

- **Bins рдордзреНрдпреЗ рд╡рд┐рднрд╛рдЧрдгреЗ**. рдЬрд░ рдЖрдкрд▓реНрдпрд╛рд▓рд╛ рдПрдЦрд╛рджреНрдпрд╛ рдореВрд▓реНрдпрд╛рдЪрд╛ рдЕрдВрддрд░рд╛рд▓ рдорд╛рд╣рд┐рдд рдЕрд╕реЗрд▓, рддрд░ рдЖрдкрдг рдпрд╛ рдЕрдВрддрд░рд╛рд▓рд╛рд▓рд╛ **bins** рдордзреНрдпреЗ рд╡рд┐рднрд╛рдЧреВ рд╢рдХрддреЛ рдЖрдгрд┐ рдирдВрддрд░ рдореВрд▓реНрдп рдмрджрд▓реВрди рддреНрдпрд╛рдЪреНрдпрд╛ bin рдХреНрд░рдорд╛рдВрдХрд╛рдиреЗ рдмрджрд▓реВ рд╢рдХрддреЛ. рд╣реЗ numpy рдЪреНрдпрд╛ [`digitize`](https://numpy.org/doc/stable/reference/generated/numpy.digitize.html) рдкрджреНрдзрддреАрдЪрд╛ рд╡рд╛рдкрд░ рдХрд░реВрди рдХреЗрд▓реЗ рдЬрд╛рдК рд╢рдХрддреЗ. рдпрд╛ рдкреНрд░рдХрд░рдгрд╛рдд, рдЖрдкрд▓реНрдпрд╛рд▓рд╛ рд╕реНрдерд┐рддреАрдЪрд╛ рдЖрдХрд╛рд░ рдЕрдЪреВрдХрдкрдгреЗ рдорд╛рд╣рд┐рдд рдЕрд╕реЗрд▓, рдХрд╛рд░рдг рддреЛ рдбрд┐рдЬрд┐рдЯрд▓рд╛рдпрдЭреЗрд╢рдирд╕рд╛рдареА рдирд┐рд╡рдбрд▓реЗрд▓реНрдпрд╛ bins рдЪреНрдпрд╛ рд╕рдВрдЦреНрдпреЗрд╡рд░ рдЕрд╡рд▓рдВрдмреВрди рдЕрд╕реЗрд▓.

тЬЕ рдЖрдкрдг linear interpolation рд╡рд╛рдкрд░реВрди рдореВрд▓реНрдпреЗ рдХрд╛рд╣реА рдорд░реНрдпрд╛рджрд┐рдд рдЕрдВрддрд░рд╛рд▓рд╛рдд (рдЙрджрд╛. -20 рддреЗ 20) рдЖрдгреВ рд╢рдХрддреЛ рдЖрдгрд┐ рдирдВрддрд░ rounding рдХрд░реВрди рд╕рдВрдЦреНрдпрд╛рдВрдирд╛ integers рдордзреНрдпреЗ рд░реВрдкрд╛рдВрддрд░рд┐рдд рдХрд░реВ рд╢рдХрддреЛ. рдпрд╛рдореБрд│реЗ рд╕реНрдерд┐рддреАрдЪреНрдпрд╛ рдЖрдХрд╛рд░рд╛рд╡рд░ рдереЛрдбреЗрд╕реЗ рдирд┐рдпрдВрддреНрд░рдг рдорд┐рд│рддреЗ, рд╡рд┐рд╢реЗрд╖рддрдГ рдЬрд░ рдЖрдкрд▓реНрдпрд╛рд▓рд╛ рдЗрдирдкреБрдЯ рдореВрд▓реНрдпрд╛рдВрдЪреНрдпрд╛ рдЕрдЪреВрдХ рд╢реНрд░реЗрдгреА рдорд╛рд╣рд┐рдд рдирд╕рддреАрд▓. рдЙрджрд╛рд╣рд░рдгрд╛рд░реНрде, рдЖрдкрд▓реНрдпрд╛ рдкреНрд░рдХрд░рдгрд╛рдд 4 рдкреИрдХреА 2 рдореВрд▓реНрдпреЗ рддреНрдпрд╛рдВрдЪреНрдпрд╛ рд╡рд░рдЪреНрдпрд╛/рдЦрд╛рд▓рдЪреНрдпрд╛ рдорд░реНрдпрд╛рджрд╛рдВрд╡рд░ рдорд░реНрдпрд╛рджрд┐рдд рдирд╛рд╣реАрдд, рдЬреНрдпрд╛рдореБрд│реЗ рд╕реНрдерд┐рддреАрдВрдЪреА рдЕрдорд░реНрдпрд╛рджрд┐рдд рд╕рдВрдЦреНрдпрд╛ рд╣реЛрдК рд╢рдХрддреЗ.

рдЖрдкрд▓реНрдпрд╛ рдЙрджрд╛рд╣рд░рдгрд╛рдд, рдЖрдкрдг рджреБрд╕рд▒реНрдпрд╛ рджреГрд╖реНрдЯрд┐рдХреЛрдирд╛рдЪрд╛ рдЕрд╡рд▓рдВрдм рдХрд░реВ. рддреБрдореНрд╣реА рдирдВрддрд░ рд▓рдХреНрд╖рд╛рдд рдШреЗрдК рд╢рдХрддрд╛ рдХреА рдЕрдкрд░рд┐рднрд╛рд╖рд┐рдд рд╡рд░рдЪреНрдпрд╛/рдЦрд╛рд▓рдЪреНрдпрд╛ рдорд░реНрдпрд╛рджрд╛рдВрдирдВрддрд░рд╣реА, рддреА рдореВрд▓реНрдпреЗ рдХреНрд╡рдЪрд┐рддрдЪ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдорд░реНрдпрд╛рджрд┐рдд рдЕрдВрддрд░рд╛рд▓рд╛рдЪреНрдпрд╛ рдмрд╛рд╣реЗрд░ рдЬрд╛рддрд╛рдд, рддреНрдпрд╛рдореБрд│реЗ рддреА рд╕реНрдерд┐рддреА рдЬреНрдпрд╛рдВрдЪреЗ рдореВрд▓реНрдп рдЕрддреНрдпрдВрдд рдЖрд╣реЗ рддреЗ рдлрд╛рд░рдЪ рджреБрд░реНрдорд┐рд│ рдЕрд╕рддреАрд▓.

1. рдпреЗрдереЗ рдПрдХ рдлрдВрдХреНрд╢рди рдЖрд╣реЗ рдЬреЗ рдЖрдкрд▓реНрдпрд╛ рдореЙрдбреЗрд▓рдХрдбреВрди рдирд┐рд░реАрдХреНрд╖рдг рдШреЗрдИрд▓ рдЖрдгрд┐ 4 integer рдореВрд▓реНрдпрд╛рдВрдЪреНрдпрд╛ tuple рддрдпрд╛рд░ рдХрд░реЗрд▓: (рдХреЛрдб рдмреНрд▓реЙрдХ 6)

    ```python
    def discretize(x):
        return tuple((x/np.array([0.25, 0.25, 0.01, 0.1])).astype(np.int))
    ```

1. рдЪрд▓рд╛ bins рд╡рд╛рдкрд░реВрди рджреБрд╕рд▒реНрдпрд╛ discretization рдкрджреНрдзрддреАрдЪрд╛ рд╢реЛрдз рдШреЗрдКрдпрд╛: (рдХреЛрдб рдмреНрд▓реЙрдХ 7)

    ```python
    def create_bins(i,num):
        return np.arange(num+1)*(i[1]-i[0])/num+i[0]
    
    print("Sample bins for interval (-5,5) with 10 bins\n",create_bins((-5,5),10))
    
    ints = [(-5,5),(-2,2),(-0.5,0.5),(-2,2)] # intervals of values for each parameter
    nbins = [20,20,10,10] # number of bins for each parameter
    bins = [create_bins(ints[i],nbins[i]) for i in range(4)]
    
    def discretize_bins(x):
        return tuple(np.digitize(x[i],bins[i]) for i in range(4))
    ```

1. рдЖрддрд╛ рдПрдХ рд▓рд╣рд╛рди рдЕрдиреБрдХрд░рдг рдЪрд╛рд▓рд╡реВрдпрд╛ рдЖрдгрд┐ рддреНрдпрд╛ discrete рд╡рд╛рддрд╛рд╡рд░рдг рдореВрд▓реНрдпрд╛рдВрдЪреЗ рдирд┐рд░реАрдХреНрд╖рдг рдХрд░реВрдпрд╛. `discretize` рдЖрдгрд┐ `discretize_bins` рджреЛрдиреНрд╣реА рд╡рд╛рдкрд░реВрди рдкрд╣рд╛ рдЖрдгрд┐ рдХрд╛рд╣реА рдлрд░рдХ рдЖрд╣реЗ рдХрд╛ рддреЗ рдкрд╣рд╛.

    тЬЕ `discretize_bins` bin рдХреНрд░рдорд╛рдВрдХ рдкрд░рдд рдХрд░рддреЗ, рдЬреЗ 0-рдЖрдзрд╛рд░рд┐рдд рдЕрд╕рддреЗ. рддреНрдпрд╛рдореБрд│реЗ рдЗрдирдкреБрдЯ рд╡реНрд╣реЗрд░рд┐рдПрдмрд▓рдЪреНрдпрд╛ 0 рдЪреНрдпрд╛ рдЖрд╕рдкрд╛рд╕рдЪреНрдпрд╛ рдореВрд▓реНрдпрд╛рдВрд╕рд╛рдареА рддреЗ рдЕрдВрддрд░рд╛рд▓рд╛рдЪреНрдпрд╛ рдордзреНрдпрднрд╛рдЧреА рдЕрд╕рд▓реЗрд▓реНрдпрд╛ рдХреНрд░рдорд╛рдВрдХ (10) рдкрд░рдд рдХрд░рддреЗ. `discretize` рдордзреНрдпреЗ, рдЖрдореНрд╣реА рдЖрдЙрдЯрдкреБрдЯ рдореВрд▓реНрдпрд╛рдВрдЪреНрдпрд╛ рд╢реНрд░реЗрдгреАрдЪреА рдХрд╛рд│рдЬреА рдШреЗрддрд▓реА рдирд╛рд╣реА, рддреНрдпрд╛рдВрдирд╛ рдирдХрд╛рд░рд╛рддреНрдордХ рд╣реЛрдК рджрд┐рд▓реЗ, рддреНрдпрд╛рдореБрд│реЗ рд╕реНрдерд┐рддреА рдореВрд▓реНрдпреЗ shift рдЭрд╛рд▓реА рдирд╛рд╣реАрдд рдЖрдгрд┐ 0 рдореНрд╣рдгрдЬреЗ 0 рдЖрд╣реЗ. (рдХреЛрдб рдмреНрд▓реЙрдХ 8)

    ```python
    env.reset()
    
    done = False
    while not done:
       #env.render()
       obs, rew, done, info = env.step(env.action_space.sample())
       #print(discretize_bins(obs))
       print(discretize(obs))
    env.close()
    ```

    тЬЕ `env.render` рд╕реБрд░реВ рдЕрд╕рд▓реЗрд▓реА рдУрд│ uncomment рдХрд░рд╛ рдЬрд░ рддреБрдореНрд╣рд╛рд▓рд╛ рд╡рд╛рддрд╛рд╡рд░рдг рдХрд╕реЗ рдХрд╛рд░реНрдп рдХрд░рддреЗ рддреЗ рдкрд╛рд╣рд╛рдпрдЪреЗ рдЕрд╕реЗрд▓. рдЕрдиреНрдпрдерд╛ рддреБрдореНрд╣реА рддреЗ background рдордзреНрдпреЗ рдЪрд╛рд▓рд╡реВ рд╢рдХрддрд╛, рдЬреЗ рдЬрд▓рдж рдЖрд╣реЗ. рдЖрдореНрд╣реА Q-Learning рдкреНрд░рдХреНрд░рд┐рдпреЗрджрд░рдореНрдпрд╛рди рд╣реЗ "рдЕрджреГрд╢реНрдп" рдХрд╛рд░реНрдп рд╡рд╛рдкрд░рдгрд╛рд░ рдЖрд╣реЛрдд.

## Q-Table рдЪреА рд░рдЪрдирд╛

рдорд╛рдЧреАрд▓ рдзрдбреНрдпрд╛рдд, рд╕реНрдерд┐рддреА 0 рддреЗ 8 рдкрд░реНрдпрдВрддрдЪреНрдпрд╛ рд╕рдВрдЦреНрдпрд╛рдВрдЪреНрдпрд╛ рд╕рд╛рдзреНрдпрд╛ рдЬреЛрдбреНрдпрд╛ рд╣реЛрддреА, рддреНрдпрд╛рдореБрд│реЗ Q-Table рд▓рд╛ numpy tensor рджреНрд╡рд╛рд░реЗ 8x8x2 рдЖрдХрд╛рд░рд╛рдиреЗ рджрд░реНрд╢рд╡рдгреЗ рд╕реЛрдпреАрдЪреЗ рд╣реЛрддреЗ. рдЬрд░ рдЖрдкрдг bins discretization рд╡рд╛рдкрд░рддреЛ, рддрд░ рдЖрдкрд▓реНрдпрд╛ рд╕реНрдерд┐рддреА рд╡реНрд╣реЗрдХреНрдЯрд░рдЪрд╛ рдЖрдХрд╛рд░ рджреЗрдЦреАрд▓ рдорд╛рд╣рд┐рдд рдЖрд╣реЗ, рддреНрдпрд╛рдореБрд│реЗ рдЖрдкрдг рд╕рдорд╛рди рджреГрд╖реНрдЯрд┐рдХреЛрди рд╡рд╛рдкрд░реВ рд╢рдХрддреЛ рдЖрдгрд┐ рд╕реНрдерд┐рддреАрд▓рд╛ 20x20x10x10x2 рдЖрдХрд╛рд░рд╛рдЪреНрдпрд╛ array рдиреЗ рджрд░реНрд╢рд╡реВ рд╢рдХрддреЛ (рдпреЗрдереЗ 2 рдореНрд╣рдгрдЬреЗ action space рдЪреЗ рдкрд░рд┐рдорд╛рдг рдЖрд╣реЗ, рдЖрдгрд┐ рдкрд╣рд┐рд▓реА рдкрд░рд┐рдорд╛рдгреЗ observation space рдордзреАрд▓ рдкреНрд░рддреНрдпреЗрдХ рдкреЕрд░рд╛рдореАрдЯрд░рд╕рд╛рдареА рдирд┐рд╡рдбрд▓реЗрд▓реНрдпрд╛ bins рдЪреНрдпрд╛ рд╕рдВрдЦреНрдпреЗрд╢реА рд╕рдВрдмрдВрдзрд┐рдд рдЖрд╣реЗрдд).

рддрдерд╛рдкрд┐, рдХрдзреАрдХрдзреА observation space рдЪреНрдпрд╛ рдЕрдЪреВрдХ рдкрд░рд┐рдорд╛рдгреЗ рдорд╛рд╣рд┐рдд рдирд╕рддрд╛рдд. `discretize` рдлрдВрдХреНрд╢рдирдЪреНрдпрд╛ рдмрд╛рдмрддреАрдд, рдЖрдкрд▓реА рд╕реНрдерд┐рддреА рд╡рд┐рд╢рд┐рд╖реНрдЯ рдорд░реНрдпрд╛рджреЗрдд рд░рд╛рд╣рддреЗ рдпрд╛рдЪреА рдЖрдкрд▓реНрдпрд╛рд▓рд╛ рдХрдзреАрд╣реА рдЦрд╛рддреНрд░реА рдирд╕рддреЗ, рдХрд╛рд░рдг рдХрд╛рд╣реА рдореВрд│ рдореВрд▓реНрдпреЗ рдорд░реНрдпрд╛рджрд┐рдд рдирд╛рд╣реАрдд. рддреНрдпрд╛рдореБрд│реЗ, рдЖрдореНрд╣реА рдереЛрдбрд╛ рд╡реЗрдЧрд│рд╛ рджреГрд╖реНрдЯрд┐рдХреЛрди рд╡рд╛рдкрд░рдгрд╛рд░ рдЖрд╣реЛрдд рдЖрдгрд┐ Q-Table рд▓рд╛ dictionary рджреНрд╡рд╛рд░реЗ рджрд░реНрд╢рд╡рдгрд╛рд░ рдЖрд╣реЛрдд.

1. *(state,action)* рдЬреЛрдбреНрдпрд╛рдЪрд╛ dictionary key рдореНрд╣рдгреВрди рд╡рд╛рдкрд░ рдХрд░рд╛, рдЖрдгрд┐ value Q-Table entry value рд╢реА рд╕рдВрдмрдВрдзрд┐рдд рдЕрд╕реЗрд▓. (рдХреЛрдб рдмреНрд▓реЙрдХ 9)

    ```python
    Q = {}
    actions = (0,1)
    
    def qvalues(state):
        return [Q.get((state,a),0) for a in actions]
    ```

    рдпреЗрдереЗ рдЖрдореНрд╣реА `qvalues()` рдирд╛рд╡рд╛рдЪреЗ рдлрдВрдХреНрд╢рди рджреЗрдЦреАрд▓ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рддреЛ, рдЬреЗ рджрд┐рд▓реЗрд▓реНрдпрд╛ рд╕реНрдерд┐рддреАрд╕рд╛рдареА Q-Table рдореВрд▓реНрдпрд╛рдВрдЪреА рдпрд╛рджреА рдкрд░рдд рдХрд░рддреЗ рдЬреА рд╕рд░реНрд╡ рд╕рдВрднрд╛рд╡реНрдп рдХреНрд░рд┐рдпрд╛рдВрд╢реА рд╕рдВрдмрдВрдзрд┐рдд рдЕрд╕рддреЗ. рдЬрд░ entry Q-Table рдордзреНрдпреЗ рдЙрдкрд╕реНрдерд┐рдд рдирд╕реЗрд▓, рддрд░ рдЖрдореНрд╣реА default рдореНрд╣рдгреВрди 0 рдкрд░рдд рдХрд░реВ.

## рдЪрд▓рд╛ Q-Learning рд╕реБрд░реВ рдХрд░реВрдпрд╛

рдЖрддрд╛ рдкреАрдЯрд░рд▓рд╛ рд╕рдВрддреБрд▓рди рд╢рд┐рдХрд╡рдгреНрдпрд╛рд╕рд╛рдареА рддрдпрд╛рд░ рдЖрд╣реЛрдд!

1. рдкреНрд░рдердо, рдХрд╛рд╣реА hyperparameters рд╕реЗрдЯ рдХрд░реВрдпрд╛: (рдХреЛрдб рдмреНрд▓реЙрдХ 10)

    ```python
    # hyperparameters
    alpha = 0.3
    gamma = 0.9
    epsilon = 0.90
    ```

    рдпреЗрдереЗ, `alpha` рдореНрд╣рдгрдЬреЗ **learning rate** рдЬреЗ рдкреНрд░рддреНрдпреЗрдХ рдЯрдкреНрдкреНрдпрд╛рд╡рд░ Q-Table рдЪреНрдпрд╛ рд╡рд░реНрддрдорд╛рди рдореВрд▓реНрдпреЗ рдХрд┐рддреА рдкреНрд░рдорд╛рдгрд╛рдд adjust рдХрд░рд╛рд╡реА рд╣реЗ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рддреЗ. рдорд╛рдЧреАрд▓ рдзрдбреНрдпрд╛рдд рдЖрдореНрд╣реА 1 рдиреЗ рд╕реБрд░реБрд╡рд╛рдд рдХреЗрд▓реА рдЖрдгрд┐ рдирдВрддрд░ рдкреНрд░рд╢рд┐рдХреНрд╖рдгрд╛рджрд░рдореНрдпрд╛рди `alpha` рдХрдореА рдХреЗрд▓реЗ. рдпрд╛ рдЙрджрд╛рд╣рд░рдгрд╛рдд рдЖрдкрдг рд╕реЛрдкреЗрдкрдгрд╛рд╕рд╛рдареА рддреЗ рд╕реНрдерд┐рд░ рдареЗрд╡рдгрд╛рд░ рдЖрд╣реЛрдд, рдЖрдгрд┐ рддреБрдореНрд╣реА рдирдВрддрд░ `alpha` рдореВрд▓реНрдпреЗ adjust рдХрд░рдгреНрдпрд╛рдЪрд╛ рдкреНрд░рдпреЛрдЧ рдХрд░реВ рд╢рдХрддрд╛.

    `gamma` рдореНрд╣рдгрдЬреЗ **discount factor** рдЬреЗ рднрд╡рд┐рд╖реНрдпрд╛рдЪреНрдпрд╛ reward рд▓рд╛ рд╡рд░реНрддрдорд╛рди reward рд╡рд░ рдХрд┐рддреА рдкреНрд░рдорд╛рдгрд╛рдд рдкреНрд░рд╛рдзрд╛рдиреНрдп рджреНрдпрд╛рд╡реЗ рд╣реЗ рджрд░реНрд╢рд╡рддреЗ.

    `epsilon` рдореНрд╣рдгрдЬреЗ **exploration/exploitation factor** рдЬреЗ рдард░рд╡рддреЗ рдХреА рдЖрдкрд▓реНрдпрд╛рд▓рд╛ exploration рд▓рд╛ рдкреНрд░рд╛рдзрд╛рдиреНрдп рджреНрдпрд╛рд╡реЗ рдХреА exploitation рд▓рд╛. рдЖрдкрд▓реНрдпрд╛ рдЕрд▓реНрдЧреЛрд░рд┐рджрдордордзреНрдпреЗ, рдЖрдореНрд╣реА `epsilon` рдЯрдХреНрдХреЗ рдкреНрд░рдХрд░рдгрд╛рдВрдордзреНрдпреЗ Q-Table рдореВрд▓реНрдпрд╛рдВрдиреБрд╕рд╛рд░ рдкреБрдвреАрд▓ рдХреНрд░рд┐рдпрд╛ рдирд┐рд╡рдбрдгрд╛рд░ рдЖрд╣реЛрдд, рдЖрдгрд┐ рдЙрд░реНрд╡рд░рд┐рдд рдкреНрд░рдХрд░рдгрд╛рдВрдордзреНрдпреЗ рдЖрдореНрд╣реА рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рдХреНрд░рд┐рдпрд╛ рдЕрдВрдорд▓рд╛рдд рдЖрдгрдгрд╛рд░ рдЖрд╣реЛрдд. рдпрд╛рдореБрд│реЗ рдЖрдкрд▓реНрдпрд╛рд▓рд╛ рд╢реЛрдз рд╕реНрдерд╛рдирд╛рдЪреНрдпрд╛ рдЕрд╢рд╛ рднрд╛рдЧрд╛рдВрдЪрд╛ рд╢реЛрдз рдШреЗрддрд╛ рдпреЗрдИрд▓ рдЬреЗ рдЖрдкрдг рдХрдзреАрд╣реА рдкрд╛рд╣рд┐рд▓реЗ рдирд╛рд╣реАрдд.

    тЬЕ рд╕рдВрддреБрд▓рдирд╛рдЪреНрдпрд╛ рдмрд╛рдмрддреАрдд - рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рдХреНрд░рд┐рдпрд╛ рдирд┐рд╡рдбрдгреЗ (exploration) рдЪреБрдХреАрдЪреНрдпрд╛ рджрд┐рд╢реЗрдиреЗ рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рдзрдХреНрдХрд╛ рджреЗрдгреНрдпрд╛рд╕рд╛рд░рдЦреЗ рдЕрд╕реЗрд▓, рдЖрдгрд┐ рдЦрд╛рдВрдмрд╛рдиреЗ рддреНрдпрд╛ "рдЪреБрдХрд╛" рдордзреВрди рд╕рдВрддреБрд▓рди рдХрд╕реЗ рдкреБрдирд░реНрдкреНрд░рд╛рдкреНрдд рдХрд░рд╛рд╡реЗ рд╣реЗ рд╢рд┐рдХрд▓реЗ рдкрд╛рд╣рд┐рдЬреЗ.

### рдЕрд▓реНрдЧреЛрд░рд┐рджрдо рд╕реБрдзрд╛рд░рд┐рдд рдХрд░рд╛

рдЖрдкрд▓реНрдпрд╛ рдорд╛рдЧреАрд▓ рдзрдбреНрдпрд╛рддреАрд▓ рдЕрд▓реНрдЧреЛрд░рд┐рджрдордордзреНрдпреЗ рджреЛрди рд╕реБрдзрд╛рд░рдгрд╛ рдХрд░реВ рд╢рдХрддреЛ:

- **рд╕рд░рд╛рд╕рд░реА cumulative reward** рдЧрдгрдирд╛ рдХрд░рд╛, рдЕрдиреЗрдХ рдЕрдиреБрдХрд░рдгрд╛рдВрд╡рд░. рдЖрдореНрд╣реА рдкреНрд░рддреНрдпреЗрдХ 5000 iterations рдирдВрддрд░ рдкреНрд░рдЧрддреА рдкреНрд░рд┐рдВрдЯ рдХрд░реВ рдЖрдгрд┐ рддреНрдпрд╛ рдХрд╛рд▓рд╛рд╡рдзреАрддреАрд▓ cumulative reward рдЪреА рд╕рд░рд╛рд╕рд░реА рдХрд╛рдвреВ. рдпрд╛рдЪрд╛ рдЕрд░реНрде рдЕрд╕рд╛ рдХреА рдЬрд░ рдЖрдкрдг 195 рдкреЗрдХреНрд╖рд╛ рдЬрд╛рд╕реНрдд рдЧреБрдг рдорд┐рд│рд╡рд▓реЗ - рддрд░ рдЖрдкрдг рд╕рдорд╕реНрдпрд╛ рд╕реЛрдбрд╡рд▓реА рдЕрд╕реЗ рдорд╛рдиреВ рд╢рдХрддреЛ, рдЖрд╡рд╢реНрдпрдХрддреЗрдкреЗрдХреНрд╖рд╛ рдЙрдЪреНрдЪ рдЧреБрдгрд╡рддреНрддреЗрд╕рд╣.

- **рдХрдорд╛рд▓ рд╕рд░рд╛рд╕рд░реА cumulative рдкрд░рд┐рдгрд╛рдо** (`Qmax`) рдЧрдгрдирд╛ рдХрд░рд╛, рдЖрдгрд┐ рдЖрдореНрд╣реА рддреНрдпрд╛ рдкрд░рд┐рдгрд╛рдорд╛рд╢реА рд╕рдВрдмрдВрдзрд┐рдд Q-Table рд╕рд╛рдард╡реВ. рддреБрдореНрд╣реА рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдЪрд╛рд▓рд╡рддрд╛рдирд╛ рд▓рдХреНрд╖рд╛рдд рдпреЗрдИрд▓ рдХреА рдХрдзреАрдХрдзреА рд╕рд░рд╛рд╕рд░реА cumulative рдкрд░рд┐рдгрд╛рдо рдХрдореА рд╣реЛрддреЛ, рдЖрдгрд┐ рдЖрдореНрд╣рд╛рд▓рд╛ рдкреНрд░рд╢рд┐рдХреНрд╖рдгрд╛рджрд░рдореНрдпрд╛рди рдкрд╛рд╣рд┐рд▓реЗрд▓реНрдпрд╛ рд╕рд░реНрд╡реЛрддреНрддрдо рдореЙрдбреЗрд▓рд╢реА рд╕рдВрдмрдВрдзрд┐рдд Q-Table рдЪреНрдпрд╛ рдореВрд▓реНрдпреЗ рдареЗрд╡рд╛рдпрдЪреА рдЖрд╣реЗрдд.

1. рдкреНрд░рддреНрдпреЗрдХ рдЕрдиреБрдХрд░рдгрд╛рдЪреНрдпрд╛ cumulative rewards `rewards` рд╡реНрд╣реЗрдХреНрдЯрд░рдордзреНрдпреЗ рдЧреЛрд│рд╛ рдХрд░рд╛ рдЬреЗрдгреЗрдХрд░реВрди рдирдВрддрд░ plotting рдХрд░рддрд╛ рдпреЗрдИрд▓. (рдХреЛрдб рдмреНрд▓реЙрдХ 11)

    ```python
    def probs(v,eps=1e-4):
        v = v-v.min()+eps
        v = v/v.sum()
        return v
    
    Qmax = 0
    cum_rewards = []
    rewards = []
    for epoch in range(100000):
        obs = env.reset()
        done = False
        cum_reward=0
        # == do the simulation ==
        while not done:
            s = discretize(obs)
            if random.random()<epsilon:
                # exploitation - chose the action according to Q-Table probabilities
                v = probs(np.array(qvalues(s)))
                a = random.choices(actions,weights=v)[0]
            else:
                # exploration - randomly chose the action
                a = np.random.randint(env.action_space.n)
    
            obs, rew, done, info = env.step(a)
            cum_reward+=rew
            ns = discretize(obs)
            Q[(s,a)] = (1 - alpha) * Q.get((s,a),0) + alpha * (rew + gamma * max(qvalues(ns)))
        cum_rewards.append(cum_reward)
        rewards.append(cum_reward)
        # == Periodically print results and calculate average reward ==
        if epoch%5000==0:
            print(f"{epoch}: {np.average(cum_rewards)}, alpha={alpha}, epsilon={epsilon}")
            if np.average(cum_rewards) > Qmax:
                Qmax = np.average(cum_rewards)
                Qbest = Q
            cum_rewards=[]
    ```

рддреБрдореНрд╣реА рдпрд╛ рдкрд░рд┐рдгрд╛рдорд╛рдВрдордзреВрди рдХрд╛рдп рд▓рдХреНрд╖рд╛рдд рдШреЗрдК рд╢рдХрддрд╛:

- **рдЖрдкрд▓реНрдпрд╛ рдзреНрдпреЗрдпрд╛рдЪреНрдпрд╛ рдЬрд╡рд│**. рдЖрдореНрд╣реА 100+ рд╕рд▓рдЧ рдЕрдиреБрдХрд░рдгрд╛рдВрдЪреНрдпрд╛ рд╕рд░рд╛рд╕рд░реА cumulative rewards рдордзреНрдпреЗ 195 рдорд┐рд│рд╡рдгреНрдпрд╛рдЪреНрдпрд╛ рдзреНрдпреЗрдпрд╛рдЪреНрдпрд╛ рдЦреВрдк рдЬрд╡рд│ рдЖрд╣реЛрдд, рдХрд┐рдВрд╡рд╛ рдЖрдореНрд╣реА рдкреНрд░рддреНрдпрдХреНрд╖рд╛рдд рддреЗ рд╕рд╛рдзреНрдп рдХреЗрд▓реЗ рдЕрд╕реЗрд▓! рдЬрд░реА рдЖрдкрд▓реНрдпрд╛рд▓рд╛ рдХрдореА рд╕рдВрдЦреНрдпрд╛ рдорд┐рд│рд╛рд▓реНрдпрд╛ рддрд░реА, рдЖрдореНрд╣рд╛рд▓рд╛ рдорд╛рд╣рд┐рдд рдирд╛рд╣реА, рдХрд╛рд░рдг рдЖрдореНрд╣реА 5000 runs рд╡рд░ рд╕рд░рд╛рд╕рд░реА рдХрд╛рдврддреЛ, рдЖрдгрд┐ рдФрдкрдЪрд╛рд░рд┐рдХ рдирд┐рдХрд╖рд╛рдВрдордзреНрдпреЗ рдлрдХреНрдд 100 runs рдЖрд╡рд╢реНрдпрдХ рдЖрд╣реЗрдд.

- **Reward рдХрдореА рд╣реЛрддреЛ**. рдХрдзреАрдХрдзреА reward рдХрдореА рд╣реЛрддреЛ, рдпрд╛рдЪрд╛ рдЕрд░реНрде рдЕрд╕рд╛ рдХреА рдЖрдкрдг Q-Table рдордзреНрдпреЗ рдЖрдзреА рд╢рд┐рдХрд▓реЗрд▓реНрдпрд╛ рдореВрд▓реНрдпрд╛рдВрдирд╛ "рдирд╖реНрдЯ" рдХрд░реВ рд╢рдХрддреЛ рдЖрдгрд┐ рдкрд░рд┐рд╕реНрдерд┐рддреА рд╡рд╛рдИрдЯ рдмрдирд╡рдгрд╛рд▒реНрдпрд╛ рдирд╡реАрди рдореВрд▓реНрдпрд╛рдВрд╕рд╣ рдмрджрд▓реВ рд╢рдХрддреЛ.

рд╣реЗ рдирд┐рд░реАрдХреНрд╖рдг рдЕрдзрд┐рдХ рд╕реНрдкрд╖реНрдЯрдкрдгреЗ рджрд┐рд╕рддреЗ рдЬрд░ рдЖрдкрдг рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдкреНрд░рдЧрддреАрдЪреЗ рдкреНрд▓реЙрдЯрд┐рдВрдЧ рдХреЗрд▓реЗ.

## рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдкреНрд░рдЧрддреАрдЪреЗ рдкреНрд▓реЙрдЯрд┐рдВрдЧ

рдкреНрд░рд╢рд┐рдХреНрд╖рдгрд╛рджрд░рдореНрдпрд╛рди, рдЖрдореНрд╣реА рдкреНрд░рддреНрдпреЗрдХ iteration рд╡рд░ cumulative reward рдореВрд▓реНрдп `rewards` рд╡реНрд╣реЗрдХреНрдЯрд░рдордзреНрдпреЗ рдЧреЛрд│рд╛ рдХреЗрд▓реЗ рдЖрд╣реЗ. рдпреЗрдереЗ рддреЗ iteration рдХреНрд░рдорд╛рдВрдХрд╛рдЪреНрдпрд╛ рд╡рд┐рд░реБрджреНрдз рдкреНрд▓реЙрдЯ рдХреЗрд▓реНрдпрд╛рд╡рд░ рдХрд╕реЗ рджрд┐рд╕рддреЗ:

```python
plt.plot(rewards)
```

![raw progress](../../../../translated_images/train_progress_raw.2adfdf2daea09c596fc786fa347a23e9aceffe1b463e2257d20a9505794823ec.mr.png)

рдпрд╛ рдЧреНрд░рд╛рдлрдордзреВрди рдХрд╛рд╣реАрд╣реА рд╕рд╛рдВрдЧрдгреЗ рд╢рдХреНрдп рдирд╛рд╣реА, рдХрд╛рд░рдг stochastic рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдкреНрд░рдХреНрд░рд┐рдпреЗрдЪреНрдпрд╛ рд╕реНрд╡рд░реВрдкрд╛рдореБрд│реЗ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рд╕рддреНрд░рд╛рдВрдЪреА рд▓рд╛рдВрдмреА рдЦреВрдк рд╡реЗрдЧрд│реА рдЕрд╕рддреЗ. рдпрд╛ рдЧреНрд░рд╛рдлрдЪрд╛ рдЕрдзрд┐рдХ рдЕрд░реНрде рд▓рд╛рд╡рдгреНрдпрд╛рд╕рд╛рдареА, рдЖрдкрдг 100 рдЪрд╛рдЪрдгреНрдпрд╛рдВрд╡рд░ **running average** рдЧрдгрдирд╛ рдХрд░реВ рд╢рдХрддреЛ. рд╣реЗ рд╕реЛрдпреАрд╕реНрдХрд░рдкрдгреЗ `np.convolve` рд╡рд╛рдкрд░реВрди рдХреЗрд▓реЗ рдЬрд╛рдК рд╢рдХрддреЗ: (рдХреЛрдб рдмреНрд▓реЙрдХ 12)

```python
def running_average(x,window):
    return np.convolve(x,np.ones(window)/window,mode='valid')

plt.plot(running_average(rewards,100))
```

![training progress](../../../../translated_images/train_progress_runav.c71694a8fa9ab35935aff6f109e5ecdfdbdf1b0ae265da49479a81b5fae8f0aa.mr.png)

## hyperparameters рдмрджрд▓рдгреЗ

рд╢рд┐рдХрдгреЗ рдЕрдзрд┐рдХ рд╕реНрдерд┐рд░ рдХрд░рдгреНрдпрд╛рд╕рд╛рдареА, рдкреНрд░рд╢рд┐рдХреНрд╖рдгрд╛рджрд░рдореНрдпрд╛рди рдХрд╛рд╣реА hyperparameters adjust рдХрд░рдгреЗ рдпреЛрдЧреНрдп рдард░рддреЗ. рд╡рд┐рд╢реЗрд╖рддрдГ:

- **learning rate** (`alpha`) рд╕рд╛рдареА, рдЖрдкрдг 1 рдЪреНрдпрд╛ рдЬрд╡рд│рдкрд╛рд╕рдЪреНрдпрд╛ рдореВрд▓реНрдпрд╛рдВрдиреА рд╕реБрд░реБрд╡рд╛рдд рдХрд░реВ рд╢рдХрддреЛ рдЖрдгрд┐ рдирдВрддрд░ рд╣рд╛ parameter рдХрдореА рдХрд░рдд рд░рд╛рд╣реВ рд╢рдХрддреЛ. рдХрд╛рд▓рд╛рдВрддрд░рд╛рдиреЗ, рдЖрдкрд▓реНрдпрд╛рд▓рд╛ Q-Table рдордзреНрдпреЗ рдЪрд╛рдВрдЧрд▓реЗ probability рдореВрд▓реНрдпреЗ рдорд┐рд│рддреАрд▓, рдЖрдгрд┐ рддреНрдпрд╛рдореБрд│реЗ рдЖрдкрд▓реНрдпрд╛рд▓рд╛ рддреНрдпрд╛рдВрдирд╛ рдереЛрдбреЗ adjust рдХрд░рд╛рд╡реЗ рд▓рд╛рдЧреЗрд▓, рдЖрдгрд┐ рдирд╡реАрди рдореВрд▓реНрдпрд╛рдВрд╕рд╣ рдкреВрд░реНрдгрдкрдгреЗ overwrite рдХрд░реВ рдирдпреЗ.

- **epsilon рд╡рд╛рдврд╡рд╛**. рдЖрдкрдг `epsilon` рд╣рд│реВрд╣рд│реВ рд╡рд╛рдврд╡реВ рдЗрдЪреНрдЫрд┐рддреЛ, рдЬреЗрдгреЗрдХрд░реВрди рдХрдореА рд╢реЛрдз рдШреЗрдКрди рдЕрдзрд┐рдХ exploitation рдХрд░реВ рд╢рдХреВ. рдХрдореА `epsilon` рдореВрд▓реНрдпрд╛рдиреЗ рд╕реБрд░реБрд╡рд╛рдд рдХрд░рдгреЗ рдЖрдгрд┐ рдЬрд╡рд│рдЬрд╡рд│ 1 рдкрд░реНрдпрдВрдд рдЬрд╛рдгреЗ рдпреЛрдЧреНрдп рдард░рддреЗ.
> **рдХрд╛рд░реНрдп 1**: рд╣рд╛рдпрдкрд░рдкреЕрд░рд╛рдореАрдЯрд░рдЪреНрдпрд╛ рдореВрд▓реНрдпрд╛рдВрд╢реА рдЦреЗрд│рд╛ рдЖрдгрд┐ рдкрд╛рд╣рд╛ рдХреА рддреБрдореНрд╣реА рдЙрдЪреНрдЪ рдПрдХреВрдг рдмрдХреНрд╖реАрд╕ рдорд┐рд│рд╡реВ рд╢рдХрддрд╛ рдХрд╛. рддреБрдореНрд╣рд╛рд▓рд╛ 195 рдкреЗрдХреНрд╖рд╛ рдЬрд╛рд╕реНрдд рдорд┐рд│рдд рдЖрд╣реЗ рдХрд╛?
> **рдХрд╛рд░реНрдп 2**: рд╕рдорд╕реНрдпрд╛ рдФрдкрдЪрд╛рд░рд┐рдХрдкрдгреЗ рд╕реЛрдбрд╡рдгреНрдпрд╛рд╕рд╛рдареА, рддреБрдореНрд╣рд╛рд▓рд╛ 100 рд╕рд▓рдЧ рд░рдирдордзреНрдпреЗ 195 рд╕рд░рд╛рд╕рд░реА рдмрдХреНрд╖реАрд╕ рдорд┐рд│рд╡рдгреЗ рдЖрд╡рд╢реНрдпрдХ рдЖрд╣реЗ. рдкреНрд░рд╢рд┐рдХреНрд╖рдгрд╛рджрд░рдореНрдпрд╛рди рддреЗ рдореЛрдЬрд╛ рдЖрдгрд┐ рдЦрд╛рддреНрд░реА рдХрд░рд╛ рдХреА рддреБрдореНрд╣реА рд╕рдорд╕реНрдпрд╛ рдФрдкрдЪрд╛рд░рд┐рдХрдкрдгреЗ рд╕реЛрдбрд╡рд▓реА рдЖрд╣реЗ!

## рдХреГрддреАрдд рдкрд░рд┐рдгрд╛рдо рдкрд╛рд╣рдгреЗ

рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдореЙрдбреЗрд▓ рдХрд╕реЗ рд╡рд╛рдЧрддреЗ рд╣реЗ рдкреНрд░рддреНрдпрдХреНрд╖ рдкрд╛рд╣рдгреЗ рдордиреЛрд░рдВрдЬрдХ рдард░реЗрд▓. рдЪрд▓рд╛ рд╕рд┐рдореНрдпреБрд▓реЗрд╢рди рдЪрд╛рд▓рд╡реВрдпрд╛ рдЖрдгрд┐ рдкреНрд░рд╢рд┐рдХреНрд╖рдгрд╛рджрд░рдореНрдпрд╛рди рд╡рд╛рдкрд░рд▓реЗрд▓реНрдпрд╛ рддреНрдпрд╛рдЪ рдХреГрддреА рдирд┐рд╡рдб рдзреЛрд░рдгрд╛рдЪреЗ рдЕрдиреБрд╕рд░рдг рдХрд░реВрдпрд╛, Q-Table рдордзреАрд▓ рд╕рдВрднрд╛рд╡реНрдпрддрд╛ рд╡рд┐рддрд░рдгрд╛рдиреБрд╕рд╛рд░ рдирдореБрдирд╛ рдШреЗрдКрди: (рдХреЛрдб рдмреНрд▓реЙрдХ 13)

```python
obs = env.reset()
done = False
while not done:
   s = discretize(obs)
   env.render()
   v = probs(np.array(qvalues(s)))
   a = random.choices(actions,weights=v)[0]
   obs,_,done,_ = env.step(a)
env.close()
```

рддреБрдореНрд╣рд╛рд▓рд╛ рдЕрд╕реЗ рдХрд╛рд╣реАрддрд░реА рджрд┐рд╕реЗрд▓:

![рдПрдХ рд╕рдВрддреБрд▓рд┐рдд рдХрд╛рд░реНрдЯрдкреЛрд▓](../../../../8-Reinforcement/2-Gym/images/cartpole-balance.gif)

---

## ЁЯЪАрдЖрд╡реНрд╣рд╛рди

> **рдХрд╛рд░реНрдп 3**: рдпреЗрдереЗ, рдЖрдореНрд╣реА Q-Table рдЪреА рдЕрдВрддрд┐рдо рдкреНрд░рдд рд╡рд╛рдкрд░рдд рд╣реЛрддреЛ, рдЬреА рдХрджрд╛рдЪрд┐рдд рд╕рд░реНрд╡реЛрддреНрддрдо рдирд╕реЗрд▓. рд▓рдХреНрд╖рд╛рдд рдареЗрд╡рд╛ рдХреА рдЖрдореНрд╣реА рд╕рд░реНрд╡реЛрддреНрддрдо рдХрд╛рдордЧрд┐рд░реА рдХрд░рдгрд╛рд░рд╛ Q-Table `Qbest` рд╡реНрд╣реЗрд░рд┐рдПрдмрд▓рдордзреНрдпреЗ рд╕рд╛рдард╡рд▓рд╛ рдЖрд╣реЗ! `Qbest` рд▓рд╛ `Q` рд╡рд░ рдХреЙрдкреА рдХрд░реВрди рдЖрдгрд┐ рддреНрдпрд╛рдЪ рдЙрджрд╛рд╣рд░рдгрд╛рдЪрд╛ рдкреНрд░рдпрддреНрди рдХрд░реВрди рдкрд╣рд╛ рдХреА рддреБрдореНрд╣рд╛рд▓рд╛ рдХрд╛рд╣реА рдлрд░рдХ рдЬрд╛рдгрд╡рддреЛ рдХрд╛.

> **рдХрд╛рд░реНрдп 4**: рдпреЗрдереЗ рдЖрдореНрд╣реА рдкреНрд░рддреНрдпреЗрдХ рдЯрдкреНрдкреНрдпрд╛рд╡рд░ рд╕рд░реНрд╡реЛрддреНрддрдо рдХреГрддреА рдирд┐рд╡рдбрдд рдирд╡реНрд╣рддреЛ, рддрд░ рд╕рдВрдмрдВрдзрд┐рдд рд╕рдВрднрд╛рд╡реНрдпрддрд╛ рд╡рд┐рддрд░рдгрд╛рд╕рд╣ рдирдореБрдирд╛ рдШреЗрдд рд╣реЛрддреЛ. рдиреЗрд╣рдореАрдЪ рд╕рд░реНрд╡реЛрддреНрддрдо рдХреГрддреА рдирд┐рд╡рдбрдгреЗ, рдЬреНрдпрд╛ Q-Table рдореВрд▓реНрдп рд╕рд░реНрд╡рд╛рдзрд┐рдХ рдЖрд╣реЗ, рдЕрдзрд┐рдХ рдЕрд░реНрдердкреВрд░реНрдг рдард░реЗрд▓ рдХрд╛? рд╣реЗ `np.argmax` рдлрдВрдХреНрд╢рди рд╡рд╛рдкрд░реВрди рдХрд░рддрд╛ рдпреЗрддреЗ, рдЬреЗ рдЙрдЪреНрдЪ Q-Table рдореВрд▓реНрдпрд╛рд╢реА рд╕рдВрдмрдВрдзрд┐рдд рдХреГрддреА рдХреНрд░рдорд╛рдВрдХ рд╢реЛрдзрддреЗ. рд╣реЗ рдзреЛрд░рдг рдЕрдВрдорд▓рд╛рдд рдЖрдгрд╛ рдЖрдгрд┐ рддреЗ рд╕рдВрддреБрд▓рди рд╕реБрдзрд╛рд░рддреЗ рдХрд╛ рддреЗ рдкрд╛рд╣рд╛.

## [рд╡реНрдпрд╛рдЦреНрдпрд╛рдирд╛рдирдВрддрд░рдЪрд╛ рдХреНрд╡рд┐рдЭ](https://gray-sand-07a10f403.1.azurestaticapps.net/quiz/48/)

## рдЕрд╕рд╛рдЗрдирдореЗрдВрдЯ
[рдорд╛рдЙрдВрдЯрди рдХрд╛рд░ рдЯреНрд░реЗрди рдХрд░рд╛](assignment.md)

## рдирд┐рд╖реНрдХрд░реНрд╖

рдЖрддрд╛ рдЖрдкрдг рдПрдЬрдВрдЯреНрд╕рдирд╛ рдЪрд╛рдВрдЧрд▓реЗ рдкрд░рд┐рдгрд╛рдо рд╕рд╛рдзреНрдп рдХрд░рдгреНрдпрд╛рд╕рд╛рдареА рдкреНрд░рд╢рд┐рдХреНрд╖рдг рджреЗрдгреЗ рд╢рд┐рдХрд▓реЗ рдЖрд╣реЗ, рдлрдХреНрдд рддреНрдпрд╛рдВрдирд╛ рдЧреЗрдордЪреНрдпрд╛ рдЗрдЪреНрдЫрд┐рдд рд╕реНрдерд┐рддреАрдЪреА рд╡реНрдпрд╛рдЦреНрдпрд╛ рдХрд░рдгрд╛рд░реЗ рдмрдХреНрд╖реАрд╕ рдлрдВрдХреНрд╢рди рдкреНрд░рджрд╛рди рдХрд░реВрди рдЖрдгрд┐ рддреНрдпрд╛рдВрдирд╛ рд╣реБрд╢рд╛рд░реАрдиреЗ рд╢реЛрдз рдЬрд╛рдЧрд╛ рдПрдХреНрд╕рдкреНрд▓реЛрд░ рдХрд░рдгреНрдпрд╛рдЪреА рд╕рдВрдзреА рджреЗрдКрди. рдЖрдкрдг Q-Learning рдЕрд▓реНрдЧреЛрд░рд┐рджрдо рдпрд╢рд╕реНрд╡реАрд░рд┐рддреНрдпрд╛ рдбрд┐рд╕реНрдХреНрд░реАрдЯ рдЖрдгрд┐ рд╕рддрдд рд╡рд╛рддрд╛рд╡рд░рдгрд╛рдЪреНрдпрд╛ рдмрд╛рдмрддреАрдд рд▓рд╛рдЧреВ рдХреЗрд▓рд╛ рдЖрд╣реЗ, рдкрд░рдВрддреБ рдбрд┐рд╕реНрдХреНрд░реАрдЯ рдХреГрддреАрдВрд╕рд╣.

рд╣реЗ рджреЗрдЦреАрд▓ рдорд╣рддреНрддреНрд╡рд╛рдЪреЗ рдЖрд╣реЗ рдХреА рдЬреНрдпрд╛ рдкрд░рд┐рд╕реНрдерд┐рддреАрдд рдХреГрддреА рд╕реНрдерд┐рддреА рд╕рддрдд рдЕрд╕рддреЗ рдЖрдгрд┐ рдирд┐рд░реАрдХреНрд╖рдг рдЬрд╛рдЧрд╛ рдЦреВрдкрдЪ рдЬрдЯрд┐рд▓ рдЕрд╕рддреЗ, рдЬрд╕реЗ рдХреА рдЕрдЯрд╛рд░реА рдЧреЗрдо рд╕реНрдХреНрд░реАрдирд╡рд░реАрд▓ рдкреНрд░рддрд┐рдорд╛, рддреНрдпрд╛ рдЕрднреНрдпрд╛рд╕рд╛рд╡реНрдпрд╛рдд. рдЕрд╢рд╛ рд╕рдорд╕реНрдпрд╛рдВрдордзреНрдпреЗ рдЪрд╛рдВрдЧрд▓реЗ рдкрд░рд┐рдгрд╛рдо рд╕рд╛рдзреНрдп рдХрд░рдгреНрдпрд╛рд╕рд╛рдареА рдЖрдкрд▓реНрдпрд╛рд▓рд╛ рдЕрдзрд┐рдХ рд╢рдХреНрддрд┐рд╢рд╛рд▓реА рдорд╢реАрди рд▓рд░реНрдирд┐рдВрдЧ рддрдВрддреНрд░рд╛рдВрдЪрд╛, рдЬрд╕реЗ рдХреА рдиреНрдпреВрд░рд▓ рдиреЗрдЯрд╡рд░реНрдХреНрд╕рдЪрд╛, рд╡рд╛рдкрд░ рдХрд░рд╛рд╡рд╛ рд▓рд╛рдЧрддреЛ. рд╣реЗ рдЕрдзрд┐рдХ рдкреНрд░рдЧрдд рд╡рд┐рд╖рдп рдЖрдкрд▓реНрдпрд╛ рдЖрдЧрд╛рдореА рдкреНрд░рдЧрдд AI рдХреЛрд░реНрд╕рдЪрд╛ рд╡рд┐рд╖рдп рдЖрд╣реЗрдд.

---

**рдЕрд╕реНрд╡реАрдХрд░рдг**:  
рд╣рд╛ рджрд╕реНрддрдРрд╡рдЬ AI рднрд╛рд╖рд╛рдВрддрд░ рд╕реЗрд╡рд╛ [Co-op Translator](https://github.com/Azure/co-op-translator) рд╡рд╛рдкрд░реВрди рднрд╛рд╖рд╛рдВрддрд░рд┐рдд рдХрд░рдгреНрдпрд╛рдд рдЖрд▓рд╛ рдЖрд╣реЗ. рдЖрдореНрд╣реА рдЕрдЪреВрдХрддреЗрд╕рд╛рдареА рдкреНрд░рдпрддреНрдирд╢реАрд▓ рдЕрд╕рд▓реЛ рддрд░реА рдХреГрдкрдпрд╛ рд▓рдХреНрд╖рд╛рдд рдареЗрд╡рд╛ рдХреА рд╕реНрд╡рдпрдВрдЪрд▓рд┐рдд рднрд╛рд╖рд╛рдВрддрд░реЗ рддреНрд░реБрдЯреА рдХрд┐рдВрд╡рд╛ рдЕрдЪреВрдХрддреЗрдЪреНрдпрд╛ рдЕрднрд╛рд╡рд╛рдиреЗ рдпреБрдХреНрдд рдЕрд╕реВ рд╢рдХрддрд╛рдд. рдореВрд│ рднрд╛рд╖реЗрддреАрд▓ рджрд╕реНрддрдРрд╡рдЬ рд╣рд╛ рдЕрдзрд┐рдХреГрдд рд╕реНрд░реЛрдд рдорд╛рдирд▓рд╛ рдЬрд╛рд╡рд╛. рдорд╣рддреНрддреНрд╡рд╛рдЪреНрдпрд╛ рдорд╛рд╣рд┐рддреАрд╕рд╛рдареА рд╡реНрдпрд╛рд╡рд╕рд╛рдпрд┐рдХ рдорд╛рдирд╡реА рднрд╛рд╖рд╛рдВрддрд░рд╛рдЪреА рд╢рд┐рдлрд╛рд░рд╕ рдХреЗрд▓реА рдЬрд╛рддреЗ. рдпрд╛ рднрд╛рд╖рд╛рдВрддрд░рд╛рдЪрд╛ рд╡рд╛рдкрд░ рдХрд░реВрди рдЙрджреНрднрд╡рд▓реЗрд▓реНрдпрд╛ рдХреЛрдгрддреНрдпрд╛рд╣реА рдЧреИрд░рд╕рдордЬ рдХрд┐рдВрд╡рд╛ рдЪреБрдХреАрдЪреНрдпрд╛ рдЕрд░реНрдерд╛рд╕рд╛рдареА рдЖрдореНрд╣реА рдЬрдмрд╛рдмрджрд╛рд░ рд░рд╛рд╣рдгрд╛рд░ рдирд╛рд╣реА.