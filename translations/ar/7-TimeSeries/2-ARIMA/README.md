<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "917dbf890db71a322f306050cb284749",
  "translation_date": "2025-09-04T20:41:47+00:00",
  "source_file": "7-TimeSeries/2-ARIMA/README.md",
  "language_code": "ar"
}
-->
# ุงูุชูุจุค ุจุงูุณูุงุณู ุงูุฒูููุฉ ุจุงุณุชุฎุฏุงู ARIMA

ูู ุงูุฏุฑุณ ุงูุณุงุจูุ ุชุนููุช ููููุงู ุนู ุงูุชูุจุค ุจุงูุณูุงุณู ุงูุฒูููุฉ ูููุช ุจุชุญููู ูุฌููุนุฉ ุจูุงูุงุช ุชูุธูุฑ ุชููุจุงุช ุงูุญูู ุงูููุฑุจุงุฆู ุนูู ูุฏู ูุชุฑุฉ ุฒูููุฉ.

[![ููุฏูุฉ ุฅูู ARIMA](https://img.youtube.com/vi/IUSk-YDau10/0.jpg)](https://youtu.be/IUSk-YDau10 "Introduction to ARIMA")

> ๐ฅ ุงููุฑ ุนูู ุงูุตูุฑุฉ ุฃุนูุงู ููุดุงูุฏุฉ ููุฏูู: ููุฏูุฉ ูุตูุฑุฉ ุนู ููุงุฐุฌ ARIMA. ุงููุซุงู ููููุฐ ุจุงุณุชุฎุฏุงู Rุ ููู ุงูููุงููู ุนุงูุฉ.

## [ุงุฎุชุจุงุฑ ูุง ูุจู ุงููุญุงุถุฑุฉ](https://ff-quizzes.netlify.app/en/ml/)

## ุงูููุฏูุฉ

ูู ูุฐุง ุงูุฏุฑุณุ ุณุชุชุนุฑู ุนูู ุทุฑููุฉ ูุญุฏุฏุฉ ูุจูุงุก ุงูููุงุฐุฌ ุจุงุณุชุฎุฏุงู [ARIMA: *A*uto*R*egressive *I*ntegrated *M*oving *A*verage](https://wikipedia.org/wiki/Autoregressive_integrated_moving_average). ุชูุนุชุจุฑ ููุงุฐุฌ ARIMA ููุงุณุจุฉ ุจุดูู ุฎุงุต ูุชูุงุฆู ุงูุจูุงูุงุช ุงูุชู ุชูุธูุฑ [ุนุฏู ุงูุซุจุงุช](https://wikipedia.org/wiki/Stationary_process).

## ุงูููุงููู ุงูุนุงูุฉ

ููู ุชุชููู ูู ุงูุนูู ูุน ARIMAุ ููุงู ุจุนุถ ุงูููุงููู ุงูุชู ุชุญุชุงุฌ ุฅูู ูุนุฑูุชูุง:

- ๐ **ุงูุซุจุงุช**. ูู ููุธูุฑ ุฅุญุตุงุฆูุ ูุดูุฑ ุงูุซุจุงุช ุฅูู ุงูุจูุงูุงุช ุงูุชู ูุง ูุชุบูุฑ ุชูุฒูุนูุง ุนูุฏ ุชุญุฑูููุง ุนุจุฑ ุงูุฒูู. ุฃูุง ุงูุจูุงูุงุช ุบูุฑ ุงูุซุงุจุชุฉุ ูุชูุธูุฑ ุชููุจุงุช ุจุณุจุจ ุงูุงุชุฌุงูุงุช ุงูุชู ูุฌุจ ุชุญููููุง ูุชุญููููุง. ุนูู ุณุจูู ุงููุซุงูุ ูููู ุฃู ุชูุฏุฎู ุงูููุณููุฉ ุชููุจุงุช ูู ุงูุจูุงูุงุช ููููู ุงูุชุฎูุต ูููุง ูู ุฎูุงู ุนูููุฉ "ุงููุฑู ุงูููุณูู".

- ๐ **[ุงููุฑู](https://wikipedia.org/wiki/Autoregressive_integrated_moving_average#Differencing)**. ูุดูุฑ ุงููุฑู ูู ุงูุจูุงูุงุชุ ูู ููุธูุฑ ุฅุญุตุงุฆูุ ุฅูู ุนูููุฉ ุชุญููู ุงูุจูุงูุงุช ุบูุฑ ุงูุซุงุจุชุฉ ูุฌุนููุง ุซุงุจุชุฉ ุนู ุทุฑูู ุฅุฒุงูุฉ ุงูุงุชุฌุงู ุบูุฑ ุงูุซุงุจุช. "ุงููุฑู ูุฒูู ุงูุชุบูุฑุงุช ูู ูุณุชูู ุงูุณูุณูุฉ ุงูุฒูููุฉุ ููุง ููุบู ุงูุงุชุฌุงู ูุงูููุณููุฉ ูุจุงูุชุงูู ูุซุจุช ุงููุชูุณุท ููุณูุณูุฉ ุงูุฒูููุฉ." [ูุฑูุฉ ุจุญุซูุฉ ูู Shixiong ูุขุฎุฑูู](https://arxiv.org/abs/1904.07632)

## ARIMA ูู ุณูุงู ุงูุณูุงุณู ุงูุฒูููุฉ

ุฏุนููุง ูููู ุฃุฌุฒุงุก ARIMA ูููู ููููุฉ ูุณุงุนุฏุชูุง ูู ููุฐุฌุฉ ุงูุณูุงุณู ุงูุฒูููุฉ ููุณุงุนุฏุชูุง ูู ุงูุชูุจุค ุจูุง.

- **AR - ุงูุงูุญุฏุงุฑ ุงูุฐุงุชู**. ููุง ููุญู ุงูุงุณูุ ุชูุธุฑ ุงูููุงุฐุฌ ุงูุงูุญุฏุงุฑูุฉ ุงูุฐุงุชูุฉ ุฅูู "ุงููุงุถู" ูุชุญููู ุงูููู ุงูุณุงุจูุฉ ูู ุจูุงูุงุชู ูุชูููู ุงูุชุฑุงุถุงุช ุญูููุง. ุชูุณูู ูุฐู ุงูููู ุงูุณุงุจูุฉ ุจู "ุงููุฌูุงุช ุงูุฒูููุฉ". ูุซุงู ุนูู ุฐูู ูู ุงูุจูุงูุงุช ุงูุชู ุชูุธูุฑ ูุจูุนุงุช ุงูุฃููุงู ุงูุดูุฑูุฉ. ุฅุฌูุงูู ูุจูุนุงุช ูู ุดูุฑ ููุนุชุจุฑ "ูุชุบูุฑูุง ูุชุทูุฑูุง" ูู ูุฌููุนุฉ ุงูุจูุงูุงุช. ูุชู ุจูุงุก ูุฐุง ุงููููุฐุฌ ุนูู ุฃุณุงุณ ุฃู "ุงููุชุบูุฑ ุงููุชุทูุฑ ูุญู ุงูุงูุชูุงู ูุชู ุงูุญุฏุงุฑู ุนูู ูููู ุงูุณุงุจูุฉ (ุฃู ุงููุฌูุงุช ุงูุฒูููุฉ)." [ููููุจูุฏูุง](https://wikipedia.org/wiki/Autoregressive_integrated_moving_average)

- **I - ุงูุชูุงูู**. ุนูู ุนูุณ ุงูููุงุฐุฌ ุงููุดุงุจูุฉ ูุซู 'ARMA'ุ ูุดูุฑ ุงูุญุฑู 'I' ูู ARIMA ุฅูู ุงูุฌุงูุจ *[ุงููุชูุงูู](https://wikipedia.org/wiki/Order_of_integration)*. ูุชู "ุชูุงูู" ุงูุจูุงูุงุช ุนูุฏ ุชุทุจูู ุฎุทูุงุช ุงููุฑู ูุฅุฒุงูุฉ ุนุฏู ุงูุซุจุงุช.

- **MA - ุงููุชูุณุท ุงููุชุญุฑู**. ูุดูุฑ ุฌุงูุจ [ุงููุชูุณุท ุงููุชุญุฑู](https://wikipedia.org/wiki/Moving-average_model) ูู ูุฐุง ุงููููุฐุฌ ุฅูู ุงููุชุบูุฑ ุงููุงุชุฌ ุงูุฐู ูุชู ุชุญุฏูุฏู ูู ุฎูุงู ูุฑุงูุจุฉ ุงูููู ุงูุญุงููุฉ ูุงูุณุงุจูุฉ ูููุฌูุงุช ุงูุฒูููุฉ.

ุงูุฎูุงุตุฉ: ุชูุณุชุฎุฏู ARIMA ูุฌุนู ุงููููุฐุฌ ูุชูุงุกู ูุน ุงูุดูู ุงูุฎุงุต ูุจูุงูุงุช ุงูุณูุงุณู ุงูุฒูููุฉ ุจุฃูุจุฑ ูุฏุฑ ูููู ูู ุงูุฏูุฉ.

## ุชูุฑูู - ุจูุงุก ูููุฐุฌ ARIMA

ุงูุชุญ ุงููุฌูุฏ [_/working_](https://github.com/microsoft/ML-For-Beginners/tree/main/7-TimeSeries/2-ARIMA/working) ูู ูุฐุง ุงูุฏุฑุณ ูุงุจุญุซ ุนู ุงูููู [_notebook.ipynb_](https://github.com/microsoft/ML-For-Beginners/blob/main/7-TimeSeries/2-ARIMA/working/notebook.ipynb).

1. ูู ุจุชุดุบูู ุงูุฏูุชุฑ ูุชุญููู ููุชุจุฉ Python `statsmodels`ุ ุณุชุญุชุงุฌูุง ูููุงุฐุฌ ARIMA.

1. ูู ุจุชุญููู ุงูููุชุจุงุช ุงููุงุฒูุฉ.

1. ุงูุขูุ ูู ุจุชุญููู ุงููุฒูุฏ ูู ุงูููุชุจุงุช ุงููููุฏุฉ ูุฑุณู ุงูุจูุงูุงุช:

    ```python
    import os
    import warnings
    import matplotlib.pyplot as plt
    import numpy as np
    import pandas as pd
    import datetime as dt
    import math

    from pandas.plotting import autocorrelation_plot
    from statsmodels.tsa.statespace.sarimax import SARIMAX
    from sklearn.preprocessing import MinMaxScaler
    from common.utils import load_data, mape
    from IPython.display import Image

    %matplotlib inline
    pd.options.display.float_format = '{:,.2f}'.format
    np.set_printoptions(precision=2)
    warnings.filterwarnings("ignore") # specify to ignore warning messages
    ```

1. ูู ุจุชุญููู ุงูุจูุงูุงุช ูู ููู `/data/energy.csv` ุฅูู ุฅุทุงุฑ ุจูุงูุงุช Pandas ูุฃููู ูุธุฑุฉ:

    ```python
    energy = load_data('./data')[['load']]
    energy.head(10)
    ```

1. ูู ุจุฑุณู ุฌููุน ุจูุงูุงุช ุงูุทุงูุฉ ุงููุชุงุญุฉ ูู ููุงูุฑ 2012 ุฅูู ุฏูุณูุจุฑ 2014. ูุง ููุจุบู ุฃู ุชููู ููุงู ููุงุฌุขุช ูุฃููุง ุฑุฃููุง ูุฐู ุงูุจูุงูุงุช ูู ุงูุฏุฑุณ ุงูุณุงุจู:

    ```python
    energy.plot(y='load', subplots=True, figsize=(15, 8), fontsize=12)
    plt.xlabel('timestamp', fontsize=12)
    plt.ylabel('load', fontsize=12)
    plt.show()
    ```

    ุงูุขูุ ุฏุนููุง ูุจูู ูููุฐุฌูุง!

### ุฅูุดุงุก ูุฌููุนุงุช ุจูุงูุงุช ุงูุชุฏุฑูุจ ูุงูุงุฎุชุจุงุฑ

ุงูุขู ุจุนุฏ ุฃู ุชู ุชุญููู ุจูุงูุงุชูุ ููููู ูุตููุง ุฅูู ูุฌููุนุงุช ุชุฏุฑูุจ ูุงุฎุชุจุงุฑ. ุณุชููู ุจุชุฏุฑูุจ ุงููููุฐุฌ ุงูุฎุงุต ุจู ุนูู ูุฌููุนุฉ ุงูุชุฏุฑูุจ. ููุงูุนุงุฏุฉุ ุจุนุฏ ุฃู ููุชูู ุงููููุฐุฌ ูู ุงูุชุฏุฑูุจุ ุณุชููู ุจุชูููู ุฏูุชู ุจุงุณุชุฎุฏุงู ูุฌููุนุฉ ุงูุงุฎุชุจุงุฑ. ุชุญุชุงุฌ ุฅูู ุงูุชุฃูุฏ ูู ุฃู ูุฌููุนุฉ ุงูุงุฎุชุจุงุฑ ุชุบุทู ูุชุฑุฉ ุฒูููุฉ ูุงุญูุฉ ููุฌููุนุฉ ุงูุชุฏุฑูุจ ูุถูุงู ุฃู ุงููููุฐุฌ ูุง ูุญุตู ุนูู ูุนูููุงุช ูู ูุชุฑุงุช ุฒูููุฉ ูุณุชูุจููุฉ.

1. ุฎุตุต ูุชุฑุฉ ุดูุฑูู ูู 1 ุณุจุชูุจุฑ ุฅูู 31 ุฃูุชูุจุฑ 2014 ููุฌููุนุฉ ุงูุชุฏุฑูุจ. ุณุชุดูู ูุฌููุนุฉ ุงูุงุฎุชุจุงุฑ ูุชุฑุฉ ุงูุดูุฑูู ูู 1 ููููุจุฑ ุฅูู 31 ุฏูุณูุจุฑ 2014:

    ```python
    train_start_dt = '2014-11-01 00:00:00'
    test_start_dt = '2014-12-30 00:00:00'
    ```

    ูุธุฑูุง ูุฃู ูุฐู ุงูุจูุงูุงุช ุชุนูุณ ุงุณุชููุงู ุงูุทุงูุฉ ุงูููููุ ููุงู ููุท ููุณูู ูููุ ูููู ุงูุงุณุชููุงู ูููู ุฃูุซุฑ ุชุดุงุจููุง ูุน ุงูุงุณุชููุงู ูู ุงูุฃูุงู ุงูุฃุฎูุฑุฉ.

1. ูู ุจุชุตูุฑ ุงููุฑููุงุช:

    ```python
    energy[(energy.index < test_start_dt) & (energy.index >= train_start_dt)][['load']].rename(columns={'load':'train'}) \
        .join(energy[test_start_dt:][['load']].rename(columns={'load':'test'}), how='outer') \
        .plot(y=['train', 'test'], figsize=(15, 8), fontsize=12)
    plt.xlabel('timestamp', fontsize=12)
    plt.ylabel('load', fontsize=12)
    plt.show()
    ```

    ![ุจูุงูุงุช ุงูุชุฏุฑูุจ ูุงูุงุฎุชุจุงุฑ](../../../../7-TimeSeries/2-ARIMA/images/train-test.png)

    ูุฐููุ ุงุณุชุฎุฏุงู ูุงูุฐุฉ ุฒูููุฉ ุตุบูุฑุฉ ูุณุจููุง ูุชุฏุฑูุจ ุงูุจูุงูุงุช ูุฌุจ ุฃู ูููู ูุงูููุง.

    > ููุงุญุธุฉ: ูุธุฑูุง ูุฃู ุงููุธููุฉ ุงูุชู ูุณุชุฎุฏููุง ูุชูุงุฆู ูููุฐุฌ ARIMA ุชุณุชุฎุฏู ุงูุชุญูู ุฏุงุฎู ุงูุนููุฉ ุฃุซูุงุก ุงูุชูุงุคูุ ุณูููู ุจุชุฌุงูู ุจูุงูุงุช ุงูุชุญูู.

### ุชุญุถูุฑ ุงูุจูุงูุงุช ููุชุฏุฑูุจ

ุงูุขูุ ุชุญุชุงุฌ ุฅูู ุชุญุถูุฑ ุงูุจูุงูุงุช ููุชุฏุฑูุจ ุนู ุทุฑูู ุชุตููุชูุง ูุชูุณูุน ูุทุงููุง. ูู ุจุชุตููุฉ ูุฌููุนุฉ ุงูุจูุงูุงุช ุงูุฎุงุตุฉ ุจู ูุชุดูู ููุท ุงููุชุฑุงุช ุงูุฒูููุฉ ูุงูุฃุนูุฏุฉ ุงูุชู ุชุญุชุงุฌูุงุ ููู ุจุชูุณูุน ุงููุทุงู ูุถูุงู ุฃู ุงูุจูุงูุงุช ุชูุน ูู ุงููุทุงู 0,1.

1. ูู ุจุชุตููุฉ ูุฌููุนุฉ ุงูุจูุงูุงุช ุงูุฃุตููุฉ ูุชุดูู ููุท ุงููุชุฑุงุช ุงูุฒูููุฉ ุงููุฐููุฑุฉ ููู ูุฌููุนุฉุ ูุน ุชุถููู ุงูุนููุฏ ุงููุทููุจ 'load' ุจุงูุฅุถุงูุฉ ุฅูู ุงูุชุงุฑูุฎ:

    ```python
    train = energy.copy()[(energy.index >= train_start_dt) & (energy.index < test_start_dt)][['load']]
    test = energy.copy()[energy.index >= test_start_dt][['load']]

    print('Training data shape: ', train.shape)
    print('Test data shape: ', test.shape)
    ```

    ููููู ุฑุคูุฉ ุดูู ุงูุจูุงูุงุช:

    ```output
    Training data shape:  (1416, 1)
    Test data shape:  (48, 1)
    ```

1. ูู ุจุชูุณูุน ูุทุงู ุงูุจูุงูุงุช ูุชููู ูู ุงููุทุงู (0, 1).

    ```python
    scaler = MinMaxScaler()
    train['load'] = scaler.fit_transform(train)
    train.head(10)
    ```

1. ูู ุจุชุตูุฑ ุงูุจูุงูุงุช ุงูุฃุตููุฉ ููุงุจู ุงูุจูุงูุงุช ุงูููุณุนุฉ:

    ```python
    energy[(energy.index >= train_start_dt) & (energy.index < test_start_dt)][['load']].rename(columns={'load':'original load'}).plot.hist(bins=100, fontsize=12)
    train.rename(columns={'load':'scaled load'}).plot.hist(bins=100, fontsize=12)
    plt.show()
    ```

    ![ุงูุฃุตููุฉ](../../../../7-TimeSeries/2-ARIMA/images/original.png)

    > ุงูุจูุงูุงุช ุงูุฃุตููุฉ

    ![ุงูููุณุนุฉ](../../../../7-TimeSeries/2-ARIMA/images/scaled.png)

    > ุงูุจูุงูุงุช ุงูููุณุนุฉ

1. ุงูุขู ุจุนุฏ ุฃู ููุช ุจูุนุงูุฑุฉ ุงูุจูุงูุงุช ุงูููุณุนุฉุ ููููู ุชูุณูุน ูุทุงู ุจูุงูุงุช ุงูุงุฎุชุจุงุฑ:

    ```python
    test['load'] = scaler.transform(test)
    test.head()
    ```

### ุชูููุฐ ARIMA

ุญุงู ุงูููุช ูุชูููุฐ ARIMA! ุณุชุณุชุฎุฏู ุงูุขู ููุชุจุฉ `statsmodels` ุงูุชู ููุช ุจุชุซุจูุชูุง ุณุงุจููุง.

ุงูุขู ุชุญุชุงุฌ ุฅูู ุงุชุจุงุน ุนุฏุฉ ุฎุทูุงุช:

   1. ูู ุจุชุนุฑูู ุงููููุฐุฌ ุนู ุทุฑูู ุงุณุชุฏุนุงุก `SARIMAX()` ูุชูุฑูุฑ ูุนููุงุช ุงููููุฐุฌ: ุงููุนููุงุช pุ dุ ู qุ ุจุงูุฅุถุงูุฉ ุฅูู ุงููุนููุงุช Pุ Dุ ู Q.
   2. ูู ุจุชุญุถูุฑ ุงููููุฐุฌ ูุจูุงูุงุช ุงูุชุฏุฑูุจ ุนู ุทุฑูู ุงุณุชุฏุนุงุก ูุธููุฉ `fit()`.
   3. ูู ุจุฅุฌุฑุงุก ุงูุชูุจุคุงุช ุนู ุทุฑูู ุงุณุชุฏุนุงุก ูุธููุฉ `forecast()` ูุชุญุฏูุฏ ุนุฏุฏ ุงูุฎุทูุงุช (ุงูุฃูู) ููุชูุจุค.

> ๐ ูุง ูู ูู ูุฐู ุงููุนููุงุชุ ูู ูููุฐุฌ ARIMAุ ููุงู 3 ูุนููุงุช ุชูุณุชุฎุฏู ูููุณุงุนุฏุฉ ูู ููุฐุฌุฉ ุงูุฌูุงูุจ ุงูุฑุฆูุณูุฉ ููุณูุณูุฉ ุงูุฒูููุฉ: ุงูููุณููุฉุ ุงูุงุชุฌุงูุ ูุงูุถูุถุงุก. ูุฐู ุงููุนููุงุช ูู:

`p`: ุงููุนููุฉ ุงููุฑุชุจุทุฉ ุจุฌุงูุจ ุงูุงูุญุฏุงุฑ ุงูุฐุงุชู ูููููุฐุฌุ ูุงูุฐู ูุฏูุฌ ุงูููู *ุงูุณุงุจูุฉ*.

`d`: ุงููุนููุฉ ุงููุฑุชุจุทุฉ ุจุงูุฌุฒุก ุงููุชูุงูู ูููููุฐุฌุ ูุงูุชู ุชุคุซุฑ ุนูู ููุฏุงุฑ *ุงููุฑู* (๐ ุชุฐูุฑ ุงููุฑู ๐ุ) ุงูุฐู ูุชู ุชุทุจููู ุนูู ุงูุณูุณูุฉ ุงูุฒูููุฉ.

`q`: ุงููุนููุฉ ุงููุฑุชุจุทุฉ ุจุฌุงูุจ ุงููุชูุณุท ุงููุชุญุฑู ูููููุฐุฌ.

> ููุงุญุธุฉ: ุฅุฐุง ูุงูุช ุจูุงูุงุชู ุชุญุชูู ุนูู ุฌุงูุจ ููุณูู - ููุง ูู ุงูุญุงู ููุง -ุ ูุณุชุฎุฏู ูููุฐุฌ ARIMA ุงูููุณูู (SARIMA). ูู ูุฐู ุงูุญุงูุฉุ ุชุญุชุงุฌ ุฅูู ุงุณุชุฎุฏุงู ูุฌููุนุฉ ุฃุฎุฑู ูู ุงููุนููุงุช: `P`ุ `D`ุ ู `Q` ุงูุชู ุชุตู ููุณ ุงูุงุฑุชุจุงุทุงุช ูุซู `p`ุ `d`ุ ู `q`ุ ูููููุง ุชุชุนูู ุจุงูููููุงุช ุงูููุณููุฉ ูููููุฐุฌ.

1. ุงุจุฏุฃ ุจุชุญุฏูุฏ ูููุฉ ุงูุฃูู ุงูููุถูุฉ ูุฏูู. ููุญุงูู 3 ุณุงุนุงุช:

    ```python
    # Specify the number of steps to forecast ahead
    HORIZON = 3
    print('Forecasting horizon:', HORIZON, 'hours')
    ```

    ุงุฎุชูุงุฑ ุฃูุถู ุงูููู ููุนููุงุช ูููุฐุฌ ARIMA ูููู ุฃู ูููู ุชุญุฏููุง ูุฃูู ูุนุชูุฏ ุฅูู ุญุฏ ูุจูุฑ ุนูู ุงูุชูุฏูุฑ ุงูุดุฎุตู ููุณุชุบุฑู ููุชูุง. ููููู ุงูุชูููุฑ ูู ุงุณุชุฎุฏุงู ูุธููุฉ `auto_arima()` ูู ููุชุจุฉ [`pyramid`](https://alkaline-ml.com/pmdarima/0.9.0/modules/generated/pyramid.arima.auto_arima.html).

1. ูู ุงูููุช ุงูุญุงููุ ุฌุฑุจ ุจุนุถ ุงูุงุฎุชูุงุฑุงุช ุงููุฏููุฉ ููุนุซูุฑ ุนูู ูููุฐุฌ ุฌูุฏ.

    ```python
    order = (4, 1, 0)
    seasonal_order = (1, 1, 0, 24)

    model = SARIMAX(endog=train, order=order, seasonal_order=seasonal_order)
    results = model.fit()

    print(results.summary())
    ```

    ูุชู ุทุจุงุนุฉ ุฌุฏูู ุงููุชุงุฆุฌ.

ููุฏ ููุช ุจุจูุงุก ูููุฐุฌู ุงูุฃูู! ุงูุขู ูุญุชุงุฌ ุฅูู ุฅูุฌุงุฏ ุทุฑููุฉ ูุชููููู.

### ุชูููู ุงููููุฐุฌ ุงูุฎุงุต ุจู

ูุชูููู ุงููููุฐุฌ ุงูุฎุงุต ุจูุ ููููู ุชูููุฐ ูุง ููุณูู ุจู `ุงูุชุญูู ุงูุชุฏุฑูุฌู`. ูู ุงูููุงุฑุณุฉ ุงูุนูููุฉุ ูุชู ุฅุนุงุฏุฉ ุชุฏุฑูุจ ููุงุฐุฌ ุงูุณูุงุณู ุงูุฒูููุฉ ูู ูู ูุฑุฉ ุชุตุจุญ ูููุง ุจูุงูุงุช ุฌุฏูุฏุฉ ูุชุงุญุฉ. ูุณูุญ ูุฐุง ูููููุฐุฌ ุจุชูุฏูู ุฃูุถู ุชูุจุค ูู ูู ุฎุทูุฉ ุฒูููุฉ.

ุงุจุฏุฃ ูู ุจุฏุงูุฉ ุงูุณูุณูุฉ ุงูุฒูููุฉ ุจุงุณุชุฎุฏุงู ูุฐู ุงูุชูููุฉุ ูู ุจุชุฏุฑูุจ ุงููููุฐุฌ ุนูู ูุฌููุนุฉ ุจูุงูุงุช ุงูุชุฏุฑูุจ. ุซู ูู ุจุฅุฌุฑุงุก ุชูุจุค ุนูู ุงูุฎุทูุฉ ุงูุฒูููุฉ ุงูุชุงููุฉ. ูุชู ุชูููู ุงูุชูุจุค ููุงุจู ุงููููุฉ ุงููุนุฑููุฉ. ูุชู ุจุนุฏ ุฐูู ุชูุณูุน ูุฌููุนุฉ ุงูุชุฏุฑูุจ ูุชุดูู ุงููููุฉ ุงููุนุฑููุฉ ููุชู ุชูุฑุงุฑ ุงูุนูููุฉ.

> ููุงุญุธุฉ: ูุฌุจ ุฃู ุชุญุงูุธ ุนูู ูุงูุฐุฉ ูุฌููุนุฉ ุงูุชุฏุฑูุจ ุซุงุจุชุฉ ูุชุญููู ุชุฏุฑูุจ ุฃูุซุฑ ููุงุกุฉุ ุจุญูุซ ูู ูู ูุฑุฉ ุชุถูู ููุงุญุธุฉ ุฌุฏูุฏุฉ ุฅูู ูุฌููุนุฉ ุงูุชุฏุฑูุจุ ุชููู ุจุฅุฒุงูุฉ ุงูููุงุญุธุฉ ูู ุจุฏุงูุฉ ุงููุฌููุนุฉ.

ุชููุฑ ูุฐู ุงูุนูููุฉ ุชูุฏูุฑูุง ุฃูุซุฑ ุฏูุฉ ูููููุฉ ุฃุฏุงุก ุงููููุฐุฌ ูู ุงูููุงุฑุณุฉ ุงูุนูููุฉ. ููุน ุฐููุ ูุฅููุง ุชุฃุชู ุจุชูููุฉ ุญุณุงุจูุฉ ุจุณุจุจ ุฅูุดุงุก ุงูุนุฏูุฏ ูู ุงูููุงุฐุฌ. ูุฐุง ููุจูู ุฅุฐุง ูุงูุช ุงูุจูุงูุงุช ุตุบูุฑุฉ ุฃู ุฅุฐุง ูุงู ุงููููุฐุฌ ุจุณูุทูุงุ ููููู ูุฏ ูููู ูุดููุฉ ุนูู ูุทุงู ูุงุณุน.

ููุนุชุจุฑ ุงูุชุญูู ุงูุชุฏุฑูุฌู ุงููุนูุงุฑ ุงูุฐูุจู ูุชูููู ููุงุฐุฌ ุงูุณูุงุณู ุงูุฒูููุฉ ูููุตู ุจู ููุดุงุฑูุนู ุงูุฎุงุตุฉ.

1. ุฃููุงูุ ูู ุจุฅูุดุงุก ููุทุฉ ุจูุงูุงุช ุงุฎุชุจุงุฑ ููู ุฎุทูุฉ ุฃูููุฉ.

    ```python
    test_shifted = test.copy()

    for t in range(1, HORIZON+1):
        test_shifted['load+'+str(t)] = test_shifted['load'].shift(-t, freq='H')

    test_shifted = test_shifted.dropna(how='any')
    test_shifted.head(5)
    ```

    |            |          | load | load+1 | load+2 |
    | ---------- | -------- | ---- | ------ | ------ |
    | 2014-12-30 | 00:00:00 | 0.33 | 0.29   | 0.27   |
    | 2014-12-30 | 01:00:00 | 0.29 | 0.27   | 0.27   |
    | 2014-12-30 | 02:00:00 | 0.27 | 0.27   | 0.30   |
    | 2014-12-30 | 03:00:00 | 0.27 | 0.30   | 0.41   |
    | 2014-12-30 | 04:00:00 | 0.30 | 0.41   | 0.57   |

    ูุชู ุฅุฒุงุญุฉ ุงูุจูุงูุงุช ุฃููููุง ููููุง ูููุทุฉ ุงูุฃูู.

1. ูู ุจุฅุฌุฑุงุก ุงูุชูุจุคุงุช ุนูู ุจูุงูุงุช ุงูุงุฎุชุจุงุฑ ุจุงุณุชุฎุฏุงู ูุฐุง ุงูููุฌ ุงููุชุญุฑู ูู ุญููุฉ ุจุญุฌู ุทูู ุจูุงูุงุช ุงูุงุฎุชุจุงุฑ:

    ```python
    %%time
    training_window = 720 # dedicate 30 days (720 hours) for training

    train_ts = train['load']
    test_ts = test_shifted

    history = [x for x in train_ts]
    history = history[(-training_window):]

    predictions = list()

    order = (2, 1, 0)
    seasonal_order = (1, 1, 0, 24)

    for t in range(test_ts.shape[0]):
        model = SARIMAX(endog=history, order=order, seasonal_order=seasonal_order)
        model_fit = model.fit()
        yhat = model_fit.forecast(steps = HORIZON)
        predictions.append(yhat)
        obs = list(test_ts.iloc[t])
        # move the training window
        history.append(obs[0])
        history.pop(0)
        print(test_ts.index[t])
        print(t+1, ': predicted =', yhat, 'expected =', obs)
    ```

    ููููู ูุดุงูุฏุฉ ุนูููุฉ ุงูุชุฏุฑูุจ:

    ```output
    2014-12-30 00:00:00
    1 : predicted = [0.32 0.29 0.28] expected = [0.32945389435989236, 0.2900626678603402, 0.2739480752014323]

    2014-12-30 01:00:00
    2 : predicted = [0.3  0.29 0.3 ] expected = [0.2900626678603402, 0.2739480752014323, 0.26812891674127126]

    2014-12-30 02:00:00
    3 : predicted = [0.27 0.28 0.32] expected = [0.2739480752014323, 0.26812891674127126, 0.3025962399283795]
    ```

1. ูุงุฑู ุงูุชูุจุคุงุช ุจุงูุญูู ุงููุนูู:

    ```python
    eval_df = pd.DataFrame(predictions, columns=['t+'+str(t) for t in range(1, HORIZON+1)])
    eval_df['timestamp'] = test.index[0:len(test.index)-HORIZON+1]
    eval_df = pd.melt(eval_df, id_vars='timestamp', value_name='prediction', var_name='h')
    eval_df['actual'] = np.array(np.transpose(test_ts)).ravel()
    eval_df[['prediction', 'actual']] = scaler.inverse_transform(eval_df[['prediction', 'actual']])
    eval_df.head()
    ```

    ุงููุฎุฑุฌุงุช
    |     |            | timestamp | h   | prediction | actual   |
    | --- | ---------- | --------- | --- | ---------- | -------- |
    | 0   | 2014-12-30 | 00:00:00  | t+1 | 3,008.74   | 3,023.00 |
    | 1   | 2014-12-30 | 01:00:00  | t+1 | 2,955.53   | 2,935.00 |
    | 2   | 2014-12-30 | 02:00:00  | t+1 | 2,900.17   | 2,899.00 |
    | 3   | 2014-12-30 | 03:00:00  | t+1 | 2,917.69   | 2,886.00 |
    | 4   | 2014-12-30 | 04:00:00  | t+1 | 2,946.99   | 2,963.00 |

    ูุงุญุธ ุงูุชูุจุค ุจุงูุจูุงูุงุช ููู ุณุงุนุฉุ ููุงุฑูุฉ ุจุงูุญูู ุงููุนูู. ูุง ูุฏู ุฏูุฉ ูุฐุงุ

### ุชุญูู ูู ุฏูุฉ ุงููููุฐุฌ

ุชุญูู ูู ุฏูุฉ ุงููููุฐุฌ ุงูุฎุงุต ุจู ุนู ุทุฑูู ุงุฎุชุจุงุฑ ูุชูุณุท ูุณุจุฉ ุงูุฎุทุฃ ุงููุทูู (MAPE) ูุฌููุน ุงูุชูุจุคุงุช.
> **๐งฎ ุฃุธูุฑ ูู ุงูุฑูุงุถูุงุช**
>
> ![MAPE](../../../../7-TimeSeries/2-ARIMA/images/mape.png)
>
> [MAPE](https://www.linkedin.com/pulse/what-mape-mad-msd-time-series-allameh-statistics/) ุชูุณุชุฎุฏู ูุนุฑุถ ุฏูุฉ ุงูุชูุจุค ููุณุจุฉ ุชูุนุฑูููุง ุงูุตูุบุฉ ุฃุนูุงู. ูุชู ูุณูุฉ ุงููุฑู ุจูู ุงูููู ุงููุนููุฉ ูุงููุชููุนุฉ ุนูู ุงูููู ุงููุนููุฉ.  
> "ูุชู ุฌูุน ุงููููุฉ ุงููุทููุฉ ูู ูุฐุง ุงูุญุณุงุจ ููู ููุทุฉ ูุชููุนุฉ ูู ุงูุฒูู ููุณูุชูุง ุนูู ุนุฏุฏ ุงูููุงุท ุงูููุงุฆูุฉ n." [wikipedia](https://wikipedia.org/wiki/Mean_absolute_percentage_error)
1. ุนุจุฑ ุนู ุงููุนุงุฏูุฉ ูู ุงูููุฏ:

    ```python
    if(HORIZON > 1):
        eval_df['APE'] = (eval_df['prediction'] - eval_df['actual']).abs() / eval_df['actual']
        print(eval_df.groupby('h')['APE'].mean())
    ```

1. ุงุญุณุจ MAPE ูุฎุทูุฉ ูุงุญุฏุฉ:

    ```python
    print('One step forecast MAPE: ', (mape(eval_df[eval_df['h'] == 't+1']['prediction'], eval_df[eval_df['h'] == 't+1']['actual']))*100, '%')
    ```

    MAPE ูุชููุน ุฎุทูุฉ ูุงุญุฏุฉ: 0.5570581332313952 %

1. ุงุทุจุน MAPE ูุชููุน ูุชุนุฏุฏ ุงูุฎุทูุงุช:

    ```python
    print('Multi-step forecast MAPE: ', mape(eval_df['prediction'], eval_df['actual'])*100, '%')
    ```

    ```output
    Multi-step forecast MAPE:  1.1460048657704118 %
    ```

    ุฑูู ููุฎูุถ ุฌููู ูู ุงูุฃูุถู: ุถุน ูู ุงุนุชุจุงุฑู ุฃู ุงูุชููุน ุงูุฐู ูุญุชูู ุนูู MAPE ุจูููุฉ 10 ูุนูู ุฃูู ุฎุงุทุฆ ุจูุณุจุฉ 10%.

1. ูููู ููุง ูู ุงูุญุงู ุฏุงุฆููุงุ ูู ุงูุฃุณูู ุฑุคูุฉ ูุฐุง ุงูููุน ูู ููุงุณ ุงูุฏูุฉ ุจุตุฑููุงุ ูุฐุง ุฏุนูุง ูุฑุณูู:

    ```python
     if(HORIZON == 1):
        ## Plotting single step forecast
        eval_df.plot(x='timestamp', y=['actual', 'prediction'], style=['r', 'b'], figsize=(15, 8))

    else:
        ## Plotting multi step forecast
        plot_df = eval_df[(eval_df.h=='t+1')][['timestamp', 'actual']]
        for t in range(1, HORIZON+1):
            plot_df['t+'+str(t)] = eval_df[(eval_df.h=='t+'+str(t))]['prediction'].values

        fig = plt.figure(figsize=(15, 8))
        ax = plt.plot(plot_df['timestamp'], plot_df['actual'], color='red', linewidth=4.0)
        ax = fig.add_subplot(111)
        for t in range(1, HORIZON+1):
            x = plot_df['timestamp'][(t-1):]
            y = plot_df['t+'+str(t)][0:len(x)]
            ax.plot(x, y, color='blue', linewidth=4*math.pow(.9,t), alpha=math.pow(0.8,t))

        ax.legend(loc='best')

    plt.xlabel('timestamp', fontsize=12)
    plt.ylabel('load', fontsize=12)
    plt.show()
    ```

    ![ูููุฐุฌ ุณูุณูุฉ ุฒูููุฉ](../../../../7-TimeSeries/2-ARIMA/images/accuracy.png)

๐ ุฑุณู ุฌููู ุฌุฏูุงุ ูุธูุฑ ูููุฐุฌูุง ุจุฏูุฉ ุฌูุฏุฉ. ุนูู ุฑุงุฆุน!

---

## ๐ุงูุชุญุฏู

ุงุณุชูุดู ุงูุทุฑู ุงููุฎุชููุฉ ูุงุฎุชุจุงุฑ ุฏูุฉ ูููุฐุฌ ุงูุณูุงุณู ุงูุฒูููุฉ. ููุฏ ุชูุงูููุง MAPE ูู ูุฐุง ุงูุฏุฑุณุ ูููู ูู ููุงู ุทุฑู ุฃุฎุฑู ููููู ุงุณุชุฎุฏุงููุงุ ูู ุจุงูุจุญุซ ุนููุง ููู ุจุชูุถูุญูุง. ูููู ุงูุนุซูุฑ ุนูู ูุซููุฉ ูููุฏุฉ [ููุง](https://otexts.com/fpp2/accuracy.html)

## [ุงุฎุชุจุงุฑ ูุง ุจุนุฏ ุงูุฏุฑุณ](https://ff-quizzes.netlify.app/en/ml/)

## ุงููุฑุงุฌุนุฉ ูุงูุฏุฑุงุณุฉ ุงูุฐุงุชูุฉ

ูุชูุงูู ูุฐุง ุงูุฏุฑุณ ููุท ุฃุณุงุณูุงุช ุงูุชูุจุค ุจุงูุณูุงุณู ุงูุฒูููุฉ ุจุงุณุชุฎุฏุงู ARIMA. ุฎุฐ ุจุนุถ ุงูููุช ูุชุนููู ูุนุฑูุชู ูู ุฎูุงู ุงุณุชูุดุงู [ูุฐุง ุงููุณุชูุฏุน](https://microsoft.github.io/forecasting/) ูุฃููุงุน ุงูููุงุฐุฌ ุงููุฎุชููุฉ ููู ูุชุชุนูู ุทุฑููุง ุฃุฎุฑู ูุจูุงุก ููุงุฐุฌ ุงูุณูุงุณู ุงูุฒูููุฉ.

## ุงููุงุฌุจ

[ูููุฐุฌ ARIMA ุฌุฏูุฏ](assignment.md)

---

**ุฅุฎูุงุก ุงููุณุคูููุฉ**:  
ุชู ุชุฑุฌูุฉ ูุฐุง ุงููุณุชูุฏ ุจุงุณุชุฎุฏุงู ุฎุฏูุฉ ุงูุชุฑุฌูุฉ ุจุงูุฐูุงุก ุงูุงุตุทูุงุนู [Co-op Translator](https://github.com/Azure/co-op-translator). ุจูููุง ูุณุนู ูุชุญููู ุงูุฏูุฉุ ูุฑุฌู ุงูุนูู ุฃู ุงูุชุฑุฌูุงุช ุงูุขููุฉ ูุฏ ุชุญุชูู ุนูู ุฃุฎุทุงุก ุฃู ูุนูููุงุช ุบูุฑ ุฏูููุฉ. ูุฌุจ ุงุนุชุจุงุฑ ุงููุณุชูุฏ ุงูุฃุตูู ุจูุบุชู ุงูุฃุตููุฉ ูู ุงููุตุฏุฑ ุงูููุซูู. ููุญุตูู ุนูู ูุนูููุงุช ุญุงุณูุฉุ ูููุตู ุจุงูุงุณุชุนุงูุฉ ุจุชุฑุฌูุฉ ุจุดุฑูุฉ ุงุญุชุฑุงููุฉ. ูุญู ุบูุฑ ูุณุคูููู ุนู ุฃู ุณูุก ููู ุฃู ุชูุณูุฑุงุช ุฎุงุทุฆุฉ ูุงุชุฌุฉ ุนู ุงุณุชุฎุฏุงู ูุฐู ุงูุชุฑุฌูุฉ.