<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "911efd5e595089000cb3c16fce1beab8",
  "translation_date": "2025-09-04T20:51:29+00:00",
  "source_file": "8-Reinforcement/1-QLearning/README.md",
  "language_code": "ar"
}
-->
# ููุฏูุฉ ุฅูู ุงูุชุนูู ุงูุชุนุฒูุฒู ูุฎูุงุฑุฒููุฉ Q-Learning

![ููุฎุต ุงูุชุนูู ุงูุชุนุฒูุฒู ูู ุงูุชุนูู ุงูุขูู ูู ุฑุณู ุชูุถูุญู](../../../../sketchnotes/ml-reinforcement.png)
> ุฑุณู ุชูุถูุญู ุจูุงุณุทุฉ [Tomomi Imura](https://www.twitter.com/girlie_mac)

ูุชุถูู ุงูุชุนูู ุงูุชุนุฒูุฒู ุซูุงุซุฉ ููุงููู ูููุฉ: ุงูููููุ ุจุนุถ ุงูุญุงูุงุชุ ููุฌููุนุฉ ูู ุงูุฅุฌุฑุงุกุงุช ููู ุญุงูุฉ. ูู ุฎูุงู ุชูููุฐ ุฅุฌุฑุงุก ูู ุญุงูุฉ ูุนููุฉุ ูุญุตู ุงููููู ุนูู ููุงูุฃุฉ. ุชุฎูู ูุฑุฉ ุฃุฎุฑู ูุนุจุฉ ุงูููุจููุชุฑ "ุณูุจุฑ ูุงุฑูู". ุฃูุช ูุงุฑููุ ูุฃูุช ูู ูุณุชูู ูู ุงููุนุจุฉุ ุชูู ุจุฌุงูุจ ุญุงูุฉ ููุญุฏุฑ. ูููู ุชูุฌุฏ ุนููุฉ ูุนุฏููุฉ. ูููู ูุงุฑููุ ูู ูุณุชูู ูุนูู ูู ุงููุนุจุฉุ ูู ูููุน ูุนูู... ูุฐู ูู ุญุงูุชู. ุงูุชุญุฑู ุฎุทูุฉ ุฅูู ุงููููู (ุฅุฌุฑุงุก) ุณูุฌุนูู ุชุณูุท ูู ุงูุญุงูุฉุ ููุฐุง ุณูููุญู ุฏุฑุฌุฉ ุฑูููุฉ ููุฎูุถุฉ. ููุน ุฐููุ ูุฅู ุงูุถุบุท ุนูู ุฒุฑ ุงูููุฒ ุณูุฌุนูู ุชุญุตู ุนูู ููุทุฉ ูุณุชุจูู ุนูู ููุฏ ุงูุญูุงุฉ. ูุฐุง ูุชูุฌุฉ ุฅูุฌุงุจูุฉ ููุฌุจ ุฃู ุชููุญู ุฏุฑุฌุฉ ุฑูููุฉ ุฅูุฌุงุจูุฉ.

ุจุงุณุชุฎุฏุงู ุงูุชุนูู ุงูุชุนุฒูุฒู ูุงููุญุงูุงุฉ (ุงููุนุจุฉ)ุ ููููู ุชุนูู ููููุฉ ูุนุจ ุงููุนุจุฉ ูุชุญููู ุฃูุตู ูุฏุฑ ูู ุงูููุงูุขุชุ ููู ุงูุจูุงุก ุนูู ููุฏ ุงูุญูุงุฉ ูุชุณุฌูู ุฃูุจุฑ ุนุฏุฏ ูููู ูู ุงูููุงุท.

[![ููุฏูุฉ ุฅูู ุงูุชุนูู ุงูุชุนุฒูุฒู](https://img.youtube.com/vi/lDq_en8RNOo/0.jpg)](https://www.youtube.com/watch?v=lDq_en8RNOo)

> ๐ฅ ุงููุฑ ุนูู ุงูุตูุฑุฉ ุฃุนูุงู ููุงุณุชูุงุน ุฅูู ุฏููุชุฑู ููู ููุงูุด ุงูุชุนูู ุงูุชุนุฒูุฒู

## [ุงุฎุชุจุงุฑ ูุง ูุจู ุงููุญุงุถุฑุฉ](https://ff-quizzes.netlify.app/en/ml/)

## ุงููุชุทูุจุงุช ูุงูุฅุนุฏุงุฏ

ูู ูุฐุง ุงูุฏุฑุณุ ุณูุฌุฑุจ ุจุนุถ ุงูุฃููุงุฏ ุจูุบุฉ Python. ูุฌุจ ุฃู ุชููู ูุงุฏุฑูุง ุนูู ุชุดุบูู ููุฏ Jupyter Notebook ูู ูุฐุง ุงูุฏุฑุณุ ุณูุงุก ุนูู ุฌูุงุฒ ุงูููุจููุชุฑ ุงูุฎุงุต ุจู ุฃู ูู ุงูุณุญุงุจุฉ.

ููููู ูุชุญ [ุฏูุชุฑ ุงูุฏุฑุณ](https://github.com/microsoft/ML-For-Beginners/blob/main/8-Reinforcement/1-QLearning/notebook.ipynb) ููุชุงุจุนุฉ ูุฐุง ุงูุฏุฑุณ ููุจูุงุก ุนููู.

> **ููุงุญุธุฉ:** ุฅุฐุง ููุช ุชูุชุญ ูุฐุง ุงูููุฏ ูู ุงูุณุญุงุจุฉุ ุณุชุญุชุงุฌ ุฃูุถูุง ุฅูู ุฌูุจ ููู [`rlboard.py`](https://github.com/microsoft/ML-For-Beginners/blob/main/8-Reinforcement/1-QLearning/rlboard.py)ุ ุงูุฐู ููุณุชุฎุฏู ูู ููุฏ ุงูุฏูุชุฑ. ุฃุถูู ุฅูู ููุณ ุงูุฏููู ุงูุฐู ูุญุชูู ุนูู ุงูุฏูุชุฑ.

## ุงูููุฏูุฉ

ูู ูุฐุง ุงูุฏุฑุณุ ุณูุณุชูุดู ุนุงูู **[ุจูุชุฑ ูุงูุฐุฆุจ](https://en.wikipedia.org/wiki/Peter_and_the_Wolf)**ุ ุงููุณุชูุญู ูู ุญูุงูุฉ ููุณูููุฉ ุฎุฑุงููุฉ ูู ุชุฃููู ุงูููุญู ุงูุฑูุณู [ุณูุฑุฌู ุจุฑููููููู](https://en.wikipedia.org/wiki/Sergei_Prokofiev). ุณูุณุชุฎุฏู **ุงูุชุนูู ุงูุชุนุฒูุฒู** ูุชูููู ุจูุชุฑ ูู ุงุณุชูุดุงู ุจูุฆุชูุ ุฌูุน ุงูุชูุงุญ ุงููุฐูุฐ ูุชุฌูุจ ููุงุฌูุฉ ุงูุฐุฆุจ.

**ุงูุชุนูู ุงูุชุนุฒูุฒู** (RL) ูู ุชูููุฉ ุชุนูู ุชุชูุญ ููุง ุชุนูู ุงูุณููู ุงูุฃูุซู ููููู **agent** ูู ุจูุฆุฉ **environment** ูุนููุฉ ูู ุฎูุงู ุฅุฌุฑุงุก ุงูุนุฏูุฏ ูู ุงูุชุฌุงุฑุจ. ูุฌุจ ุฃู ูููู ูููููู ูู ูุฐู ุงูุจูุฆุฉ ูุฏู **goal** ูุญุฏุฏ ุจูุงุณุทุฉ ุฏุงูุฉ ููุงูุฃุฉ **reward function**.

## ุงูุจูุฆุฉ

ููุชุจุณูุทุ ุฏุนููุง ูุนุชุจุฑ ุฃู ุนุงูู ุจูุชุฑ ูู ููุญุฉ ูุฑุจุนุฉ ุจุญุฌู `width` x `height`ุ ูุซู ูุฐู:

![ุจูุฆุฉ ุจูุชุฑ](../../../../8-Reinforcement/1-QLearning/images/environment.png)

ูู ุฎููุฉ ูู ูุฐู ุงูููุญุฉ ูููู ุฃู ุชููู:

* **ุฃุฑุถ**ุ ูููู ูุจูุชุฑ ูุงููุฎูููุงุช ุงูุฃุฎุฑู ุงููุดู ุนูููุง.
* **ูุงุก**ุ ูุง ูููู ุงููุดู ุนููู ุจุงูุทุจุน.
* **ุดุฌุฑุฉ** ุฃู **ุนุดุจ**ุ ููุงู ูููู ุงูุฑุงุญุฉ ููู.
* **ุชูุงุญุฉ**ุ ุชูุซู ุดูุฆูุง ููุฏ ุจูุชุฑ ุงูุนุซูุฑ ุนููู ูุฅุทุนุงู ููุณู.
* **ุฐุฆุจ**ุ ููู ุฎุทูุฑ ููุฌุจ ุชุฌูุจู.

ููุฌุฏ ูุญุฏุฉ Python ูููุตูุฉุ [`rlboard.py`](https://github.com/microsoft/ML-For-Beginners/blob/main/8-Reinforcement/1-QLearning/rlboard.py)ุ ุชุญุชูู ุนูู ุงูููุฏ ููุนูู ูุน ูุฐู ุงูุจูุฆุฉ. ูุธุฑูุง ูุฃู ูุฐุง ุงูููุฏ ููุณ ููููุง ูููู ููุงููููุงุ ุณูููู ุจุงุณุชูุฑุงุฏ ุงููุญุฏุฉ ูุงุณุชุฎุฏุงููุง ูุฅูุดุงุก ุงูููุญุฉ ุงููููุฐุฌูุฉ (ูุชูุฉ ุงูููุฏ 1):

```python
from rlboard import *

width, height = 8,8
m = Board(width,height)
m.randomize(seed=13)
m.plot()
```

ูุฌุจ ุฃู ูุทุจุน ูุฐุง ุงูููุฏ ุตูุฑุฉ ููุจูุฆุฉ ูุดุงุจูุฉ ููุตูุฑุฉ ุฃุนูุงู.

## ุงูุฅุฌุฑุงุกุงุช ูุงูุณูุงุณุฉ

ูู ูุซุงููุงุ ุณูููู ูุฏู ุจูุชุฑ ูู ุงูุนุซูุฑ ุนูู ุชูุงุญุฉุ ูุน ุชุฌูุจ ุงูุฐุฆุจ ูุงูุนูุงุฆู ุงูุฃุฎุฑู. ููููุงู ุจุฐููุ ููููู ุจุจุณุงุทุฉ ุงูุชุฌูู ุญุชู ูุฌุฏ ุชูุงุญุฉ.

ูุฐููุ ูู ุฃู ููุถุนุ ููููู ุงูุงุฎุชูุงุฑ ุจูู ุฃุญุฏ ุงูุฅุฌุฑุงุกุงุช ุงูุชุงููุฉ: ุฃุนููุ ุฃุณููุ ูุณุงุฑุ ููููู.

ุณูุนุฑูู ูุฐู ุงูุฅุฌุฑุงุกุงุช ููุงููุณุ ููุฑุจุทูุง ุจุฃุฒูุงุฌ ูู ุงูุชุบูุฑุงุช ุงูููุณูุฉ ุงูููุงุจูุฉ. ุนูู ุณุจูู ุงููุซุงูุ ุงูุชุญุฑู ุฅูู ุงููููู (`R`) ุณููุงุจู ุงูุฒูุฌ `(1,0)`. (ูุชูุฉ ุงูููุฏ 2):

```python
actions = { "U" : (0,-1), "D" : (0,1), "L" : (-1,0), "R" : (1,0) }
action_idx = { a : i for i,a in enumerate(actions.keys()) }
```

ูุชูุฎูุตุ ุงูุงุณุชุฑุงุชูุฌูุฉ ูุงููุฏู ูู ูุฐุง ุงูุณููุงุฑูู ููุง ููุง ููู:

- **ุงูุงุณุชุฑุงุชูุฌูุฉ**ุ ุงูุฎุงุตุฉ ุจูููููุง (ุจูุชุฑ) ุชูุนุฑู ุจูุง ูุณูู **ุงูุณูุงุณุฉ**. ุงูุณูุงุณุฉ ูู ุฏุงูุฉ ุชูุฑุฌุน ุงูุฅุฌุฑุงุก ูู ุฃู ุญุงูุฉ ูุนููุฉ. ูู ุญุงูุชูุงุ ุชูุซู ุญุงูุฉ ุงููุดููุฉ ุงูููุญุฉุ ุจูุง ูู ุฐูู ุงูููุถุน ุงูุญุงูู ููุงุนุจ.

- **ุงููุฏู**ุ ูู ุงูุชุนูู ุงูุชุนุฒูุฒู ูู ูู ุงูููุงูุฉ ุชุนูู ุณูุงุณุฉ ุฌูุฏุฉ ุชุชูุญ ููุง ุญู ุงููุดููุฉ ุจููุงุกุฉ. ููุน ุฐููุ ูุฎุท ุฃุณุงุณุ ุฏุนููุง ูุนุชุจุฑ ุงูุณูุงุณุฉ ุงูุฃุจุณุท ุงููุณูุงุฉ **ุงููุดู ุงูุนุดูุงุฆู**.

## ุงููุดู ุงูุนุดูุงุฆู

ุฏุนููุง ูุญู ูุดููุชูุง ุฃููุงู ูู ุฎูุงู ุชูููุฐ ุงุณุชุฑุงุชูุฌูุฉ ุงููุดู ุงูุนุดูุงุฆู. ูุน ุงููุดู ุงูุนุดูุงุฆูุ ุณูุฎุชุงุฑ ุงูุฅุฌุฑุงุก ุงูุชุงูู ุนุดูุงุฆููุง ูู ุจูู ุงูุฅุฌุฑุงุกุงุช ุงููุณููุญ ุจูุงุ ุญุชู ูุตู ุฅูู ุงูุชูุงุญุฉ (ูุชูุฉ ุงูููุฏ 3).

1. ูู ุจุชูููุฐ ุงููุดู ุงูุนุดูุงุฆู ุจุงุณุชุฎุฏุงู ุงูููุฏ ุฃุฏูุงู:

    ```python
    def random_policy(m):
        return random.choice(list(actions))
    
    def walk(m,policy,start_position=None):
        n = 0 # number of steps
        # set initial position
        if start_position:
            m.human = start_position 
        else:
            m.random_start()
        while True:
            if m.at() == Board.Cell.apple:
                return n # success!
            if m.at() in [Board.Cell.wolf, Board.Cell.water]:
                return -1 # eaten by wolf or drowned
            while True:
                a = actions[policy(m)]
                new_pos = m.move_pos(m.human,a)
                if m.is_valid(new_pos) and m.at(new_pos)!=Board.Cell.water:
                    m.move(a) # do the actual move
                    break
            n+=1
    
    walk(m,random_policy)
    ```

    ูุฌุจ ุฃู ุชูุฑุฌุน ุงุณุชุฏุนุงุก `walk` ุทูู ุงููุณุงุฑ ุงูููุงุจูุ ูุงูุฐู ูููู ุฃู ูุฎุชูู ูู ุชุดุบูู ุฅูู ุขุฎุฑ.

1. ูู ุจุชุดุบูู ุชุฌุฑุจุฉ ุงููุดู ุนุฏุฉ ูุฑุงุช (ุนูู ุณุจูู ุงููุซุงูุ 100 ูุฑุฉ)ุ ูุงุทุจุน ุงูุฅุญุตุงุฆูุงุช ุงููุงุชุฌุฉ (ูุชูุฉ ุงูููุฏ 4):

    ```python
    def print_statistics(policy):
        s,w,n = 0,0,0
        for _ in range(100):
            z = walk(m,policy)
            if z<0:
                w+=1
            else:
                s += z
                n += 1
        print(f"Average path length = {s/n}, eaten by wolf: {w} times")
    
    print_statistics(random_policy)
    ```

    ูุงุญุธ ุฃู ูุชูุณุท ุทูู ุงููุณุงุฑ ุญูุงูู 30-40 ุฎุทูุฉุ ููู ุนุฏุฏ ูุจูุฑ ูุณุจููุงุ ุจุงููุธุฑ ุฅูู ุฃู ูุชูุณุท ุงููุณุงูุฉ ุฅูู ุฃูุฑุจ ุชูุงุญุฉ ุญูุงูู 5-6 ุฎุทูุงุช.

    ููููู ุฃูุถูุง ุฑุคูุฉ ููู ูุจุฏู ุชุญุฑู ุจูุชุฑ ุฃุซูุงุก ุงููุดู ุงูุนุดูุงุฆู:

    ![ูุดู ุจูุชุฑ ุงูุนุดูุงุฆู](../../../../8-Reinforcement/1-QLearning/images/random_walk.gif)

## ุฏุงูุฉ ุงูููุงูุฃุฉ

ูุฌุนู ุณูุงุณุชูุง ุฃูุซุฑ ุฐูุงุกูุ ูุญุชุงุฌ ุฅูู ููู ุฃู ุงูุญุฑูุงุช "ุฃูุถู" ูู ุบูุฑูุง. ููููุงู ุจุฐููุ ูุญุชุงุฌ ุฅูู ุชุนุฑูู ูุฏููุง.

ูููู ุชุนุฑูู ุงููุฏู ูู ุฎูุงู **ุฏุงูุฉ ุงูููุงูุฃุฉ**ุ ุงูุชู ุณุชูุฑุฌุน ูููุฉ ุฏุฑุฌุฉ ููู ุญุงูุฉ. ูููุง ุฒุงุฏ ุงูุฑููุ ูุงูุช ุฏุงูุฉ ุงูููุงูุฃุฉ ุฃูุถู. (ูุชูุฉ ุงูููุฏ 5)

```python
move_reward = -0.1
goal_reward = 10
end_reward = -10

def reward(m,pos=None):
    pos = pos or m.human
    if not m.is_valid(pos):
        return end_reward
    x = m.at(pos)
    if x==Board.Cell.water or x == Board.Cell.wolf:
        return end_reward
    if x==Board.Cell.apple:
        return goal_reward
    return move_reward
```

ุงูุดูุก ุงููุซูุฑ ููุงูุชูุงู ุญูู ุฏูุงู ุงูููุงูุฃุฉ ูู ุฃูู ูู ูุนุธู ุงูุญุงูุงุชุ *ูุญุตู ููุท ุนูู ููุงูุฃุฉ ูุจูุฑุฉ ูู ููุงูุฉ ุงููุนุจุฉ*. ูุฐุง ูุนูู ุฃู ุฎูุงุฑุฒููุฉูุง ูุฌุจ ุฃู ุชุชุฐูุฑ ุจุทุฑููุฉ ูุง ุงูุฎุทูุงุช "ุงูุฌูุฏุฉ" ุงูุชู ุชุคุฏู ุฅูู ููุงูุฃุฉ ุฅูุฌุงุจูุฉ ูู ุงูููุงูุฉุ ูุชุฒูุฏ ูู ุฃูููุชูุง. ูุจุงููุซูุ ูุฌุจ ุชุซุจูุท ุฌููุน ุงูุญุฑูุงุช ุงูุชู ุชุคุฏู ุฅูู ูุชุงุฆุฌ ุณูุฆุฉ.

## ุฎูุงุฑุฒููุฉ Q-Learning

ุงูุฎูุงุฑุฒููุฉ ุงูุชู ุณููุงูุดูุง ููุง ุชูุณูู **Q-Learning**. ูู ูุฐู ุงูุฎูุงุฑุฒููุฉุ ุชูุนุฑู ุงูุณูุงุณุฉ ุจุฏุงูุฉ (ุฃู ุจููุฉ ุจูุงูุงุช) ุชูุณูู **ุฌุฏูู Q**. ูุณุฌู ุงูุฌุฏูู "ุฌูุฏุฉ" ูู ุฅุฌุฑุงุก ูู ุญุงูุฉ ูุนููุฉ.

ููุณูู ุฌุฏูู Q ุจูุฐุง ุงูุงุณู ูุฃูู ุบุงูุจูุง ูุง ูููู ูู ุงูููุงุฆู ุชูุซููู ูุฌุฏููุ ุฃู ูุตูููุฉ ูุชุนุฏุฏุฉ ุงูุฃุจุนุงุฏ. ูุธุฑูุง ูุฃู ููุญุชูุง ููุง ุฃุจุนุงุฏ `width` x `height`ุ ูููููุง ุชูุซูู ุฌุฏูู Q ุจุงุณุชุฎุฏุงู ูุตูููุฉ numpy ุฐุงุช ุงูุดูู `width` x `height` x `len(actions)`: (ูุชูุฉ ุงูููุฏ 6)

```python
Q = np.ones((width,height,len(actions)),dtype=np.float)*1.0/len(actions)
```

ูุงุญุธ ุฃููุง ูุจุฏุฃ ุฌููุน ููู ุฌุฏูู Q ุจูููุฉ ูุชุณุงููุฉุ ูู ุญุงูุชูุง - 0.25. ูุฐุง ูุชูุงูู ูุน ุณูุงุณุฉ "ุงููุดู ุงูุนุดูุงุฆู"ุ ูุฃู ุฌููุน ุงูุญุฑูุงุช ูู ูู ุญุงูุฉ ูุชุณุงููุฉ ุงูุฌูุฏุฉ. ูููููุง ุชูุฑูุฑ ุฌุฏูู Q ุฅูู ุฏุงูุฉ `plot` ูุชุตูุฑ ุงูุฌุฏูู ุนูู ุงูููุญุฉ: `m.plot(Q)`.

![ุจูุฆุฉ ุจูุชุฑ](../../../../8-Reinforcement/1-QLearning/images/env_init.png)

ูู ูุฑูุฒ ูู ุฎููุฉ ููุฌุฏ "ุณูู" ูุดูุฑ ุฅูู ุงูุงุชุฌุงู ุงูููุถู ููุญุฑูุฉ. ูุธุฑูุง ูุฃู ุฌููุน ุงูุงุชุฌุงูุงุช ูุชุณุงููุฉุ ูุชู ุนุฑุถ ููุทุฉ.

ุงูุขู ูุญุชุงุฌ ุฅูู ุชุดุบูู ุงููุญุงูุงุฉุ ุงุณุชูุดุงู ุจูุฆุชูุงุ ูุชุนูู ุชูุฒูุน ุฃูุถู ูููู ุฌุฏูู Qุ ููุง ุณูููููุง ูู ุงูุนุซูุฑ ุนูู ุงููุณุงุฑ ุฅูู ุงูุชูุงุญุฉ ุจุดูู ุฃุณุฑุน ุจูุซูุฑ.

## ุฌููุฑ Q-Learning: ูุนุงุฏูุฉ ุจูููุงู

ุจูุฌุฑุฏ ุฃู ูุจุฏุฃ ูู ุงูุชุญุฑูุ ุณูููู ููู ุฅุฌุฑุงุก ููุงูุฃุฉ ููุงุจูุฉุ ุฃู ูููููุง ูุธุฑููุง ุงุฎุชูุงุฑ ุงูุฅุฌุฑุงุก ุงูุชุงูู ุจูุงุกู ุนูู ุฃุนูู ููุงูุฃุฉ ููุฑูุฉ. ููุน ุฐููุ ูู ูุนุธู ุงูุญุงูุงุชุ ูู ุชุญูู ุงูุญุฑูุฉ ูุฏููุง ุงููุชูุซู ูู ุงููุตูู ุฅูู ุงูุชูุงุญุฉุ ูุจุงูุชุงูู ูุง ูููููุง ุฃู ููุฑุฑ ููุฑูุง ุฃู ุงุชุฌุงู ูู ุงูุฃูุถู.

> ุชุฐูุฑ ุฃู ุงููุชูุฌุฉ ุงูููุฑูุฉ ููุณุช ูู ุงููููุฉุ ุจู ุงููุชูุฌุฉ ุงูููุงุฆูุฉุ ุงูุชู ุณูุญุตู ุนูููุง ูู ููุงูุฉ ุงููุญุงูุงุฉ.

ูุฃุฎุฐ ูุฐู ุงูููุงูุฃุฉ ุงููุคุฌูุฉ ูู ุงูุงุนุชุจุงุฑุ ูุญุชุงุฌ ุฅูู ุงุณุชุฎุฏุงู ูุจุงุฏุฆ **[ุงูุจุฑูุฌุฉ ุงูุฏููุงููููุฉ](https://en.wikipedia.org/wiki/Dynamic_programming)**ุ ุงูุชู ุชุชูุญ ููุง ุงูุชูููุฑ ูู ูุดููุชูุง ุจุดูู ุชูุฑุงุฑู.

ุงูุชุฑุถ ุฃููุง ุงูุขู ูู ุงูุญุงูุฉ *s*ุ ููุฑูุฏ ุงูุงูุชูุงู ุฅูู ุงูุญุงูุฉ ุงูุชุงููุฉ *s'*. ูู ุฎูุงู ุงูููุงู ุจุฐููุ ุณูุญุตู ุนูู ุงูููุงูุฃุฉ ุงูููุฑูุฉ *r(s,a)*ุ ุงููุนุฑูุฉ ุจูุงุณุทุฉ ุฏุงูุฉ ุงูููุงูุฃุฉุ ุจุงูุฅุถุงูุฉ ุฅูู ุจุนุถ ุงูููุงูุขุช ุงููุณุชูุจููุฉ. ุฅุฐุง ุงูุชุฑุถูุง ุฃู ุฌุฏูู Q ูุนูุณ ุจุดูู ุตุญูุญ "ุฌุงุฐุจูุฉ" ูู ุฅุฌุฑุงุกุ ูุฅููุง ูู ุงูุญุงูุฉ *s'* ุณูุฎุชุงุฑ ุงูุฅุฌุฑุงุก *a* ุงูุฐู ูุชูุงูู ูุน ุงููููุฉ ุงููุตูู ูู *Q(s',a')*. ูุจุงูุชุงููุ ูุฅู ุฃูุถู ููุงูุฃุฉ ูุณุชูุจููุฉ ููููุฉ ูููููุง ุงูุญุตูู ุนูููุง ูู ุงูุญุงูุฉ *s* ุณุชูุนุฑู ุจู `max`

## ุงูุชุญูู ูู ุงูุณูุงุณุฉ

ูุธุฑูุง ูุฃู ุฌุฏูู Q ูุณุฑุฏ "ุฌุงุฐุจูุฉ" ูู ุฅุฌุฑุงุก ูู ูู ุญุงูุฉุ ููู ุงูุณูู ุงุณุชุฎุฏุงูู ูุชุญุฏูุฏ ุงูุชููู ุงููุนูุงู ูู ุนุงูููุง. ูู ุฃุจุณุท ุงูุญุงูุงุชุ ูููููุง ุงุฎุชูุงุฑ ุงูุฅุฌุฑุงุก ุงูุฐู ูุชูุงูู ูุน ุฃุนูู ูููุฉ ูู ุฌุฏูู Q: (ูุชูุฉ ุงูููุฏ 9)

```python
def qpolicy_strict(m):
        x,y = m.human
        v = probs(Q[x,y])
        a = list(actions)[np.argmax(v)]
        return a

walk(m,qpolicy_strict)
```

> ุฅุฐุง ุฌุฑุจุช ุงูููุฏ ุฃุนูุงู ุนุฏุฉ ูุฑุงุชุ ูุฏ ุชูุงุญุธ ุฃูู ุฃุญูุงููุง "ูุชููู"ุ ูุชุญุชุงุฌ ุฅูู ุงูุถุบุท ุนูู ุฒุฑ ุงูุฅููุงู ูู ุงูุฏูุชุฑ ูููุงุทุนุชู. ูุญุฏุซ ูุฐุง ูุฃู ููุงู ุญุงูุงุช ูุฏ ุชุดูุฑ ูููุง ุญุงูุชุงู ุฅูู ุจุนุถููุง ุงูุจุนุถ ูู ุญูุซ ูููุฉ Q ุงููุซููุ ููู ูุฐู ุงูุญุงูุฉ ููุชูู ุงูุฃูุฑ ุจุงููููู ุจุงูุชููู ุจูู ุชูู ุงูุญุงูุงุช ุฅูู ูุง ูุง ููุงูุฉ.

## ๐ุงูุชุญุฏู

> **ุงููููุฉ 1:** ูู ุจุชุนุฏูู ูุธููุฉ `walk` ูุชุญุฏูุฏ ุงูุญุฏ ุงูุฃูุตู ูุทูู ุงููุณุงุฑ ุจุนุฏุฏ ูุนูู ูู ุงูุฎุทูุงุช (ุนูู ุณุจูู ุงููุซุงูุ 100)ุ ูุดุงูุฏ ุงูููุฏ ุฃุนูุงู ูุนูุฏ ูุฐู ุงููููุฉ ูู ููุช ูุขุฎุฑ.

> **ุงููููุฉ 2:** ูู ุจุชุนุฏูู ูุธููุฉ `walk` ุจุญูุซ ูุง ุชุนูุฏ ุฅูู ุงูุฃูุงูู ุงูุชู ุฒุงุฑุชูุง ูุณุจููุง. ุณูููุน ูุฐุง `walk` ูู ุงูุชูุฑุงุฑุ ููุน ุฐููุ ูุฏ ููุชูู ุงูุฃูุฑ ุจุงููููู ุจุฃู ูููู "ูุญุงุตุฑูุง" ูู ูููุน ูุง ูุณุชุทูุน ุงููุฑูุจ ููู.

## ุงูุชููู

ุณูุงุณุฉ ุงูุชููู ุงูุฃูุถู ูู ุชูู ุงูุชู ุงุณุชุฎุฏููุงูุง ุฃุซูุงุก ุงูุชุฏุฑูุจุ ูุงูุชู ุชุฌูุน ุจูู ุงูุงุณุชุบูุงู ูุงูุงุณุชูุดุงู. ูู ูุฐู ุงูุณูุงุณุฉุ ุณูุฎุชุงุฑ ูู ุฅุฌุฑุงุก ุจุงุญุชูุงููุฉ ูุนููุฉุ ุชุชูุงุณุจ ูุน ุงูููู ูู ุฌุฏูู Q. ูุฏ ุชุคุฏู ูุฐู ุงูุงุณุชุฑุงุชูุฌูุฉ ุฅูู ุนูุฏุฉ ุงููููู ุฅูู ูููุน ุณุจู ุฃู ุงุณุชูุดููุ ูููู ููุง ุชุฑู ูู ุงูููุฏ ุฃุฏูุงูุ ูุฅููุง ุชุคุฏู ุฅูู ูุณุงุฑ ูุชูุณุท ูุตูุฑ ุฌุฏูุง ุฅูู ุงููููุน ุงููุทููุจ (ุชุฐูุฑ ุฃู `print_statistics` ูุดุบู ุงููุญุงูุงุฉ 100 ูุฑุฉ): (ูุชูุฉ ุงูููุฏ 10)

```python
def qpolicy(m):
        x,y = m.human
        v = probs(Q[x,y])
        a = random.choices(list(actions),weights=v)[0]
        return a

print_statistics(qpolicy)
```

ุจุนุฏ ุชุดุบูู ูุฐุง ุงูููุฏุ ูุฌุจ ุฃู ุชุญุตู ุนูู ุทูู ูุณุงุฑ ูุชูุณุท ุฃุตุบุฑ ุจูุซูุฑ ูู ุงูุณุงุจูุ ูู ูุทุงู 3-6.

## ุงูุชุญููู ูู ุนูููุฉ ุงูุชุนูู

ููุง ุฐูุฑูุงุ ุนูููุฉ ุงูุชุนูู ูู ุชูุงุฒู ุจูู ุงูุงุณุชูุดุงู ูุงุณุชุบูุงู ุงููุนุฑูุฉ ุงูููุชุณุจุฉ ุญูู ูููู ูุณุงุญุฉ ุงููุดููุฉ. ููุฏ ุฑุฃููุง ุฃู ูุชุงุฆุฌ ุงูุชุนูู (ุงููุฏุฑุฉ ุนูู ูุณุงุนุฏุฉ ุงููููู ูู ุงูุนุซูุฑ ุนูู ูุณุงุฑ ูุตูุฑ ุฅูู ุงููุฏู) ูุฏ ุชุญุณูุชุ ูููู ูู ุงููุซูุฑ ุฃูุถูุง ููุงุญุธุฉ ููู ูุชุตุฑู ูุชูุณุท ุทูู ุงููุณุงุฑ ุฃุซูุงุก ุนูููุฉ ุงูุชุนูู:

### ูููู ุชูุฎูุต ุงูุชุนูู ููุง ููู:

- **ุฒูุงุฏุฉ ูุชูุณุท ุทูู ุงููุณุงุฑ**. ูุง ูุฑุงู ููุง ูู ุฃูู ูู ุงูุจุฏุงูุฉุ ูุฒูุฏ ูุชูุณุท ุทูู ุงููุณุงุฑ. ุฑุจูุง ูุฑุฌุน ุฐูู ุฅูู ุฃูู ุนูุฏูุง ูุง ูุนุฑู ุดูุฆูุง ุนู ุงูุจูุฆุฉุ ููู ุงููุญุชูู ุฃู ููุน ูู ุญุงูุงุช ุณูุฆุฉุ ูุซู ุงููุงุก ุฃู ุงูุฐุฆุจ. ููุน ุชุนูููุง ุงููุฒูุฏ ูุงุณุชุฎุฏุงู ูุฐู ุงููุนุฑูุฉุ ูููููุง ุงุณุชูุดุงู ุงูุจูุฆุฉ ููุชุฑุฉ ุฃุทููุ ูููููุง ูุง ูุฒุงู ูุง ูุนุฑู ุฌูุฏูุง ููุงู ุงูุชูุงุญ.

- **ุงูุฎูุงุถ ุทูู ุงููุณุงุฑ ูุน ุฒูุงุฏุฉ ุงูุชุนูู**. ุจูุฌุฑุฏ ุฃู ูุชุนูู ุจูุง ููููุ ูุตุจุญ ูู ุงูุฃุณูู ูููููู ุชุญููู ุงููุฏูุ ููุจุฏุฃ ุทูู ุงููุณุงุฑ ูู ุงูุงูุฎูุงุถ. ููุน ุฐููุ ูุง ูุฒุงู ูููุชุญูู ุนูู ุงูุงุณุชูุดุงูุ ูุฐุง ุบุงูุจูุง ูุง ููุญุฑู ุจุนูุฏูุง ุนู ุงููุณุงุฑ ุงูุฃูุถูุ ููุณุชูุดู ุฎูุงุฑุงุช ุฌุฏูุฏุฉุ ููุง ูุฌุนู ุงููุณุงุฑ ุฃุทูู ูู ุงููุซุงูู.

- **ุฒูุงุฏุฉ ุงูุทูู ุจุดูู ููุงุฌุฆ**. ูุง ููุงุญุธู ุฃูุถูุง ูู ูุฐุง ุงูุฑุณู ุงูุจูุงูู ูู ุฃูู ูู ูุฑุญูุฉ ูุงุ ุฒุงุฏ ุงูุทูู ุจุดูู ููุงุฌุฆ. ูุดูุฑ ูุฐุง ุฅูู ุงูุทุจูุนุฉ ุงูุนุดูุงุฆูุฉ ููุนูููุฉุ ูุฃูู ูููููุง ูู ูุฑุญูุฉ ูุง "ุฅูุณุงุฏ" ูุนุงููุงุช ุฌุฏูู Q ุนู ุทุฑูู ุงููุชุงุจุฉ ููููุง ุจููู ุฌุฏูุฏุฉ. ูุฌุจ ุชูููู ูุฐุง ุจุดูู ูุซุงูู ุนู ุทุฑูู ุชูููู ูุนุฏู ุงูุชุนูู (ุนูู ุณุจูู ุงููุซุงูุ ูู ููุงูุฉ ุงูุชุฏุฑูุจุ ูููู ููุท ุจุชุนุฏูู ููู ุฌุฏูู Q ุจูููุฉ ุตุบูุฑุฉ).

ุจุดูู ุนุงูุ ูู ุงูููู ุฃู ูุชุฐูุฑ ุฃู ูุฌุงุญ ูุฌูุฏุฉ ุนูููุฉ ุงูุชุนูู ุชุนุชูุฏ ุจุดูู ูุจูุฑ ุนูู ุงููุนููุงุชุ ูุซู ูุนุฏู ุงูุชุนููุ ุงูุฎูุงุถ ูุนุฏู ุงูุชุนููุ ูุนุงูู ุงูุฎุตู. ุบุงูุจูุง ูุง ููุทูู ุนูู ูุฐู ุงููุนููุงุช ุงุณู **ุงููุนููุงุช ุงููุงุฆูุฉ**ุ ูุชูููุฒูุง ุนู **ุงููุนููุงุช**ุ ุงูุชู ูููู ุจุชุญุณูููุง ุฃุซูุงุก ุงูุชุฏุฑูุจ (ุนูู ุณุจูู ุงููุซุงูุ ูุนุงููุงุช ุฌุฏูู Q). ุนูููุฉ ุงูุนุซูุฑ ุนูู ุฃูุถู ููู ูููุนููุงุช ุงููุงุฆูุฉ ุชูุณูู **ุชุญุณูู ุงููุนููุงุช ุงููุงุฆูุฉ**ุ ููู ุชุณุชุญู ููุถูุนูุง ูููุตููุง.

## [ุงุฎุชุจุงุฑ ูุง ุจุนุฏ ุงููุญุงุถุฑุฉ](https://ff-quizzes.netlify.app/en/ml/)

## ุงููุงุฌุจ 
[ุนุงูู ุฃูุซุฑ ูุงูุนูุฉ](assignment.md)

---

**ุฅุฎูุงุก ุงููุณุคูููุฉ**:  
ุชูุช ุชุฑุฌูุฉ ูุฐุง ุงููุณุชูุฏ ุจุงุณุชุฎุฏุงู ุฎุฏูุฉ ุงูุชุฑุฌูุฉ ุงูุขููุฉ [Co-op Translator](https://github.com/Azure/co-op-translator). ุจูููุง ูุณุนู ูุชุญููู ุงูุฏูุฉุ ูุฑุฌู ุงูุนูู ุฃู ุงูุชุฑุฌูุงุช ุงูุขููุฉ ูุฏ ุชุญุชูู ุนูู ุฃุฎุทุงุก ุฃู ูุนูููุงุช ุบูุฑ ุฏูููุฉ. ูุฌุจ ุงุนุชุจุงุฑ ุงููุณุชูุฏ ุงูุฃุตูู ุจูุบุชู ุงูุฃุตููุฉ ูู ุงููุตุฏุฑ ุงูููุซูู. ููุญุตูู ุนูู ูุนูููุงุช ุญุณุงุณุฉ ุฃู ูุงูุฉุ ูููุตู ุจุงูุงุณุชุนุงูุฉ ุจุชุฑุฌูุฉ ุจุดุฑูุฉ ุงุญุชุฑุงููุฉ. ูุญู ุบูุฑ ูุณุคูููู ุนู ุฃู ุณูุก ููู ุฃู ุชูุณูุฑุงุช ุฎุงุทุฆุฉ ุชูุดุฃ ุนู ุงุณุชุฎุฏุงู ูุฐู ุงูุชุฑุฌูุฉ.