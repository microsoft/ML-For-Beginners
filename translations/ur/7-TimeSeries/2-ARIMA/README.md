<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "2f400075e003e749fdb0d6b3b4787a99",
  "translation_date": "2025-08-29T13:09:53+00:00",
  "source_file": "7-TimeSeries/2-ARIMA/README.md",
  "language_code": "ur"
}
-->
# ุง ุขุฑ ุขุฆ ุงู ุง ฺฉ ุณุงุชฺพ ููุช ฺฉ ุณุฑุฒ ฺฉ ูพุดู ฺฏูุฆ

ูพฺฺพู ุณุจู ูฺบุ ุขูพ ู ููุช ฺฉ ุณุฑุฒ ฺฉ ูพุดู ฺฏูุฆ ฺฉ ุจุงุฑ ูฺบ ุชฺพูฺุง ุณุง ุณฺฉฺพุง ุงูุฑ ุงฺฉ ฺูนุง ุณูน ููฺ ฺฉุง ุฌู ุงฺฉ ููุช ฺฉ ุนุฑุต ูฺบ ุจุฌู ฺฉ ููฺ ฺฉ ุงุชุงุฑ ฺฺฺพุงุค ฺฉู ุธุงุฑ ฺฉุฑุชุง 

> ๐ฅ ุงููพุฑ ุฏ ฺฏุฆ ุชุตูุฑ ูพุฑ ฺฉูฺฉ ฺฉุฑฺบ: ุง ุขุฑ ุขุฆ ุงู ุง ูุงฺูุฒ ฺฉุง ูุฎุชุตุฑ ุชุนุงุฑู ูุซุงู ุขุฑ ูฺบ ฺฉ ฺฏุฆ ุ ูฺฉู ุชุตูุฑุงุช ุนุงููฺฏุฑ ฺบ

## [ุณุจู ุณ ูพู ฺฉุง ฺฉูุฆุฒ](https://gray-sand-07a10f403.1.azurestaticapps.net/quiz/43/)

## ุชุนุงุฑู

ุงุณ ุณุจู ูฺบุ ุขูพ ุงฺฉ ูุฎุตูุต ุทุฑู ุฏุฑุงูุช ฺฉุฑฺบ ฺฏ ุฌุณ ฺฉ ุฐุฑุน ูุงฺูุฒ ุจูุงุฆ ุฌุง ุณฺฉุช ฺบ [ุง ุขุฑ ุขุฆ ุงู ุง: *ุขูนู*ุฑฺฏุฑุณู *ุงููนฺฏุฑูนฺ* *ููููฺฏ* *ุงูุฑุฌ*](https://wikipedia.org/wiki/Autoregressive_integrated_moving_average) ุง ุขุฑ ุขุฆ ุงู ุง ูุงฺูุฒ ุฎุงุต ุทูุฑ ูพุฑ ุงุณ ฺูนุง ฺฉ ู ููุฒูฺบ ฺบ ุฌู [ุบุฑ ุงุณูนุดูุฑ](https://wikipedia.org/wiki/Stationary_process) ุฏฺฉฺพุงุชุง 

## ุนููู ุชุตูุฑุงุช

ุง ุขุฑ ุขุฆ ุงู ุง ฺฉ ุณุงุชฺพ ฺฉุงู ฺฉุฑู ฺฉ ูุ ฺฉฺฺพ ุชุตูุฑุงุช ฺฉู ุณูุฌฺพูุง ุถุฑูุฑ :

- ๐ **ุงุณูนุดูุฑูน** ุดูุงุฑุงุช ุณุงู ู ุณุจุงู ูฺบุ ุงุณูนุดูุฑูน ุงุณ ฺูนุง ฺฉู ุธุงุฑ ฺฉุฑุช  ุฌุณ ฺฉ ุชูุณู ููุช ฺฉ ุณุงุชฺพ ุชุจุฏู ูฺบ ูุช ุบุฑ ุงุณูนุดูุฑ ฺูนุงุ ูพฺพุฑุ ุฑุฌุญุงูุงุช ฺฉ ูุฌ ุณ ุงุชุงุฑ ฺฺฺพุงุค ุฏฺฉฺพุงุชุง  ุฌุณ ุชุฌุฒ ฺฉุฑู ฺฉ ู ุชุจุฏู ฺฉุฑูุง ุถุฑูุฑ ูุชุง  ูุซุงู ฺฉ ุทูุฑ ูพุฑุ ููุณูุงุช ุงุซุฑุงุช ฺูนุง ูฺบ ุงุชุงุฑ ฺฺฺพุงุค ูพุฏุง ฺฉุฑ ุณฺฉุช ฺบ ุงูุฑ ุงูฺบ 'ููุณูุงุช ูุฑู' ฺฉ ุนูู ฺฉ ุฐุฑุน ุฎุชู ฺฉุง ุฌุง ุณฺฉุชุง 

- ๐ **[ูุฑู ฺฉุฑูุง](https://wikipedia.org/wiki/Autoregressive_integrated_moving_average#Differencing)** ูุฑู ฺฉุฑูุงุ ุดูุงุฑุงุช ุณุงู ู ุณุจุงู ูฺบุ ุบุฑ ุงุณูนุดูุฑ ฺูนุง ฺฉู ุงุณูนุดูุฑ ุจูุงู ฺฉ ุนูู ฺฉู ุธุงุฑ ฺฉุฑุชุง  ุชุงฺฉ ุงุณ ฺฉ ุบุฑ ูุณุชูู ุฑุฌุญุงู ฺฉู ุฎุชู ฺฉุง ุฌุง ุณฺฉ "ูุฑู ฺฉุฑูุง ููุช ฺฉ ุณุฑุฒ ฺฉ ุณุทุญ ูฺบ ุชุจุฏููฺบ ฺฉู ุฎุชู ฺฉุฑุชุง ุ ุฑุฌุญุงู ุงูุฑ ููุณูุงุช ุงุซุฑุงุช ฺฉู ุฎุชู ฺฉุฑุชุง  ุงูุฑ ูุชุฌุชุงู ููุช ฺฉ ุณุฑุฒ ฺฉ ุงูุณุท ฺฉู ูุณุชุญฺฉู ฺฉุฑุชุง " [ุดฺฉุณููฺฏ ูุบุฑ ฺฉุง ููุงู](https://arxiv.org/abs/1904.07632)

## ููุช ฺฉ ุณุฑุฒ ฺฉ ุณุงู ู ุณุจุงู ูฺบ ุง ุขุฑ ุขุฆ ุงู ุง

ุขุฆ ุง ุขุฑ ุขุฆ ุงู ุง ฺฉ ุญุตูฺบ ฺฉู ฺฉฺพููุช ฺบ ุชุงฺฉ ุจุชุฑ ุณูุฌฺพ ุณฺฉฺบ ฺฉ  ููุช ฺฉ ุณุฑุฒ ฺฉู ูุงฺู ฺฉุฑู ูฺบ ฺฉุณ ูุฏุฏ ฺฉุฑุชุง  ุงูุฑ ุงุณ ฺฉ ุฎูุงู ูพุดู ฺฏูุฆ ฺฉุฑู ูฺบ ฺฉุณ ูุฏุฏ ฺฉุฑุชุง 

- **ุง ุขุฑ - ุขูนู ุฑฺฏุฑุณู ฺฉ ู** ุขูนู ุฑฺฏุฑุณู ูุงฺูุฒุ ุฌุณุง ฺฉ ูุงู ุธุงุฑ ฺฉุฑุชุง ุ ููุช ูฺบ 'ูพฺฺพ' ุฏฺฉฺพุช ฺบ ุชุงฺฉ ุขูพ ฺฉ ฺูนุง ูฺบ ูพฺฺพู ูุฏุฑูฺบ ฺฉุง ุชุฌุฒ ฺฉุฑฺบ ุงูุฑ ุงู ฺฉ ุจุงุฑ ูฺบ ููุฑูุถ ุจูุงุฆฺบ ุงู ูพฺฺพู ูุฏุฑูฺบ ฺฉู 'ูฺฏุฒ' ฺฉุง ุฌุงุชุง  ุงฺฉ ูุซุงู ู ฺูนุง ู ุณฺฉุชุง  ุฌู ูพูุณููฺบ ฺฉ ูุงุงู ูุฑูุฎุช ฺฉู ุธุงุฑ ฺฉุฑุชุง  ุฑ ูู ฺฉ ูุฑูุฎุช ฺฉุง ฺฉู ฺูนุง ุณูน ูฺบ ุงฺฉ 'ุงุฑุชูุงุฆ ูุชุบุฑ' ุณูุฌฺพุง ุฌุงุฆ ฺฏุง  ูุงฺู ุงุณ ุทุฑุญ ุจูุงุง ุฌุงุชุง  ฺฉ "ุฏูฺุณูพ ฺฉุง ุงุฑุชูุงุฆ ูุชุบุฑ ุงูพู  ูฺฏฺ (ุนูุ ูพฺฺพู) ูุฏุฑูฺบ ูพุฑ ุฑฺฏุฑุณ ฺฉุง ุฌุงุชุง " [ูฺฉูพฺุง](https://wikipedia.org/wiki/Autoregressive_integrated_moving_average)

- **ุขุฆ - ุงููนฺฏุฑูนฺ ฺฉ ู** ุง ุขุฑ ุงู ุง ูุงฺูุฒ ฺฉ ูุดุงุจุ ุง ุขุฑ ุขุฆ ุงู ุง ูฺบ 'ุขุฆ' ุงุณ ฺฉ *[ุงููนฺฏุฑูนฺ](https://wikipedia.org/wiki/Order_of_integration)* ูพูู ฺฉ ุทุฑู ุงุดุงุฑ ฺฉุฑุชุง  ฺูนุง ฺฉู 'ุงููนฺฏุฑูนฺ' ฺฉุง ุฌุงุชุง  ุฌุจ ูุฑู ฺฉุฑู ฺฉ ูุฑุงุญู ฺฉู ุบุฑ ุงุณูนุดูุฑ ฺฉู ุฎุชู ฺฉุฑู ฺฉ ู ูุงฺฏู ฺฉุง ุฌุงุชุง 

- **ุงู ุง - ููููฺฏ ุงูุฑุฌ ฺฉ ู** ุงุณ ูุงฺู ฺฉุง [ููููฺฏ ุงูุฑุฌ](https://wikipedia.org/wiki/Moving-average_model) ูพูู ุงุณ ุขุคูน ูพูน ูุชุบุฑ ฺฉ ุทุฑู ุงุดุงุฑ ฺฉุฑุชุง  ุฌู ูฺฏุฒ ฺฉ ููุฌูุฏ ุงูุฑ ูพฺฺพู ูุฏุฑูฺบ ฺฉู ุฏฺฉฺพ ฺฉุฑ ุท ฺฉุง ุฌุงุชุง 

ุฎูุงุต: ุง ุขุฑ ุขุฆ ุงู ุง ููุช ฺฉ ุณุฑุฒ ฺฉ ฺูนุง ฺฉ ุฎุงุต ุดฺฉู ฺฉู ุฌุชูุง ููฺฉู ู ูุฑุจ ุณ ููน ฺฉุฑู ฺฉ ู ุงุณุชุนูุงู ฺฉุง ุฌุงุชุง 

## ูุดู - ุง ุขุฑ ุขุฆ ุงู ุง ูุงฺู ุจูุงุฆฺบ

ุงุณ ุณุจู ูฺบ [_/working_](https://github.com/microsoft/ML-For-Beginners/tree/main/7-TimeSeries/2-ARIMA/working) ูููฺุฑ ฺฉฺพููฺบ ุงูุฑ [_notebook.ipynb_](https://github.com/microsoft/ML-For-Beginners/blob/main/7-TimeSeries/2-ARIMA/working/notebook.ipynb) ูุงุฆู ุชูุงุด ฺฉุฑฺบ

1. ูููน ุจฺฉ ฺูุงุฆฺบ ุชุงฺฉ `statsmodels` ูพุงุฆุชฺพูู ูุงุฆุจุฑุฑ ููฺ ูุ ุขูพ ฺฉู ุง ุขุฑ ุขุฆ ุงู ุง ูุงฺูุฒ ฺฉ ู ุงุณ ฺฉ ุถุฑูุฑุช ูฺฏ

1. ุถุฑูุฑ ูุงุฆุจุฑุฑุงฺบ ููฺ ฺฉุฑฺบ

1. ุงุจุ ฺูนุง ฺฉู ูพูุงูน ฺฉุฑู ฺฉ ู ูุฒุฏ ููุฏ ูุงุฆุจุฑุฑุงฺบ ููฺ ฺฉุฑฺบ:

    ```python
    import os
    import warnings
    import matplotlib.pyplot as plt
    import numpy as np
    import pandas as pd
    import datetime as dt
    import math

    from pandas.plotting import autocorrelation_plot
    from statsmodels.tsa.statespace.sarimax import SARIMAX
    from sklearn.preprocessing import MinMaxScaler
    from common.utils import load_data, mape
    from IPython.display import Image

    %matplotlib inline
    pd.options.display.float_format = '{:,.2f}'.format
    np.set_printoptions(precision=2)
    warnings.filterwarnings("ignore") # specify to ignore warning messages
    ```

1. `/data/energy.csv` ูุงุฆู ุณ ฺูนุง ฺฉู ุงฺฉ ูพุงูฺุงุฒ ฺูนุง ูุฑู ูฺบ ููฺ ฺฉุฑฺบ ุงูุฑ ุฏฺฉฺพฺบ:

    ```python
    energy = load_data('./data')[['load']]
    energy.head(10)
    ```

1. ุฌููุฑ 2012 ุณ ุฏุณูุจุฑ 2014 ุชฺฉ ุฏุณุชุงุจ ุชูุงู ุชูุงูุงุฆ ฺฉ ฺูนุง ฺฉู ูพูุงูน ฺฉุฑฺบ ฺฉูุฆ ุญุฑุช ูฺบ ูู ฺุง ฺฉููฺฉ ู ู  ฺูนุง ูพฺฺพู ุณุจู ูฺบ ุฏฺฉฺพุง ุชฺพุง:

    ```python
    energy.plot(y='load', subplots=True, figsize=(15, 8), fontsize=12)
    plt.xlabel('timestamp', fontsize=12)
    plt.ylabel('load', fontsize=12)
    plt.show()
    ```

    ุงุจุ ุขุฆ ุงฺฉ ูุงฺู ุจูุงุช ฺบ!

### ุชุฑุจุช ุงูุฑ ุฌุงูฺ ฺฉ ฺูนุง ุณูนุณ ุจูุงุฆฺบ

ุงุจ ุขูพ ฺฉุง ฺูนุง ููฺ ู ฺฺฉุง ุ ูุฐุง ุขูพ ุงุณ ุชุฑุจุช ุงูุฑ ุฌุงูฺ ฺฉ ุณูนุณ ูฺบ ุชูุณู ฺฉุฑ ุณฺฉุช ฺบ ุขูพ ุงูพู ูุงฺู ฺฉู ุชุฑุจุช ุณูน ูพุฑ ุชุฑุจุช ุฏฺบ ฺฏ ุญุณุจ ูุนูููุ ูุงฺู ฺฉ ุชุฑุจุช ูฺฉูู ูู ฺฉ ุจุนุฏุ ุขูพ ุงุณ ฺฉ ุฏุฑุณุชฺฏ ฺฉุง ุงูุฏุงุฒ ุฌุงูฺ ฺฉ ุณูน ฺฉุง ุงุณุชุนูุงู ฺฉุฑุช ูุฆ ฺฉุฑฺบ ฺฏ ุขูพ ฺฉู  ูู ุจูุงูุง ูฺฏุง ฺฉ ุฌุงูฺ ฺฉุง ุณูน ุชุฑุจุช ุณูน ฺฉ ุจุนุฏ ฺฉ ููุช ฺฉ ุนุฑุต ฺฉุง ุงุญุงุท ฺฉุฑุชุง  ุชุงฺฉ ูุงฺู ูุณุชูุจู ฺฉ ููุช ฺฉ ุนุฑุต ุณ ูุนูููุงุช ุญุงุตู ู ฺฉุฑ

1. ุชุฑุจุช ุณูน ฺฉ ู 1 ุณุชูุจุฑ ุณ 31 ุงฺฉุชูุจุฑ 2014 ุชฺฉ ุฏู ูุง ฺฉุง ุนุฑุต ูุฎุชุต ฺฉุฑฺบ ุฌุงูฺ ฺฉุง ุณูน 1 ูููุจุฑ ุณ 31 ุฏุณูุจุฑ 2014 ุชฺฉ ุฏู ูุง ฺฉ ุนุฑุต ฺฉู ุดุงูู ฺฉุฑ ฺฏุง:

    ```python
    train_start_dt = '2014-11-01 00:00:00'
    test_start_dt = '2014-12-30 00:00:00'
    ```

    ฺููฺฉ  ฺูนุง ุชูุงูุงุฆ ฺฉ ุฑูุฒุงู ฺฉ ฺฉฺพูพุช ฺฉู ุธุงุฑ ฺฉุฑุชุง ุ ุงุณ ูฺบ ุงฺฉ ูุถุจูุท ููุณูุงุช ูููู ุ ูฺฉู ฺฉฺพูพุช ุญุงู ุฏููฺบ ฺฉ ฺฉฺพูพุช ุณ ุณุจ ุณ ุฒุงุฏ ูุดุงุจุช ุฑฺฉฺพุช 

1. ูุฑู ฺฉู ุจุตุฑ ุทูุฑ ูพุฑ ุฏฺฉฺพฺบ:

    ```python
    energy[(energy.index < test_start_dt) & (energy.index >= train_start_dt)][['load']].rename(columns={'load':'train'}) \
        .join(energy[test_start_dt:][['load']].rename(columns={'load':'test'}), how='outer') \
        .plot(y=['train', 'test'], figsize=(15, 8), fontsize=12)
    plt.xlabel('timestamp', fontsize=12)
    plt.ylabel('load', fontsize=12)
    plt.show()
    ```

    ![ุชุฑุจุช ุงูุฑ ุฌุงูฺ ฺฉุง ฺูนุง](../../../../translated_images/train-test.8928d14e5b91fc942f0ca9201b2d36c890ea7e98f7619fd94f75de3a4c2bacb9.ur.png)

    ูุฐุงุ ฺูนุง ฺฉู ุชุฑุจุช ุฏู ฺฉ ู ููุช ฺฉ ูุณุจุชุงู ฺฺพููน ููฺู ฺฉุง ุงุณุชุนูุงู ฺฉุงู ููุง ฺุง

    > ูููน: ฺููฺฉ ู ุง ุขุฑ ุขุฆ ุงู ุง ูุงฺู ฺฉู ููน ฺฉุฑู ฺฉ ู ุงุณุชุนูุงู ูู ูุงู ููฺฉุดู ูฺบ ููนูฺฏ ฺฉ ุฏูุฑุงู ุงู ุณููพู ููฺุดู ฺฉุง ุงุณุชุนูุงู ฺฉุฑุช ฺบุ ู ููฺุดู ฺูนุง ฺฉู ฺฺพูฺ ุฏฺบ ฺฏ

### ุชุฑุจุช ฺฉ ู ฺูนุง ุชุงุฑ ฺฉุฑฺบ

ุงุจุ ุขูพ ฺฉู ฺูนุง ฺฉู ุชุฑุจุช ฺฉ ู ุชุงุฑ ฺฉุฑู ฺฉ ุถุฑูุฑุช ุ ุฌุณ ูฺบ ูููนุฑูฺฏ ุงูุฑ ฺูนุง ฺฉู ุงุณฺฉู ฺฉุฑูุง ุดุงูู  ุงูพู ฺูนุง ุณูน ฺฉู ุตุฑู ูุทููุจ ููุช ฺฉ ุนุฑุต ุงูุฑ ฺฉุงููุฒ ฺฉู ุดุงูู ฺฉุฑู ฺฉ ู ูููนุฑ ฺฉุฑฺบุ ุงูุฑ ุงุณฺฉููฺฏ ุชุงฺฉ ฺูนุง ฺฉู 0,1 ฺฉ ููู ูฺบ ูพุด ฺฉุง ุฌุง ุณฺฉ

1. ุงุตู ฺูนุง ุณูน ฺฉู ูููนุฑ ฺฉุฑฺบ ุชุงฺฉ ุตุฑู ูุฐฺฉูุฑ ููุช ฺฉ ุนุฑุต ู ุณูน ุงูุฑ ุตุฑู ูุทููุจ ฺฉุงูู 'ููฺ' ุงูุฑ ุชุงุฑุฎ ุดุงูู ู:

    ```python
    train = energy.copy()[(energy.index >= train_start_dt) & (energy.index < test_start_dt)][['load']]
    test = energy.copy()[energy.index >= test_start_dt][['load']]

    print('Training data shape: ', train.shape)
    print('Test data shape: ', test.shape)
    ```

    ุขูพ ฺูนุง ฺฉ ุดฺฉู ุฏฺฉฺพ ุณฺฉุช ฺบ:

    ```output
    Training data shape:  (1416, 1)
    Test data shape:  (48, 1)
    ```

1. ฺูนุง ฺฉู (0, 1) ฺฉ ุญุฏ ูฺบ ุงุณฺฉู ฺฉุฑฺบ

    ```python
    scaler = MinMaxScaler()
    train['load'] = scaler.fit_transform(train)
    train.head(10)
    ```

1. ุงุตู ุจููุงุจู ุงุณฺฉูฺ ฺูนุง ฺฉู ุจุตุฑ ุทูุฑ ูพุฑ ุฏฺฉฺพฺบ:

    ```python
    energy[(energy.index >= train_start_dt) & (energy.index < test_start_dt)][['load']].rename(columns={'load':'original load'}).plot.hist(bins=100, fontsize=12)
    train.rename(columns={'load':'scaled load'}).plot.hist(bins=100, fontsize=12)
    plt.show()
    ```

    ![ุงุตู](../../../../translated_images/original.b2b15efe0ce92b8745918f071dceec2231661bf49c8db6918e3ff4b3b0b183c2.ur.png)

    > ุงุตู ฺูนุง

    ![ุงุณฺฉูฺ](../../../../translated_images/scaled.e35258ca5cd3d43f86d5175e584ba96b38d51501f234abf52e11f4fe2631e45f.ur.png)

    > ุงุณฺฉูฺ ฺูนุง

1. ุงุจ ุฌุจ ฺฉ ุขูพ ู ุงุณฺฉูฺ ฺูนุง ฺฉู ฺฉูุจุฑูน ฺฉุฑ ูุง ุ ุขูพ ุฌุงูฺ ฺฉ ฺูนุง ฺฉู ุงุณฺฉู ฺฉุฑ ุณฺฉุช ฺบ:

    ```python
    test['load'] = scaler.transform(test)
    test.head()
    ```

### ุง ุขุฑ ุขุฆ ุงู ุง ูุงูุฐ ฺฉุฑฺบ

ุงุจ ููุช  ฺฉ ุง ุขุฑ ุขุฆ ุงู ุง ฺฉู ูุงูุฐ ฺฉุฑฺบ! ุขูพ ุงุจ `statsmodels` ูุงุฆุจุฑุฑ ฺฉุง ุงุณุชุนูุงู ฺฉุฑฺบ ฺฏ ุฌู ุขูพ ู ูพู ุงูุณูนุงู ฺฉ ุชฺพ

ุงุจ ุขูพ ฺฉู ฺฉุฆ ูุฑุงุญู ูพุฑ ุนูู ฺฉุฑูุง ูฺฏุง:

   1. ูุงฺู ฺฉู `SARIMAX()` ฺฉุงู ฺฉุฑ ฺฉ ุงูุฑ ูุงฺู ฺฉ ูพุฑุงููนุฑุฒ: pุ dุ ุงูุฑ q ูพุฑุงููนุฑุฒุ ุงูุฑ Pุ Dุ ุงูุฑ Q ูพุฑุงููนุฑุฒ ูพุงุณ ฺฉุฑ ฺฉ ฺูุงุฆู ฺฉุฑฺบ
   2. ุชุฑุจุช ฺูนุง ฺฉ ู ูุงฺู ฺฉู ุชุงุฑ ฺฉุฑฺบ `fit()` ููฺฉุดู ฺฉุงู ฺฉุฑ ฺฉ
   3. ูพุดู ฺฏูุฆ ฺฉุฑู ฺฉ ู `forecast()` ููฺฉุดู ฺฉุงู ฺฉุฑฺบ ุงูุฑ ูพุดู ฺฏูุฆ ฺฉ ู ูุฏููฺบ ฺฉ ุชุนุฏุงุฏ (ูุฑุงุฆุฒู) ฺฉู ูุฎุตูุต ฺฉุฑฺบ

> ๐  ุชูุงู ูพุฑุงููนุฑุฒ ฺฉุณ ู ฺบุ ุง ุขุฑ ุขุฆ ุงู ุง ูุงฺู ูฺบ 3 ูพุฑุงููนุฑุฒ ูุช ฺบ ุฌู ููุช ฺฉ ุณุฑุฒ ฺฉ ุงู ูพููุคฺบ ฺฉู ูุงฺู ฺฉุฑู ูฺบ ูุฏุฏ ฺฉุฑุช ฺบ: ููุณูุงุช ุงุซุฑุงุชุ ุฑุฌุญุงูุ ุงูุฑ ุดูุฑ  ูพุฑุงููนุฑุฒ ฺบ:

`p`: ูุงฺู ฺฉ ุขูนู ุฑฺฏุฑุณู ูพูู ุณ ูุงุจุณุช ูพุฑุงููนุฑุ ุฌู *ูุงุถ* ฺฉ ูุฏุฑูฺบ ฺฉู ุดุงูู ฺฉุฑุชุง 
`d`: ูุงฺู ฺฉ ุงููนฺฏุฑูนฺ ุญุต ุณ ูุงุจุณุช ูพุฑุงููนุฑุ ุฌู ููุช ฺฉ ุณุฑุฒ ูพุฑ *ูุฑู ฺฉุฑู* ฺฉ ููุฏุงุฑ ฺฉู ูุชุงุซุฑ ฺฉุฑุชุง 
`q`: ูุงฺู ฺฉ ููููฺฏ ุงูุฑุฌ ุญุต ุณ ูุงุจุณุช ูพุฑุงููนุฑ

> ูููน: ุงฺฏุฑ ุขูพ ฺฉ ฺูนุง ูฺบ ููุณูุงุช ูพูู  - ุฌุณุง ฺฉ ุงุณ ูฺบ  - ุชู ู ููุณูุงุช ุง ุขุฑ ุขุฆ ุงู ุง ูุงฺู (SARIMA) ุงุณุชุนูุงู ฺฉุฑุช ฺบ ุงุณ ุตูุฑุช ูฺบ ุขูพ ฺฉู ูพุฑุงููนุฑุฒ ฺฉุง ุงฺฉ ุงูุฑ ุณูน ุงุณุชุนูุงู ฺฉุฑู ฺฉ ุถุฑูุฑุช : `P`, `D`, ุงูุฑ `Q` ุฌู `p`, `d`, ุงูุฑ `q` ฺฉ ุฌุณ ุชุนููุงุช ฺฉู ุจุงู ฺฉุฑุช ฺบุ ูฺฉู ูุงฺู ฺฉ ููุณูุงุช ุงุฌุฒุงุก ุณ ูุชุนูู ฺบ

1. ุงูพู ูพุณูุฏุฏ ูุฑุงุฆุฒู ููู ฺฉู ุณูน ฺฉุฑฺบ ุขุฆ 3 ฺฏฺพููน ุขุฒูุงุฆฺบ:

    ```python
    # Specify the number of steps to forecast ahead
    HORIZON = 3
    print('Forecasting horizon:', HORIZON, 'hours')
    ```

    ุง ุขุฑ ุขุฆ ุงู ุง ูุงฺู ฺฉ ูพุฑุงููนุฑุฒ ฺฉ ู ุจุชุฑู ูุฏุฑูฺบ ฺฉุง ุงูุชุฎุงุจ ฺฉุฑูุง ฺููุฌูฺฏ ู ุณฺฉุชุง  ฺฉููฺฉ  ฺฉุณ ุญุฏ ุชฺฉ ููุถูุน ุงูุฑ ููุช ุทูุจ  ุขูพ [`pyramid` ูุงุฆุจุฑุฑ](https://alkaline-ml.com/pmdarima/0.9.0/modules/generated/pyramid.arima.auto_arima.html) ุณ `auto_arima()` ููฺฉุดู ุงุณุชุนูุงู ฺฉุฑู ูพุฑ ุบูุฑ ฺฉุฑ ุณฺฉุช ฺบ

1. ู ุงูุญุงู ฺฉฺฺพ ุฏุณุช ุงูุชุฎุงุจ ุขุฒูุงุฆฺบ ุชุงฺฉ ุงฺฉ ุงฺฺพุง ูุงฺู ุชูุงุด ฺฉุง ุฌุง ุณฺฉ

    ```python
    order = (4, 1, 0)
    seasonal_order = (1, 1, 0, 24)

    model = SARIMAX(endog=train, order=order, seasonal_order=seasonal_order)
    results = model.fit()

    print(results.summary())
    ```

    ูุชุงุฆุฌ ฺฉ ุงฺฉ ุฌุฏูู ูพุฑููน ฺฉ ฺฏุฆ 

ุขูพ ู ุงูพูุง ูพูุง ูุงฺู ุจูุง ูุง ! ุงุจ ูฺบ ุงุณ ุฌุงูฺู ฺฉุง ุทุฑู ุชูุงุด ฺฉุฑูุง ูฺฏุง

### ุงูพู ูุงฺู ฺฉุง ุฌุงุฆุฒ ูฺบ

ุงูพู ูุงฺู ฺฉุง ุฌุงุฆุฒ ูู ฺฉ ูุ ุขูพ ูุงู ูุงุฏ `walk forward` ููฺุดู ุงูุฌุงู ุฏ ุณฺฉุช ฺบ ุนูู ุทูุฑ ูพุฑุ ููุช ฺฉ ุณุฑุฒ ฺฉ ูุงฺูุฒ ุฑ ุจุงุฑ ุฌุจ ูุง ฺูนุง ุฏุณุชุงุจ ูุชุง  ุฏูุจุงุฑ ุชุฑุจุช ุฏ ุฌุงุช ฺบ  ูุงฺู ฺฉู ุฑ ููุช ฺฉ ูุฏู ูพุฑ ุจุชุฑู ูพุดู ฺฏูุฆ ฺฉุฑู ฺฉ ุงุฌุงุฒุช ุฏุชุง 

ุงุณ ุชฺฉูฺฉ ฺฉุง ุงุณุชุนูุงู ฺฉุฑุช ูุฆ ููุช ฺฉ ุณุฑุฒ ฺฉ ุขุบุงุฒ ุณ ุดุฑูุน ฺฉุฑฺบุ ุชุฑุจุช ฺูนุง ุณูน ูพุฑ ูุงฺู ฺฉู ุชุฑุจุช ุฏฺบ ูพฺพุฑ ุงฺฏู ููุช ฺฉ ูุฏู ูพุฑ ูพุดู ฺฏูุฆ ฺฉุฑฺบ ูพุดู ฺฏูุฆ ูุนููู ูุฏุฑ ฺฉ ุฎูุงู ุฌุงูฺ ฺฉ ุฌุงุช  ุชุฑุจุช ุณูน ฺฉู ูุนููู ูุฏุฑ ฺฉู ุดุงูู ฺฉุฑู ฺฉ ู ุจฺฺพุงุง ุฌุงุชุง  ุงูุฑ ุนูู ฺฉู ุฏุฑุงุง ุฌุงุชุง 

> ูููน: ุขูพ ฺฉู ุชุฑุจุช ุณูน ููฺู ฺฉู ุฒุงุฏ ููุซุฑ ุชุฑุจุช ฺฉ ู ููุฑุฑ ุฑฺฉฺพูุง ฺุง ุชุงฺฉ ุฑ ุจุงุฑ ุฌุจ ุขูพ ุชุฑุจุช ุณูน ูฺบ ุงฺฉ ูุง ูุดุงุฏ ุดุงูู ฺฉุฑฺบุ ุขูพ ุณูน ฺฉ ุขุบุงุฒ ุณ ูุดุงุฏ ฺฉู ูนุง ุฏฺบ

 ุนูู ุงุณ ุจุงุช ฺฉุง ุฒุงุฏ ูุถุจูุท ุชุฎูู ูุฑุงู ฺฉุฑุชุง  ฺฉ ูุงฺู ุนูู ุทูุฑ ูพุฑ ฺฉุณุง ฺฉุงุฑฺฉุฑุฏฺฏ ุฏฺฉฺพุงุฆ ฺฏุง ุชุงูุ  ุงุชู ุฒุงุฏ ูุงฺูุฒ ุจูุงู ฺฉ ฺฉููพููนุดู ูุงฺฏุช ูพุฑ ุขุชุง  ุงฺฏุฑ ฺูนุง ฺฺพููนุง ู ุง ูุงฺู ุณุงุฏ ู ุชู  ูุงุจู ูุจูู ุ ูฺฉู ุจฺ ูพูุงู ูพุฑ ูุณุฆู ู ุณฺฉุชุง 

ูุงฺฉ ูุงุฑูุฑฺ ููฺุดู ููุช ฺฉ ุณุฑุฒ ฺฉ ูุงฺู ฺฉ ุฌุงุฆุฒ ฺฉุง ุณูุฑ ูุนุงุฑ  ุงูุฑ ุขูพ ฺฉ ุงูพู ููุตูุจูฺบ ฺฉ ู ุชุฌูุฒ ฺฉุง ุฌุงุชุง 

1. ูพูุ ุฑ ูุฑุงุฆุฒู ูุฏู ฺฉ ู ุงฺฉ ุฌุงูฺ ฺูนุง ูพูุงุฆููน ุจูุงุฆฺบ

    ```python
    test_shifted = test.copy()

    for t in range(1, HORIZON+1):
        test_shifted['load+'+str(t)] = test_shifted['load'].shift(-t, freq='H')

    test_shifted = test_shifted.dropna(how='any')
    test_shifted.head(5)
    ```

    |            |          | ููฺ | ููฺ+1 | ููฺ+2 |
    | ---------- | -------- | ---- | ------ | ------ |
    | 2014-12-30 | 00:00:00 | 0.33 | 0.29   | 0.27   |
    | 2014-12-30 | 01:00:00 | 0.29 | 0.27   | 0.27   |
    | 2014-12-30 | 02:00:00 | 0.27 | 0.27   | 0.30   |
    | 2014-12-30 | 03:00:00 | 0.27 | 0.30   | 0.41   |
    | 2014-12-30 | 04:00:00 | 0.30 | 0.41   | 0.57   |

    ฺูนุง ฺฉู ุงูู ุทูุฑ ูพุฑ ุงุณ ฺฉ ูุฑุงุฆุฒู ูพูุงุฆููน ฺฉ ูุทุงุจู ููุชูู ฺฉุง ุฌุงุชุง 

1. ุงุณ ุณูุงุฆฺูฺฏ ููฺู ุงูพุฑูฺ ฺฉุง ุงุณุชุนูุงู ฺฉุฑุช ูุฆ ุงูพู ุฌุงูฺ ฺูนุง ูพุฑ ูพุดู ฺฏูุฆ ฺฉุฑฺบุ ุฌุงูฺ ฺูนุง ฺฉ ููุจุงุฆ ฺฉ ุณุงุฆุฒ ูฺบ ุงฺฉ ูููพ ฺฉ ุฐุฑุน:

    ```python
    %%time
    training_window = 720 # dedicate 30 days (720 hours) for training

    train_ts = train['load']
    test_ts = test_shifted

    history = [x for x in train_ts]
    history = history[(-training_window):]

    predictions = list()

    order = (2, 1, 0)
    seasonal_order = (1, 1, 0, 24)

    for t in range(test_ts.shape[0]):
        model = SARIMAX(endog=history, order=order, seasonal_order=seasonal_order)
        model_fit = model.fit()
        yhat = model_fit.forecast(steps = HORIZON)
        predictions.append(yhat)
        obs = list(test_ts.iloc[t])
        # move the training window
        history.append(obs[0])
        history.pop(0)
        print(test_ts.index[t])
        print(t+1, ': predicted =', yhat, 'expected =', obs)
    ```

    ุขูพ ุชุฑุจุช ฺฉู ุฏฺฉฺพ ุณฺฉุช ฺบ:

    ```output
    2014-12-30 00:00:00
    1 : predicted = [0.32 0.29 0.28] expected = [0.32945389435989236, 0.2900626678603402, 0.2739480752014323]

    2014-12-30 01:00:00
    2 : predicted = [0.3  0.29 0.3 ] expected = [0.2900626678603402, 0.2739480752014323, 0.26812891674127126]

    2014-12-30 02:00:00
    3 : predicted = [0.27 0.28 0.32] expected = [0.2739480752014323, 0.26812891674127126, 0.3025962399283795]
    ```

1. ูพุดู ฺฏูุฆ ฺฉู ุงุตู ููฺ ฺฉ ุณุงุชฺพ ููุงุฒู ฺฉุฑฺบ:

    ```python
    eval_df = pd.DataFrame(predictions, columns=['t+'+str(t) for t in range(1, HORIZON+1)])
    eval_df['timestamp'] = test.index[0:len(test.index)-HORIZON+1]
    eval_df = pd.melt(eval_df, id_vars='timestamp', value_name='prediction', var_name='h')
    eval_df['actual'] = np.array(np.transpose(test_ts)).ravel()
    eval_df[['prediction', 'actual']] = scaler.inverse_transform(eval_df[['prediction', 'actual']])
    eval_df.head()
    ```

    ุขุคูน ูพูน
    |     |            | ูนุงุฆู ุงุณูนููพ | h   | ูพุดู ฺฏูุฆ | ุงุตู   |
    | --- | ---------- | --------- | --- | ---------- | -------- |
    | 0   | 2014-12-30 | 00:00:00  | t+1 | 3,008.74   | 3,023.00 |
    | 1   | 2014-12-30 | 01:00:00  | t+1 | 2,955.53   | 2,935.00 |
    | 2   | 2014-12-30 | 02:00:00  | t+1 | 2,900.17   | 2,899.00 |
    | 3   | 2014-12-30 | 03:00:00  | t+1 | 2,917.69   | 2,886.00 |
    | 4   | 2014-12-30 | 04:00:00  | t+1 | 2,946.99   | 2,963.00 |

    ฺฏฺพููน ูุงุฑ ฺูนุง ฺฉ ูพุดู ฺฏูุฆ ฺฉู ุงุตู ููฺ ฺฉ ุณุงุชฺพ ููุงุญุธ ฺฉุฑฺบ  ฺฉุชูุง ุฏุฑุณุช ุ

### ูุงฺู ฺฉ ุฏุฑุณุชฺฏ ฺฺฉ ฺฉุฑฺบ

ุงูพู ูุงฺู ฺฉ ุฏุฑุณุชฺฏ ฺฉู ุชูุงู ูพุดู ฺฏูุฆูฺบ ูพุฑ ุงุณ ฺฉ ุงูุณุท ูุทูู ูุตุฏ ุบูุท (MAPE) ฺฉ ุฌุงูฺ ฺฉุฑ ฺฉ ฺฺฉ ฺฉุฑฺบ
> **๐งฎ ุฑุงุถ ุฏฺฉฺพฺบ**
>
> ![MAPE](../../../../translated_images/mape.fd87bbaf4d346846df6af88b26bf6f0926bf9a5027816d5e23e1200866e3e8a4.ur.png)
>
> [MAPE](https://www.linkedin.com/pulse/what-mape-mad-msd-time-series-allameh-statistics/) ูพุด ฺฏูุฆ ฺฉ ุฏุฑุณุชฺฏ ฺฉู ุงฺฉ ุชูุงุณุจ ฺฉ ุทูุฑ ูพุฑ ุธุงุฑ ฺฉุฑู ฺฉ ู ุงุณุชุนูุงู ฺฉุง ุฌุงุชุง ุ ุฌู ุงููพุฑ ุฏ ฺฏุฆ ูุงุฑููู ุณ ุจุงู ฺฉุง ฺฏุง  ุงุตู ุงูุฑ ูพุด ฺฏูุฆ ฺฉ ุฏุฑูุงู ูุฑู ฺฉู ุงุตู ุณ ุชูุณู ฺฉุง ุฌุงุชุง 
>
> "ุงุณ ุญุณุงุจ ูฺบ ูุทูู ูุฏุฑ ฺฉู ููุช ฺฉ ุฑ ูพุด ฺฏูุฆ ุดุฏ ููุท ฺฉ ู ุฌูุน ฺฉุง ุฌุงุชุง  ุงูุฑ ููน ฺฉ ฺฏุฆ ููุงุท ฺฉ ุชุนุฏุงุฏ n ุณ ุชูุณู ฺฉุง ุฌุงุชุง " [ูฺฉูพฺุง](https://wikipedia.org/wiki/Mean_absolute_percentage_error)
1. ฺฉูฺ ูฺบ ูุณุงูุงุช ูฺฉฺพฺบ:

    ```python
    if(HORIZON > 1):
        eval_df['APE'] = (eval_df['prediction'] - eval_df['actual']).abs() / eval_df['actual']
        print(eval_df.groupby('h')['APE'].mean())
    ```

1. ุงฺฉ ูุฏู ฺฉ ู MAPE ฺฉุง ุญุณุงุจ ูฺฏุงุฆฺบ:

    ```python
    print('One step forecast MAPE: ', (mape(eval_df[eval_df['h'] == 't+1']['prediction'], eval_df[eval_df['h'] == 't+1']['actual']))*100, '%')
    ```

    ุงฺฉ ูุฏู ฺฉ ูพุด ฺฏูุฆ ฺฉุง MAPE:  0.5570581332313952 %

1. ฺฉุซุฑ ูุฏู ฺฉ ูพุด ฺฏูุฆ ฺฉุง MAPE ูพุฑููน ฺฉุฑฺบ:

    ```python
    print('Multi-step forecast MAPE: ', mape(eval_df['prediction'], eval_df['actual'])*100, '%')
    ```

    ```output
    Multi-step forecast MAPE:  1.1460048657704118 %
    ```

    ุงฺฉ ุงฺฺพุง ฺฉู ููุจุฑ ุจุชุฑู : ุบูุฑ ฺฉุฑฺบ ฺฉ ุงฺฏุฑ ฺฉุณ ูพุด ฺฏูุฆ ฺฉุง MAPE 10 ู ุชู ุงุณ ฺฉุง ูุทูุจ  ฺฉ  10% ุชฺฉ ุบูุท 

1. ูฺฉู ูุด ฺฉ ุทุฑุญุ ุงุณ ูุณู ฺฉ ุฏุฑุณุชฺฏ ฺฉ ูพูุงุฆุด ฺฉู ุจุตุฑ ุทูุฑ ูพุฑ ุฏฺฉฺพูุง ุขุณุงู ุ ุชู ุขุฆ ุงุณ ูพูุงูน ฺฉุฑฺบ:

    ```python
     if(HORIZON == 1):
        ## Plotting single step forecast
        eval_df.plot(x='timestamp', y=['actual', 'prediction'], style=['r', 'b'], figsize=(15, 8))

    else:
        ## Plotting multi step forecast
        plot_df = eval_df[(eval_df.h=='t+1')][['timestamp', 'actual']]
        for t in range(1, HORIZON+1):
            plot_df['t+'+str(t)] = eval_df[(eval_df.h=='t+'+str(t))]['prediction'].values

        fig = plt.figure(figsize=(15, 8))
        ax = plt.plot(plot_df['timestamp'], plot_df['actual'], color='red', linewidth=4.0)
        ax = fig.add_subplot(111)
        for t in range(1, HORIZON+1):
            x = plot_df['timestamp'][(t-1):]
            y = plot_df['t+'+str(t)][0:len(x)]
            ax.plot(x, y, color='blue', linewidth=4*math.pow(.9,t), alpha=math.pow(0.8,t))

        ax.legend(loc='best')

    plt.xlabel('timestamp', fontsize=12)
    plt.ylabel('load', fontsize=12)
    plt.show()
    ```

    ![ุงฺฉ ููุช ฺฉ ุณุฑุฒ ูุงฺู](../../../../translated_images/accuracy.2c47fe1bf15f44b3656651c84d5e2ba9b37cd929cd2aa8ab6cc3073f50570f4e.ur.png)

๐ ุงฺฉ ุจุช ุงฺฺพุง ูพูุงูนุ ุฌู ุงฺฉ ูุงฺู ฺฉู ุงฺฺพ ุฏุฑุณุชฺฏ ฺฉ ุณุงุชฺพ ุฏฺฉฺพุงุชุง  ุดุงุจุงุด!

---

## ๐ฺููุฌ

ููุช ฺฉ ุณุฑุฒ ูุงฺู ฺฉ ุฏุฑุณุชฺฏ ฺฉู ุฌุงูฺู ฺฉ ูุฎุชูู ุทุฑููฺบ ูพุฑ ุบูุฑ ฺฉุฑฺบ ู ู ุงุณ ุณุจู ูฺบ MAPE ูพุฑ ุจุงุช ฺฉ ุ ูฺฉู ฺฉุง ุขูพ ุฏูุณุฑ ุทุฑู ุงุณุชุนูุงู ฺฉุฑ ุณฺฉุช ฺบุ ุงู ูพุฑ ุชุญูู ฺฉุฑฺบ ุงูุฑ ุงู ฺฉ ูุถุงุญุช ฺฉุฑฺบ ุงฺฉ ูุฏุฏฺฏุงุฑ ุฏุณุชุงูุฒ [ุงฺบ](https://otexts.com/fpp2/accuracy.html) ุฏุณุชุงุจ 

## [ูฺฉฺุฑ ฺฉ ุจุนุฏ ฺฉุง ฺฉูุฆุฒ](https://gray-sand-07a10f403.1.azurestaticapps.net/quiz/44/)

## ุฌุงุฆุฒ ุงูุฑ ุฎูุฏ ูุทุงูุน

 ุณุจู ARIMA ฺฉ ุณุงุชฺพ ููุช ฺฉ ุณุฑุฒ ฺฉ ูพุด ฺฏูุฆ ฺฉ ุตุฑู ุจูุงุฏ ุงุตูููฺบ ูพุฑ ุจุงุช ฺฉุฑุชุง  ุงูพู ุนูู ฺฉู ฺฏุฑุง ฺฉุฑู ฺฉ ู ููุช ูฺฉุงูฺบ ุงูุฑ [ุงุณ ุฑูพูุฒูนุฑ](https://microsoft.github.io/forecasting/) ุงูุฑ ุงุณ ฺฉ ูุฎุชูู ูุงฺู ุงูุณุงู ฺฉู ุฏฺฉฺพฺบ ุชุงฺฉ ููุช ฺฉ ุณุฑุฒ ฺฉ ูุงฺูุฒ ุจูุงู ฺฉ ุฏูุณุฑ ุทุฑู ุณฺฉฺพ ุณฺฉฺบ

## ุงุณุงุฆููููน

[ุงฺฉ ูุง ARIMA ูุงฺู](assignment.md)

---

**ฺุณฺฉููุฑ**:  
 ุฏุณุชุงูุฒ AI ุชุฑุฌู ุณุฑูุณ [Co-op Translator](https://github.com/Azure/co-op-translator) ฺฉุง ุงุณุชุนูุงู ฺฉุฑุช ูุฆ ุชุฑุฌู ฺฉ ฺฏุฆ  ู ุฏุฑุณุชฺฏ ฺฉ ู ฺฉูุดุด ฺฉุฑุช ฺบุ ูฺฉู ุจุฑุง ฺฉุฑู ุขฺฏุง ุฑฺบ ฺฉ ุฎูุฏฺฉุงุฑ ุชุฑุฌู ูฺบ ุบูุทุงฺบ ุง ุนุฏู ุฏุฑุณุชฺฏ ู ุณฺฉุช ฺบ ุงุตู ุฏุณุชุงูุฒุ ุฌู ุงุณ ฺฉ ููุงู ุฒุจุงู ูฺบ ุ ฺฉู ูุณุชูุฏ ุฐุฑุน ุณูุฌฺพุง ุฌุงูุง ฺุง ุงู ูุนูููุงุช ฺฉ ูุ ูพุด ูุฑ ุงูุณุงู ุชุฑุฌู ฺฉ ุณูุงุฑุด ฺฉ ุฌุงุช  ุงุณ ุชุฑุฌู ฺฉ ุงุณุชุนูุงู ุณ ูพุฏุง ูู ูุงู ฺฉุณ ุจฺพ ุบูุท ูู ุง ุบูุท ุชุดุฑุญ ฺฉ ู ู ุฐู ุฏุงุฑ ูฺบ ฺบ