<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "107d5bb29da8a562e7ae72262d251a75",
  "translation_date": "2025-09-05T01:14:14+00:00",
  "source_file": "8-Reinforcement/2-Gym/README.md",
  "language_code": "bg"
}
-->
# –ö–∞—Ä—Ç–æ—Ñ–µ–ª–Ω–æ –ø—ä—Ä–∑–∞–ª—è–Ω–µ

–ü—Ä–æ–±–ª–µ–º—ä—Ç, –∫–æ–π—Ç–æ —Ä–µ—à–∞–≤–∞—Ö–º–µ –≤ –ø—Ä–µ–¥–∏—à–Ω–∏—è —É—Ä–æ–∫, –º–æ–∂–µ –¥–∞ –∏–∑–≥–ª–µ–∂–¥–∞ –∫–∞—Ç–æ –∏–≥—Ä–∞—á–∫–∞, –∫–æ—è—Ç–æ –Ω—è–º–∞ —Ä–µ–∞–ª–Ω–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤ –∂–∏–≤–æ—Ç–∞. –¢–æ–≤–∞ –Ω–µ –µ —Ç–∞–∫–∞, –∑–∞—â–æ—Ç–æ –º–Ω–æ–≥–æ —Ä–µ–∞–ª–Ω–∏ –ø—Ä–æ–±–ª–µ–º–∏ —Å—ä—â–æ —Å–ø–æ–¥–µ–ª—è—Ç —Ç–æ–∑–∏ —Å—Ü–µ–Ω–∞—Ä–∏–π - –≤–∫–ª—é—á–∏—Ç–µ–ª–Ω–æ –∏–≥—Ä–∞—Ç–∞ –Ω–∞ —à–∞—Ö –∏–ª–∏ –≥–æ. –¢–µ —Å–∞ –ø–æ–¥–æ–±–Ω–∏, –∑–∞—â–æ—Ç–æ —Å—ä—â–æ –∏–º–∞–º–µ –¥—ä—Å–∫–∞ —Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏ –ø—Ä–∞–≤–∏–ª–∞ –∏ **–¥–∏—Å–∫—Ä–µ—Ç–Ω–æ —Å—ä—Å—Ç–æ—è–Ω–∏–µ**.

## [–¢–µ—Å—Ç –ø—Ä–µ–¥–∏ —É—Ä–æ–∫–∞](https://ff-quizzes.netlify.app/en/ml/)

## –í—ä–≤–µ–¥–µ–Ω–∏–µ

–í —Ç–æ–∑–∏ —É—Ä–æ–∫ —â–µ –ø—Ä–∏–ª–æ–∂–∏–º —Å—ä—â–∏—Ç–µ –ø—Ä–∏–Ω—Ü–∏–ø–∏ –Ω–∞ Q-Learning –∫—ä–º –ø—Ä–æ–±–ª–µ–º —Å **–Ω–µ–ø—Ä–µ–∫—ä—Å–Ω–∞—Ç–æ —Å—ä—Å—Ç–æ—è–Ω–∏–µ**, —Ç.–µ. —Å—ä—Å—Ç–æ—è–Ω–∏–µ, –∫–æ–µ—Ç–æ —Å–µ –æ–ø—Ä–µ–¥–µ–ª—è –æ—Ç –µ–¥–Ω–æ –∏–ª–∏ –ø–æ–≤–µ—á–µ —Ä–µ–∞–ª–Ω–∏ —á–∏—Å–ª–∞. –©–µ —Ä–∞–∑–≥–ª–µ–¥–∞–º–µ —Å–ª–µ–¥–Ω–∏—è –ø—Ä–æ–±–ª–µ–º:

> **–ü—Ä–æ–±–ª–µ–º**: –ê–∫–æ –ü–µ—Ç—ä—Ä –∏—Å–∫–∞ –¥–∞ –∏–∑–±—è–≥–∞ –æ—Ç –≤—ä–ª–∫–∞, —Ç—Ä—è–±–≤–∞ –¥–∞ —Å–µ –Ω–∞—É—á–∏ –¥–∞ —Å–µ –¥–≤–∏–∂–∏ –ø–æ-–±—ä—Ä–∑–æ. –©–µ –≤–∏–¥–∏–º –∫–∞–∫ –ü–µ—Ç—ä—Ä –º–æ–∂–µ –¥–∞ —Å–µ –Ω–∞—É—á–∏ –¥–∞ —Å–µ –ø—ä—Ä–∑–∞–ª—è, –ø–æ-—Å–ø–µ—Ü–∏–∞–ª–Ω–æ –¥–∞ –∑–∞–ø–∞–∑–≤–∞ –±–∞–ª–∞–Ω—Å, –∏–∑–ø–æ–ª–∑–≤–∞–π–∫–∏ Q-Learning.

![–ì–æ–ª—è–º–æ—Ç–æ –±—è–≥—Å—Ç–≤–æ!](../../../../8-Reinforcement/2-Gym/images/escape.png)

> –ü–µ—Ç—ä—Ä –∏ –ø—Ä–∏—è—Ç–µ–ª–∏—Ç–µ –º—É —Å—Ç–∞–≤–∞—Ç –∫—Ä–µ–∞—Ç–∏–≤–Ω–∏, –∑–∞ –¥–∞ –∏–∑–±—è–≥–∞—Ç –æ—Ç –≤—ä–ª–∫–∞! –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –æ—Ç [Jen Looper](https://twitter.com/jenlooper)

–©–µ –∏–∑–ø–æ–ª–∑–≤–∞–º–µ –æ–ø—Ä–æ—Å—Ç–µ–Ω–∞ –≤–µ—Ä—Å–∏—è –Ω–∞ –±–∞–ª–∞–Ω—Å–∏—Ä–∞–Ω–µ, –∏–∑–≤–µ—Å—Ç–Ω–∞ –∫–∞—Ç–æ –ø—Ä–æ–±–ª–µ–º–∞ **CartPole**. –í —Å–≤–µ—Ç–∞ –Ω–∞ CartPole –∏–º–∞–º–µ —Ö–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª–µ–Ω –ø–ª—ä–∑–≥–∞—á, –∫–æ–π—Ç–æ –º–æ–∂–µ –¥–∞ —Å–µ –¥–≤–∏–∂–∏ –Ω–∞–ª—è–≤–æ –∏–ª–∏ –Ω–∞–¥—è—Å–Ω–æ, –∞ —Ü–µ–ª—Ç–∞ –µ –¥–∞ –±–∞–ª–∞–Ω—Å–∏—Ä–∞–º–µ –≤–µ—Ä—Ç–∏–∫–∞–ª–µ–Ω –ø—Ä—ä—Ç –≤—ä—Ä—Ö—É –ø–ª—ä–∑–≥–∞—á–∞.

## –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª–Ω–∏ –∑–Ω–∞–Ω–∏—è

–í —Ç–æ–∑–∏ —É—Ä–æ–∫ —â–µ –∏–∑–ø–æ–ª–∑–≤–∞–º–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞, –Ω–∞—Ä–µ—á–µ–Ω–∞ **OpenAI Gym**, –∑–∞ –¥–∞ —Å–∏–º—É–ª–∏—Ä–∞–º–µ —Ä–∞–∑–ª–∏—á–Ω–∏ **—Å—Ä–µ–¥–∏**. –ú–æ–∂–µ—Ç–µ –¥–∞ –∏–∑–ø—ä–ª–Ω–∏—Ç–µ –∫–æ–¥–∞ –Ω–∞ —É—Ä–æ–∫–∞ –ª–æ–∫–∞–ª–Ω–æ (–Ω–∞–ø—Ä–∏–º–µ—Ä –æ—Ç Visual Studio Code), –∫–∞—Ç–æ —Å–∏–º—É–ª–∞—Ü–∏—è—Ç–∞ —â–µ —Å–µ –æ—Ç–≤–æ—Ä–∏ –≤ –Ω–æ–≤ –ø—Ä–æ–∑–æ—Ä–µ—Ü. –ê–∫–æ –∏–∑–ø—ä–ª–Ω—è–≤–∞—Ç–µ –∫–æ–¥–∞ –æ–Ω–ª–∞–π–Ω, –º–æ–∂–µ –¥–∞ —Å–µ –Ω–∞–ª–æ–∂–∏ –¥–∞ –Ω–∞–ø—Ä–∞–≤–∏—Ç–µ –Ω—è–∫–æ–∏ –ø—Ä–æ–º–µ–Ω–∏ –≤ –∫–æ–¥–∞, –∫–∞–∫—Ç–æ –µ –æ–ø–∏—Å–∞–Ω–æ [—Ç—É–∫](https://towardsdatascience.com/rendering-openai-gym-envs-on-binder-and-google-colab-536f99391cc7).

## OpenAI Gym

–í –ø—Ä–µ–¥–∏—à–Ω–∏—è —É—Ä–æ–∫ –ø—Ä–∞–≤–∏–ª–∞—Ç–∞ –Ω–∞ –∏–≥—Ä–∞—Ç–∞ –∏ —Å—ä—Å—Ç–æ—è–Ω–∏–µ—Ç–æ –±—è—Ö–∞ –∑–∞–¥–∞–¥–µ–Ω–∏ –æ—Ç –∫–ª–∞—Å–∞ `Board`, –∫–æ–π—Ç–æ –¥–µ—Ñ–∏–Ω–∏—Ä–∞—Ö–º–µ —Å–∞–º–∏. –¢—É–∫ —â–µ –∏–∑–ø–æ–ª–∑–≤–∞–º–µ —Å–ø–µ—Ü–∏–∞–ª–Ω–∞ **—Å–∏–º—É–ª–∞—Ü–∏–æ–Ω–Ω–∞ —Å—Ä–µ–¥–∞**, –∫–æ—è—Ç–æ —â–µ —Å–∏–º—É–ª–∏—Ä–∞ —Ñ–∏–∑–∏–∫–∞—Ç–∞ –∑–∞–¥ –±–∞–ª–∞–Ω—Å–∏—Ä–∞—â–∏—è –ø—Ä—ä—Ç. –ï–¥–Ω–∞ –æ—Ç –Ω–∞–π-–ø–æ–ø—É–ª—è—Ä–Ω–∏—Ç–µ —Å–∏–º—É–ª–∞—Ü–∏–æ–Ω–Ω–∏ —Å—Ä–µ–¥–∏ –∑–∞ –æ–±—É—á–µ–Ω–∏–µ –Ω–∞ –∞–ª–≥–æ—Ä–∏—Ç–º–∏ –∑–∞ –ø–æ–¥—Å–∏–ª–≤–∞—â–æ –æ–±—É—á–µ–Ω–∏–µ —Å–µ –Ω–∞—Ä–∏—á–∞ [Gym](https://gym.openai.com/), –∫–æ—è—Ç–æ —Å–µ –ø–æ–¥–¥—ä—Ä–∂–∞ –æ—Ç [OpenAI](https://openai.com/). –° –ø–æ–º–æ—â—Ç–∞ –Ω–∞ —Ç–æ–∑–∏ Gym –º–æ–∂–µ–º –¥–∞ —Å—ä–∑–¥–∞–≤–∞–º–µ —Ä–∞–∑–ª–∏—á–Ω–∏ **—Å—Ä–µ–¥–∏** - –æ—Ç —Å–∏–º—É–ª–∞—Ü–∏—è –Ω–∞ CartPole –¥–æ –∏–≥—Ä–∏ –Ω–∞ Atari.

> **–ó–∞–±–µ–ª–µ–∂–∫–∞**: –ú–æ–∂–µ—Ç–µ –¥–∞ –≤–∏–¥–∏—Ç–µ –¥—Ä—É–≥–∏ —Å—Ä–µ–¥–∏, –Ω–∞–ª–∏—á–Ω–∏ –≤ OpenAI Gym, [—Ç—É–∫](https://gym.openai.com/envs/#classic_control).

–ü—ä—Ä–≤–æ, –Ω–µ–∫–∞ –∏–Ω—Å—Ç–∞–ª–∏—Ä–∞–º–µ Gym –∏ –∏–º–ø–æ—Ä—Ç–∏—Ä–∞–º–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–∏—Ç–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ (–∫–æ–¥ –±–ª–æ–∫ 1):

```python
import sys
!{sys.executable} -m pip install gym 

import gym
import matplotlib.pyplot as plt
import numpy as np
import random
```

## –£–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ - –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–∞–Ω–µ –Ω–∞ —Å—Ä–µ–¥–∞ –∑–∞ CartPole

–ó–∞ –¥–∞ —Ä–∞–±–æ—Ç–∏–º —Å –ø—Ä–æ–±–ª–µ–º–∞ –∑–∞ –±–∞–ª–∞–Ω—Å–∏—Ä–∞–Ω–µ –Ω–∞ CartPole, —Ç—Ä—è–±–≤–∞ –¥–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–∞–º–µ —Å—ä–æ—Ç–≤–µ—Ç–Ω–∞—Ç–∞ —Å—Ä–µ–¥–∞. –í—Å—è–∫–∞ —Å—Ä–µ–¥–∞ –µ —Å–≤—ä—Ä–∑–∞–Ω–∞ —Å:

- **–ü—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –Ω–∞ –Ω–∞–±–ª—é–¥–µ–Ω–∏—è—Ç–∞**, –∫–æ–µ—Ç–æ –æ–ø—Ä–µ–¥–µ–ª—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞—Ç–∞ –Ω–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è—Ç–∞, –∫–æ—è—Ç–æ –ø–æ–ª—É—á–∞–≤–∞–º–µ –æ—Ç —Å—Ä–µ–¥–∞—Ç–∞. –ó–∞ –ø—Ä–æ–±–ª–µ–º–∞ —Å CartPole –ø–æ–ª—É—á–∞–≤–∞–º–µ –ø–æ–∑–∏—Ü–∏—è—Ç–∞ –Ω–∞ –ø—Ä—ä—Ç–∞, —Å–∫–æ—Ä–æ—Å—Ç—Ç–∞ –∏ –Ω—è–∫–æ–∏ –¥—Ä—É–≥–∏ —Å—Ç–æ–π–Ω–æ—Å—Ç–∏.

- **–ü—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –Ω–∞ –¥–µ–π—Å—Ç–≤–∏—è—Ç–∞**, –∫–æ–µ—Ç–æ –æ–ø—Ä–µ–¥–µ–ª—è –≤—ä–∑–º–æ–∂–Ω–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏—è. –í –Ω–∞—à–∏—è —Å–ª—É—á–∞–π –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ—Ç–æ –Ω–∞ –¥–µ–π—Å—Ç–≤–∏—è—Ç–∞ –µ –¥–∏—Å–∫—Ä–µ—Ç–Ω–æ –∏ —Å–µ —Å—ä—Å—Ç–æ–∏ –æ—Ç –¥–≤–µ –¥–µ–π—Å—Ç–≤–∏—è - **–Ω–∞–ª—è–≤–æ** –∏ **–Ω–∞–¥—è—Å–Ω–æ**. (–∫–æ–¥ –±–ª–æ–∫ 2)

1. –ó–∞ –¥–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–∞—Ç–µ, –≤—ä–≤–µ–¥–µ—Ç–µ —Å–ª–µ–¥–Ω–∏—è –∫–æ–¥:

    ```python
    env = gym.make("CartPole-v1")
    print(env.action_space)
    print(env.observation_space)
    print(env.action_space.sample())
    ```

–ó–∞ –¥–∞ –≤–∏–¥–∏–º –∫–∞–∫ —Ä–∞–±–æ—Ç–∏ —Å—Ä–µ–¥–∞—Ç–∞, –Ω–µ–∫–∞ –∏–∑–ø—ä–ª–Ω–∏–º –∫—Ä–∞—Ç–∫–∞ —Å–∏–º—É–ª–∞—Ü–∏—è –∑–∞ 100 —Å—Ç—ä–ø–∫–∏. –ù–∞ –≤—Å—è–∫–∞ —Å—Ç—ä–ø–∫–∞ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤—è–º–µ –µ–¥–Ω–æ –æ—Ç –¥–µ–π—Å—Ç–≤–∏—è—Ç–∞, –∫–æ–∏—Ç–æ —Ç—Ä—è–±–≤–∞ –¥–∞ —Å–µ –∏–∑–ø—ä–ª–Ω—è—Ç - –≤ —Ç–∞–∑–∏ —Å–∏–º—É–ª–∞—Ü–∏—è –ø—Ä–æ—Å—Ç–æ —Å–ª—É—á–∞–π–Ω–æ –∏–∑–±–∏—Ä–∞–º–µ –¥–µ–π—Å—Ç–≤–∏–µ –æ—Ç `action_space`.

1. –ò–∑–ø—ä–ª–Ω–µ—Ç–µ –∫–æ–¥–∞ –ø–æ-–¥–æ–ª—É –∏ –≤–∏–∂—Ç–µ –∫–∞–∫–≤–æ –≤–æ–¥–∏ –¥–æ —Ç–æ–≤–∞.

    ‚úÖ –ó–∞–ø–æ–º–Ω–µ—Ç–µ, —á–µ –µ –ø—Ä–µ–ø–æ—Ä—ä—á–∏—Ç–µ–ª–Ω–æ –¥–∞ –∏–∑–ø—ä–ª–Ω—è–≤–∞—Ç–µ —Ç–æ–∑–∏ –∫–æ–¥ –Ω–∞ –ª–æ–∫–∞–ª–Ω–∞ Python –∏–Ω—Å—Ç–∞–ª–∞—Ü–∏—è! (–∫–æ–¥ –±–ª–æ–∫ 3)

    ```python
    env.reset()
    
    for i in range(100):
       env.render()
       env.step(env.action_space.sample())
    env.close()
    ```

    –¢—Ä—è–±–≤–∞ –¥–∞ –≤–∏–∂–¥–∞—Ç–µ –Ω–µ—â–æ –ø–æ–¥–æ–±–Ω–æ –Ω–∞ —Ç–æ–≤–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ:

    ![–Ω–µ–±–∞–ª–∞–Ω—Å–∏—Ä–∞—â CartPole](../../../../8-Reinforcement/2-Gym/images/cartpole-nobalance.gif)

1. –ü–æ –≤—Ä–µ–º–µ –Ω–∞ —Å–∏–º—É–ª–∞—Ü–∏—è—Ç–∞ —Ç—Ä—è–±–≤–∞ –¥–∞ –ø–æ–ª—É—á–∞–≤–∞–º–µ –Ω–∞–±–ª—é–¥–µ–Ω–∏—è, –∑–∞ –¥–∞ —Ä–µ—à–∏–º –∫–∞–∫ –¥–∞ –¥–µ–π—Å—Ç–≤–∞–º–µ. –í—Å—ä—â–Ω–æ—Å—Ç —Ñ—É–Ω–∫—Ü–∏—è—Ç–∞ `step` –≤—Ä—ä—â–∞ —Ç–µ–∫—É—â–∏—Ç–µ –Ω–∞–±–ª—é–¥–µ–Ω–∏—è, —Ñ—É–Ω–∫—Ü–∏—è –∑–∞ –Ω–∞–≥—Ä–∞–¥–∞ –∏ —Ñ–ª–∞–≥ `done`, –∫–æ–π—Ç–æ –ø–æ–∫–∞–∑–≤–∞ –¥–∞–ª–∏ –∏–º–∞ —Å–º–∏—Å—ä–ª –¥–∞ –ø—Ä–æ–¥—ä–ª–∂–∏–º —Å–∏–º—É–ª–∞—Ü–∏—è—Ç–∞ –∏–ª–∏ –Ω–µ: (–∫–æ–¥ –±–ª–æ–∫ 4)

    ```python
    env.reset()
    
    done = False
    while not done:
       env.render()
       obs, rew, done, info = env.step(env.action_space.sample())
       print(f"{obs} -> {rew}")
    env.close()
    ```

    –©–µ –≤–∏–¥–∏—Ç–µ –Ω–µ—â–æ –ø–æ–¥–æ–±–Ω–æ –Ω–∞ —Ç–æ–≤–∞ –≤ –∏–∑—Ö–æ–¥–∞ –Ω–∞ notebook-–∞:

    ```text
    [ 0.03403272 -0.24301182  0.02669811  0.2895829 ] -> 1.0
    [ 0.02917248 -0.04828055  0.03248977  0.00543839] -> 1.0
    [ 0.02820687  0.14636075  0.03259854 -0.27681916] -> 1.0
    [ 0.03113408  0.34100283  0.02706215 -0.55904489] -> 1.0
    [ 0.03795414  0.53573468  0.01588125 -0.84308041] -> 1.0
    ...
    [ 0.17299878  0.15868546 -0.20754175 -0.55975453] -> 1.0
    [ 0.17617249  0.35602306 -0.21873684 -0.90998894] -> 1.0
    ```

    –í–µ–∫—Ç–æ—Ä—ä—Ç –Ω–∞ –Ω–∞–±–ª—é–¥–µ–Ω–∏—è—Ç–∞, –∫–æ–π—Ç–æ —Å–µ –≤—Ä—ä—â–∞ –Ω–∞ –≤—Å—è–∫–∞ —Å—Ç—ä–ø–∫–∞ –æ—Ç —Å–∏–º—É–ª–∞—Ü–∏—è—Ç–∞, —Å—ä–¥—ä—Ä–∂–∞ —Å–ª–µ–¥–Ω–∏—Ç–µ —Å—Ç–æ–π–Ω–æ—Å—Ç–∏:
    - –ü–æ–∑–∏—Ü–∏—è –Ω–∞ –∫–æ–ª–∏—á–∫–∞—Ç–∞
    - –°–∫–æ—Ä–æ—Å—Ç –Ω–∞ –∫–æ–ª–∏—á–∫–∞—Ç–∞
    - –™–≥—ä–ª –Ω–∞ –ø—Ä—ä—Ç–∞
    - –°–∫–æ—Ä–æ—Å—Ç –Ω–∞ –≤—ä—Ä—Ç–µ–Ω–µ –Ω–∞ –ø—Ä—ä—Ç–∞

1. –ü–æ–ª—É—á–µ—Ç–µ –º–∏–Ω–∏–º–∞–ª–Ω–∞—Ç–∞ –∏ –º–∞–∫—Å–∏–º–∞–ª–Ω–∞—Ç–∞ —Å—Ç–æ–π–Ω–æ—Å—Ç –Ω–∞ —Ç–µ–∑–∏ —á–∏—Å–ª–∞: (–∫–æ–¥ –±–ª–æ–∫ 5)

    ```python
    print(env.observation_space.low)
    print(env.observation_space.high)
    ```

    –ú–æ–∂–µ —Å—ä—â–æ –¥–∞ –∑–∞–±–µ–ª–µ–∂–∏—Ç–µ, —á–µ —Å—Ç–æ–π–Ω–æ—Å—Ç—Ç–∞ –Ω–∞ –Ω–∞–≥—Ä–∞–¥–∞—Ç–∞ –Ω–∞ –≤—Å—è–∫–∞ —Å—Ç—ä–ø–∫–∞ –æ—Ç —Å–∏–º—É–ª–∞—Ü–∏—è—Ç–∞ –≤–∏–Ω–∞–≥–∏ –µ 1. –¢–æ–≤–∞ –µ —Ç–∞–∫–∞, –∑–∞—â–æ—Ç–æ –Ω–∞—à–∞—Ç–∞ —Ü–µ–ª –µ –¥–∞ –æ—Ü–µ–ª–µ–µ–º –≤—ä–∑–º–æ–∂–Ω–æ –Ω–∞–π-–¥—ä–ª–≥–æ, —Ç.–µ. –¥–∞ –∑–∞–ø–∞–∑–∏–º –ø—Ä—ä—Ç–∞ –≤ —Ä–∞–∑—É–º–Ω–æ –≤–µ—Ä—Ç–∏–∫–∞–ª–Ω–æ –ø–æ–ª–æ–∂–µ–Ω–∏–µ –∑–∞ –Ω–∞–π-–¥—ä–ª—ä–≥ –ø–µ—Ä–∏–æ–¥ –æ—Ç –≤—Ä–µ–º–µ.

    ‚úÖ –í—Å—ä—â–Ω–æ—Å—Ç —Å–∏–º—É–ª–∞—Ü–∏—è—Ç–∞ –Ω–∞ CartPole —Å–µ —Å—á–∏—Ç–∞ –∑–∞ —Ä–µ—à–µ–Ω–∞, –∞–∫–æ —É—Å–ø–µ–µ–º –¥–∞ –ø–æ—Å—Ç–∏–≥–Ω–µ–º —Å—Ä–µ–¥–Ω–∞ –Ω–∞–≥—Ä–∞–¥–∞ –æ—Ç 195 –∑–∞ 100 –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª–Ω–∏ –æ–ø–∏—Ç–∞.

## –î–∏—Å–∫—Ä–µ—Ç–∏–∑–∞—Ü–∏—è –Ω–∞ —Å—ä—Å—Ç–æ—è–Ω–∏–µ—Ç–æ

–í Q-Learning —Ç—Ä—è–±–≤–∞ –¥–∞ –∏–∑–≥—Ä–∞–¥–∏–º Q-—Ç–∞–±–ª–∏—Ü–∞, –∫–æ—è—Ç–æ –æ–ø—Ä–µ–¥–µ–ª—è –∫–∞–∫–≤–æ –¥–∞ –ø—Ä–∞–≤–∏–º –≤—ä–≤ –≤—Å—è–∫–æ —Å—ä—Å—Ç–æ—è–Ω–∏–µ. –ó–∞ –¥–∞ –º–æ–∂–µ–º –¥–∞ –Ω–∞–ø—Ä–∞–≤–∏–º —Ç–æ–≤–∞, —Å—ä—Å—Ç–æ—è–Ω–∏–µ—Ç–æ —Ç—Ä—è–±–≤–∞ –¥–∞ –±—ä–¥–µ **–¥–∏—Å–∫—Ä–µ—Ç–Ω–æ**, –ø–æ-—Ç–æ—á–Ω–æ, —Ç—Ä—è–±–≤–∞ –¥–∞ —Å—ä–¥—ä—Ä–∂–∞ –∫—Ä–∞–µ–Ω –±—Ä–æ–π –¥–∏—Å–∫—Ä–µ—Ç–Ω–∏ —Å—Ç–æ–π–Ω–æ—Å—Ç–∏. –°–ª–µ–¥–æ–≤–∞—Ç–µ–ª–Ω–æ —Ç—Ä—è–±–≤–∞ –ø–æ –Ω—è–∫–∞–∫—ä–≤ –Ω–∞—á–∏–Ω –¥–∞ **–¥–∏—Å–∫—Ä–µ—Ç–∏–∑–∏—Ä–∞–º–µ** –Ω–∞—à–∏—Ç–µ –Ω–∞–±–ª—é–¥–µ–Ω–∏—è, –∫–∞—Ç–æ –≥–∏ –∫–∞—Ä—Ç–æ–≥—Ä–∞—Ñ–∏—Ä–∞–º–µ –∫—ä–º –∫—Ä–∞–µ–Ω –Ω–∞–±–æ—Ä –æ—Ç —Å—ä—Å—Ç–æ—è–Ω–∏—è.

–ò–º–∞ –Ω—è–∫–æ–ª–∫–æ –Ω–∞—á–∏–Ω–∞ –¥–∞ –Ω–∞–ø—Ä–∞–≤–∏–º —Ç–æ–≤–∞:

- **–†–∞–∑–¥–µ–ª—è–Ω–µ –Ω–∞ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∏**. –ê–∫–æ –∑–Ω–∞–µ–º –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞ –Ω–∞ –¥–∞–¥–µ–Ω–∞ —Å—Ç–æ–π–Ω–æ—Å—Ç, –º–æ–∂–µ–º –¥–∞ —Ä–∞–∑–¥–µ–ª–∏–º —Ç–æ–∑–∏ –∏–Ω—Ç–µ—Ä–≤–∞–ª –Ω–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω –±—Ä–æ–π **–∏–Ω—Ç–µ—Ä–≤–∞–ª–∏** –∏ —Å–ª–µ–¥ —Ç–æ–≤–∞ –¥–∞ –∑–∞–º–µ–Ω–∏–º —Å—Ç–æ–π–Ω–æ—Å—Ç—Ç–∞ —Å –Ω–æ–º–µ—Ä–∞ –Ω–∞ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞, –∫—ä–º –∫–æ–π—Ç–æ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏. –¢–æ–≤–∞ –º–æ–∂–µ –¥–∞ —Å–µ –Ω–∞–ø—Ä–∞–≤–∏ —Å –ø–æ–º–æ—â—Ç–∞ –Ω–∞ –º–µ—Ç–æ–¥–∞ [`digitize`](https://numpy.org/doc/stable/reference/generated/numpy.digitize.html) –Ω–∞ numpy. –í —Ç–æ–∑–∏ —Å–ª—É—á–∞–π —â–µ –∑–Ω–∞–µ–º —Ç–æ—á–Ω–æ —Ä–∞–∑–º–µ—Ä–∞ –Ω–∞ —Å—ä—Å—Ç–æ—è–Ω–∏–µ—Ç–æ, –∑–∞—â–æ—Ç–æ —Ç–æ–π —â–µ –∑–∞–≤–∏—Å–∏ –æ—Ç –±—Ä–æ—è –Ω–∞ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∏—Ç–µ, –∫–æ–∏—Ç–æ –∏–∑–±–µ—Ä–µ–º –∑–∞ –¥–∏–≥–∏—Ç–∞–ª–∏–∑–∞—Ü–∏—è.

‚úÖ –ú–æ–∂–µ–º –¥–∞ –∏–∑–ø–æ–ª–∑–≤–∞–º–µ –ª–∏–Ω–µ–π–Ω–∞ –∏–Ω—Ç–µ—Ä–ø–æ–ª–∞—Ü–∏—è, –∑–∞ –¥–∞ –ø—Ä–∏–≤–µ–¥–µ–º —Å—Ç–æ–π–Ω–æ—Å—Ç–∏—Ç–µ –∫—ä–º –Ω—è–∫–∞–∫—ä–≤ –∫—Ä–∞–µ–Ω –∏–Ω—Ç–µ—Ä–≤–∞–ª (–Ω–∞–ø—Ä–∏–º–µ—Ä –æ—Ç -20 –¥–æ 20), –∏ —Å–ª–µ–¥ —Ç–æ–≤–∞ –¥–∞ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–∞–º–µ —á–∏—Å–ª–∞—Ç–∞ –≤ —Ü–µ–ª–∏ —á–∏—Å–ª–∞ —á—Ä–µ–∑ –∑–∞–∫—Ä—ä–≥–ª—è–≤–∞–Ω–µ. –¢–æ–≤–∞ –Ω–∏ –¥–∞–≤–∞ –º–∞–ª–∫–æ –ø–æ-–º–∞–ª—ä–∫ –∫–æ–Ω—Ç—Ä–æ–ª –≤—ä—Ä—Ö—É —Ä–∞–∑–º–µ—Ä–∞ –Ω–∞ —Å—ä—Å—Ç–æ—è–Ω–∏–µ—Ç–æ, –æ—Å–æ–±–µ–Ω–æ –∞–∫–æ –Ω–µ –∑–Ω–∞–µ–º —Ç–æ—á–Ω–∏—Ç–µ –≥—Ä–∞–Ω–∏—Ü–∏ –Ω–∞ –≤—Ö–æ–¥–Ω–∏—Ç–µ —Å—Ç–æ–π–Ω–æ—Å—Ç–∏. –ù–∞–ø—Ä–∏–º–µ—Ä, –≤ –Ω–∞—à–∏—è —Å–ª—É—á–∞–π 2 –æ—Ç 4 —Å—Ç–æ–π–Ω–æ—Å—Ç–∏ –Ω—è–º–∞—Ç –≥–æ—Ä–Ω–∞/–¥–æ–ª–Ω–∞ –≥—Ä–∞–Ω–∏—Ü–∞, –∫–æ–µ—Ç–æ –º–æ–∂–µ –¥–∞ –¥–æ–≤–µ–¥–µ –¥–æ –±–µ–∑–∫—Ä–∞–µ–Ω –±—Ä–æ–π —Å—ä—Å—Ç–æ—è–Ω–∏—è.

–í –Ω–∞—à–∏—è –ø—Ä–∏–º–µ—Ä —â–µ –∏–∑–ø–æ–ª–∑–≤–∞–º–µ –≤—Ç–æ—Ä–∏—è –ø–æ–¥—Ö–æ–¥. –ö–∞–∫—Ç–æ –º–æ–∂–µ –¥–∞ –∑–∞–±–µ–ª–µ–∂–∏—Ç–µ –ø–æ-–∫—ä—Å–Ω–æ, –≤—ä–ø—Ä–µ–∫–∏ –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—Ç–µ –≥–æ—Ä–Ω–∏/–¥–æ–ª–Ω–∏ –≥—Ä–∞–Ω–∏—Ü–∏, —Ç–µ–∑–∏ —Å—Ç–æ–π–Ω–æ—Å—Ç–∏ —Ä—è–¥–∫–æ –ø—Ä–∏–µ–º–∞—Ç —Å—Ç–æ–π–Ω–æ—Å—Ç–∏ –∏–∑–≤—ä–Ω –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏ –∫—Ä–∞–π–Ω–∏ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∏, —Ç–∞–∫–∞ —á–µ —Å—ä—Å—Ç–æ—è–Ω–∏—è—Ç–∞ —Å –µ–∫—Å—Ç—Ä–µ–º–Ω–∏ —Å—Ç–æ–π–Ω–æ—Å—Ç–∏ —â–µ –±—ä–¥–∞—Ç –º–Ω–æ–≥–æ —Ä–µ–¥–∫–∏.

1. –ï—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è—Ç–∞, –∫–æ—è—Ç–æ —â–µ –≤–∑–µ–º–µ –Ω–∞–±–ª—é–¥–µ–Ω–∏–µ—Ç–æ –æ—Ç –Ω–∞—à–∏—è –º–æ–¥–µ–ª –∏ —â–µ –ø—Ä–æ–∏–∑–≤–µ–¥–µ –∫–æ—Ä—Ç–µ–∂ –æ—Ç 4 —Ü–µ–ª–∏ —á–∏—Å–ª–∞: (–∫–æ–¥ –±–ª–æ–∫ 6)

    ```python
    def discretize(x):
        return tuple((x/np.array([0.25, 0.25, 0.01, 0.1])).astype(np.int))
    ```

1. –ù–µ–∫–∞ —Å—ä—â–æ —Ç–∞–∫–∞ –∏–∑—Å–ª–µ–¥–≤–∞–º–µ –¥—Ä—É–≥ –º–µ—Ç–æ–¥ –∑–∞ –¥–∏—Å–∫—Ä–µ—Ç–∏–∑–∞—Ü–∏—è, –∏–∑–ø–æ–ª–∑–≤–∞–π–∫–∏ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∏: (–∫–æ–¥ –±–ª–æ–∫ 7)

    ```python
    def create_bins(i,num):
        return np.arange(num+1)*(i[1]-i[0])/num+i[0]
    
    print("Sample bins for interval (-5,5) with 10 bins\n",create_bins((-5,5),10))
    
    ints = [(-5,5),(-2,2),(-0.5,0.5),(-2,2)] # intervals of values for each parameter
    nbins = [20,20,10,10] # number of bins for each parameter
    bins = [create_bins(ints[i],nbins[i]) for i in range(4)]
    
    def discretize_bins(x):
        return tuple(np.digitize(x[i],bins[i]) for i in range(4))
    ```

1. –°–µ–≥–∞ –Ω–µ–∫–∞ –∏–∑–ø—ä–ª–Ω–∏–º –∫—Ä–∞—Ç–∫–∞ —Å–∏–º—É–ª–∞—Ü–∏—è –∏ –Ω–∞–±–ª—é–¥–∞–≤–∞–º–µ —Ç–µ–∑–∏ –¥–∏—Å–∫—Ä–µ—Ç–Ω–∏ —Å—Ç–æ–π–Ω–æ—Å—Ç–∏ –Ω–∞ —Å—Ä–µ–¥–∞—Ç–∞. –ß—É–≤—Å—Ç–≤–∞–π—Ç–µ —Å–µ —Å–≤–æ–±–æ–¥–Ω–∏ –¥–∞ –æ–ø–∏—Ç–∞—Ç–µ –∫–∞–∫—Ç–æ `discretize`, —Ç–∞–∫–∞ –∏ `discretize_bins` –∏ –≤–∏–∂—Ç–µ –¥–∞–ª–∏ –∏–º–∞ —Ä–∞–∑–ª–∏–∫–∞.

    ‚úÖ `discretize_bins` –≤—Ä—ä—â–∞ –Ω–æ–º–µ—Ä–∞ –Ω–∞ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞, –∫–æ–π—Ç–æ –∑–∞–ø–æ—á–≤–∞ –æ—Ç 0. –°–ª–µ–¥–æ–≤–∞—Ç–µ–ª–Ω–æ –∑–∞ —Å—Ç–æ–π–Ω–æ—Å—Ç–∏ –Ω–∞ –≤—Ö–æ–¥–Ω–∞—Ç–∞ –ø—Ä–æ–º–µ–Ω–ª–∏–≤–∞ –æ–∫–æ–ª–æ 0 –≤—Ä—ä—â–∞ —á–∏—Å–ª–æ –æ—Ç —Å—Ä–µ–¥–∞—Ç–∞ –Ω–∞ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞ (10). –í `discretize` –Ω–µ —Å–µ –≥—Ä–∏–∂–µ—Ö–º–µ –∑–∞ –¥–∏–∞–ø–∞–∑–æ–Ω–∞ –Ω–∞ –∏–∑—Ö–æ–¥–Ω–∏—Ç–µ —Å—Ç–æ–π–Ω–æ—Å—Ç–∏, –ø–æ–∑–≤–æ–ª—è–≤–∞–π–∫–∏ –∏–º –¥–∞ –±—ä–¥–∞—Ç –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª–Ω–∏, —Ç–∞–∫–∞ —á–µ —Å—Ç–æ–π–Ω–æ—Å—Ç–∏—Ç–µ –Ω–∞ —Å—ä—Å—Ç–æ—è–Ω–∏–µ—Ç–æ –Ω–µ —Å–∞ –∏–∑–º–µ—Å—Ç–µ–Ω–∏ –∏ 0 —Å—ä–æ—Ç–≤–µ—Ç—Å—Ç–≤–∞ –Ω–∞ 0. (–∫–æ–¥ –±–ª–æ–∫ 8)

    ```python
    env.reset()
    
    done = False
    while not done:
       #env.render()
       obs, rew, done, info = env.step(env.action_space.sample())
       #print(discretize_bins(obs))
       print(discretize(obs))
    env.close()
    ```

    ‚úÖ –†–∞–∑–∫–æ–º–µ–Ω—Ç–∏—Ä–∞–π—Ç–µ —Ä–µ–¥–∞, –∑–∞–ø–æ—á–≤–∞—â —Å `env.render`, –∞–∫–æ –∏—Å–∫–∞—Ç–µ –¥–∞ –≤–∏–¥–∏—Ç–µ –∫–∞–∫ —Å–µ –∏–∑–ø—ä–ª–Ω—è–≤–∞ —Å—Ä–µ–¥–∞—Ç–∞. –í –ø—Ä–æ—Ç–∏–≤–µ–Ω —Å–ª—É—á–∞–π –º–æ–∂–µ—Ç–µ –¥–∞ –≥–æ –∏–∑–ø—ä–ª–Ω–∏—Ç–µ –≤—ä–≤ —Ñ–æ–Ω–æ–≤ —Ä–µ–∂–∏–º, –∫–æ–µ—Ç–æ –µ –ø–æ-–±—ä—Ä–∑–æ. –©–µ –∏–∑–ø–æ–ª–∑–≤–∞–º–µ —Ç–æ–≤–∞ "–Ω–µ–≤–∏–¥–∏–º–æ" –∏–∑–ø—ä–ª–Ω–µ–Ω–∏–µ –ø–æ –≤—Ä–µ–º–µ –Ω–∞ –ø—Ä–æ—Ü–µ—Å–∞ –Ω–∞ Q-Learning.

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –Ω–∞ Q-—Ç–∞–±–ª–∏—Ü–∞—Ç–∞

–í –ø—Ä–µ–¥–∏—à–Ω–∏—è —É—Ä–æ–∫ —Å—ä—Å—Ç–æ—è–Ω–∏–µ—Ç–æ –±–µ—à–µ –ø—Ä–æ—Å—Ç–∞ –¥–≤–æ–π–∫–∞ —á–∏—Å–ª–∞ –æ—Ç 0 –¥–æ 8, –∏ –∑–∞—Ç–æ–≤–∞ –±–µ—à–µ —É–¥–æ–±–Ω–æ –¥–∞ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏–º Q-—Ç–∞–±–ª–∏—Ü–∞—Ç–∞ –∫–∞—Ç–æ numpy —Ç–µ–Ω–∑–æ—Ä —Å —Ä–∞–∑–º–µ—Ä–∏ 8x8x2. –ê–∫–æ –∏–∑–ø–æ–ª–∑–≤–∞–º–µ –¥–∏—Å–∫—Ä–µ—Ç–∏–∑–∞—Ü–∏—è —Å –∏–Ω—Ç–µ—Ä–≤–∞–ª–∏, —Ä–∞–∑–º–µ—Ä—ä—Ç –Ω–∞ –Ω–∞—à–∏—è –≤–µ–∫—Ç–æ—Ä –Ω–∞ —Å—ä—Å—Ç–æ—è–Ω–∏–µ—Ç–æ —Å—ä—â–æ –µ –∏–∑–≤–µ—Å—Ç–µ–Ω, —Ç–∞–∫–∞ —á–µ –º–æ–∂–µ–º –¥–∞ –∏–∑–ø–æ–ª–∑–≤–∞–º–µ —Å—ä—â–∏—è –ø–æ–¥—Ö–æ–¥ –∏ –¥–∞ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏–º —Å—ä—Å—Ç–æ—è–Ω–∏–µ—Ç–æ –∫–∞—Ç–æ –º–∞—Å–∏–≤ —Å —Ä–∞–∑–º–µ—Ä–∏ 20x20x10x10x2 (—Ç—É–∫ 2 –µ —Ä–∞–∑–º–µ—Ä—ä—Ç –Ω–∞ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ—Ç–æ –Ω–∞ –¥–µ–π—Å—Ç–≤–∏—è—Ç–∞, –∞ –ø—ä—Ä–≤–∏—Ç–µ —Ä–∞–∑–º–µ—Ä–∏ —Å—ä–æ—Ç–≤–µ—Ç—Å—Ç–≤–∞—Ç –Ω–∞ –±—Ä–æ—è –Ω–∞ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∏—Ç–µ, –∫–æ–∏—Ç–æ —Å–º–µ –∏–∑–±—Ä–∞–ª–∏ –∑–∞ –≤—Å—è–∫–∞ –æ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä–∏—Ç–µ –≤ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ—Ç–æ –Ω–∞ –Ω–∞–±–ª—é–¥–µ–Ω–∏—è—Ç–∞).

–í—ä–ø—Ä–µ–∫–∏ —Ç–æ–≤–∞, –ø–æ–Ω—è–∫–æ–≥–∞ —Ç–æ—á–Ω–∏—Ç–µ —Ä–∞–∑–º–µ—Ä–∏ –Ω–∞ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ—Ç–æ –Ω–∞ –Ω–∞–±–ª—é–¥–µ–Ω–∏—è—Ç–∞ –Ω–µ —Å–∞ –∏–∑–≤–µ—Å—Ç–Ω–∏. –í —Å–ª—É—á–∞–π –Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è—Ç–∞ `discretize`, –Ω–∏–∫–æ–≥–∞ –Ω–µ –º–æ–∂–µ–º –¥–∞ –±—ä–¥–µ–º —Å–∏–≥—É—Ä–Ω–∏, —á–µ –Ω–∞—à–µ—Ç–æ —Å—ä—Å—Ç–æ—è–Ω–∏–µ –æ—Å—Ç–∞–≤–∞ –≤ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏ –≥—Ä–∞–Ω–∏—Ü–∏, –∑–∞—â–æ—Ç–æ –Ω—è–∫–æ–∏ –æ—Ç –æ—Ä–∏–≥–∏–Ω–∞–ª–Ω–∏—Ç–µ —Å—Ç–æ–π–Ω–æ—Å—Ç–∏ –Ω–µ —Å–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏. –ó–∞—Ç–æ–≤–∞ —â–µ –∏–∑–ø–æ–ª–∑–≤–∞–º–µ –º–∞–ª–∫–æ –ø–æ-—Ä–∞–∑–ª–∏—á–µ–Ω –ø–æ–¥—Ö–æ–¥ –∏ —â–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏–º Q-—Ç–∞–±–ª–∏—Ü–∞—Ç–∞ –∫–∞—Ç–æ —Ä–µ—á–Ω–∏–∫.

1. –ò–∑–ø–æ–ª–∑–≤–∞–π—Ç–µ –¥–≤–æ–π–∫–∞—Ç–∞ *(state,action)* –∫–∞—Ç–æ –∫–ª—é—á –Ω–∞ —Ä–µ—á–Ω–∏–∫–∞, –∞ —Å—Ç–æ–π–Ω–æ—Å—Ç—Ç–∞ —â–µ —Å—ä–æ—Ç–≤–µ—Ç—Å—Ç–≤–∞ –Ω–∞ —Å—Ç–æ–π–Ω–æ—Å—Ç—Ç–∞ –Ω–∞ –∑–∞–ø–∏—Å–∞ –≤ Q-—Ç–∞–±–ª–∏—Ü–∞—Ç–∞. (–∫–æ–¥ –±–ª–æ–∫ 9)

    ```python
    Q = {}
    actions = (0,1)
    
    def qvalues(state):
        return [Q.get((state,a),0) for a in actions]
    ```

    –¢—É–∫ —Å—ä—â–æ –¥–µ—Ñ–∏–Ω–∏—Ä–∞–º–µ —Ñ—É–Ω–∫—Ü–∏—è—Ç–∞ `qvalues()`, –∫–æ—è—Ç–æ –≤—Ä—ä—â–∞ —Å–ø–∏—Å—ä–∫ –æ—Ç —Å—Ç–æ–π–Ω–æ—Å—Ç–∏ –Ω–∞ Q-—Ç–∞–±–ª–∏—Ü–∞—Ç–∞ –∑–∞ –¥–∞–¥–µ–Ω–æ —Å—ä—Å—Ç–æ—è–Ω–∏–µ, –∫–æ–µ—Ç–æ —Å—ä–æ—Ç–≤–µ—Ç—Å—Ç–≤–∞ –Ω–∞ –≤—Å–∏—á–∫–∏ –≤—ä–∑–º–æ–∂–Ω–∏ –¥–µ–π—Å—Ç–≤–∏—è. –ê–∫–æ –∑–∞–ø–∏—Å—ä—Ç –Ω–µ –ø—Ä–∏—Å—ä—Å—Ç–≤–∞ –≤ Q-—Ç–∞–±–ª–∏—Ü–∞—Ç–∞, —â–µ –≤—ä—Ä–Ω–µ–º 0 –∫–∞—Ç–æ —Å—Ç–æ–π–Ω–æ—Å—Ç –ø–æ –ø–æ–¥—Ä–∞–∑–±–∏—Ä–∞–Ω–µ.

## –î–∞ –∑–∞–ø–æ—á–Ω–µ–º Q-Learning

–°–µ–≥–∞ —Å–º–µ –≥–æ—Ç–æ–≤–∏ –¥–∞ –Ω–∞—É—á–∏–º –ü–µ—Ç—ä—Ä –¥–∞ –±–∞–ª–∞–Ω—Å–∏—Ä–∞!

1. –ü—ä—Ä–≤–æ, –Ω–µ–∫–∞ –∑–∞–¥–∞–¥–µ–º –Ω—è–∫–æ–∏ —Ö–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–∏: (–∫–æ–¥ –±–ª–æ–∫ 10)

    ```python
    # hyperparameters
    alpha = 0.3
    gamma = 0.9
    epsilon = 0.90
    ```

    –¢—É–∫ `alpha` –µ **—Å–∫–æ—Ä–æ—Å—Ç—Ç–∞ –Ω–∞ —É—á–µ–Ω–µ**, –∫–æ—è—Ç–æ –æ–ø—Ä–µ–¥–µ–ª—è –¥–æ –∫–∞–∫–≤–∞ —Å—Ç–µ–ø–µ–Ω —Ç—Ä—è–±–≤–∞ –¥–∞ –∫–æ—Ä–∏–≥–∏—Ä–∞–º–µ —Ç–µ–∫—É—â–∏—Ç–µ —Å—Ç–æ–π–Ω–æ—Å—Ç–∏ –Ω–∞ Q-—Ç–∞–±–ª–∏—Ü–∞—Ç–∞ –Ω–∞ –≤—Å—è–∫–∞ —Å—Ç—ä–ø–∫–∞. –í –ø—Ä–µ–¥–∏—à–Ω–∏—è —É—Ä–æ–∫ –∑–∞–ø–æ—á–Ω–∞—Ö–º–µ —Å 1 –∏ —Å–ª–µ–¥ —Ç–æ–≤–∞ –Ω–∞–º–∞–ª–∏—Ö–º–µ `alpha` –¥–æ –ø–æ-–Ω–∏—Å–∫–∏ —Å—Ç–æ–π–Ω–æ—Å—Ç–∏ –ø–æ –≤—Ä–µ–º–µ –Ω–∞ –æ–±—É—á–µ–Ω–∏–µ—Ç–æ. –í —Ç–æ–∑–∏ –ø—Ä–∏–º–µ—Ä —â–µ –≥–æ –∑–∞–ø–∞–∑–∏–º –∫–æ–Ω—Å—Ç–∞–Ω—Ç–Ω–æ –∑–∞ –ø—Ä–æ—Å—Ç–æ—Ç–∞, –∞ –≤–∏–µ –º–æ–∂–µ—Ç–µ –¥–∞ –µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏—Ä–∞—Ç–µ —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ç–∞ –Ω–∞ —Å—Ç–æ–π–Ω–æ—Å—Ç–∏—Ç–µ –Ω–∞ `alpha` –ø–æ-–∫—ä—Å–Ω–æ.

    `gamma` –µ **—Ñ–∞–∫—Ç–æ—Ä—ä—Ç –Ω–∞ –¥–∏—Å–∫–æ–Ω—Ç–∏—Ä–∞–Ω–µ**, –∫–æ–π—Ç–æ –ø–æ–∫–∞–∑–≤–∞ –¥–æ –∫–∞–∫–≤–∞ —Å—Ç–µ–ø–µ–Ω —Ç—Ä—è–±–≤–∞ –¥–∞ –ø—Ä–∏–æ—Ä–∏—Ç–∏–∑–∏—Ä–∞–º–µ –±—ä–¥–µ—â–∞—Ç–∞ –Ω–∞–≥—Ä–∞–¥–∞ –ø—Ä–µ–¥ —Ç–µ–∫—É—â–∞—Ç–∞ –Ω–∞–≥—Ä–∞–¥–∞.

    `epsilon` –µ **—Ñ–∞–∫—Ç–æ—Ä—ä—Ç –Ω–∞ –∏–∑—Å–ª–µ–¥–≤–∞–Ω–µ/–µ–∫—Å–ø–ª–æ–∞—Ç–∞—Ü–∏—è**, –∫–æ–π—Ç–æ –æ–ø—Ä–µ–¥–µ–ª—è –¥–∞–ª–∏ —Ç—Ä—è–±–≤–∞ –¥–∞ –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞–º–µ –∏–∑—Å–ª–µ–¥–≤–∞–Ω–µ—Ç–æ –ø—Ä–µ–¥ –µ–∫—Å–ø–ª–æ–∞—Ç–∞—Ü–∏—è—Ç–∞ –∏–ª–∏ –æ–±—Ä–∞—Ç–Ω–æ—Ç–æ. –í –Ω–∞—à–∏—è –∞–ª–≥–æ—Ä–∏—Ç—ä–º —â–µ –∏–∑–±–∏—Ä–∞–º–µ —Å–ª–µ–¥–≤–∞—â–æ—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ —Å–ø–æ—Ä–µ–¥ —Å—Ç–æ–π–Ω–æ—Å—Ç–∏—Ç–µ –Ω–∞ Q-—Ç–∞–±–ª–∏—Ü–∞—Ç–∞ –≤ `epsilon` –ø—Ä–æ—Ü–µ–Ω—Ç–∞ –æ—Ç —Å–ª—É—á–∞–∏—Ç–µ, –∞ –≤ –æ—Å—Ç–∞–Ω–∞–ª–∏—Ç–µ —Å–ª—É—á–∞–∏ —â–µ –∏–∑–ø—ä–ª–Ω—è–≤–∞–º–µ —Å–ª—É—á–∞–π–Ω–æ –¥–µ–π—Å—Ç–≤–∏–µ. –¢–æ–≤–∞ —â–µ –Ω–∏ –ø–æ–∑–≤–æ–ª–∏ –¥–∞ –∏–∑—Å–ª–µ–¥–≤–∞–º–µ –æ–±–ª–∞—Å—Ç–∏ –æ—Ç –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ—Ç–æ –∑–∞ —Ç—ä—Ä—Å–µ–Ω–µ, –∫–æ–∏—Ç–æ –Ω–∏–∫–æ–≥–∞ –Ω–µ —Å–º–µ –≤–∏–∂–¥–∞–ª–∏ –ø—Ä–µ–¥–∏.

    ‚úÖ –í –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –Ω–∞ –±–∞–ª–∞–Ω—Å–∏—Ä–∞–Ω–µ—Ç–æ - –∏–∑–±–æ—Ä—ä—Ç –Ω–∞ —Å–ª—É—á–∞–π–Ω–æ –¥–µ–π—Å—Ç–≤–∏–µ (–∏–∑—Å–ª–µ–¥–≤–∞–Ω–µ) –±–∏ –¥–µ–π—Å—Ç–≤–∞–ª –∫–∞—Ç–æ —Å–ª—É—á–∞–π–Ω–æ –∏–∑–±—É—Ç–≤–∞–Ω–µ –≤ –≥—Ä–µ—à–Ω–∞ –ø–æ—Å–æ–∫–∞, –∏ –ø—Ä—ä—Ç—ä—Ç —â–µ —Ç—Ä—è–±–≤–∞ –¥–∞ —Å–µ –Ω–∞—É—á–∏ –∫–∞–∫ –¥–∞ –≤—ä–∑—Å—Ç–∞–Ω–æ–≤–∏ –±–∞–ª–∞–Ω—Å–∞ –æ—Ç —Ç–µ–∑–∏ "–≥—Ä–µ—à–∫–∏".

### –ü–æ–¥–æ–±—Ä—è–≤–∞–Ω–µ –Ω–∞ –∞–ª–≥–æ—Ä–∏—Ç—ä–º–∞

–ú–æ–∂–µ–º —Å—ä—â–æ —Ç–∞–∫–∞ –¥–∞ –Ω–∞–ø—Ä–∞–≤–∏–º –¥–≤–µ –ø–æ–¥–æ–±—Ä–µ–Ω–∏—è –Ω–∞ –Ω–∞—à–∏—è –∞–ª–≥–æ—Ä–∏—Ç—ä–º –æ—Ç –ø—Ä–µ–¥–∏—à–Ω–∏—è —É—Ä–æ–∫:

- **–ò–∑—á–∏—Å–ª—è–≤–∞–Ω–µ –Ω–∞ —Å—Ä–µ–¥–Ω–∞ –∫—É–º—É–ª–∞—Ç–∏–≤–Ω–∞ –Ω–∞–≥—Ä–∞–¥–∞** –∑–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω –±—Ä–æ–π —Å–∏–º—É–ª–∞—Ü–∏–∏. –©–µ –æ—Ç–ø–µ—á–∞—Ç–≤–∞–º–µ –Ω–∞–ø—Ä–µ–¥—ä–∫–∞ –Ω–∞ –≤—Å–µ–∫–∏ 5000 –∏—Ç–µ—Ä–∞—Ü–∏–∏ –∏ —â–µ —É—Å—Ä–µ–¥–Ω—è–≤–∞–º–µ –∫—É–º—É–ª–∞—Ç–∏–≤–Ω–∞—Ç–∞ –Ω–∞–≥—Ä–∞–¥–∞ –∑–∞ —Ç–æ–∑–∏ –ø–µ—Ä–∏–æ–¥ –æ—Ç –≤—Ä–µ–º–µ. –¢–æ–≤–∞ –æ–∑–Ω–∞—á–∞–≤–∞, —á–µ –∞–∫–æ –ø–æ—Å—Ç–∏–≥–Ω–µ–º –ø–æ–≤–µ—á–µ –æ—Ç 195 —Ç–æ—á–∫–∏, –º–æ–∂–µ–º –¥–∞ —Å—á–∏—Ç–∞–º–µ –ø—Ä–æ–±–ª–µ–º–∞ –∑–∞ —Ä–µ—à–µ–Ω, –∏ —Ç–æ —Å –ø–æ-–≤–∏—Å–æ–∫–æ –∫–∞—á–µ—Å—Ç–≤–æ –æ—Ç –∏–∑–∏—Å–∫–≤–∞–Ω–æ—Ç–æ.

- **–ò–∑—á–∏—Å–ª—è–≤–∞–Ω–µ –Ω–∞ –º–∞–∫—Å–∏–º–∞–ª–µ–Ω —Å—Ä–µ–¥–µ–Ω –∫—É–º—É–ª–∞—Ç–∏–≤–µ–Ω —Ä–µ–∑—É–ª—Ç–∞—Ç**, `Qmax`, –∏ —â–µ —Å—ä—Ö—Ä–∞–Ω—è–≤–∞–º–µ Q-—Ç–∞–±–ª–∏—Ü–∞—Ç–∞, —Å—ä–æ—Ç–≤–µ—Ç—Å—Ç–≤–∞—â–∞ –Ω–∞ —Ç–æ–∑–∏ —Ä–µ–∑—É–ª—Ç–∞—Ç. –ö–æ–≥–∞—Ç–æ –∏–∑–ø—ä–ª–Ω—è–≤–∞—Ç–µ –æ–±—É—á–µ–Ω–∏–µ—Ç–æ, —â–µ –∑–∞–±–µ–ª–µ–∂–∏—Ç–µ, —á–µ –ø–æ–Ω—è–∫–æ–≥–∞ —Å—Ä–µ–¥–Ω–∏—è—Ç –∫—É–º—É–ª–∞—Ç–∏–≤–µ–Ω —Ä–µ–∑—É–ª—Ç–∞—Ç –∑–∞–ø–æ—á–≤–∞ –¥–∞ –Ω–∞–º–∞–ª—è–≤–∞, –∏ –∏—Å–∫–∞–º–µ –¥–∞ –∑–∞–ø–∞–∑–∏–º —Å—Ç–æ–π–Ω–æ—Å—Ç–∏—Ç–µ –Ω–∞ Q-—Ç–∞–±–ª–∏—Ü–∞—Ç–∞, –∫–æ–∏—Ç–æ —Å—ä–æ—Ç–≤–µ—Ç—Å—Ç–≤–∞—Ç –Ω–∞ –Ω–∞–π-–¥–æ–±—Ä–∏—è –º–æ–¥–µ–ª, –Ω–∞–±–ª—é–¥–∞–≤–∞–Ω –ø–æ –≤—Ä–µ–º–µ –Ω–∞ –æ–±—É—á–µ–Ω–∏–µ—Ç–æ.

1. –°—ä–±–µ—Ä–µ—Ç–µ –≤—Å–∏—á–∫–∏ –∫—É–º—É–ª–∞—Ç–∏–≤–Ω–∏ –Ω–∞–≥—Ä–∞–¥–∏ –Ω–∞ –≤—Å—è–∫–∞ —Å–∏–º—É–ª–∞—Ü–∏—è –≤ –≤–µ–∫—Ç–æ—Ä `rewards` –∑–∞ –ø–æ-–Ω–∞—Ç–∞—Ç—ä—à–Ω–æ –∏–∑–æ–±—Ä–∞–∑—è–≤–∞–Ω–µ. (–∫–æ–¥ –±–ª–æ–∫ 11)

    ```python
    def probs(v,eps=1e-4):
        v = v-v.min()+eps
        v = v/v.sum()
        return v
    
    Qmax = 0
    cum_rewards = []
    rewards = []
    for epoch in range(100000):
        obs = env.reset()
        done = False
        cum_reward=0
        # == do the simulation ==
        while not done:
            s = discretize(obs)
            if random.random()<epsilon:
                # exploitation - chose the action according to Q-Table probabilities
                v = probs(np.array(qvalues(s)))
                a = random.choices(actions,weights=v)[0]
            else:
                # exploration - randomly chose the action
                a = np.random.randint(env.action_space.n)
    
            obs, rew, done, info = env.step(a)
            cum_reward+=rew
            ns = discretize(obs)
            Q[(s,a)] = (1 - alpha) * Q.get((s,a),0) + alpha * (rew + gamma * max(qvalues(ns)))
        cum_rewards.append(cum_reward)
        rewards.append(cum_reward)
        # == Periodically print results and calculate average reward ==
        if epoch%5000==0:
            print(f"{epoch}: {np.average(cum_rewards)}, alpha={alpha}, epsilon={epsilon}")
            if np.average(cum_rewards) > Qmax:
                Qmax = np.average(cum_rewards)
                Qbest = Q
            cum_rewards=[]
    ```

–ö–∞–∫–≤–æ –º–æ–∂–µ –¥–∞ –∑–∞–±–µ–ª–µ–∂–∏—Ç–µ –æ—Ç —Ç–µ–∑–∏ —Ä–µ–∑—É–ª—Ç–∞—Ç–∏:

- **–ë–ª–∏–∑–æ –¥–æ —Ü–µ–ª—Ç–∞**. –ù–∏–µ —Å–º–µ –º–Ω–æ–≥–æ –±–ª–∏–∑–æ –¥–æ –ø–æ—Å—Ç–∏–≥–∞–Ω–µ—Ç–æ –Ω–∞ —Ü–µ–ª—Ç–∞ –æ—Ç 195 –∫—É–º—É–ª–∞—Ç–∏–≤–Ω–∏ –Ω–∞–≥—Ä–∞–¥–∏ –∑–∞ 100+ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª–Ω–∏ –∏–∑–ø—ä–ª–Ω–µ–Ω–∏—è –Ω–∞ —Å–∏–º—É–ª–∞—Ü–∏—è—Ç–∞, –∏–ª–∏ –º–æ–∂–µ –±–∏ –≤–µ—á–µ —Å–º–µ —è –ø–æ—Å—Ç–∏–≥–Ω–∞–ª–∏! –î–æ—Ä–∏ –∞–∫–æ –ø–æ–ª—É—á–∏–º –ø–æ-–º–∞–ª–∫–∏ —á–∏—Å–ª–∞, –≤—Å–µ –æ—â–µ –Ω–µ –∑–Ω–∞–µ–º, –∑–∞—â–æ—Ç–æ —É—Å—Ä–µ–¥–Ω—è–≤–∞–º–µ –∑–∞ 5000 –∏–∑–ø—ä–ª–Ω–µ–Ω–∏—è, –∞ —Å–∞–º–æ 100 –∏–∑–ø—ä–ª–Ω–µ–Ω–∏—è —Å–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–∏ —Å–ø–æ—Ä–µ–¥ —Ñ–æ—Ä–º–∞–ª–Ω–∏—Ç–µ –∫—Ä–∏—Ç–µ—Ä–∏–∏.

- **–ù–∞–≥—Ä–∞–¥–∞—Ç–∞ –∑–∞–ø–æ—á–≤–∞ –¥–∞ –Ω–∞–º–∞–ª—è–≤–∞**. –ü–æ–Ω—è–∫–æ–≥–∞ –Ω–∞–≥—Ä–∞–¥–∞—Ç–∞ –∑–∞–ø–æ—á–≤–∞ –¥–∞ –Ω–∞–º–∞–ª—è–≤–∞, –∫–æ–µ—Ç–æ –æ–∑–Ω–∞—á–∞–≤–∞, —á–µ –º–æ–∂–µ–º –¥–∞ "—Ä–∞–∑—Ä—É—à–∏–º" –≤–µ—á–µ –Ω–∞—É—á–µ–Ω–∏—Ç–µ —Å—Ç–æ–π–Ω–æ—Å—Ç–∏ –≤ Q-—Ç–∞–±–ª–∏—Ü–∞—Ç–∞ —Å—ä—Å —Å—Ç–æ–π–Ω–æ—Å—Ç–∏, –∫–æ–∏—Ç–æ –≤–ª–æ—à–∞–≤–∞—Ç —Å–∏—Ç—É–∞—Ü–∏—è—Ç–∞.

–¢–æ–≤–∞ –Ω–∞–±–ª—é–¥–µ–Ω–∏–µ –µ –ø–æ-—è—Å–Ω–æ –≤–∏–¥–∏–º–æ, –∞–∫–æ –∏–∑–æ–±—Ä–∞–∑–∏–º –Ω–∞–ø—Ä–µ–¥—ä–∫–∞ –Ω–∞ –æ–±—É—á–µ–Ω–∏–µ—Ç–æ.

## –ò–∑–æ–±—Ä–∞–∑—è–≤–∞–Ω–µ –Ω–∞ –Ω–∞–ø—Ä–µ–¥—ä–∫–∞ –Ω–∞ –æ–±—É—á–µ–Ω–∏–µ—Ç–æ

–ü–æ –≤—Ä–µ–º–µ –Ω–∞ –æ–±—É—á–µ–Ω–∏–µ—Ç–æ —Å—ä–±—Ä–∞—Ö–º–µ —Å—Ç–æ–π–Ω–æ—Å—Ç—Ç–∞ –Ω–∞ –∫—É–º—É–ª–∞—Ç–∏–≤–Ω–∞—Ç–∞ –Ω–∞–≥—Ä–∞–¥–∞ –Ω–∞ –≤—Å—è–∫–∞ –æ—Ç –∏—Ç–µ—Ä–∞—Ü–∏–∏—Ç–µ –≤ –≤–µ–∫—Ç–æ—Ä `rewards`. –ï—Ç–æ –∫–∞–∫ –∏–∑–≥–ª–µ–∂–¥–∞, –∫–æ–≥–∞—Ç–æ –≥–æ –∏–∑–æ–±—Ä–∞–∑–∏–º —Å–ø—Ä—è–º–æ –Ω–æ–º–µ—Ä–∞ –Ω–∞ –∏—Ç–µ—Ä–∞—Ü–∏—è—Ç–∞:

```python
plt.plot(rewards)
```

![—Å—É—Ä–æ–≤ –Ω–∞–ø—Ä–µ–¥—ä–∫](../../../../8-Reinforcement/2-Gym/images/train_progress_raw.png)

–û—Ç —Ç–æ–∑–∏ –≥—Ä–∞—Ñ–∏–∫ –Ω–µ –º–æ–∂–µ –¥–∞ —Å–µ –∫–∞–∂–µ –Ω–∏—â–æ, –∑–∞—â–æ—Ç–æ –ø–æ—Ä–∞–¥–∏ –µ—Å—Ç–µ—Å—Ç–≤–æ—Ç–æ –Ω–∞ —Å—Ç–æ—Ö–∞—Å—Ç–∏—á–Ω–∏—è –ø—Ä–æ—Ü–µ—Å –Ω–∞ –æ–±—É—á–µ–Ω–∏–µ –¥—ä–ª–∂–∏–Ω–∞—Ç–∞ –Ω–∞ –æ–±—É—á–∏—Ç–µ–ª–Ω–∏—Ç–µ —Å–µ—Å–∏–∏ –≤–∞—Ä–∏—Ä–∞ –∑–Ω–∞—á–∏—Ç–µ–ª–Ω–æ. –ó–∞ –¥–∞ –Ω–∞–ø—Ä–∞–≤–∏–º —Ç–æ–∑–∏ –≥—Ä–∞—Ñ–∏–∫ –ø–æ-—Å–º–∏—Å–ª–µ–Ω, –º–æ–∂–µ–º –¥–∞ –∏–∑—á–∏—Å–ª–∏–º **–ø–ª—ä–∑–≥–∞—â–∞ —Å—Ä–µ–¥–Ω–∞ —Å—Ç–æ–π–Ω–æ—Å—Ç** –∑–∞ —Å–µ—Ä–∏—è –æ—Ç –µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏, –¥–∞ —Ä–µ—á–µ–º 100. –¢–æ–≤–∞ –º–æ–∂–µ –¥–∞ —Å–µ –Ω–∞–ø—Ä–∞–≤–∏ —É–¥–æ–±–Ω–æ —Å –ø–æ–º–æ—â—Ç–∞ –Ω–∞ `np.convolve`: (–∫–æ–¥ –±–ª–æ–∫ 12)

```python
def running_average(x,window):
    return np.convolve(x,np.ones(window)/window,mode='valid')

plt.plot(running_average(rewards,100))
```

![–Ω–∞–ø—Ä–µ–¥—ä–∫ –Ω–∞ –æ–±—É—á–µ–Ω–∏–µ—Ç–æ](../../../../8-Reinforcement/2-Gym/images/train_progress_runav.png)

## –ü—Ä–æ–º–µ–Ω—è–Ω–µ –Ω–∞ —Ö–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–∏—Ç–µ

–ó–∞ –¥–∞ –Ω–∞–ø—Ä–∞–≤–∏–º –æ–±—É—á–µ–Ω–∏–µ—Ç–æ –ø–æ-—Å—Ç–∞–±–∏–ª–Ω–æ, –∏–º–∞ —Å–º–∏—Å—ä–ª –¥–∞ –∫–æ—Ä–∏–≥–∏—Ä–∞–º–µ –Ω—è–∫–æ–∏ –æ—Ç –Ω–∞—à–∏—Ç–µ —Ö–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–∏ –ø–æ –≤—Ä–µ–º–µ –Ω–∞ –æ–±—É—á–µ–Ω–∏–µ—Ç–æ. –ü–æ-—Å–ø–µ—Ü–∏–∞–ª–Ω–æ:

- **–ó–∞ —Å–∫–æ—Ä–æ—Å—Ç—Ç–∞ –Ω–∞ —É—á–µ–Ω–µ**, `alpha`, –º–æ–∂–µ–º –¥–∞ –∑–∞–ø–æ—á–Ω–µ–º —Å—ä—Å —Å—Ç–æ–π–Ω–æ—Å—Ç–∏ –±–ª–∏–∑–∫–∏ –¥–æ 1 –∏ —Å–ª–µ–¥ —Ç–æ–≤–∞ –¥–∞ –ø—Ä–æ–¥—ä–ª–∂–∏–º –¥–∞ –Ω–∞–º–∞–ª—è–≤–∞–º–µ –ø–∞—Ä–∞–º–µ—Ç—ä—Ä–∞. –° –≤—Ä–µ–º–µ—Ç–æ —â–µ –ø–æ–ª—É—á–∞–≤–∞–º–µ –¥–æ–±—Ä–∏ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–Ω–∏ —Å—Ç–æ–π–Ω–æ—Å—Ç–∏ –≤ Q-—Ç–∞–±–ª–∏—Ü–∞—Ç–∞ –∏ —Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª–Ω–æ —Ç—Ä—è–±–≤–∞ –¥–∞ –≥–∏ –∫–æ—Ä–∏–≥–∏—Ä–∞–º–µ –ª–µ–∫–æ, –∞ –Ω–µ –¥–∞ –≥–∏ –ø—Ä–µ–∑–∞–ø–∏—Å–≤–∞–º–µ –Ω–∞–ø—ä–ª–Ω–æ —Å –Ω–æ–≤–∏ —Å—Ç–æ–π–Ω–æ—Å—Ç–∏.

- **–£–≤–µ–ª–∏—á–∞–≤–∞–Ω–µ –Ω–∞ epsilon**. –ú–æ–∂–µ –¥–∞ –∏—Å–∫–∞–º–µ –¥–∞ —É–≤–µ–ª–∏—á–∏–º `epsilon` –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ, –∑–∞ –¥–∞ –∏–∑—Å–ª–µ–¥–≤–∞–º–µ –ø–æ-–º–∞–ª–∫–æ –∏ –¥–∞ –µ–∫—Å–ø–ª–æ–∞—Ç–∏—Ä–∞–º–µ –ø–æ–≤–µ—á–µ. –í–µ—Ä–æ—è—Ç–Ω–æ –∏–º–∞ —Å–º–∏—Å—ä–ª –¥–∞ –∑–∞–ø–æ—á–Ω–µ–º —Å –ø–æ-–Ω–∏—Å–∫–∞ —Å—Ç–æ–π–Ω–æ—Å—Ç –Ω–∞ `epsilon` –∏ –¥–∞ —Å–µ –¥–≤–∏–∂–∏–º –Ω–∞–≥–æ—Ä–µ –¥–æ –ø–æ—á—Ç–∏ 1.
> **–ó–∞–¥–∞—á–∞ 1**: –ï–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏—Ä–∞–π—Ç–µ —Å —Å—Ç–æ–π–Ω–æ—Å—Ç–∏—Ç–µ –Ω–∞ —Ö–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–∏—Ç–µ –∏ –≤–∏–∂—Ç–µ –¥–∞–ª–∏ –º–æ–∂–µ—Ç–µ –¥–∞ –ø–æ—Å—Ç–∏–≥–Ω–µ—Ç–µ –ø–æ-–≤–∏—Å–æ–∫–∞ –æ–±—â–∞ –Ω–∞–≥—Ä–∞–¥–∞. –£—Å–ø—è–≤–∞—Ç–µ –ª–∏ –¥–∞ –Ω–∞–¥—Ö–≤—ä—Ä–ª–∏—Ç–µ 195?
> **–ó–∞–¥–∞—á–∞ 2**: –ó–∞ –¥–∞ —Ä–µ—à–∏—Ç–µ —Ñ–æ—Ä–º–∞–ª–Ω–æ –ø—Ä–æ–±–ª–µ–º–∞, —Ç—Ä—è–±–≤–∞ –¥–∞ –ø–æ—Å—Ç–∏–≥–Ω–µ—Ç–µ —Å—Ä–µ–¥–Ω–∞ –Ω–∞–≥—Ä–∞–¥–∞ –æ—Ç 195 –ø—Ä–µ–∑ 100 –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª–Ω–∏ –∏–∑–ø—ä–ª–Ω–µ–Ω–∏—è. –ò–∑–º–µ—Ä–µ—Ç–µ —Ç–æ–≤–∞ –ø–æ –≤—Ä–µ–º–µ –Ω–∞ –æ–±—É—á–µ–Ω–∏–µ—Ç–æ –∏ —Å–µ —É–≤–µ—Ä–µ—Ç–µ, —á–µ —Å—Ç–µ —Ñ–æ—Ä–º–∞–ª–Ω–æ —Ä–µ—à–∏–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞!

## –í–∏–∂–¥–∞–Ω–µ –Ω–∞ —Ä–µ–∑—É–ª—Ç–∞—Ç–∞ –≤ –¥–µ–π—Å—Ç–≤–∏–µ

–ë–∏ –±–∏–ª–æ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ –¥–∞ –≤–∏–¥–∏–º –∫–∞–∫ –æ–±—É—á–µ–Ω–∏—è—Ç –º–æ–¥–µ–ª —Å–µ –¥—ä—Ä–∂–∏. –ù–µ–∫–∞ —Å—Ç–∞—Ä—Ç–∏—Ä–∞–º–µ —Å–∏–º—É–ª–∞—Ü–∏—è—Ç–∞ –∏ —Å–ª–µ–¥–≤–∞–º–µ —Å—ä—â–∞—Ç–∞ —Å—Ç—Ä–∞—Ç–µ–≥–∏—è –∑–∞ –∏–∑–±–æ—Ä –Ω–∞ –¥–µ–π—Å—Ç–≤–∏—è, –∫–∞–∫—Ç–æ –ø–æ –≤—Ä–µ–º–µ –Ω–∞ –æ–±—É—á–µ–Ω–∏–µ—Ç–æ, –∫–∞—Ç–æ –∏–∑–±–∏—Ä–∞–º–µ —Å–ø–æ—Ä–µ–¥ —Ä–∞–∑–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ—Ç–æ –Ω–∞ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏—Ç–µ –≤ Q-—Ç–∞–±–ª–∏—Ü–∞—Ç–∞: (–∫–æ–¥ –±–ª–æ–∫ 13)

```python
obs = env.reset()
done = False
while not done:
   s = discretize(obs)
   env.render()
   v = probs(np.array(qvalues(s)))
   a = random.choices(actions,weights=v)[0]
   obs,_,done,_ = env.step(a)
env.close()
```

–¢—Ä—è–±–≤–∞ –¥–∞ –≤–∏–¥–∏—Ç–µ –Ω–µ—â–æ –ø–æ–¥–æ–±–Ω–æ:

![–±–∞–ª–∞–Ω—Å–∏—Ä–∞—â–∞ –∫–æ–ª–∏—á–∫–∞](../../../../8-Reinforcement/2-Gym/images/cartpole-balance.gif)

---

## üöÄ–ü—Ä–µ–¥–∏–∑–≤–∏–∫–∞—Ç–µ–ª—Å—Ç–≤–æ

> **–ó–∞–¥–∞—á–∞ 3**: –¢—É–∫ –∏–∑–ø–æ–ª–∑–≤–∞—Ö–º–µ —Ñ–∏–Ω–∞–ª–Ω–æ—Ç–æ –∫–æ–ø–∏–µ –Ω–∞ Q-—Ç–∞–±–ª–∏—Ü–∞—Ç–∞, –∫–æ–µ—Ç–æ –º–æ–∂–µ –¥–∞ –Ω–µ –µ –Ω–∞–π-–¥–æ–±—Ä–æ—Ç–æ. –ü–æ–º–Ω–µ—Ç–µ, —á–µ —Å–º–µ –∑–∞–ø–∞–∑–∏–ª–∏ –Ω–∞–π-–¥–æ–±—Ä–µ –ø—Ä–µ–¥—Å—Ç–∞–≤—è—â–∞—Ç–∞ —Å–µ Q-—Ç–∞–±–ª–∏—Ü–∞ –≤ –ø—Ä–æ–º–µ–Ω–ª–∏–≤–∞—Ç–∞ `Qbest`! –û–ø–∏—Ç–∞–π—Ç–µ —Å—ä—â–∏—è –ø—Ä–∏–º–µ—Ä —Å –Ω–∞–π-–¥–æ–±—Ä–µ –ø—Ä–µ–¥—Å—Ç–∞–≤—è—â–∞—Ç–∞ —Å–µ Q-—Ç–∞–±–ª–∏—Ü–∞, –∫–∞—Ç–æ –∫–æ–ø–∏—Ä–∞—Ç–µ `Qbest` –≤—ä—Ä—Ö—É `Q` –∏ –≤–∏–∂—Ç–µ –¥–∞–ª–∏ –∑–∞–±–µ–ª—è–∑–≤–∞—Ç–µ —Ä–∞–∑–ª–∏–∫–∞.

> **–ó–∞–¥–∞—á–∞ 4**: –¢—É–∫ –Ω–µ –∏–∑–±–∏—Ä–∞—Ö–º–µ –Ω–∞–π-–¥–æ–±—Ä–æ—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–∞ –≤—Å—è–∫–∞ —Å—Ç—ä–ø–∫–∞, –∞ –ø–æ-—Å–∫–æ—Ä–æ –∏–∑–±–∏—Ä–∞—Ö–º–µ —Å–ø–æ—Ä–µ–¥ —Å—ä–æ—Ç–≤–µ—Ç–Ω–æ—Ç–æ —Ä–∞–∑–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏—Ç–µ. –ë–∏ –ª–∏ –∏–º–∞–ª–æ –ø–æ–≤–µ—á–µ —Å–º–∏—Å—ä–ª –≤–∏–Ω–∞–≥–∏ –¥–∞ –∏–∑–±–∏—Ä–∞–º–µ –Ω–∞–π-–¥–æ–±—Ä–æ—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ, —Å –Ω–∞–π-–≤–∏—Å–æ–∫–∞—Ç–∞ —Å—Ç–æ–π–Ω–æ—Å—Ç –≤ Q-—Ç–∞–±–ª–∏—Ü–∞—Ç–∞? –¢–æ–≤–∞ –º–æ–∂–µ –¥–∞ —Å–µ –Ω–∞–ø—Ä–∞–≤–∏ —Å –ø–æ–º–æ—â—Ç–∞ –Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è—Ç–∞ `np.argmax`, –∑–∞ –¥–∞ —Å–µ –Ω–∞–º–µ—Ä–∏ –Ω–æ–º–µ—Ä—ä—Ç –Ω–∞ –¥–µ–π—Å—Ç–≤–∏–µ—Ç–æ, —Å—ä–æ—Ç–≤–µ—Ç—Å—Ç–≤–∞—â –Ω–∞ –Ω–∞–π-–≤–∏—Å–æ–∫–∞—Ç–∞ —Å—Ç–æ–π–Ω–æ—Å—Ç –≤ Q-—Ç–∞–±–ª–∏—Ü–∞—Ç–∞. –†–µ–∞–ª–∏–∑–∏—Ä–∞–π—Ç–µ —Ç–∞–∑–∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏—è –∏ –≤–∏–∂—Ç–µ –¥–∞–ª–∏ –ø–æ–¥–æ–±—Ä—è–≤–∞ –±–∞–ª–∞–Ω—Å–∏—Ä–∞–Ω–µ—Ç–æ.

## [–¢–µ—Å—Ç —Å–ª–µ–¥ –ª–µ–∫—Ü–∏—è—Ç–∞](https://ff-quizzes.netlify.app/en/ml/)

## –ó–∞–¥–∞–Ω–∏–µ
[–û–±—É—á–µ—Ç–µ Mountain Car](assignment.md)

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–°–µ–≥–∞ –Ω–∞—É—á–∏—Ö–º–µ –∫–∞–∫ –¥–∞ –æ–±—É—á–∞–≤–∞–º–µ –∞–≥–µ–Ω—Ç–∏ –¥–∞ –ø–æ—Å—Ç–∏–≥–∞—Ç –¥–æ–±—Ä–∏ —Ä–µ–∑—É–ª—Ç–∞—Ç–∏, —Å–∞–º–æ –∫–∞—Ç–æ –∏–º –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏–º —Ñ—É–Ω–∫—Ü–∏—è –∑–∞ –Ω–∞–≥—Ä–∞–¥–∞, –∫–æ—è—Ç–æ –¥–µ—Ñ–∏–Ω–∏—Ä–∞ –∂–µ–ª–∞–Ω–æ—Ç–æ —Å—ä—Å—Ç–æ—è–Ω–∏–µ –Ω–∞ –∏–≥—Ä–∞—Ç–∞, –∏ –∫–∞—Ç–æ –∏–º –¥–∞–¥–µ–º –≤—ä–∑–º–æ–∂–Ω–æ—Å—Ç –∏–Ω—Ç–µ–ª–∏–≥–µ–Ω—Ç–Ω–æ –¥–∞ –∏–∑—Å–ª–µ–¥–≤–∞—Ç –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ—Ç–æ –∑–∞ —Ç—ä—Ä—Å–µ–Ω–µ. –£—Å–ø–µ—à–Ω–æ –ø—Ä–∏–ª–æ–∂–∏—Ö–º–µ –∞–ª–≥–æ—Ä–∏—Ç—ä–º–∞ Q-Learning –≤ —Å–ª—É—á–∞–∏ –Ω–∞ –¥–∏—Å–∫—Ä–µ—Ç–Ω–∏ –∏ –Ω–µ–ø—Ä–µ–∫—ä—Å–Ω–∞—Ç–∏ —Å—Ä–µ–¥–∏, –Ω–æ —Å –¥–∏—Å–∫—Ä–µ—Ç–Ω–∏ –¥–µ–π—Å—Ç–≤–∏—è.

–í–∞–∂–Ω–æ –µ —Å—ä—â–æ —Ç–∞–∫–∞ –¥–∞ –∏–∑—É—á–∏–º —Å–∏—Ç—É–∞—Ü–∏–∏, –≤ –∫–æ–∏—Ç–æ —Å—ä—Å—Ç–æ—è–Ω–∏–µ—Ç–æ –Ω–∞ –¥–µ–π—Å—Ç–≤–∏—è—Ç–∞ —Å—ä—â–æ –µ –Ω–µ–ø—Ä–µ–∫—ä—Å–Ω–∞—Ç–æ, –∏ –∫–æ–≥–∞—Ç–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ—Ç–æ –∑–∞ –Ω–∞–±–ª—é–¥–µ–Ω–∏–µ –µ –º–Ω–æ–≥–æ –ø–æ-—Å–ª–æ–∂–Ω–æ, –∫–∞—Ç–æ –Ω–∞–ø—Ä–∏–º–µ—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ—Ç–æ –æ—Ç –µ–∫—Ä–∞–Ω–∞ –Ω–∞ –∏–≥—Ä–∞—Ç–∞ Atari. –í —Ç–µ–∑–∏ –ø—Ä–æ–±–ª–µ–º–∏ —á–µ—Å—Ç–æ —Å–µ –Ω–∞–ª–∞–≥–∞ –¥–∞ –∏–∑–ø–æ–ª–∑–≤–∞–º–µ –ø–æ-–º–æ—â–Ω–∏ —Ç–µ—Ö–Ω–∏–∫–∏ –∑–∞ –º–∞—à–∏–Ω–Ω–æ –æ–±—É—á–µ–Ω–∏–µ, –∫–∞—Ç–æ –Ω–µ–≤—Ä–æ–Ω–Ω–∏ –º—Ä–µ–∂–∏, –∑–∞ –¥–∞ –ø–æ—Å—Ç–∏–≥–Ω–µ–º –¥–æ–±—Ä–∏ —Ä–µ–∑—É–ª—Ç–∞—Ç–∏. –¢–µ–∑–∏ –ø–æ-–Ω–∞–ø—Ä–µ–¥–Ω–∞–ª–∏ —Ç–µ–º–∏ —Å–∞ –ø—Ä–µ–¥–º–µ—Ç –Ω–∞ –Ω–∞—à–∏—è –ø—Ä–µ–¥—Å—Ç–æ—è—â –∫—É—Ä—Å –∑–∞ –ø–æ-–Ω–∞–ø—Ä–µ–¥–Ω–∞–ª –∏–∑–∫—É—Å—Ç–≤–µ–Ω –∏–Ω—Ç–µ–ª–µ–∫—Ç.

---

**–û—Ç–∫–∞–∑ –æ—Ç –æ—Ç–≥–æ–≤–æ—Ä–Ω–æ—Å—Ç**:  
–¢–æ–∑–∏ –¥–æ–∫—É–º–µ–Ω—Ç –µ –ø—Ä–µ–≤–µ–¥–µ–Ω —Å –ø–æ–º–æ—â—Ç–∞ –Ω–∞ AI —É—Å–ª—É–≥–∞ –∑–∞ –ø—Ä–µ–≤–æ–¥ [Co-op Translator](https://github.com/Azure/co-op-translator). –í—ä–ø—Ä–µ–∫–∏ —á–µ —Å–µ —Å—Ç—Ä–µ–º–∏–º –∫—ä–º —Ç–æ—á–Ω–æ—Å—Ç, –º–æ–ª—è, –∏–º–∞–π—Ç–µ –ø—Ä–µ–¥–≤–∏–¥, —á–µ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–∞–Ω–∏—Ç–µ –ø—Ä–µ–≤–æ–¥–∏ –º–æ–∂–µ –¥–∞ —Å—ä–¥—ä—Ä–∂–∞—Ç –≥—Ä–µ—à–∫–∏ –∏–ª–∏ –Ω–µ—Ç–æ—á–Ω–æ—Å—Ç–∏. –û—Ä–∏–≥–∏–Ω–∞–ª–Ω–∏—è—Ç –¥–æ–∫—É–º–µ–Ω—Ç –Ω–∞ –Ω–µ–≥–æ–≤–∏—è —Ä–æ–¥–µ–Ω –µ–∑–∏–∫ —Ç—Ä—è–±–≤–∞ –¥–∞ —Å–µ —Å—á–∏—Ç–∞ –∑–∞ –∞–≤—Ç–æ—Ä–∏—Ç–µ—Ç–µ–Ω –∏–∑—Ç–æ—á–Ω–∏–∫. –ó–∞ –∫—Ä–∏—Ç–∏—á–Ω–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è —Å–µ –ø—Ä–µ–ø–æ—Ä—ä—á–≤–∞ –ø—Ä–æ—Ñ–µ—Å–∏–æ–Ω–∞–ª–µ–Ω —á–æ–≤–µ—à–∫–∏ –ø—Ä–µ–≤–æ–¥. –ù–∏–µ –Ω–µ –Ω–æ—Å–∏–º –æ—Ç–≥–æ–≤–æ—Ä–Ω–æ—Å—Ç –∑–∞ –Ω–µ–¥–æ—Ä–∞–∑—É–º–µ–Ω–∏—è –∏–ª–∏ –ø–æ–≥—Ä–µ—à–Ω–∏ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏, –ø—Ä–æ–∏–∑—Ç–∏—á–∞—â–∏ –æ—Ç –∏–∑–ø–æ–ª–∑–≤–∞–Ω–µ—Ç–æ –Ω–∞ —Ç–æ–∑–∏ –ø—Ä–µ–≤–æ–¥.