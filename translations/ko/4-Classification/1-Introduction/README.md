# ë¶„ë¥˜ ì†Œê°œ

ì´ ë„¤ ê°€ì§€ ê°•ì˜ì—ì„œ, ì—¬ëŸ¬ë¶„ì€ ê³ ì „ì ì¸ ë¨¸ì‹  ëŸ¬ë‹ì˜ ê·¼ë³¸ì ì¸ ì´ˆì ì¸ _ë¶„ë¥˜_ë¥¼ íƒêµ¬í•  ê²ƒì…ë‹ˆë‹¤. ì•„ì‹œì•„ì™€ ì¸ë„ì˜ ëª¨ë“  í›Œë¥­í•œ ìš”ë¦¬ì— ê´€í•œ ë°ì´í„°ì…‹ì„ ì‚¬ìš©í•˜ì—¬ ë‹¤ì–‘í•œ ë¶„ë¥˜ ì•Œê³ ë¦¬ì¦˜ì„ ë‹¤ë£° ê²ƒì…ë‹ˆë‹¤. ë°°ê°€ ê³ í”„ì‹œê¸¸ ë°”ëë‹ˆë‹¤!

![just a pinch!](../../../../translated_images/pinch.1b035ec9ba7e0d408313b551b60c721c9c290b2dd2094115bc87e6ddacd114c9.ko.png)

> ì´ ê°•ì˜ì—ì„œ ë²”ì•„ì‹œì•„ ìš”ë¦¬ë¥¼ ì¶•í•˜í•˜ì„¸ìš”! ì´ë¯¸ì§€ ì œê³µ: [Jen Looper](https://twitter.com/jenlooper)

ë¶„ë¥˜ëŠ” íšŒê·€ ê¸°ë²•ê³¼ ë§ì€ ê³µí†µì ì„ ê°€ì§„ [ì§€ë„ í•™ìŠµ](https://wikipedia.org/wiki/Supervised_learning)ì˜ í•œ í˜•íƒœì…ë‹ˆë‹¤. ë¨¸ì‹  ëŸ¬ë‹ì´ ë°ì´í„°ì…‹ì„ ì‚¬ìš©í•˜ì—¬ ê°’ì´ë‚˜ ì´ë¦„ì„ ì˜ˆì¸¡í•˜ëŠ” ê²ƒì´ë¼ë©´, ë¶„ë¥˜ëŠ” ì¼ë°˜ì ìœ¼ë¡œ _ì´ì§„ ë¶„ë¥˜_ì™€ _ë‹¤ì¤‘ í´ë˜ìŠ¤ ë¶„ë¥˜_ì˜ ë‘ ê·¸ë£¹ìœ¼ë¡œ ë‚˜ë‰©ë‹ˆë‹¤.

[![ë¶„ë¥˜ ì†Œê°œ](https://img.youtube.com/vi/eg8DJYwdMyg/0.jpg)](https://youtu.be/eg8DJYwdMyg "ë¶„ë¥˜ ì†Œê°œ")

> ğŸ¥ ìœ„ ì´ë¯¸ì§€ë¥¼ í´ë¦­í•˜ë©´ MITì˜ John Guttagì´ ë¶„ë¥˜ë¥¼ ì†Œê°œí•˜ëŠ” ë¹„ë””ì˜¤ë¡œ ì´ë™í•©ë‹ˆë‹¤.

ê¸°ì–µí•˜ì„¸ìš”:

- **ì„ í˜• íšŒê·€**ëŠ” ë³€ìˆ˜ ê°„ì˜ ê´€ê³„ë¥¼ ì˜ˆì¸¡í•˜ê³  ìƒˆë¡œìš´ ë°ì´í„° í¬ì¸íŠ¸ê°€ ê·¸ ì„ ê³¼ì˜ ê´€ê³„ì—ì„œ ì–´ë””ì— ìœ„ì¹˜í• ì§€ ì •í™•í•˜ê²Œ ì˜ˆì¸¡í•˜ëŠ” ë° ë„ì›€ì„ ì¤ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, _9ì›”ê³¼ 12ì›”ì— í˜¸ë°• ê°€ê²©ì´ ì–¼ë§ˆì¼ì§€_ ì˜ˆì¸¡í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- **ë¡œì§€ìŠ¤í‹± íšŒê·€**ëŠ” "ì´ì§„ ì¹´í…Œê³ ë¦¬"ë¥¼ ë°œê²¬í•˜ëŠ” ë° ë„ì›€ì„ ì¤ë‹ˆë‹¤: ì´ ê°€ê²©ëŒ€ì—ì„œ _ì´ í˜¸ë°•ì´ ì£¼í™©ìƒ‰ì¸ì§€ ì•„ë‹Œì§€_?

ë¶„ë¥˜ëŠ” ë°ì´í„° í¬ì¸íŠ¸ì˜ ë ˆì´ë¸”ì´ë‚˜ í´ë˜ìŠ¤ë¥¼ ê²°ì •í•˜ëŠ” ë‹¤ì–‘í•œ ì•Œê³ ë¦¬ì¦˜ì„ ì‚¬ìš©í•©ë‹ˆë‹¤. ì´ ìš”ë¦¬ ë°ì´í„°ë¥¼ ì‚¬ìš©í•˜ì—¬ ì¬ë£Œ ê·¸ë£¹ì„ ê´€ì°°í•¨ìœ¼ë¡œì¨ ì›ì‚°ì§€ ìš”ë¦¬ë¥¼ ê²°ì •í•  ìˆ˜ ìˆëŠ”ì§€ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.

## [ê°•ì˜ ì „ í€´ì¦ˆ](https://gray-sand-07a10f403.1.azurestaticapps.net/quiz/19/)

> ### [ì´ ê°•ì˜ëŠ” Rë¡œë„ ì œê³µë©ë‹ˆë‹¤!](../../../../4-Classification/1-Introduction/solution/R/lesson_10.html)

### ì†Œê°œ

ë¶„ë¥˜ëŠ” ë¨¸ì‹  ëŸ¬ë‹ ì—°êµ¬ìì™€ ë°ì´í„° ê³¼í•™ìì˜ ê¸°ë³¸ í™œë™ ì¤‘ í•˜ë‚˜ì…ë‹ˆë‹¤. ì´ì§„ ê°’ì˜ ê¸°ë³¸ ë¶„ë¥˜("ì´ ì´ë©”ì¼ì´ ìŠ¤íŒ¸ì¸ì§€ ì•„ë‹Œì§€")ë¶€í„° ì»´í“¨í„° ë¹„ì „ì„ ì‚¬ìš©í•œ ë³µì¡í•œ ì´ë¯¸ì§€ ë¶„ë¥˜ ë° ì„¸ë¶„í™”ê¹Œì§€, ë°ì´í„°ë¥¼ í´ë˜ìŠ¤ë¡œ ë¶„ë¥˜í•˜ê³  ì§ˆë¬¸í•˜ëŠ” ê²ƒì€ í•­ìƒ ìœ ìš©í•©ë‹ˆë‹¤.

ê³¼ì •ì„ ë” ê³¼í•™ì ìœ¼ë¡œ ì„¤ëª…í•˜ìë©´, ë¶„ë¥˜ ë°©ë²•ì€ ì…ë ¥ ë³€ìˆ˜ì™€ ì¶œë ¥ ë³€ìˆ˜ ê°„ì˜ ê´€ê³„ë¥¼ ë§¤í•‘í•  ìˆ˜ ìˆëŠ” ì˜ˆì¸¡ ëª¨ë¸ì„ ìƒì„±í•©ë‹ˆë‹¤.

![ì´ì§„ vs. ë‹¤ì¤‘ í´ë˜ìŠ¤ ë¶„ë¥˜](../../../../translated_images/binary-multiclass.b56d0c86c81105a697dddd82242c1d11e4d78b7afefea07a44627a0f1111c1a9.ko.png)

> ë¶„ë¥˜ ì•Œê³ ë¦¬ì¦˜ì´ ì²˜ë¦¬í•  ì´ì§„ vs. ë‹¤ì¤‘ í´ë˜ìŠ¤ ë¬¸ì œ. ì¸í¬ê·¸ë˜í”½ ì œê³µ: [Jen Looper](https://twitter.com/jenlooper)

ë°ì´í„°ë¥¼ ì •ë¦¬í•˜ê³  ì‹œê°í™”í•˜ë©° ML ì‘ì—…ì„ ì¤€ë¹„í•˜ê¸° ì „ì—, ë°ì´í„°ë¥¼ ë¶„ë¥˜í•˜ëŠ” ë° ë¨¸ì‹  ëŸ¬ë‹ì„ í™œìš©í•  ìˆ˜ ìˆëŠ” ë‹¤ì–‘í•œ ë°©ë²•ì— ëŒ€í•´ ì•Œì•„ë´…ì‹œë‹¤.

ê³ ì „ì ì¸ ë¨¸ì‹  ëŸ¬ë‹ì„ ì‚¬ìš©í•œ ë¶„ë¥˜ëŠ” [í†µê³„í•™](https://wikipedia.org/wiki/Statistical_classification)ì—ì„œ ìœ ë˜í•˜ë©°, `smoker`, `weight`, `age`ì™€ ê°™ì€ íŠ¹ì§•ì„ ì‚¬ìš©í•˜ì—¬ _X ì§ˆë³‘ ë°œë³‘ ê°€ëŠ¥ì„±_ì„ ê²°ì •í•©ë‹ˆë‹¤. ì´ì „ì— ìˆ˜í–‰í•œ íšŒê·€ ì—°ìŠµê³¼ ìœ ì‚¬í•œ ì§€ë„ í•™ìŠµ ê¸°ë²•ìœ¼ë¡œ, ë°ì´í„°ëŠ” ë¼ë²¨ì´ ì§€ì •ë˜ê³  ML ì•Œê³ ë¦¬ì¦˜ì€ ì´ëŸ¬í•œ ë¼ë²¨ì„ ì‚¬ìš©í•˜ì—¬ ë°ì´í„°ì…‹ì˜ í´ë˜ìŠ¤(ë˜ëŠ” 'íŠ¹ì§•')ë¥¼ ë¶„ë¥˜í•˜ê³  ì˜ˆì¸¡í•˜ì—¬ ê·¸ë£¹ì´ë‚˜ ê²°ê³¼ì— í• ë‹¹í•©ë‹ˆë‹¤.

âœ… ìš”ë¦¬ì— ê´€í•œ ë°ì´í„°ì…‹ì„ ìƒìƒí•´ë³´ì„¸ìš”. ë‹¤ì¤‘ í´ë˜ìŠ¤ ëª¨ë¸ì€ ì–´ë–¤ ì§ˆë¬¸ì— ë‹µí•  ìˆ˜ ìˆì„ê¹Œìš”? ì´ì§„ ëª¨ë¸ì€ ì–´ë–¤ ì§ˆë¬¸ì— ë‹µí•  ìˆ˜ ìˆì„ê¹Œìš”? íŠ¹ì • ìš”ë¦¬ê°€ í˜¸ë¡œíŒŒë¥¼ ì‚¬ìš©í•  ê°€ëŠ¥ì„±ì´ ìˆëŠ”ì§€ ê²°ì •í•˜ê³  ì‹¶ë‹¤ë©´ ì–´ë–»ê²Œ í• ê¹Œìš”? ë³„ëª¨ì–‘ì˜ ì•„ë‹ˆìŠ¤, ì•„í‹°ì´ˆí¬, ì½œë¦¬í”Œë¼ì›Œ, ê³ ì¶”ëƒ‰ì´ê°€ ê°€ë“í•œ ì‹ë£Œí’ˆ ê°€ë°©ì„ ì„ ë¬¼ë¡œ ë°›ì•˜ì„ ë•Œ ì „í˜•ì ì¸ ì¸ë„ ìš”ë¦¬ë¥¼ ë§Œë“¤ ìˆ˜ ìˆì„ê¹Œìš”?

[![Crazy mystery baskets](https://img.youtube.com/vi/GuTeDbaNoEU/0.jpg)](https://youtu.be/GuTeDbaNoEU "Crazy mystery baskets")

> ğŸ¥ ìœ„ ì´ë¯¸ì§€ë¥¼ í´ë¦­í•˜ë©´ 'Chopped' ì‡¼ì˜ 'ë¯¸ìŠ¤í„°ë¦¬ ë°”êµ¬ë‹ˆ'ì—ì„œ ì…°í”„ë“¤ì´ ë¬´ì‘ìœ„ë¡œ ì„ íƒëœ ì¬ë£Œë¡œ ìš”ë¦¬ë¥¼ ë§Œë“œëŠ” ì „ì œì˜ ë¹„ë””ì˜¤ë¡œ ì´ë™í•©ë‹ˆë‹¤. ë¶„ëª…íˆ ML ëª¨ë¸ì´ ë„ì›€ì´ ë˜ì—ˆì„ ê²ƒì…ë‹ˆë‹¤!

## ì•ˆë…•í•˜ì„¸ìš” 'ë¶„ë¥˜ê¸°'

ì´ ìš”ë¦¬ ë°ì´í„°ì…‹ì— ëŒ€í•´ ìš°ë¦¬ê°€ ë¬»ê³  ì‹¶ì€ ì§ˆë¬¸ì€ ì‹¤ì œë¡œ **ë‹¤ì¤‘ í´ë˜ìŠ¤ ì§ˆë¬¸**ì…ë‹ˆë‹¤. ì—¬ëŸ¬ ì ì¬ì ì¸ êµ­ê°€ ìš”ë¦¬ê°€ ìˆê¸° ë•Œë¬¸ì…ë‹ˆë‹¤. ì¬ë£Œì˜ ë¬¶ìŒì„ ì£¼ì–´ì¡Œì„ ë•Œ, ì´ ë§ì€ í´ë˜ìŠ¤ ì¤‘ ì–´ëŠ ê²ƒì— ë°ì´í„°ê°€ ë§ì„ê¹Œìš”?

Scikit-learnì€ ë¬¸ì œë¥¼ í•´ê²°í•˜ê³ ì í•˜ëŠ” ìœ í˜•ì— ë”°ë¼ ë°ì´í„°ë¥¼ ë¶„ë¥˜í•˜ëŠ” ë° ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ì—¬ëŸ¬ ì•Œê³ ë¦¬ì¦˜ì„ ì œê³µí•©ë‹ˆë‹¤. ë‹¤ìŒ ë‘ ê°•ì˜ì—ì„œëŠ” ì´ëŸ¬í•œ ì•Œê³ ë¦¬ì¦˜ ì¤‘ ëª‡ ê°€ì§€ì— ëŒ€í•´ ë°°ìš¸ ê²ƒì…ë‹ˆë‹¤.

## ì—°ìŠµ - ë°ì´í„° ì •ë¦¬ ë° ê· í˜• ë§ì¶”ê¸°

ì´ í”„ë¡œì íŠ¸ë¥¼ ì‹œì‘í•˜ê¸° ì „ì— ì²« ë²ˆì§¸ ì‘ì—…ì€ ë°ì´í„°ë¥¼ ì •ë¦¬í•˜ê³  **ê· í˜•ì„ ë§ì¶”ëŠ” ê²ƒ**ì…ë‹ˆë‹¤. ì´ í´ë”ì˜ ë£¨íŠ¸ì— ìˆëŠ” ë¹ˆ _notebook.ipynb_ íŒŒì¼ë¡œ ì‹œì‘í•˜ì„¸ìš”.

ì²« ë²ˆì§¸ë¡œ ì„¤ì¹˜í•  ê²ƒì€ [imblearn](https://imbalanced-learn.org/stable/)ì…ë‹ˆë‹¤. ì´ê²ƒì€ ë°ì´í„°ë¥¼ ë” ì˜ ê· í˜• ë§ì¶œ ìˆ˜ ìˆê²Œ í•´ì£¼ëŠ” Scikit-learn íŒ¨í‚¤ì§€ì…ë‹ˆë‹¤(ì´ ì‘ì—…ì— ëŒ€í•´ ê³§ ë” ë°°ìš¸ ê²ƒì…ë‹ˆë‹¤).

1. `imblearn`ë¥¼ ì„¤ì¹˜í•˜ë ¤ë©´ `pip install`ë¥¼ ì‹¤í–‰í•˜ì„¸ìš”:

    ```python
    pip install imblearn
    ```

1. ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ê³  ì‹œê°í™”í•˜ëŠ” ë° í•„ìš”í•œ íŒ¨í‚¤ì§€ë¥¼ ê°€ì ¸ì˜¤ê³ , `imblearn`ì—ì„œ `SMOTE`ë¥¼ ê°€ì ¸ì˜¤ì„¸ìš”.

    ```python
    import pandas as pd
    import matplotlib.pyplot as plt
    import matplotlib as mpl
    import numpy as np
    from imblearn.over_sampling import SMOTE
    ```

    ì´ì œ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¬ ì¤€ë¹„ê°€ ë˜ì—ˆìŠµë‹ˆë‹¤.

1. ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ëŠ” ë‹¤ìŒ ì‘ì—…ì„ ìˆ˜í–‰í•˜ì„¸ìš”:

    ```python
    df  = pd.read_csv('../data/cuisines.csv')
    ```

   `read_csv()` will read the content of the csv file _cusines.csv_ and place it in the variable `df`ë¥¼ ì‚¬ìš©í•˜ì„¸ìš”.

1. ë°ì´í„°ì˜ ëª¨ì–‘ì„ í™•ì¸í•˜ì„¸ìš”:

    ```python
    df.head()
    ```

   ì²˜ìŒ ë‹¤ì„¯ ì¤„ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:

    ```output
    |     | Unnamed: 0 | cuisine | almond | angelica | anise | anise_seed | apple | apple_brandy | apricot | armagnac | ... | whiskey | white_bread | white_wine | whole_grain_wheat_flour | wine | wood | yam | yeast | yogurt | zucchini |
    | --- | ---------- | ------- | ------ | -------- | ----- | ---------- | ----- | ------------ | ------- | -------- | --- | ------- | ----------- | ---------- | ----------------------- | ---- | ---- | --- | ----- | ------ | -------- |
    | 0   | 65         | indian  | 0      | 0        | 0     | 0          | 0     | 0            | 0       | 0        | ... | 0       | 0           | 0          | 0                       | 0    | 0    | 0   | 0     | 0      | 0        |
    | 1   | 66         | indian  | 1      | 0        | 0     | 0          | 0     | 0            | 0       | 0        | ... | 0       | 0           | 0          | 0                       | 0    | 0    | 0   | 0     | 0      | 0        |
    | 2   | 67         | indian  | 0      | 0        | 0     | 0          | 0     | 0            | 0       | 0        | ... | 0       | 0           | 0          | 0                       | 0    | 0    | 0   | 0     | 0      | 0        |
    | 3   | 68         | indian  | 0      | 0        | 0     | 0          | 0     | 0            | 0       | 0        | ... | 0       | 0           | 0          | 0                       | 0    | 0    | 0   | 0     | 0      | 0        |
    | 4   | 69         | indian  | 0      | 0        | 0     | 0          | 0     | 0            | 0       | 0        | ... | 0       | 0           | 0          | 0                       | 0    | 0    | 0   | 0     | 1      | 0        |
    ```

1. `info()`ë¥¼ í˜¸ì¶œí•˜ì—¬ ì´ ë°ì´í„°ì— ëŒ€í•œ ì •ë³´ë¥¼ ì–»ìœ¼ì„¸ìš”:

    ```python
    df.info()
    ```

    ì¶œë ¥ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:

    ```output
    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 2448 entries, 0 to 2447
    Columns: 385 entries, Unnamed: 0 to zucchini
    dtypes: int64(384), object(1)
    memory usage: 7.2+ MB
    ```

## ì—°ìŠµ - ìš”ë¦¬ì— ëŒ€í•´ ë°°ìš°ê¸°

ì´ì œ ì‘ì—…ì´ ë” í¥ë¯¸ë¡œì›Œì§‘ë‹ˆë‹¤. ìš”ë¦¬ë³„ ë°ì´í„° ë¶„í¬ë¥¼ ë°œê²¬í•´ ë´…ì‹œë‹¤.

1. `barh()`ë¥¼ í˜¸ì¶œí•˜ì—¬ ë°ì´í„°ë¥¼ ë§‰ëŒ€ë¡œ í”Œë¡œíŒ…í•˜ì„¸ìš”:

    ```python
    df.cuisine.value_counts().plot.barh()
    ```

    ![ìš”ë¦¬ ë°ì´í„° ë¶„í¬](../../../../translated_images/cuisine-dist.d0cc2d551abe5c25f83d73a5f560927e4a061e9a4560bac1e97d35682ef3ca6d.ko.png)

    ìš”ë¦¬ì˜ ìˆ˜ëŠ” ìœ í•œí•˜ì§€ë§Œ ë°ì´í„°ì˜ ë¶„í¬ëŠ” ê³ ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤. ì´ë¥¼ ìˆ˜ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤! ê·¸ ì „ì— ì¡°ê¸ˆ ë” íƒìƒ‰í•´ ë³´ì„¸ìš”.

1. ìš”ë¦¬ë³„ë¡œ ì‚¬ìš© ê°€ëŠ¥í•œ ë°ì´í„° ì–‘ì„ ì°¾ì•„ ì¶œë ¥í•˜ì„¸ìš”:

    ```python
    thai_df = df[(df.cuisine == "thai")]
    japanese_df = df[(df.cuisine == "japanese")]
    chinese_df = df[(df.cuisine == "chinese")]
    indian_df = df[(df.cuisine == "indian")]
    korean_df = df[(df.cuisine == "korean")]
    
    print(f'thai df: {thai_df.shape}')
    print(f'japanese df: {japanese_df.shape}')
    print(f'chinese df: {chinese_df.shape}')
    print(f'indian df: {indian_df.shape}')
    print(f'korean df: {korean_df.shape}')
    ```

    ì¶œë ¥ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:

    ```output
    thai df: (289, 385)
    japanese df: (320, 385)
    chinese df: (442, 385)
    indian df: (598, 385)
    korean df: (799, 385)
    ```

## ì¬ë£Œ ë°œê²¬í•˜ê¸°

ì´ì œ ë°ì´í„°ë¥¼ ë” ê¹Šì´ íŒŒê³ ë“¤ì–´ ìš”ë¦¬ë³„ ì „í˜•ì ì¸ ì¬ë£Œê°€ ë¬´ì—‡ì¸ì§€ ì•Œì•„ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ìš”ë¦¬ ê°„ í˜¼ë™ì„ ì¼ìœ¼í‚¤ëŠ” ë°˜ë³µ ë°ì´í„°ë¥¼ ì •ë¦¬í•´ì•¼ í•˜ë¯€ë¡œ, ì´ ë¬¸ì œì— ëŒ€í•´ ë°°ì›Œë´…ì‹œë‹¤.

1. ì¬ë£Œ ë°ì´í„°í”„ë ˆì„ì„ ìƒì„±í•˜ëŠ” `create_ingredient()` í•¨ìˆ˜ë¥¼ Pythonì—ì„œ ë§Œë“œì„¸ìš”. ì´ í•¨ìˆ˜ëŠ” ë„ì›€ì´ ë˜ì§€ ì•ŠëŠ” ì—´ì„ ì œê±°í•˜ê³  ì¬ë£Œë¥¼ ê·¸ ìˆ˜ì— ë”°ë¼ ì •ë ¬í•˜ëŠ” ê²ƒìœ¼ë¡œ ì‹œì‘í•©ë‹ˆë‹¤:

    ```python
    def create_ingredient_df(df):
        ingredient_df = df.T.drop(['cuisine','Unnamed: 0']).sum(axis=1).to_frame('value')
        ingredient_df = ingredient_df[(ingredient_df.T != 0).any()]
        ingredient_df = ingredient_df.sort_values(by='value', ascending=False,
        inplace=False)
        return ingredient_df
    ```

   ì´ì œ ì´ í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ìš”ë¦¬ë³„ ìƒìœ„ 10ê°œì˜ ê°€ì¥ ì¸ê¸° ìˆëŠ” ì¬ë£Œì— ëŒ€í•œ ì•„ì´ë””ì–´ë¥¼ ì–»ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

1. `create_ingredient()` and plot it calling `barh()`ë¥¼ í˜¸ì¶œí•˜ì„¸ìš”:

    ```python
    thai_ingredient_df = create_ingredient_df(thai_df)
    thai_ingredient_df.head(10).plot.barh()
    ```

    ![thai](../../../../translated_images/thai.0269dbab2e78bd38a132067759fe980008bdb80b6d778e5313448dbe12bed846.ko.png)

1. ì¼ë³¸ ìš”ë¦¬ì— ëŒ€í•´ ë™ì¼í•˜ê²Œ ìˆ˜í–‰í•˜ì„¸ìš”:

    ```python
    japanese_ingredient_df = create_ingredient_df(japanese_df)
    japanese_ingredient_df.head(10).plot.barh()
    ```

    ![japanese](../../../../translated_images/japanese.30260486f2a05c463c8faa62ebe7b38f0961ed293bd9a6db8eef5d3f0cf17155.ko.png)

1. ì¤‘êµ­ ìš”ë¦¬ì— ëŒ€í•´ ë™ì¼í•˜ê²Œ ìˆ˜í–‰í•˜ì„¸ìš”:

    ```python
    chinese_ingredient_df = create_ingredient_df(chinese_df)
    chinese_ingredient_df.head(10).plot.barh()
    ```

    ![chinese](../../../../translated_images/chinese.e62cafa5309f111afd1b54490336daf4e927ce32bed837069a0b7ce481dfae8d.ko.png)

1. ì¸ë„ ìš”ë¦¬ë¥¼ í”Œë¡œíŒ…í•˜ì„¸ìš”:

    ```python
    indian_ingredient_df = create_ingredient_df(indian_df)
    indian_ingredient_df.head(10).plot.barh()
    ```

    ![indian](../../../../translated_images/indian.2c4292002af1a1f97a4a24fec6b1459ee8ff616c3822ae56bb62b9903e192af6.ko.png)

1. ë§ˆì§€ë§‰ìœ¼ë¡œ í•œêµ­ ìš”ë¦¬ë¥¼ í”Œë¡œíŒ…í•˜ì„¸ìš”:

    ```python
    korean_ingredient_df = create_ingredient_df(korean_df)
    korean_ingredient_df.head(10).plot.barh()
    ```

    ![korean](../../../../translated_images/korean.4a4f0274f3d9805a65e61f05597eeaad8620b03be23a2c0a705c023f65fad2c0.ko.png)

1. ì´ì œ `drop()`ì„ í˜¸ì¶œí•˜ì—¬ ì„œë¡œ ë‹¤ë¥¸ ìš”ë¦¬ ê°„ í˜¼ë™ì„ ì¼ìœ¼í‚¤ëŠ” ê°€ì¥ ì¼ë°˜ì ì¸ ì¬ë£Œë¥¼ ì œê±°í•˜ì„¸ìš”:

   ëª¨ë‘ê°€ ìŒ€, ë§ˆëŠ˜, ìƒê°•ì„ ì¢‹ì•„í•©ë‹ˆë‹¤!

    ```python
    feature_df= df.drop(['cuisine','Unnamed: 0','rice','garlic','ginger'], axis=1)
    labels_df = df.cuisine #.unique()
    feature_df.head()
    ```

## ë°ì´í„°ì…‹ ê· í˜• ë§ì¶”ê¸°

ì´ì œ ë°ì´í„°ë¥¼ ì •ë¦¬í–ˆìœ¼ë‹ˆ, [SMOTE](https://imbalanced-learn.org/dev/references/generated/imblearn.over_sampling.SMOTE.html) - "Synthetic Minority Over-sampling Technique" -ë¥¼ ì‚¬ìš©í•˜ì—¬ ê· í˜•ì„ ë§ì¶”ì„¸ìš”.

1. `fit_resample()`ì„ í˜¸ì¶œí•˜ì„¸ìš”. ì´ ì „ëµì€ ë³´ê°„ì„ í†µí•´ ìƒˆë¡œìš´ ìƒ˜í”Œì„ ìƒì„±í•©ë‹ˆë‹¤.

    ```python
    oversample = SMOTE()
    transformed_feature_df, transformed_label_df = oversample.fit_resample(feature_df, labels_df)
    ```

    ë°ì´í„°ë¥¼ ê· í˜• ë§ì¶¤ìœ¼ë¡œì¨ ë¶„ë¥˜ ì‹œ ë” ë‚˜ì€ ê²°ê³¼ë¥¼ ì–»ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ì§„ ë¶„ë¥˜ë¥¼ ìƒê°í•´ë³´ì„¸ìš”. ëŒ€ë¶€ë¶„ì˜ ë°ì´í„°ê°€ í•˜ë‚˜ì˜ í´ë˜ìŠ¤ì¸ ê²½ìš°, ML ëª¨ë¸ì€ ë‹¨ìˆœíˆ ê·¸ í´ë˜ìŠ¤ì— ëŒ€í•œ ë°ì´í„°ê°€ ë” ë§ê¸° ë•Œë¬¸ì— ê·¸ í´ë˜ìŠ¤ë¥¼ ë” ìì£¼ ì˜ˆì¸¡í•  ê²ƒì…ë‹ˆë‹¤. ë°ì´í„°ë¥¼ ê· í˜• ë§ì¶”ë©´ ì™œê³¡ëœ ë°ì´í„°ë¥¼ ì œê±°í•˜ëŠ” ë° ë„ì›€ì´ ë©ë‹ˆë‹¤.

1. ì´ì œ ì¬ë£Œë³„ ë¼ë²¨ ìˆ˜ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

    ```python
    print(f'new label count: {transformed_label_df.value_counts()}')
    print(f'old label count: {df.cuisine.value_counts()}')
    ```

    ì¶œë ¥ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:

    ```output
    new label count: korean      799
    chinese     799
    indian      799
    japanese    799
    thai        799
    Name: cuisine, dtype: int64
    old label count: korean      799
    indian      598
    chinese     442
    japanese    320
    thai        289
    Name: cuisine, dtype: int64
    ```

    ë°ì´í„°ëŠ” ê¹”ë”í•˜ê³  ê· í˜•ì´ ë§ìœ¼ë©° ë§¤ìš° ë§›ìˆìŠµë‹ˆë‹¤!

1. ë§ˆì§€ë§‰ ë‹¨ê³„ëŠ” ê· í˜• ì¡íŒ ë°ì´í„°(ë¼ë²¨ê³¼ íŠ¹ì§• í¬í•¨)ë¥¼ ìƒˆë¡œìš´ ë°ì´í„°í”„ë ˆì„ì— ì €ì¥í•˜ì—¬ íŒŒì¼ë¡œ ë‚´ë³´ë‚´ëŠ” ê²ƒì…ë‹ˆë‹¤:

    ```python
    transformed_df = pd.concat([transformed_label_df,transformed_feature_df],axis=1, join='outer')
    ```

1. `transformed_df.head()` and `transformed_df.info()`ë¥¼ ì‚¬ìš©í•˜ì—¬ ë°ì´í„°ë¥¼ í•œ ë²ˆ ë” í™•ì¸í•˜ì„¸ìš”. ì´ ë°ì´í„°ë¥¼ ì €ì¥í•˜ì—¬ í–¥í›„ ê°•ì˜ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

    ```python
    transformed_df.head()
    transformed_df.info()
    transformed_df.to_csv("../data/cleaned_cuisines.csv")
    ```

    ì´ ìƒˆë¡œìš´ CSVëŠ” ì´ì œ ë£¨íŠ¸ ë°ì´í„° í´ë”ì—ì„œ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

---

## ğŸš€ë„ì „

ì´ ì»¤ë¦¬í˜ëŸ¼ì—ëŠ” ì—¬ëŸ¬ í¥ë¯¸ë¡œìš´ ë°ì´í„°ì…‹ì´ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤. `data` í´ë”ë¥¼ ì‚´í´ë³´ê³  ì´ì§„ ë˜ëŠ” ë‹¤ì¤‘ í´ë˜ìŠ¤ ë¶„ë¥˜ì— ì í•©í•œ ë°ì´í„°ì…‹ì´ ìˆëŠ”ì§€ í™•ì¸í•´ ë³´ì„¸ìš”. ì´ ë°ì´í„°ì…‹ì— ëŒ€í•´ ì–´ë–¤ ì§ˆë¬¸ì„ í•  ìˆ˜ ìˆì„ê¹Œìš”?

## [ê°•ì˜ í›„ í€´ì¦ˆ](https://gray-sand-07a10f403.1.azurestaticapps.net/quiz/20/)

## ë³µìŠµ ë° ìê¸° í•™ìŠµ

SMOTEì˜ APIë¥¼ íƒìƒ‰í•´ ë³´ì„¸ìš”. ì–´ë–¤ ì‚¬ìš© ì‚¬ë¡€ì— ê°€ì¥ ì í•©í• ê¹Œìš”? ì–´ë–¤ ë¬¸ì œë¥¼ í•´ê²°í•  ìˆ˜ ìˆì„ê¹Œìš”?

## ê³¼ì œ

[ë¶„ë¥˜ ë°©ë²• íƒìƒ‰](assignment.md)

**ë©´ì±… ì¡°í•­**:
ì´ ë¬¸ì„œëŠ” ê¸°ê³„ ê¸°ë°˜ AI ë²ˆì—­ ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•˜ì—¬ ë²ˆì—­ë˜ì—ˆìŠµë‹ˆë‹¤. ìš°ë¦¬ëŠ” ì •í™•ì„±ì„ ìœ„í•´ ë…¸ë ¥í•˜ì§€ë§Œ, ìë™ ë²ˆì—­ì—ëŠ” ì˜¤ë¥˜ë‚˜ ë¶€ì •í™•ì„±ì´ í¬í•¨ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì›ì–´ë¡œ ì‘ì„±ëœ ì›ë³¸ ë¬¸ì„œë¥¼ ê¶Œìœ„ ìˆëŠ” ìë£Œë¡œ ê°„ì£¼í•´ì•¼ í•©ë‹ˆë‹¤. ì¤‘ìš”í•œ ì •ë³´ì˜ ê²½ìš°, ì „ë¬¸ì ì¸ ì¸ê°„ ë²ˆì—­ì„ ê¶Œì¥í•©ë‹ˆë‹¤. ì´ ë²ˆì—­ ì‚¬ìš©ìœ¼ë¡œ ì¸í•´ ë°œìƒí•˜ëŠ” ì˜¤í•´ë‚˜ ì˜ëª»ëœ í•´ì„ì— ëŒ€í•´ ë‹¹ì‚¬ëŠ” ì±…ì„ì„ ì§€ì§€ ì•ŠìŠµë‹ˆë‹¤.