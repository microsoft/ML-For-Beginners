# ì›¹ ì•±ì„ ë§Œë“¤ì–´ ML ëª¨ë¸ ì‚¬ìš©í•˜ê¸°

ì´ë²ˆ ê°•ì˜ì—ì„œëŠ” _ì§€ë‚œ í•œ ì„¸ê¸° ë™ì•ˆì˜ UFO ëª©ê²©_ ë°ì´í„° ì„¸íŠ¸ë¥¼ ì‚¬ìš©í•˜ì—¬ ML ëª¨ë¸ì„ í›ˆë ¨í•  ê²ƒì…ë‹ˆë‹¤. ì´ ë°ì´í„°ëŠ” NUFORCì˜ ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ê°€ì ¸ì™”ìŠµë‹ˆë‹¤.

ë°°ìš¸ ë‚´ìš©:

- í›ˆë ¨ëœ ëª¨ë¸ì„ 'í”¼í´'í•˜ëŠ” ë°©ë²•
- Flask ì•±ì—ì„œ ê·¸ ëª¨ë¸ì„ ì‚¬ìš©í•˜ëŠ” ë°©ë²•

ë…¸íŠ¸ë¶ì„ ì‚¬ìš©í•˜ì—¬ ë°ì´í„°ë¥¼ ì •ë¦¬í•˜ê³  ëª¨ë¸ì„ í›ˆë ¨í•˜ëŠ” ë°©ë²•ì„ ê³„ì† ë°°ìš°ê² ì§€ë§Œ, ì´ë¥¼ í•œ ë‹¨ê³„ ë” ë‚˜ì•„ê°€ ì›¹ ì•±ì—ì„œ ëª¨ë¸ì„ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ë„ íƒêµ¬í•  ê²ƒì…ë‹ˆë‹¤.

ì´ë¥¼ ìœ„í•´ Flaskë¥¼ ì‚¬ìš©í•˜ì—¬ ì›¹ ì•±ì„ êµ¬ì¶•í•´ì•¼ í•©ë‹ˆë‹¤.

## [ê°•ì˜ ì „ í€´ì¦ˆ](https://gray-sand-07a10f403.1.azurestaticapps.net/quiz/17/)

## ì•± êµ¬ì¶•í•˜ê¸°

ë¨¸ì‹  ëŸ¬ë‹ ëª¨ë¸ì„ ì‚¬ìš©í•˜ëŠ” ì›¹ ì•±ì„ êµ¬ì¶•í•˜ëŠ” ë°©ë²•ì—ëŠ” ì—¬ëŸ¬ ê°€ì§€ê°€ ìˆìŠµë‹ˆë‹¤. ì›¹ ì•„í‚¤í…ì²˜ëŠ” ëª¨ë¸ í›ˆë ¨ ë°©ì‹ì— ì˜í–¥ì„ ë¯¸ì¹  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë°ì´í„° ê³¼í•™ ê·¸ë£¹ì´ í›ˆë ¨í•œ ëª¨ë¸ì„ ì•±ì—ì„œ ì‚¬ìš©í•´ì•¼ í•˜ëŠ” ìƒí™©ì„ ìƒìƒí•´ ë³´ì„¸ìš”.

### ê³ ë ¤ ì‚¬í•­

ë‹¤ìŒê³¼ ê°™ì€ ì—¬ëŸ¬ ì§ˆë¬¸ì„ í•´ì•¼ í•©ë‹ˆë‹¤:

- **ì›¹ ì•±ì¸ê°€ ëª¨ë°”ì¼ ì•±ì¸ê°€?** ëª¨ë°”ì¼ ì•±ì„ êµ¬ì¶•í•˜ê±°ë‚˜ IoT í™˜ê²½ì—ì„œ ëª¨ë¸ì„ ì‚¬ìš©í•´ì•¼ í•˜ëŠ” ê²½ìš°, [TensorFlow Lite](https://www.tensorflow.org/lite/)ë¥¼ ì‚¬ìš©í•˜ì—¬ Android ë˜ëŠ” iOS ì•±ì—ì„œ ëª¨ë¸ì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- **ëª¨ë¸ì€ ì–´ë””ì— ìœ„ì¹˜í•  ê²ƒì¸ê°€?** í´ë¼ìš°ë“œì— ìˆì„ ê²ƒì¸ê°€, ë¡œì»¬ì— ìˆì„ ê²ƒì¸ê°€?
- **ì˜¤í”„ë¼ì¸ ì§€ì›.** ì•±ì´ ì˜¤í”„ë¼ì¸ì—ì„œë„ ì‘ë™í•´ì•¼ í•˜ëŠ”ê°€?
- **ëª¨ë¸ì„ í›ˆë ¨í•˜ëŠ” ë° ì‚¬ìš©ëœ ê¸°ìˆ ì€ ë¬´ì—‡ì¸ê°€?** ì„ íƒí•œ ê¸°ìˆ ì´ ì‚¬ìš©í•´ì•¼ í•  ë„êµ¬ì— ì˜í–¥ì„ ë¯¸ì¹  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
    - **TensorFlow ì‚¬ìš©.** ì˜ˆë¥¼ ë“¤ì–´ TensorFlowë¥¼ ì‚¬ìš©í•˜ì—¬ ëª¨ë¸ì„ í›ˆë ¨í•˜ëŠ” ê²½ìš°, [TensorFlow.js](https://www.tensorflow.org/js/)ë¥¼ ì‚¬ìš©í•˜ì—¬ ì›¹ ì•±ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ TensorFlow ëª¨ë¸ì„ ë³€í™˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
    - **PyTorch ì‚¬ìš©.** [PyTorch](https://pytorch.org/)ì™€ ê°™ì€ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•˜ì—¬ ëª¨ë¸ì„ êµ¬ì¶•í•˜ëŠ” ê²½ìš°, [ONNX](https://onnx.ai/) (Open Neural Network Exchange) í˜•ì‹ìœ¼ë¡œ ë‚´ë³´ë‚´ JavaScript ì›¹ ì•±ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” [Onnx Runtime](https://www.onnxruntime.ai/)ì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ì˜µì…˜ì€ Scikit-learnìœ¼ë¡œ í›ˆë ¨ëœ ëª¨ë¸ì— ëŒ€í•´ ì¶”í›„ ê°•ì˜ì—ì„œ íƒêµ¬í•  ê²ƒì…ë‹ˆë‹¤.
    - **Lobe.ai ë˜ëŠ” Azure Custom Vision ì‚¬ìš©.** [Lobe.ai](https://lobe.ai/) ë˜ëŠ” [Azure Custom Vision](https://azure.microsoft.com/services/cognitive-services/custom-vision-service/?WT.mc_id=academic-77952-leestott)ê³¼ ê°™ì€ ML SaaS(Software as a Service) ì‹œìŠ¤í…œì„ ì‚¬ìš©í•˜ì—¬ ëª¨ë¸ì„ í›ˆë ¨í•˜ëŠ” ê²½ìš°, ì´ ì†Œí”„íŠ¸ì›¨ì–´ëŠ” ëª¨ë¸ì„ ë‹¤ì–‘í•œ í”Œë«í¼ì— ë‚´ë³´ë‚´ëŠ” ë°©ë²•ì„ ì œê³µí•©ë‹ˆë‹¤. ì—¬ê¸°ì—ëŠ” ì˜¨ë¼ì¸ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ í´ë¼ìš°ë“œì—ì„œ ì¿¼ë¦¬í•  ìˆ˜ ìˆëŠ” ë§ì¶¤í˜• APIë¥¼ êµ¬ì¶•í•˜ëŠ” ê²ƒë„ í¬í•¨ë©ë‹ˆë‹¤.

ë˜í•œ ì›¹ ë¸Œë¼ìš°ì €ì—ì„œ ì§ì ‘ ëª¨ë¸ì„ í›ˆë ¨í•  ìˆ˜ ìˆëŠ” ì „ì²´ Flask ì›¹ ì•±ì„ êµ¬ì¶•í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤. ì´ëŠ” JavaScript í™˜ê²½ì—ì„œ TensorFlow.jsë¥¼ ì‚¬ìš©í•˜ì—¬ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ìš°ë¦¬ì˜ ëª©ì ì„ ìœ„í•´, Python ê¸°ë°˜ ë…¸íŠ¸ë¶ì„ ì‚¬ìš©í•˜ê³  ìˆìœ¼ë¯€ë¡œ, í›ˆë ¨ëœ ëª¨ë¸ì„ ì´ëŸ¬í•œ ë…¸íŠ¸ë¶ì—ì„œ Pythonìœ¼ë¡œ êµ¬ì¶•ëœ ì›¹ ì•±ì—ì„œ ì½ì„ ìˆ˜ ìˆëŠ” í˜•ì‹ìœ¼ë¡œ ë‚´ë³´ë‚´ëŠ” ë‹¨ê³„ë¥¼ íƒêµ¬í•´ ë³´ê² ìŠµë‹ˆë‹¤.

## ë„êµ¬

ì´ ì‘ì—…ì„ ìœ„í•´ Flaskì™€ Pickle ë‘ ê°€ì§€ ë„êµ¬ê°€ í•„ìš”í•©ë‹ˆë‹¤. ë‘˜ ë‹¤ Pythonì—ì„œ ì‹¤í–‰ë©ë‹ˆë‹¤.

âœ… [Flask](https://palletsprojects.com/p/flask/)ë€? FlaskëŠ” ê·¸ ì°½ì‹œìë“¤ì— ì˜í•´ 'ë§ˆì´í¬ë¡œ í”„ë ˆì„ì›Œí¬'ë¡œ ì •ì˜ë˜ë©°, Pythonì„ ì‚¬ìš©í•˜ì—¬ ì›¹ í˜ì´ì§€ë¥¼ êµ¬ì¶•í•˜ëŠ” í…œí”Œë¦¿ ì—”ì§„ì„ í¬í•¨í•œ ì›¹ í”„ë ˆì„ì›Œí¬ì˜ ê¸°ë³¸ ê¸°ëŠ¥ì„ ì œê³µí•©ë‹ˆë‹¤. Flaskë¡œ êµ¬ì¶•í•˜ëŠ” ì—°ìŠµì„ ìœ„í•´ [ì´ í•™ìŠµ ëª¨ë“ˆ](https://docs.microsoft.com/learn/modules/python-flask-build-ai-web-app?WT.mc_id=academic-77952-leestott)ì„ ì‚´í´ë³´ì„¸ìš”.

âœ… [Pickle](https://docs.python.org/3/library/pickle.html)ì´ë€? Pickle ğŸ¥’ì€ Python ê°ì²´ êµ¬ì¡°ë¥¼ ì§ë ¬í™”í•˜ê³  ì—­ì§ë ¬í™”í•˜ëŠ” Python ëª¨ë“ˆì…ë‹ˆë‹¤. ëª¨ë¸ì„ 'í”¼í´'í•  ë•Œ, êµ¬ì¡°ë¥¼ ì›¹ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ ì§ë ¬í™”í•˜ê±°ë‚˜ í‰íƒ„í™”í•©ë‹ˆë‹¤. ì£¼ì˜í•˜ì„¸ìš”: í”¼í´ì€ ë³¸ì§ˆì ìœ¼ë¡œ ì•ˆì „í•˜ì§€ ì•Šìœ¼ë¯€ë¡œ íŒŒì¼ì„ 'ì–¸í”¼í´'í•˜ë¼ëŠ” ë©”ì‹œì§€ê°€ í‘œì‹œë˜ë©´ ì£¼ì˜í•´ì•¼ í•©ë‹ˆë‹¤. í”¼í´ëœ íŒŒì¼ì˜ ì ‘ë¯¸ì‚¬ëŠ” `.pkl`ì…ë‹ˆë‹¤.

## ì—°ìŠµ - ë°ì´í„° ì •ë¦¬í•˜ê¸°

ì´ë²ˆ ê°•ì˜ì—ì„œëŠ” [NUFORC](https://nuforc.org) (National UFO Reporting Center)ì—ì„œ ìˆ˜ì§‘í•œ 80,000ê±´ì˜ UFO ëª©ê²© ë°ì´í„°ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. ì´ ë°ì´í„°ì—ëŠ” í¥ë¯¸ë¡œìš´ UFO ëª©ê²© ì„¤ëª…ì´ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´:

- **ê¸´ ì„¤ëª… ì˜ˆì‹œ.** "í•œ ë‚¨ìê°€ ë°¤ì— í’€ë°­ì— ë¹›ë‚˜ëŠ” ë¹”ì—ì„œ ë‚˜ì™€ í…ì‚¬ìŠ¤ ì¸ìŠ¤íŠ¸ë£¨ë¨¼íŠ¸ ì£¼ì°¨ì¥ìœ¼ë¡œ ë‹¬ë ¤ê°‘ë‹ˆë‹¤".
- **ì§§ì€ ì„¤ëª… ì˜ˆì‹œ.** "ë¶ˆë¹›ì´ ìš°ë¦¬ë¥¼ ì«“ì•„ì™”ìŠµë‹ˆë‹¤".

[ufos.csv](../../../../3-Web-App/1-Web-App/data/ufos.csv) ìŠ¤í”„ë ˆë“œì‹œíŠ¸ì—ëŠ” ëª©ê²©ì´ ë°œìƒí•œ `city`, `state`, `country`ì— ëŒ€í•œ ì—´ê³¼ ê°ì²´ì˜ `shape`, `latitude`, `longitude`ê°€ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤.

ì´ë²ˆ ê°•ì˜ì— í¬í•¨ëœ ë¹ˆ [ë…¸íŠ¸ë¶](../../../../3-Web-App/1-Web-App/notebook.ipynb)ì—ì„œ:

1. ì´ì „ ê°•ì˜ì—ì„œ í–ˆë˜ ê²ƒì²˜ëŸ¼ `pandas`, `matplotlib`, `numpy`ì„ ê°€ì ¸ì˜¤ê³  ufos ìŠ¤í”„ë ˆë“œì‹œíŠ¸ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤. ìƒ˜í”Œ ë°ì´í„° ì„¸íŠ¸ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

    ```python
    import pandas as pd
    import numpy as np
    
    ufos = pd.read_csv('./data/ufos.csv')
    ufos.head()
    ```

1. ufos ë°ì´í„°ë¥¼ ìƒˆ ì œëª©ìœ¼ë¡œ ì‘ì€ ë°ì´í„°í”„ë ˆì„ìœ¼ë¡œ ë³€í™˜í•©ë‹ˆë‹¤. `Country` í•„ë“œì˜ ê³ ìœ  ê°’ì„ í™•ì¸í•©ë‹ˆë‹¤.

    ```python
    ufos = pd.DataFrame({'Seconds': ufos['duration (seconds)'], 'Country': ufos['country'],'Latitude': ufos['latitude'],'Longitude': ufos['longitude']})
    
    ufos.Country.unique()
    ```

1. ì´ì œ í•„ìš”í•œ ë°ì´í„° ì–‘ì„ ì¤„ì´ê¸° ìœ„í•´ null ê°’ì„ ì‚­ì œí•˜ê³  1-60ì´ˆ ì‚¬ì´ì˜ ëª©ê²©ë§Œ ê°€ì ¸ì˜µë‹ˆë‹¤:

    ```python
    ufos.dropna(inplace=True)
    
    ufos = ufos[(ufos['Seconds'] >= 1) & (ufos['Seconds'] <= 60)]
    
    ufos.info()
    ```

1. Scikit-learnì˜ `LabelEncoder` ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ê°€ì ¸ì™€ êµ­ê°€ì˜ í…ìŠ¤íŠ¸ ê°’ì„ ìˆ«ìë¡œ ë³€í™˜í•©ë‹ˆë‹¤:

    âœ… LabelEncoderëŠ” ë°ì´í„°ë¥¼ ì•ŒíŒŒë²³ ìˆœì„œë¡œ ì¸ì½”ë”©í•©ë‹ˆë‹¤

    ```python
    from sklearn.preprocessing import LabelEncoder
    
    ufos['Country'] = LabelEncoder().fit_transform(ufos['Country'])
    
    ufos.head()
    ```

    ë°ì´í„°ëŠ” ë‹¤ìŒê³¼ ê°™ì•„ì•¼ í•©ë‹ˆë‹¤:

    ```output
    	Seconds	Country	Latitude	Longitude
    2	20.0	3		53.200000	-2.916667
    3	20.0	4		28.978333	-96.645833
    14	30.0	4		35.823889	-80.253611
    23	60.0	4		45.582778	-122.352222
    24	3.0		3		51.783333	-0.783333
    ```

## ì—°ìŠµ - ëª¨ë¸ êµ¬ì¶•í•˜ê¸°

ì´ì œ ë°ì´í„°ë¥¼ í›ˆë ¨ ë° í…ŒìŠ¤íŠ¸ ê·¸ë£¹ìœ¼ë¡œ ë‚˜ëˆ„ì–´ ëª¨ë¸ì„ í›ˆë ¨í•  ì¤€ë¹„ë¥¼ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

1. í›ˆë ¨í•  ì„¸ ê°€ì§€ íŠ¹ì§•ì„ X ë²¡í„°ë¡œ ì„ íƒí•˜ê³ , y ë²¡í„°ëŠ” `Country`. You want to be able to input `Seconds`, `Latitude` and `Longitude`ë¥¼ ì„ íƒí•˜ì—¬ êµ­ê°€ IDë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.

    ```python
    from sklearn.model_selection import train_test_split
    
    Selected_features = ['Seconds','Latitude','Longitude']
    
    X = ufos[Selected_features]
    y = ufos['Country']
    
    X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=0)
    ```

1. ë¡œì§€ìŠ¤í‹± íšŒê·€ë¥¼ ì‚¬ìš©í•˜ì—¬ ëª¨ë¸ì„ í›ˆë ¨í•©ë‹ˆë‹¤:

    ```python
    from sklearn.metrics import accuracy_score, classification_report
    from sklearn.linear_model import LogisticRegression
    model = LogisticRegression()
    model.fit(X_train, y_train)
    predictions = model.predict(X_test)
    
    print(classification_report(y_test, predictions))
    print('Predicted labels: ', predictions)
    print('Accuracy: ', accuracy_score(y_test, predictions))
    ```

ì •í™•ë„ëŠ” **ì•½ 95%**ë¡œ ë‚˜ì˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ì´ëŠ” `Country` and `Latitude/Longitude` correlate.

The model you created isn't very revolutionary as you should be able to infer a `Country` from its `Latitude` and `Longitude` ë•Œë¬¸ì…ë‹ˆë‹¤. í•˜ì§€ë§Œ, ì •ë¦¬í•œ ì›ì‹œ ë°ì´í„°ì—ì„œ í›ˆë ¨í•˜ê³ , ë‚´ë³´ë‚¸ í›„ ì´ ëª¨ë¸ì„ ì›¹ ì•±ì—ì„œ ì‚¬ìš©í•˜ëŠ” ì—°ìŠµì„ í•˜ëŠ” ê²ƒì€ ì¢‹ì€ ê²½í—˜ì…ë‹ˆë‹¤.

## ì—°ìŠµ - ëª¨ë¸ 'í”¼í´'í•˜ê¸°

ì´ì œ ëª¨ë¸ì„ _í”¼í´_í•  ì‹œê°„ì…ë‹ˆë‹¤! ëª‡ ì¤„ì˜ ì½”ë“œë¡œ ì´ë¥¼ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. _í”¼í´_ëœ í›„ì—ëŠ” í”¼í´ëœ ëª¨ë¸ì„ ë¡œë“œí•˜ê³  ì´ˆ, ìœ„ë„, ê²½ë„ ê°’ì„ í¬í•¨í•˜ëŠ” ìƒ˜í”Œ ë°ì´í„° ë°°ì—´ì— ëŒ€í•´ í…ŒìŠ¤íŠ¸í•©ë‹ˆë‹¤.

```python
import pickle
model_filename = 'ufo-model.pkl'
pickle.dump(model, open(model_filename,'wb'))

model = pickle.load(open('ufo-model.pkl','rb'))
print(model.predict([[50,44,-12]]))
```

ëª¨ë¸ì€ **'3'**ì„ ë°˜í™˜í•©ë‹ˆë‹¤. ì´ëŠ” ì˜êµ­ì˜ êµ­ê°€ ì½”ë“œì…ë‹ˆë‹¤. ë†€ëêµ°ìš”! ğŸ‘½

## ì—°ìŠµ - Flask ì•± êµ¬ì¶•í•˜ê¸°

ì´ì œ ëª¨ë¸ì„ í˜¸ì¶œí•˜ê³  ìœ ì‚¬í•œ ê²°ê³¼ë¥¼ ë°˜í™˜í•˜ëŠ” Flask ì•±ì„ êµ¬ì¶•í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë” ì‹œê°ì ìœ¼ë¡œ ë³´ê¸° ì¢‹ê²Œ ë§Œë“¤ ê²ƒì…ë‹ˆë‹¤.

1. _notebook.ipynb_ íŒŒì¼ì´ ìˆëŠ” ìœ„ì¹˜ì— **web-app** í´ë”ë¥¼ ë§Œë“­ë‹ˆë‹¤. ì—¬ê¸°ì—ëŠ” _ufo-model.pkl_ íŒŒì¼ì´ ìˆìŠµë‹ˆë‹¤.

1. ê·¸ í´ë”ì— ì„¸ ê°œì˜ í´ë”ë¥¼ ë” ë§Œë“­ë‹ˆë‹¤: **static** í´ë”ì™€ ê·¸ ì•ˆì— **css** í´ë”, ê·¸ë¦¬ê³  **templates** í´ë”. ì´ì œ ë‹¤ìŒê³¼ ê°™ì€ íŒŒì¼ê³¼ ë””ë ‰í† ë¦¬ê°€ ìˆì–´ì•¼ í•©ë‹ˆë‹¤:

    ```output
    web-app/
      static/
        css/
      templates/
    notebook.ipynb
    ufo-model.pkl
    ```

    âœ… ì™„ì„±ëœ ì•±ì˜ ëª¨ìŠµì„ ë³´ë ¤ë©´ ì†”ë£¨ì…˜ í´ë”ë¥¼ ì°¸ì¡°í•˜ì„¸ìš”

1. _web-app_ í´ë”ì—ì„œ ì²« ë²ˆì§¸ë¡œ ìƒì„±í•  íŒŒì¼ì€ **requirements.txt** íŒŒì¼ì…ë‹ˆë‹¤. JavaScript ì•±ì˜ _package.json_ê³¼ ê°™ì´ ì´ íŒŒì¼ì€ ì•±ì— í•„ìš”í•œ ì¢…ì†ì„±ì„ ë‚˜ì—´í•©ë‹ˆë‹¤. **requirements.txt**ì— ë‹¤ìŒ ì¤„ì„ ì¶”ê°€í•©ë‹ˆë‹¤:

    ```text
    scikit-learn
    pandas
    numpy
    flask
    ```

1. ì´ì œ _web-app_ìœ¼ë¡œ ì´ë™í•˜ì—¬ ì´ íŒŒì¼ì„ ì‹¤í–‰í•©ë‹ˆë‹¤:

    ```bash
    cd web-app
    ```

1. í„°ë¯¸ë„ì—ì„œ `pip install`ì„ ì…ë ¥í•˜ì—¬ _requirements.txt_ì— ë‚˜ì—´ëœ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì„¤ì¹˜í•©ë‹ˆë‹¤:

    ```bash
    pip install -r requirements.txt
    ```

1. ì´ì œ ì•±ì„ ì™„ì„±í•˜ê¸° ìœ„í•´ ì„¸ ê°œì˜ íŒŒì¼ì„ ë” ìƒì„±í•  ì¤€ë¹„ê°€ ë˜ì—ˆìŠµë‹ˆë‹¤:

    1. ë£¨íŠ¸ì— **app.py**ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.
    2. _templates_ ë””ë ‰í† ë¦¬ì— **index.html**ì„ ìƒì„±í•©ë‹ˆë‹¤.
    3. _static/css_ ë””ë ‰í† ë¦¬ì— **styles.css**ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.

1. _styles.css_ íŒŒì¼ì— ëª‡ ê°€ì§€ ìŠ¤íƒ€ì¼ì„ ì¶”ê°€í•©ë‹ˆë‹¤:

    ```css
    body {
    	width: 100%;
    	height: 100%;
    	font-family: 'Helvetica';
    	background: black;
    	color: #fff;
    	text-align: center;
    	letter-spacing: 1.4px;
    	font-size: 30px;
    }
    
    input {
    	min-width: 150px;
    }
    
    .grid {
    	width: 300px;
    	border: 1px solid #2d2d2d;
    	display: grid;
    	justify-content: center;
    	margin: 20px auto;
    }
    
    .box {
    	color: #fff;
    	background: #2d2d2d;
    	padding: 12px;
    	display: inline-block;
    }
    ```

1. ë‹¤ìŒìœ¼ë¡œ _index.html_ íŒŒì¼ì„ ì‘ì„±í•©ë‹ˆë‹¤:

    ```html
    <!DOCTYPE html>
    <html>
      <head>
        <meta charset="UTF-8">
        <title>ğŸ›¸ UFO Appearance Prediction! ğŸ‘½</title>
        <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
      </head>
    
      <body>
        <div class="grid">
    
          <div class="box">
    
            <p>According to the number of seconds, latitude and longitude, which country is likely to have reported seeing a UFO?</p>
    
            <form action="{{ url_for('predict')}}" method="post">
              <input type="number" name="seconds" placeholder="Seconds" required="required" min="0" max="60" />
              <input type="text" name="latitude" placeholder="Latitude" required="required" />
              <input type="text" name="longitude" placeholder="Longitude" required="required" />
              <button type="submit" class="btn">Predict country where the UFO is seen</button>
            </form>
    
            <p>{{ prediction_text }}</p>
    
          </div>
    
        </div>
    
      </body>
    </html>
    ```

    ì´ íŒŒì¼ì˜ í…œí”Œë¦¿ êµ¬ë¬¸ì„ ì‚´í´ë³´ì„¸ìš”. ì˜ˆì¸¡ í…ìŠ¤íŠ¸ì™€ ê°™ì€ ë³€ìˆ˜ê°€ ì œê³µë  ë•Œ `{{}}`. There's also a form that posts a prediction to the `/predict` route.

    Finally, you're ready to build the python file that drives the consumption of the model and the display of predictions:

1. In `app.py`ì— ì¶”ê°€í•©ë‹ˆë‹¤:

    ```python
    import numpy as np
    from flask import Flask, request, render_template
    import pickle
    
    app = Flask(__name__)
    
    model = pickle.load(open("./ufo-model.pkl", "rb"))
    
    
    @app.route("/")
    def home():
        return render_template("index.html")
    
    
    @app.route("/predict", methods=["POST"])
    def predict():
    
        int_features = [int(x) for x in request.form.values()]
        final_features = [np.array(int_features)]
        prediction = model.predict(final_features)
    
        output = prediction[0]
    
        countries = ["Australia", "Canada", "Germany", "UK", "US"]
    
        return render_template(
            "index.html", prediction_text="Likely country: {}".format(countries[output])
        )
    
    
    if __name__ == "__main__":
        app.run(debug=True)
    ```

    > ğŸ’¡ íŒ: [`debug=True`](https://www.askpython.com/python-modules/flask/flask-debug-mode) while running the web app using Flask, any changes you make to your application will be reflected immediately without the need to restart the server. Beware! Don't enable this mode in a production app.

If you run `python app.py` or `python3 app.py` - your web server starts up, locally, and you can fill out a short form to get an answer to your burning question about where UFOs have been sighted!

Before doing that, take a look at the parts of `app.py`:

1. First, dependencies are loaded and the app starts.
1. Then, the model is imported.
1. Then, index.html is rendered on the home route.

On the `/predict` route, several things happen when the form is posted:

1. The form variables are gathered and converted to a numpy array. They are then sent to the model and a prediction is returned.
2. The Countries that we want displayed are re-rendered as readable text from their predicted country code, and that value is sent back to index.html to be rendered in the template.

Using a model this way, with Flask and a pickled model, is relatively straightforward. The hardest thing is to understand what shape the data is that must be sent to the model to get a prediction. That all depends on how the model was trained. This one has three data points to be input in order to get a prediction.

In a professional setting, you can see how good communication is necessary between the folks who train the model and those who consume it in a web or mobile app. In our case, it's only one person, you!

---

## ğŸš€ Challenge

Instead of working in a notebook and importing the model to the Flask app, you could train the model right within the Flask app! Try converting your Python code in the notebook, perhaps after your data is cleaned, to train the model from within the app on a route called `train`. ì´ ë°©ë²•ì„ ì¶”êµ¬í•  ë•Œì˜ ì¥ë‹¨ì ì€ ë¬´ì—‡ì¸ê°€ìš”?

## [ê°•ì˜ í›„ í€´ì¦ˆ](https://gray-sand-07a10f403.1.azurestaticapps.net/quiz/18/)

## ë³µìŠµ ë° ììŠµ

ML ëª¨ë¸ì„ ì‚¬ìš©í•˜ëŠ” ì›¹ ì•±ì„ êµ¬ì¶•í•˜ëŠ” ë°©ë²•ì€ ì—¬ëŸ¬ ê°€ì§€ê°€ ìˆìŠµë‹ˆë‹¤. JavaScript ë˜ëŠ” Pythonì„ ì‚¬ìš©í•˜ì—¬ ë¨¸ì‹  ëŸ¬ë‹ì„ í™œìš©í•˜ëŠ” ì›¹ ì•±ì„ êµ¬ì¶•í•  ìˆ˜ ìˆëŠ” ë°©ë²•ì„ ëª©ë¡ìœ¼ë¡œ ë§Œë“¤ì–´ ë³´ì„¸ìš”. ì•„í‚¤í…ì²˜ë¥¼ ê³ ë ¤í•´ ë³´ì„¸ìš”: ëª¨ë¸ì´ ì•±ì— ìˆì–´ì•¼ í•˜ë‚˜ìš”, ì•„ë‹ˆë©´ í´ë¼ìš°ë“œì— ìˆì–´ì•¼ í•˜ë‚˜ìš”? í›„ìì˜ ê²½ìš°, ì–´ë–»ê²Œ ì ‘ê·¼í•  ìˆ˜ ìˆë‚˜ìš”? ì ìš©ëœ ML ì›¹ ì†”ë£¨ì…˜ì˜ ì•„í‚¤í…ì²˜ ëª¨ë¸ì„ ê·¸ë ¤ë³´ì„¸ìš”.

## ê³¼ì œ

[ë‹¤ë¥¸ ëª¨ë¸ ì‹œë„í•´ë³´ê¸°](assignment.md)

**ë©´ì±… ì¡°í•­**:
ì´ ë¬¸ì„œëŠ” ê¸°ê³„ ê¸°ë°˜ AI ë²ˆì—­ ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•˜ì—¬ ë²ˆì—­ë˜ì—ˆìŠµë‹ˆë‹¤. ì •í™•ì„±ì„ ìœ„í•´ ë…¸ë ¥í•˜ê³  ìˆì§€ë§Œ, ìë™ ë²ˆì—­ì—ëŠ” ì˜¤ë¥˜ë‚˜ ë¶€ì •í™•ì„±ì´ ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì›ì–´ë¡œ ì‘ì„±ëœ ì›ë³¸ ë¬¸ì„œë¥¼ ê¶Œìœ„ ìˆëŠ” ìë£Œë¡œ ê°„ì£¼í•´ì•¼ í•©ë‹ˆë‹¤. ì¤‘ìš”í•œ ì •ë³´ì˜ ê²½ìš°, ì „ë¬¸ì ì¸ ì¸ê°„ ë²ˆì—­ì„ ê¶Œì¥í•©ë‹ˆë‹¤. ì´ ë²ˆì—­ì˜ ì‚¬ìš©ìœ¼ë¡œ ì¸í•´ ë°œìƒí•˜ëŠ” ì˜¤í•´ë‚˜ ì˜ëª»ëœ í•´ì„ì— ëŒ€í•´ ë‹¹ì‚¬ëŠ” ì±…ì„ì„ ì§€ì§€ ì•ŠìŠµë‹ˆë‹¤.