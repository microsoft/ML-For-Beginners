# ä½¿ç”¨ Python å’Œ Scikit-learn æ„å»ºå›å½’æ¨¡å‹å…¥é—¨

![å›å½’æ¨¡å‹çš„æ¦‚è¿°](../../../../translated_images/ml-regression.4e4f70e3b3ed446e3ace348dec973e133fa5d3680fbc8412b61879507369b98d.zh.png)

> ç”± [Tomomi Imura](https://www.twitter.com/girlie_mac) ç»˜åˆ¶çš„æ‰‹ç»˜ç¬”è®°

## [è¯¾å‰æµ‹éªŒ](https://gray-sand-07a10f403.1.azurestaticapps.net/quiz/9/)

> ### [æœ¬è¯¾ç¨‹æä¾› R è¯­è¨€ç‰ˆæœ¬ï¼](../../../../2-Regression/1-Tools/solution/R/lesson_1.html)

## ç®€ä»‹

åœ¨è¿™å››èŠ‚è¯¾ä¸­ï¼Œä½ å°†å­¦ä¹ å¦‚ä½•æ„å»ºå›å½’æ¨¡å‹ã€‚æˆ‘ä»¬å°†å¾ˆå¿«è®¨è®ºè¿™äº›æ¨¡å‹çš„ç”¨é€”ã€‚ä½†åœ¨å¼€å§‹ä¹‹å‰ï¼Œè¯·ç¡®ä¿ä½ å·²ç»å‡†å¤‡å¥½äº†åˆé€‚çš„å·¥å…·ï¼

åœ¨æœ¬è¯¾ä¸­ï¼Œä½ å°†å­¦åˆ°ï¼š

- é…ç½®ä½ çš„ç”µè„‘ä»¥è¿›è¡Œæœ¬åœ°æœºå™¨å­¦ä¹ ä»»åŠ¡ã€‚
- ä½¿ç”¨ Jupyter ç¬”è®°æœ¬ã€‚
- å®‰è£…å’Œä½¿ç”¨ Scikit-learnã€‚
- é€šè¿‡åŠ¨æ‰‹ç»ƒä¹ æ¢ç´¢çº¿æ€§å›å½’ã€‚

## å®‰è£…å’Œé…ç½®

[![æœºå™¨å­¦ä¹ åˆå­¦è€… - è®¾ç½®å·¥å…·ä»¥æ„å»ºæœºå™¨å­¦ä¹ æ¨¡å‹](https://img.youtube.com/vi/-DfeD2k2Kj0/0.jpg)](https://youtu.be/-DfeD2k2Kj0 "æœºå™¨å­¦ä¹ åˆå­¦è€… - è®¾ç½®å·¥å…·ä»¥æ„å»ºæœºå™¨å­¦ä¹ æ¨¡å‹")

> ğŸ¥ ç‚¹å‡»ä¸Šé¢çš„å›¾ç‰‡è§‚çœ‹ä¸€ä¸ªç®€çŸ­çš„è§†é¢‘ï¼Œäº†è§£å¦‚ä½•é…ç½®ä½ çš„ç”µè„‘ä»¥è¿›è¡Œæœºå™¨å­¦ä¹ ã€‚

1. **å®‰è£… Python**ã€‚ç¡®ä¿ä½ çš„ç”µè„‘ä¸Šå®‰è£…äº† [Python](https://www.python.org/downloads/)ã€‚ä½ å°†ä½¿ç”¨ Python è¿›è¡Œè®¸å¤šæ•°æ®ç§‘å­¦å’Œæœºå™¨å­¦ä¹ ä»»åŠ¡ã€‚å¤§å¤šæ•°è®¡ç®—æœºç³»ç»Ÿå·²ç»åŒ…å«äº† Python å®‰è£…ã€‚ä¹Ÿæœ‰ä¸€äº›æœ‰ç”¨çš„ [Python ç¼–ç åŒ…](https://code.visualstudio.com/learn/educators/installers?WT.mc_id=academic-77952-leestott)ï¼Œå¯ä»¥ç®€åŒ–æŸäº›ç”¨æˆ·çš„è®¾ç½®è¿‡ç¨‹ã€‚

   ç„¶è€Œï¼Œæœ‰äº› Python çš„ä½¿ç”¨éœ€è¦ä¸€ä¸ªç‰ˆæœ¬çš„è½¯ä»¶ï¼Œè€Œå…¶ä»–ä½¿ç”¨åˆ™éœ€è¦ä¸åŒçš„ç‰ˆæœ¬ã€‚å› æ­¤ï¼Œåœ¨ [è™šæ‹Ÿç¯å¢ƒ](https://docs.python.org/3/library/venv.html) ä¸­å·¥ä½œæ˜¯å¾ˆæœ‰ç”¨çš„ã€‚

2. **å®‰è£… Visual Studio Code**ã€‚ç¡®ä¿ä½ çš„ç”µè„‘ä¸Šå®‰è£…äº† Visual Studio Codeã€‚æŒ‰ç…§è¿™äº›è¯´æ˜è¿›è¡Œ [å®‰è£… Visual Studio Code](https://code.visualstudio.com/) çš„åŸºæœ¬å®‰è£…ã€‚åœ¨æœ¬è¯¾ç¨‹ä¸­ï¼Œä½ å°†ä½¿ç”¨ Visual Studio Code ä¸­çš„ Pythonï¼Œå› æ­¤ä½ å¯èƒ½éœ€è¦äº†è§£å¦‚ä½• [é…ç½® Visual Studio Code](https://docs.microsoft.com/learn/modules/python-install-vscode?WT.mc_id=academic-77952-leestott) ä»¥è¿›è¡Œ Python å¼€å‘ã€‚

   > é€šè¿‡å­¦ä¹ è¿™ç»„ [Learn æ¨¡å—](https://docs.microsoft.com/users/jenlooper-2911/collections/mp1pagggd5qrq7?WT.mc_id=academic-77952-leestott) æ¥ç†Ÿæ‚‰ Python
   >
   > [![ä½¿ç”¨ Visual Studio Code è®¾ç½® Python](https://img.youtube.com/vi/yyQM70vi7V8/0.jpg)](https://youtu.be/yyQM70vi7V8 "ä½¿ç”¨ Visual Studio Code è®¾ç½® Python")
   >
   > ğŸ¥ ç‚¹å‡»ä¸Šé¢çš„å›¾ç‰‡è§‚çœ‹è§†é¢‘ï¼šåœ¨ VS Code ä¸­ä½¿ç”¨ Pythonã€‚

3. **å®‰è£… Scikit-learn**ï¼ŒæŒ‰ç…§ [è¿™äº›è¯´æ˜](https://scikit-learn.org/stable/install.html)ã€‚ç”±äºä½ éœ€è¦ç¡®ä¿ä½¿ç”¨ Python 3ï¼Œå»ºè®®ä½ ä½¿ç”¨è™šæ‹Ÿç¯å¢ƒã€‚è¯·æ³¨æ„ï¼Œå¦‚æœä½ åœ¨ M1 Mac ä¸Šå®‰è£…æ­¤åº“ï¼Œè¯·å‚é˜…ä¸Šè¿°é“¾æ¥é¡µé¢ä¸­çš„ç‰¹åˆ«è¯´æ˜ã€‚

1. **å®‰è£… Jupyter Notebook**ã€‚ä½ éœ€è¦ [å®‰è£… Jupyter åŒ…](https://pypi.org/project/jupyter/)ã€‚

## ä½ çš„æœºå™¨å­¦ä¹ ç¼–å†™ç¯å¢ƒ

ä½ å°†ä½¿ç”¨ **notebooks** æ¥å¼€å‘ä½ çš„ Python ä»£ç å¹¶åˆ›å»ºæœºå™¨å­¦ä¹ æ¨¡å‹ã€‚è¿™ç§ç±»å‹çš„æ–‡ä»¶æ˜¯æ•°æ®ç§‘å­¦å®¶çš„å¸¸ç”¨å·¥å…·ï¼Œå¯ä»¥é€šè¿‡å…¶åç¼€æˆ–æ‰©å±•å `.ipynb` è¯†åˆ«ã€‚

ç¬”è®°æœ¬æ˜¯ä¸€ç§äº¤äº’å¼ç¯å¢ƒï¼Œå…è®¸å¼€å‘è€…ç¼–å†™ä»£ç å¹¶æ·»åŠ æ³¨é‡Šå’Œæ–‡æ¡£ï¼Œè¿™å¯¹äºå®éªŒæˆ–ç ”ç©¶å¯¼å‘çš„é¡¹ç›®éå¸¸æœ‰å¸®åŠ©ã€‚

[![æœºå™¨å­¦ä¹ åˆå­¦è€… - è®¾ç½® Jupyter ç¬”è®°æœ¬ä»¥å¼€å§‹æ„å»ºå›å½’æ¨¡å‹](https://img.youtube.com/vi/7E-jC8FLA2E/0.jpg)](https://youtu.be/7E-jC8FLA2E "æœºå™¨å­¦ä¹ åˆå­¦è€… - è®¾ç½® Jupyter ç¬”è®°æœ¬ä»¥å¼€å§‹æ„å»ºå›å½’æ¨¡å‹")

> ğŸ¥ ç‚¹å‡»ä¸Šé¢çš„å›¾ç‰‡è§‚çœ‹ä¸€ä¸ªç®€çŸ­çš„è§†é¢‘ï¼Œäº†è§£å¦‚ä½•è¿›è¡Œæ­¤ç»ƒä¹ ã€‚

### ç»ƒä¹  - ä½¿ç”¨ç¬”è®°æœ¬

åœ¨è¿™ä¸ªæ–‡ä»¶å¤¹ä¸­ï¼Œä½ ä¼šæ‰¾åˆ° _notebook.ipynb_ æ–‡ä»¶ã€‚

1. åœ¨ Visual Studio Code ä¸­æ‰“å¼€ _notebook.ipynb_ã€‚

   ä¸€ä¸ª Jupyter æœåŠ¡å™¨å°†ä¼šå¯åŠ¨ï¼Œå¹¶å¯åŠ¨ Python 3+ã€‚ä½ ä¼šå‘ç°ç¬”è®°æœ¬ä¸­æœ‰ä¸€äº›åŒºåŸŸå¯ä»¥ `run`ï¼Œå³ä»£ç ç‰‡æ®µã€‚ä½ å¯ä»¥é€šè¿‡é€‰æ‹©ä¸€ä¸ªçœ‹èµ·æ¥åƒæ’­æ”¾æŒ‰é’®çš„å›¾æ ‡æ¥è¿è¡Œä¸€ä¸ªä»£ç å—ã€‚

1. é€‰æ‹© `md` å›¾æ ‡å¹¶æ·»åŠ ä¸€äº› markdownï¼Œä»¥åŠä»¥ä¸‹æ–‡æœ¬ **# æ¬¢è¿æ¥åˆ°ä½ çš„ç¬”è®°æœ¬**ã€‚

   æ¥ä¸‹æ¥ï¼Œæ·»åŠ ä¸€äº› Python ä»£ç ã€‚

1. åœ¨ä»£ç å—ä¸­è¾“å…¥ **print('hello notebook')**ã€‚
1. é€‰æ‹©ç®­å¤´æ¥è¿è¡Œä»£ç ã€‚

   ä½ åº”è¯¥ä¼šçœ‹åˆ°æ‰“å°çš„è¯­å¥ï¼š

    ```output
    hello notebook
    ```

![åœ¨ VS Code ä¸­æ‰“å¼€çš„ç¬”è®°æœ¬](../../../../translated_images/notebook.4a3ee31f396b88325607afda33cadcc6368de98040ff33942424260aa84d75f2.zh.jpg)

ä½ å¯ä»¥åœ¨ä»£ç ä¸­æ’å…¥æ³¨é‡Šï¼Œä»¥è‡ªæˆ‘è®°å½•ç¬”è®°æœ¬ã€‚

âœ… æƒ³ä¸€æƒ³ï¼Œç½‘é¡µå¼€å‘è€…çš„å·¥ä½œç¯å¢ƒä¸æ•°æ®ç§‘å­¦å®¶çš„å·¥ä½œç¯å¢ƒæœ‰ä½•ä¸åŒã€‚

## ä½¿ç”¨ Scikit-learn å…¥é—¨

ç°åœ¨ Python å·²ç»åœ¨ä½ çš„æœ¬åœ°ç¯å¢ƒä¸­è®¾ç½®å®Œæ¯•ï¼Œå¹¶ä¸”ä½ å·²ç»ç†Ÿæ‚‰äº† Jupyter ç¬”è®°æœ¬ï¼Œè®©æˆ‘ä»¬åŒæ ·ç†Ÿæ‚‰ä¸€ä¸‹ Scikit-learnï¼ˆå‘éŸ³ä¸º `sci` as in `science`ï¼‰ã€‚Scikit-learn æä¾›äº†ä¸€ä¸ª [å¹¿æ³›çš„ API](https://scikit-learn.org/stable/modules/classes.html#api-ref)ï¼Œå¸®åŠ©ä½ æ‰§è¡Œæœºå™¨å­¦ä¹ ä»»åŠ¡ã€‚

æ ¹æ®ä»–ä»¬çš„ [ç½‘ç«™](https://scikit-learn.org/stable/getting_started.html)ï¼Œ"Scikit-learn æ˜¯ä¸€ä¸ªå¼€æºæœºå™¨å­¦ä¹ åº“ï¼Œæ”¯æŒç›‘ç£å­¦ä¹ å’Œéç›‘ç£å­¦ä¹ ã€‚å®ƒè¿˜æä¾›äº†å„ç§å·¥å…·ç”¨äºæ¨¡å‹æ‹Ÿåˆã€æ•°æ®é¢„å¤„ç†ã€æ¨¡å‹é€‰æ‹©å’Œè¯„ä¼°ï¼Œä»¥åŠè®¸å¤šå…¶ä»–å®ç”¨å·¥å…·ã€‚"

åœ¨æœ¬è¯¾ç¨‹ä¸­ï¼Œä½ å°†ä½¿ç”¨ Scikit-learn å’Œå…¶ä»–å·¥å…·æ¥æ„å»ºæœºå™¨å­¦ä¹ æ¨¡å‹ï¼Œä»¥æ‰§è¡Œæˆ‘ä»¬ç§°ä¹‹ä¸ºâ€œä¼ ç»Ÿæœºå™¨å­¦ä¹ â€çš„ä»»åŠ¡ã€‚æˆ‘ä»¬æ•…æ„é¿å¼€äº†ç¥ç»ç½‘ç»œå’Œæ·±åº¦å­¦ä¹ ï¼Œå› ä¸ºå®ƒä»¬å°†åœ¨æˆ‘ä»¬å³å°†æ¨å‡ºçš„â€œAI for Beginnersâ€è¯¾ç¨‹ä¸­æ›´å¥½åœ°è¦†ç›–ã€‚

Scikit-learn ä½¿æ„å»ºæ¨¡å‹å’Œè¯„ä¼°å®ƒä»¬çš„ä½¿ç”¨å˜å¾—ç®€å•ã€‚å®ƒä¸»è¦ä¸“æ³¨äºä½¿ç”¨æ•°å€¼æ•°æ®ï¼Œå¹¶åŒ…å«å‡ ä¸ªç°æˆçš„æ•°æ®é›†ä¾›å­¦ä¹ ä½¿ç”¨ã€‚å®ƒè¿˜åŒ…æ‹¬é¢„æ„å»ºçš„æ¨¡å‹ä¾›å­¦ç”Ÿå°è¯•ã€‚è®©æˆ‘ä»¬æ¢ç´¢ä¸€ä¸‹åŠ è½½é¢„æ‰“åŒ…æ•°æ®å’Œä½¿ç”¨å†…ç½®ä¼°ç®—å™¨æ¥æ„å»ºç¬¬ä¸€ä¸ªæœºå™¨å­¦ä¹ æ¨¡å‹çš„è¿‡ç¨‹ã€‚

## ç»ƒä¹  - ä½ çš„ç¬¬ä¸€ä¸ª Scikit-learn ç¬”è®°æœ¬

> æœ¬æ•™ç¨‹çš„çµæ„Ÿæ¥è‡ª Scikit-learn ç½‘ç«™ä¸Šçš„ [çº¿æ€§å›å½’ç¤ºä¾‹](https://scikit-learn.org/stable/auto_examples/linear_model/plot_ols.html#sphx-glr-auto-examples-linear-model-plot-ols-py)ã€‚

[![æœºå™¨å­¦ä¹ åˆå­¦è€… - ä½ çš„ç¬¬ä¸€ä¸ª Python çº¿æ€§å›å½’é¡¹ç›®](https://img.youtube.com/vi/2xkXL5EUpS0/0.jpg)](https://youtu.be/2xkXL5EUpS0 "æœºå™¨å­¦ä¹ åˆå­¦è€… - ä½ çš„ç¬¬ä¸€ä¸ª Python çº¿æ€§å›å½’é¡¹ç›®")

> ğŸ¥ ç‚¹å‡»ä¸Šé¢çš„å›¾ç‰‡è§‚çœ‹ä¸€ä¸ªç®€çŸ­çš„è§†é¢‘ï¼Œäº†è§£å¦‚ä½•è¿›è¡Œæ­¤ç»ƒä¹ ã€‚

åœ¨ä¸æœ¬è¯¾ç›¸å…³çš„ _notebook.ipynb_ æ–‡ä»¶ä¸­ï¼ŒæŒ‰ä¸‹â€œåƒåœ¾æ¡¶â€å›¾æ ‡æ¸…é™¤æ‰€æœ‰å•å…ƒæ ¼ã€‚

åœ¨æœ¬èŠ‚ä¸­ï¼Œä½ å°†ä½¿ç”¨ä¸€ä¸ªå†…ç½®äº Scikit-learn ä¸­çš„å°æ•°æ®é›†ï¼Œå…³äºç³–å°¿ç—…ã€‚å‡è®¾ä½ æƒ³æµ‹è¯•ä¸€ç§ç³–å°¿ç—…æ‚£è€…çš„æ²»ç–—æ–¹æ³•ã€‚æœºå™¨å­¦ä¹ æ¨¡å‹å¯ä»¥å¸®åŠ©ä½ ç¡®å®šå“ªäº›æ‚£è€…åœ¨ä¸åŒå˜é‡ç»„åˆä¸‹å¯¹æ²»ç–—ååº”æ›´å¥½ã€‚å³ä½¿æ˜¯ä¸€ä¸ªéå¸¸åŸºæœ¬çš„å›å½’æ¨¡å‹ï¼Œå½“å¯è§†åŒ–æ—¶ï¼Œä¹Ÿå¯èƒ½æ˜¾ç¤ºå‡ºå…³äºå˜é‡çš„ä¿¡æ¯ï¼Œè¿™äº›ä¿¡æ¯å¯ä»¥å¸®åŠ©ä½ ç»„ç»‡ç†è®ºä¸Šçš„ä¸´åºŠè¯•éªŒã€‚

âœ… å›å½’æ–¹æ³•æœ‰å¾ˆå¤šç§ï¼Œé€‰æ‹©å“ªä¸€ç§å–å†³äºä½ è¦å›ç­”çš„é—®é¢˜ã€‚å¦‚æœä½ æƒ³é¢„æµ‹ä¸€ä¸ªç‰¹å®šå¹´é¾„çš„äººçš„å¯èƒ½èº«é«˜ï¼Œä½ ä¼šä½¿ç”¨çº¿æ€§å›å½’ï¼Œå› ä¸ºä½ åœ¨å¯»æ‰¾ä¸€ä¸ª**æ•°å€¼å€¼**ã€‚å¦‚æœä½ æƒ³çŸ¥é“æŸç§èœè‚´æ˜¯å¦åº”è¯¥è¢«è®¤ä¸ºæ˜¯ç´ é£Ÿï¼Œä½ åœ¨å¯»æ‰¾ä¸€ä¸ª**ç±»åˆ«åˆ†é…**ï¼Œå› æ­¤ä½ ä¼šä½¿ç”¨é€»è¾‘å›å½’ã€‚ä½ ç¨åä¼šå­¦ä¹ æ›´å¤šå…³äºé€»è¾‘å›å½’çš„å†…å®¹ã€‚æƒ³ä¸€æƒ³ä½ å¯ä»¥å‘æ•°æ®æå‡ºçš„ä¸€äº›é—®é¢˜ï¼Œä»¥åŠå“ªç§æ–¹æ³•æ›´åˆé€‚ã€‚

è®©æˆ‘ä»¬å¼€å§‹è¿™ä¸ªä»»åŠ¡ã€‚

### å¯¼å…¥åº“

å¯¹äºè¿™ä¸ªä»»åŠ¡ï¼Œæˆ‘ä»¬å°†å¯¼å…¥ä¸€äº›åº“ï¼š

- **matplotlib**ã€‚è¿™æ˜¯ä¸€ä¸ªæœ‰ç”¨çš„ [ç»˜å›¾å·¥å…·](https://matplotlib.org/)ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨å®ƒæ¥åˆ›å»ºæŠ˜çº¿å›¾ã€‚
- **numpy**ã€‚ [numpy](https://numpy.org/doc/stable/user/whatisnumpy.html) æ˜¯ä¸€ä¸ªå¤„ç† Python æ•°å€¼æ•°æ®çš„æœ‰ç”¨åº“ã€‚
- **sklearn**ã€‚è¿™æ˜¯ [Scikit-learn](https://scikit-learn.org/stable/user_guide.html) åº“ã€‚

å¯¼å…¥ä¸€äº›åº“æ¥å¸®åŠ©ä½ å®Œæˆä»»åŠ¡ã€‚

1. é€šè¿‡è¾“å…¥ä»¥ä¸‹ä»£ç æ·»åŠ å¯¼å…¥ï¼š

   ```python
   import matplotlib.pyplot as plt
   import numpy as np
   from sklearn import datasets, linear_model, model_selection
   ```

   ä¸Šé¢ä½ æ­£åœ¨å¯¼å…¥ `matplotlib`, `numpy` and you are importing `datasets`, `linear_model` and `model_selection` from `sklearn`. `model_selection` is used for splitting data into training and test sets.

### The diabetes dataset

The built-in [diabetes dataset](https://scikit-learn.org/stable/datasets/toy_dataset.html#diabetes-dataset) includes 442 samples of data around diabetes, with 10 feature variables, some of which include:

- age: age in years
- bmi: body mass index
- bp: average blood pressure
- s1 tc: T-Cells (a type of white blood cells)

âœ… This dataset includes the concept of 'sex' as a feature variable important to research around diabetes. Many medical datasets include this type of binary classification. Think a bit about how categorizations such as this might exclude certain parts of a population from treatments.

Now, load up the X and y data.

> ğŸ“ Remember, this is supervised learning, and we need a named 'y' target.

In a new code cell, load the diabetes dataset by calling `load_diabetes()`. The input `return_X_y=True` signals that `X` will be a data matrix, and `y` å°†æ˜¯å›å½’ç›®æ ‡ã€‚

1. æ·»åŠ ä¸€äº›æ‰“å°å‘½ä»¤ä»¥æ˜¾ç¤ºæ•°æ®çŸ©é˜µçš„å½¢çŠ¶åŠå…¶ç¬¬ä¸€ä¸ªå…ƒç´ ï¼š

    ```python
    X, y = datasets.load_diabetes(return_X_y=True)
    print(X.shape)
    print(X[0])
    ```

    ä½ å¾—åˆ°çš„å“åº”æ˜¯ä¸€ä¸ªå…ƒç»„ã€‚ä½ æ‰€åšçš„æ˜¯å°†å…ƒç»„çš„å‰ä¸¤ä¸ªå€¼åˆ†åˆ«åˆ†é…ç»™ `X` and `y`ã€‚äº†è§£æ›´å¤š [å…³äºå…ƒç»„](https://wikipedia.org/wiki/Tuple)ã€‚

    ä½ å¯ä»¥çœ‹åˆ°è¿™ä¸ªæ•°æ®æœ‰ 442 ä¸ªé¡¹ç›®ï¼Œå½¢çŠ¶ä¸º 10 ä¸ªå…ƒç´ çš„æ•°ç»„ï¼š

    ```text
    (442, 10)
    [ 0.03807591  0.05068012  0.06169621  0.02187235 -0.0442235  -0.03482076
    -0.04340085 -0.00259226  0.01990842 -0.01764613]
    ```

    âœ… æƒ³ä¸€æƒ³æ•°æ®å’Œå›å½’ç›®æ ‡ä¹‹é—´çš„å…³ç³»ã€‚çº¿æ€§å›å½’é¢„æµ‹ç‰¹å¾ X å’Œç›®æ ‡å˜é‡ y ä¹‹é—´çš„å…³ç³»ã€‚ä½ èƒ½åœ¨æ–‡æ¡£ä¸­æ‰¾åˆ°ç³–å°¿ç—…æ•°æ®é›†çš„ [ç›®æ ‡](https://scikit-learn.org/stable/datasets/toy_dataset.html#diabetes-dataset) å—ï¼Ÿè€ƒè™‘åˆ°ç›®æ ‡ï¼Œè¿™ä¸ªæ•°æ®é›†åœ¨å±•ç¤ºä»€ä¹ˆï¼Ÿ

2. æ¥ä¸‹æ¥ï¼Œé€šè¿‡é€‰æ‹©æ•°æ®é›†çš„ç¬¬ 3 åˆ—æ¥ç»˜åˆ¶ä¸€éƒ¨åˆ†æ•°æ®ã€‚ä½ å¯ä»¥é€šè¿‡ä½¿ç”¨ `:` operator to select all rows, and then selecting the 3rd column using the index (2). You can also reshape the data to be a 2D array - as required for plotting - by using `reshape(n_rows, n_columns)` æ¥å®ç°ã€‚å¦‚æœå…¶ä¸­ä¸€ä¸ªå‚æ•°ä¸º -1ï¼Œåˆ™è‡ªåŠ¨è®¡ç®—ç›¸åº”çš„ç»´åº¦ã€‚

   ```python
   X = X[:, 2]
   X = X.reshape((-1,1))
   ```

   âœ… éšæ—¶æ‰“å°å‡ºæ•°æ®ä»¥æ£€æŸ¥å…¶å½¢çŠ¶ã€‚

3. ç°åœ¨ä½ å·²ç»å‡†å¤‡å¥½è¦ç»˜åˆ¶çš„æ•°æ®ï¼Œå¯ä»¥çœ‹çœ‹æœºå™¨æ˜¯å¦èƒ½å¸®åŠ©ç¡®å®šæ­¤æ•°æ®é›†ä¸­æ•°å­—ä¹‹é—´çš„é€»è¾‘åˆ†å‰²ã€‚ä¸ºæ­¤ï¼Œä½ éœ€è¦å°†æ•°æ®ï¼ˆXï¼‰å’Œç›®æ ‡ï¼ˆyï¼‰åˆ†æˆæµ‹è¯•é›†å’Œè®­ç»ƒé›†ã€‚Scikit-learn æœ‰ä¸€ä¸ªç®€å•çš„æ–¹æ³•æ¥åšåˆ°è¿™ä¸€ç‚¹ï¼›ä½ å¯ä»¥åœ¨ç»™å®šç‚¹åˆ†å‰²æµ‹è¯•æ•°æ®ã€‚

   ```python
   X_train, X_test, y_train, y_test = model_selection.train_test_split(X, y, test_size=0.33)
   ```

4. ç°åœ¨ä½ å‡†å¤‡å¥½è®­ç»ƒä½ çš„æ¨¡å‹äº†ï¼åŠ è½½çº¿æ€§å›å½’æ¨¡å‹ï¼Œå¹¶ä½¿ç”¨ `model.fit()` è®­ç»ƒä½ çš„ X å’Œ y è®­ç»ƒé›†ï¼š

    ```python
    model = linear_model.LinearRegression()
    model.fit(X_train, y_train)
    ```

    âœ… `model.fit()` is a function you'll see in many ML libraries such as TensorFlow

5. Then, create a prediction using test data, using the function `predict()`ã€‚è¿™å°†ç”¨äºåœ¨æ•°æ®ç»„ä¹‹é—´ç”»çº¿

    ```python
    y_pred = model.predict(X_test)
    ```

6. ç°åœ¨æ˜¯æ—¶å€™åœ¨å›¾ä¸­æ˜¾ç¤ºæ•°æ®äº†ã€‚Matplotlib æ˜¯å®Œæˆæ­¤ä»»åŠ¡çš„éå¸¸æœ‰ç”¨çš„å·¥å…·ã€‚åˆ›å»ºæ‰€æœ‰ X å’Œ y æµ‹è¯•æ•°æ®çš„æ•£ç‚¹å›¾ï¼Œå¹¶ä½¿ç”¨é¢„æµ‹åœ¨æ¨¡å‹çš„æ•°æ®ç»„ä¹‹é—´çš„æœ€åˆé€‚ä½ç½®ç”»ä¸€æ¡çº¿ã€‚

    ```python
    plt.scatter(X_test, y_test,  color='black')
    plt.plot(X_test, y_pred, color='blue', linewidth=3)
    plt.xlabel('Scaled BMIs')
    plt.ylabel('Disease Progression')
    plt.title('A Graph Plot Showing Diabetes Progression Against BMI')
    plt.show()
    ```

   ![æ˜¾ç¤ºç³–å°¿ç—…æ•°æ®ç‚¹çš„æ•£ç‚¹å›¾](../../../../translated_images/scatterplot.ad8b356bcbb33be68d54050e09b9b7bfc03e94fde7371f2609ae43f4c563b2d7.zh.png)

   âœ… æƒ³ä¸€æƒ³è¿™é‡Œå‘ç”Ÿäº†ä»€ä¹ˆã€‚ä¸€æ¡ç›´çº¿ç©¿è¿‡è®¸å¤šå°æ•°æ®ç‚¹ï¼Œä½†å®ƒåˆ°åº•åœ¨åšä»€ä¹ˆï¼Ÿä½ èƒ½çœ‹åˆ°å¦‚ä½•ä½¿ç”¨è¿™æ¡çº¿æ¥é¢„æµ‹ä¸€ä¸ªæ–°çš„ã€æœªè§è¿‡çš„æ•°æ®ç‚¹åœ¨å›¾çš„ y è½´ä¸Šçš„ä½ç½®å—ï¼Ÿè¯•ç€ç”¨è¯­è¨€æè¿°è¿™ä¸ªæ¨¡å‹çš„å®é™…ç”¨é€”ã€‚

æ­å–œä½ ï¼Œä½ æ„å»ºäº†ä½ çš„ç¬¬ä¸€ä¸ªçº¿æ€§å›å½’æ¨¡å‹ï¼Œç”¨å®ƒè¿›è¡Œäº†é¢„æµ‹ï¼Œå¹¶åœ¨å›¾ä¸­æ˜¾ç¤ºäº†å®ƒï¼

---
## ğŸš€æŒ‘æˆ˜

ç»˜åˆ¶æ­¤æ•°æ®é›†çš„ä¸åŒå˜é‡ã€‚æç¤ºï¼šç¼–è¾‘è¿™è¡Œï¼š`X = X[:,2]`ã€‚è€ƒè™‘åˆ°è¿™ä¸ªæ•°æ®é›†çš„ç›®æ ‡ï¼Œä½ èƒ½å‘ç°ç³–å°¿ç—…ä½œä¸ºä¸€ç§ç–¾ç—…çš„è¿›å±•æƒ…å†µå—ï¼Ÿ
## [è¯¾åæµ‹éªŒ](https://gray-sand-07a10f403.1.azurestaticapps.net/quiz/10/)

## å¤ä¹ ä¸è‡ªå­¦

åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œä½ ä½¿ç”¨äº†ç®€å•çº¿æ€§å›å½’ï¼Œè€Œä¸æ˜¯å•å˜é‡æˆ–å¤šå˜é‡çº¿æ€§å›å½’ã€‚é˜…è¯»ä¸€ä¸‹è¿™äº›æ–¹æ³•ä¹‹é—´çš„åŒºåˆ«ï¼Œæˆ–è€…çœ‹çœ‹ [è¿™ä¸ªè§†é¢‘](https://www.coursera.org/lecture/quantifying-relationships-regression-models/linear-vs-nonlinear-categorical-variables-ai2Ef)ã€‚

é˜…è¯»æ›´å¤šå…³äºå›å½’æ¦‚å¿µçš„å†…å®¹ï¼Œå¹¶æ€è€ƒå¯ä»¥ç”¨è¿™ç§æŠ€æœ¯å›ç­”å“ªäº›é—®é¢˜ã€‚å‚åŠ è¿™ä¸ª [æ•™ç¨‹](https://docs.microsoft.com/learn/modules/train-evaluate-regression-models?WT.mc_id=academic-77952-leestott) ä»¥åŠ æ·±ç†è§£ã€‚

## ä½œä¸š

[ä¸åŒçš„æ•°æ®é›†](assignment.md)

**å…è´£å£°æ˜**:
æœ¬æ–‡æ¡£æ˜¯ä½¿ç”¨æœºå™¨ç¿»è¯‘æœåŠ¡ç¿»è¯‘çš„ã€‚å°½ç®¡æˆ‘ä»¬åŠªåŠ›ç¡®ä¿å‡†ç¡®æ€§ï¼Œä½†è¯·æ³¨æ„ï¼Œè‡ªåŠ¨ç¿»è¯‘å¯èƒ½åŒ…å«é”™è¯¯æˆ–ä¸å‡†ç¡®ä¹‹å¤„ã€‚åº”å°†åŸå§‹è¯­è¨€çš„æ–‡æ¡£è§†ä¸ºæƒå¨æ¥æºã€‚å¯¹äºå…³é”®ä¿¡æ¯ï¼Œå»ºè®®ä½¿ç”¨ä¸“ä¸šäººå·¥ç¿»è¯‘ã€‚å¯¹äºå› ä½¿ç”¨æ­¤ç¿»è¯‘è€Œå¼•èµ·çš„ä»»ä½•è¯¯è§£æˆ–è¯¯è¯»ï¼Œæˆ‘ä»¬ä¸æ‰¿æ‹…è´£ä»»ã€‚