<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "917dbf890db71a322f306050cb284749",
  "translation_date": "2025-09-06T06:28:10+00:00",
  "source_file": "7-TimeSeries/2-ARIMA/README.md",
  "language_code": "ne"
}
-->
# ARIMA рд╕рдБрдЧ рд╕рдордп рд╢реНрд░реГрдВрдЦрд▓рд╛ рдкреВрд░реНрд╡рд╛рдиреБрдорд╛рди

рдЕрдШрд┐рд▓реНрд▓реЛ рдкрд╛рдардорд╛, рддрдкрд╛рдИрдВрд▓реЗ рд╕рдордп рд╢реНрд░реГрдВрдЦрд▓рд╛ рдкреВрд░реНрд╡рд╛рдиреБрдорд╛рдирдХреЛ рдмрд╛рд░реЗрдорд╛ рдХреЗрд╣реА рд╕рд┐рдХреНрдиреБрднрдпреЛ рд░ рд╡рд┐рджреНрдпреБрдд рд▓реЛрдбрдХреЛ рд╕рдордп рдЕрд╡рдзрд┐рдорд╛ рд╣реБрдиреЗ рдЙрддрд╛рд░-рдЪрдврд╝рд╛рд╡ рджреЗрдЦрд╛рдЙрдиреЗ рдбреЗрдЯрд╛рд╕реЗрдЯ рд▓реЛрдб рдЧрд░реНрдиреБрднрдпреЛред

[![ARIMA рдХреЛ рдкрд░рд┐рдЪрдп](https://img.youtube.com/vi/IUSk-YDau10/0.jpg)](https://youtu.be/IUSk-YDau10 "ARIMA рдХреЛ рдкрд░рд┐рдЪрдп")

> ЁЯОе рдорд╛рдерд┐рдХреЛ рддрд╕реНрдмрд┐рд░рдорд╛ рдХреНрд▓рд┐рдХ рдЧрд░реНрдиреБрд╣реЛрд╕реН: ARIMA рдореЛрдбреЗрд▓рд╣рд░реВрдХреЛ рдЫреЛрдЯреЛ рдкрд░рд┐рдЪрдпред рдпреЛ рдЙрджрд╛рд╣рд░рдг R рдорд╛ рдЧрд░рд┐рдПрдХреЛ рдЫ, рддрд░ рдЕрд╡рдзрд╛рд░рдгрд╛рд╣рд░реВ рд╕рдмреИ рдард╛рдЙрдБрдорд╛ рд▓рд╛рдЧреВ рд╣реБрдиреНрдЫрдиреНред

## [рдкрд╛рдардкреВрд░реНрд╡ рдкреНрд░рд╢реНрдиреЛрддреНрддрд░реА](https://ff-quizzes.netlify.app/en/ml/)

## рдкрд░рд┐рдЪрдп

рдпрд╕ рдкрд╛рдардорд╛, рддрдкрд╛рдИрдВ [ARIMA: *A*uto*R*egressive *I*ntegrated *M*oving *A*verage](https://wikipedia.org/wiki/Autoregressive_integrated_moving_average) рдкреНрд░рдпреЛрдЧ рдЧрд░реЗрд░ рдореЛрдбреЗрд▓ рдирд┐рд░реНрдорд╛рдг рдЧрд░реНрдиреЗ рдПрдХ рд╡рд┐рд╢реЗрд╖ рддрд░рд┐рдХрд╛ рдкрддреНрддрд╛ рд▓рдЧрд╛рдЙрдиреБрд╣реБрдиреЗрдЫред ARIMA рдореЛрдбреЗрд▓рд╣рд░реВ рд╡рд┐рд╢реЗрд╖ рдЧрд░реА [рдЧреИрд░-рд╕реНрдЯреЗрд╢рдирд░реА](https://wikipedia.org/wiki/Stationary_process) рдбрд╛рдЯрд╛рд▓рд╛рдИ рдлрд┐рдЯ рдЧрд░реНрди рдЙрдкрдпреБрдХреНрдд рд╣реБрдиреНрдЫрдиреНред

## рд╕рд╛рдорд╛рдиреНрдп рдЕрд╡рдзрд╛рд░рдгрд╛рд╣рд░реВ

ARIMA рд╕рдБрдЧ рдХрд╛рдо рдЧрд░реНрди рд╕рдХреНрд╖рдо рд╣реБрди, рддрдкрд╛рдИрдВрд▓реЗ рдХреЗрд╣реА рдЕрд╡рдзрд╛рд░рдгрд╛рд╣рд░реВ рдмреБрдЭреНрди рдЖрд╡рд╢реНрдпрдХ рдЫ:

- ЁЯОУ **рд╕реНрдЯреЗрд╢рдирд░рд┐рдЯреА**ред рд╕рд╛рдВрдЦреНрдпрд┐рдХреАрдп рд╕рдиреНрджрд░реНрднрдорд╛, рд╕реНрдЯреЗрд╢рдирд░рд┐рдЯреА рднрдиреЗрдХреЛ рддреНрдпрд╕реНрддреЛ рдбрд╛рдЯрд╛ рд╣реЛ рдЬрд╕рдХреЛ рд╡рд┐рддрд░рдг рд╕рдордпрд╕рдБрдЧреИ рдкрд░рд┐рд╡рд░реНрддрди рд╣реБрдБрджреИрдиред рдЧреИрд░-рд╕реНрдЯреЗрд╢рдирд░реА рдбрд╛рдЯрд╛рд▓реЗ рдЯреНрд░реЗрдиреНрдбрдХрд╛ рдХрд╛рд░рдг рдЙрддрд╛рд░-рдЪрдврд╝рд╛рд╡ рджреЗрдЦрд╛рдЙрдБрдЫ, рдЬрд╕рд▓рд╛рдИ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдЧрд░реНрди рдкрд░рд┐рд╡рд░реНрддрди рдЧрд░реНрдиреБрдкрд░реНрдЫред рдЙрджрд╛рд╣рд░рдгрдХрд╛ рд▓рд╛рдЧрд┐, рдореМрд╕рдореАрдкрдирд▓реЗ рдбрд╛рдЯрд╛рдорд╛ рдЙрддрд╛рд░-рдЪрдврд╝рд╛рд╡ рд▓реНрдпрд╛рдЙрди рд╕рдХреНрдЫ, рдЬрд╕рд▓рд╛рдИ 'рдореМрд╕рдореА-рдбрд┐рдлрд░реЗрдиреНрд╕рд┐рдЩ' рдкреНрд░рдХреНрд░рд┐рдпрд╛рдмрд╛рдЯ рд╣рдЯрд╛рдЙрди рд╕рдХрд┐рдиреНрдЫред

- ЁЯОУ **[рдбрд┐рдлрд░реЗрдиреНрд╕рд┐рдЩ](https://wikipedia.org/wiki/Autoregressive_integrated_moving_average#Differencing)**ред рд╕рд╛рдВрдЦреНрдпрд┐рдХреАрдп рд╕рдиреНрджрд░реНрднрдорд╛, рдбрд┐рдлрд░реЗрдиреНрд╕рд┐рдЩ рднрдиреЗрдХреЛ рдЧреИрд░-рд╕реНрдЯреЗрд╢рдирд░реА рдбрд╛рдЯрд╛рд▓рд╛рдИ рд╕реНрдЯреЗрд╢рдирд░реА рдмрдирд╛рдЙрди рдЯреНрд░реЗрдиреНрдб рд╣рдЯрд╛рдЙрдиреЗ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рд╣реЛред "рдбрд┐рдлрд░реЗрдиреНрд╕рд┐рдЩрд▓реЗ рд╕рдордп рд╢реНрд░реГрдВрдЦрд▓рд╛рдХреЛ рд╕реНрддрд░рдорд╛ рд╣реБрдиреЗ рдкрд░рд┐рд╡рд░реНрддрдирд╣рд░реВ рд╣рдЯрд╛рдЙрдБрдЫ, рдЯреНрд░реЗрдиреНрдб рд░ рдореМрд╕рдореАрдкрдирд▓рд╛рдИ рд╕рдорд╛рдкреНрдд рдЧрд░реНрдЫ рд░ рдпрд╕рд░реА рд╢реНрд░реГрдВрдЦрд▓рд╛рдХреЛ рдФрд╕рддрд▓рд╛рдИ рд╕реНрдерд┐рд░ рдмрдирд╛рдЙрдБрдЫред" [Shixiong et al рдХреЛ рдкреЗрдкрд░](https://arxiv.org/abs/1904.07632)

## рд╕рдордп рд╢реНрд░реГрдВрдЦрд▓рд╛рдХреЛ рд╕рдиреНрджрд░реНрднрдорд╛ ARIMA

ARIMA рдХрд╛ рднрд╛рдЧрд╣рд░реВрд▓рд╛рдИ рд╡рд┐рд╕реНрддрд╛рд░рдорд╛ рдмреБрдЭреМрдВ рддрд╛рдХрд┐ рдпрд╕рд▓реЗ рд╕рдордп рд╢реНрд░реГрдВрдЦрд▓рд╛ рдореЛрдбреЗрд▓ рдЧрд░реНрди рд░ рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА рдЧрд░реНрди рдХрд╕рд░реА рдорджреНрджрдд рдЧрд░реНрдЫ рднрдиреНрдиреЗ рдерд╛рд╣рд╛ рдкрд╛рдЙрди рд╕рдХрд┐рдпреЛрд╕реНред

- **AR - рдЕрдЯреЛрд░реЗрдЧреНрд░реЗрд╕рд┐рднрдХреЛ рд▓рд╛рдЧрд┐**ред рдЕрдЯреЛрд░реЗрдЧреНрд░реЗрд╕рд┐рдн рдореЛрдбреЗрд▓рд╣рд░реВрд▓реЗ, рдирд╛рдорд▓реЗ рдиреИ рдЬрдирд╛рдПрдЭреИрдВ, рд╕рдордпрдХреЛ 'рдкрдЫрд╛рдбрд┐' рд╣реЗрд░реНрдЫрдиреН рд░ рдбрд╛рдЯрд╛рдХрд╛ рдЕрдШрд┐рд▓реНрд▓рд╛ рдорд╛рдирд╣рд░реВ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдЧрд░реЗрд░ рддрд┐рдирдХрд╛ рдмрд╛рд░реЗрдорд╛ рдЕрдиреБрдорд╛рди рд▓рдЧрд╛рдЙрдБрдЫрдиреНред рдпреА рдЕрдШрд┐рд▓реНрд▓рд╛ рдорд╛рдирд╣рд░реВрд▓рд╛рдИ 'рд▓рд╛рдЧреНрд╕' рднрдирд┐рдиреНрдЫред рдЙрджрд╛рд╣рд░рдгрдХрд╛ рд▓рд╛рдЧрд┐, рдорд╛рд╕рд┐рдХ рдкреЗрдиреНрд╕рд┐рд▓ рдмрд┐рдХреНрд░реА рджреЗрдЦрд╛рдЙрдиреЗ рдбрд╛рдЯрд╛ред рдкреНрд░рддреНрдпреЗрдХ рдорд╣рд┐рдирд╛рдХреЛ рдмрд┐рдХреНрд░реА рдХреБрд▓рд▓рд╛рдИ рдбрд╛рдЯрд╛рд╕реЗрдЯрдорд╛ 'рд╡рд┐рдХрд╕рд┐рдд рд╣реБрдиреЗ рднреЗрд░рд┐рдПрдмрд▓' рдорд╛рдирд┐рдиреНрдЫред рдпреЛ рдореЛрдбреЗрд▓ рдпрд╕рд░реА рдирд┐рд░реНрдорд╛рдг рдЧрд░рд┐рдиреНрдЫ рдХрд┐ "рдЪрд╛рд╕реЛрдХреЛ рд╡рд┐рдХрд╕рд┐рдд рд╣реБрдиреЗ рднреЗрд░рд┐рдПрдмрд▓рд▓рд╛рдИ рдпрд╕рдХреЛ рдЖрдлреНрдиреИ рдкрдЫрд┐рд▓реНрд▓рд╛ (рдЕрд░реНрдерд╛рддреН, рдЕрдШрд┐рд▓реНрд▓рд╛) рдорд╛рдирд╣рд░реВрдорд╛ рд░рд┐рдЧреНрд░реЗрд╕ рдЧрд░рд┐рдиреНрдЫред" [рд╡рд┐рдХрд┐рдкреАрдбрд┐рдпрд╛](https://wikipedia.org/wiki/Autoregressive_integrated_moving_average)

- **I - рдЗрдиреНрдЯрд┐рдЧреНрд░реЗрдЯреЗрдбрдХреЛ рд▓рд╛рдЧрд┐**ред рд╕рдорд╛рди 'ARMA' рдореЛрдбреЗрд▓рд╣рд░реВрдХреЛ рд╡рд┐рдкрд░реАрдд, ARIMA рдорд╛ 'I' рд▓реЗ рдпрд╕рдХреЛ *[рдЗрдиреНрдЯрд┐рдЧреНрд░реЗрдЯреЗрдб](https://wikipedia.org/wiki/Order_of_integration)* рдкрдХреНрд╖рд▓рд╛рдИ рдЬрдирд╛рдЙрдБрдЫред рдЧреИрд░-рд╕реНрдЯреЗрд╢рдирд░реАрдкрди рд╣рдЯрд╛рдЙрди рдбрд┐рдлрд░реЗрдиреНрд╕рд┐рдЩ рдЪрд░рдгрд╣рд░реВ рд▓рд╛рдЧреВ рдЧрд░реНрджрд╛ рдбрд╛рдЯрд╛рд▓рд╛рдИ 'рдЗрдиреНрдЯрд┐рдЧреНрд░реЗрдЯреЗрдб' рдЧрд░рд┐рдиреНрдЫред

- **MA - рдореБрднрд┐рдЩ рдПрднрд░реЗрдЬрдХреЛ рд▓рд╛рдЧрд┐**ред рдпрд╕ рдореЛрдбреЗрд▓рдХреЛ [рдореБрднрд┐рдЩ-рдПрднрд░реЗрдЬ](https://wikipedia.org/wiki/Moving-average_model) рдкрдХреНрд╖рд▓реЗ рд╣рд╛рд▓рдХрд╛ рд░ рдЕрдШрд┐рд▓реНрд▓рд╛ рд▓рд╛рдЧреНрд╕рдХрд╛ рдорд╛рдирд╣рд░реВрд▓рд╛рдИ рдЕрд╡рд▓реЛрдХрди рдЧрд░реЗрд░ рдирд┐рд░реНрдзрд╛рд░рдг рдЧрд░рд┐рдиреЗ рдЙрддреНрдкрд╛рджрди рднреЗрд░рд┐рдПрдмрд▓рд▓рд╛рдИ рдЬрдирд╛рдЙрдБрдЫред

рдореБрдЦреНрдп рдХреБрд░рд╛: ARIMA рд╕рдордп рд╢реНрд░реГрдВрдЦрд▓рд╛ рдбрд╛рдЯрд╛рдХреЛ рд╡рд┐рд╢реЗрд╖ рд╕реНрд╡рд░реВрдкрд▓рд╛рдИ рд╕рдХреЗрд╕рдореНрдо рдирдЬрд┐рдХрдмрд╛рдЯ рдлрд┐рдЯ рдЧрд░реНрди рдкреНрд░рдпреЛрдЧ рдЧрд░рд┐рдиреНрдЫред

## рдЕрднреНрдпрд╛рд╕ - ARIMA рдореЛрдбреЗрд▓ рдирд┐рд░реНрдорд╛рдг рдЧрд░реНрдиреБрд╣реЛрд╕реН

рдпрд╕ рдкрд╛рдардХреЛ [_/working_](https://github.com/microsoft/ML-For-Beginners/tree/main/7-TimeSeries/2-ARIMA/working) рдлреЛрд▓реНрдбрд░ рдЦреЛрд▓реНрдиреБрд╣реЛрд╕реН рд░ [_notebook.ipynb_](https://github.com/microsoft/ML-For-Beginners/blob/main/7-TimeSeries/2-ARIMA/working/notebook.ipynb) рдлрд╛рдЗрд▓ рдлреЗрд▓рд╛ рдкрд╛рд░реНрдиреБрд╣реЛрд╕реНред

1. `statsmodels` Python рд▓рд╛рдЗрдмреНрд░реЗрд░реА рд▓реЛрдб рдЧрд░реНрди рдиреЛрдЯрдмреБрдХ рдЪрд▓рд╛рдЙрдиреБрд╣реЛрд╕реН; рддрдкрд╛рдИрдВрд▓рд╛рдИ ARIMA рдореЛрдбреЗрд▓рд╣рд░реВрдХреЛ рд▓рд╛рдЧрд┐ рдпреЛ рдЖрд╡рд╢реНрдпрдХ рд╣реБрдиреЗрдЫред

1. рдЖрд╡рд╢реНрдпрдХ рд▓рд╛рдЗрдмреНрд░реЗрд░реАрд╣рд░реВ рд▓реЛрдб рдЧрд░реНрдиреБрд╣реЛрд╕реНред

1. рдЕрдм, рдбрд╛рдЯрд╛ рдкреНрд▓рдЯ рдЧрд░реНрди рдЙрдкрдпреЛрдЧреА рдердк рд▓рд╛рдЗрдмреНрд░реЗрд░реАрд╣рд░реВ рд▓реЛрдб рдЧрд░реНрдиреБрд╣реЛрд╕реН:

    ```python
    import os
    import warnings
    import matplotlib.pyplot as plt
    import numpy as np
    import pandas as pd
    import datetime as dt
    import math

    from pandas.plotting import autocorrelation_plot
    from statsmodels.tsa.statespace.sarimax import SARIMAX
    from sklearn.preprocessing import MinMaxScaler
    from common.utils import load_data, mape
    from IPython.display import Image

    %matplotlib inline
    pd.options.display.float_format = '{:,.2f}'.format
    np.set_printoptions(precision=2)
    warnings.filterwarnings("ignore") # specify to ignore warning messages
    ```

1. `/data/energy.csv` рдлрд╛рдЗрд▓рдмрд╛рдЯ рдбрд╛рдЯрд╛ Pandas рдбрд╛рдЯрд╛рдлреНрд░реЗрдордорд╛ рд▓реЛрдб рдЧрд░реНрдиреБрд╣реЛрд╕реН рд░ рд╣реЗрд░реНрдиреБрд╣реЛрд╕реН:

    ```python
    energy = load_data('./data')[['load']]
    energy.head(10)
    ```

1. рдЬрдирд╡рд░реА 2012 рджреЗрдЦрд┐ рдбрд┐рд╕реЗрдореНрдмрд░ 2014 рд╕рдореНрдордХреЛ рд╕рдмреИ рдЙрдкрд▓рдмреНрдз рдКрд░реНрдЬрд╛ рдбрд╛рдЯрд╛ рдкреНрд▓рдЯ рдЧрд░реНрдиреБрд╣реЛрд╕реНред рдХреБрдиреИ рдЖрд╢реНрдЪрд░реНрдп рд╣реБрдиреБ рд╣реБрдБрджреИрди рдХрд┐рдирднрдиреЗ рд╣рд╛рдореАрд▓реЗ рдпреЛ рдбрд╛рдЯрд╛ рдЕрдШрд┐рд▓реНрд▓реЛ рдкрд╛рдардорд╛ рджреЗрдЦрд┐рд╕рдХреЗрдХрд╛ рдЫреМрдВ:

    ```python
    energy.plot(y='load', subplots=True, figsize=(15, 8), fontsize=12)
    plt.xlabel('timestamp', fontsize=12)
    plt.ylabel('load', fontsize=12)
    plt.show()
    ```

    рдЕрдм, рдореЛрдбреЗрд▓ рдирд┐рд░реНрдорд╛рдг рдЧрд░реМрдВ!

### рдкреНрд░рд╢рд┐рдХреНрд╖рдг рд░ рдкрд░реАрдХреНрд╖рдг рдбрд╛рдЯрд╛рд╕реЗрдЯрд╣рд░реВ рд╕рд┐рд░реНрдЬрдирд╛ рдЧрд░реНрдиреБрд╣реЛрд╕реН

рдЕрдм рддрдкрд╛рдИрдВрдХреЛ рдбрд╛рдЯрд╛ рд▓реЛрдб рднрдЗрд╕рдХреЗрдХреЛ рдЫ, рддреНрдпрд╕рд▓рд╛рдИ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рд░ рдкрд░реАрдХреНрд╖рдг рд╕реЗрдЯрд╣рд░реВрдорд╛ рд╡рд┐рднрд╛рдЬрди рдЧрд░реНрдиреБрд╣реЛрд╕реНред рддрдкрд╛рдИрдВ рдЖрдлреНрдиреЛ рдореЛрдбреЗрд▓рд▓рд╛рдИ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рд╕реЗрдЯрдорд╛ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдЧрд░реНрдиреБрд╣реБрдиреЗрдЫред рд╕рд╛рдорд╛рдиреНрдпрддрдпрд╛, рдореЛрдбреЗрд▓рд▓реЗ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдкреВрд░рд╛ рдЧрд░реЗрдкрдЫрд┐, рддрдкрд╛рдИрдВ рдпрд╕рдХреЛ рд╕рдЯреАрдХрддрд╛ рдкрд░реАрдХреНрд╖рдг рд╕реЗрдЯ рдкреНрд░рдпреЛрдЧ рдЧрд░реЗрд░ рдореВрд▓реНрдпрд╛рдЩреНрдХрди рдЧрд░реНрдиреБрд╣реБрдиреЗрдЫред рддрдкрд╛рдИрдВрд▓реЗ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдЧрд░реНрдиреБрдкрд░реНрдЫ рдХрд┐ рдкрд░реАрдХреНрд╖рдг рд╕реЗрдЯрд▓реЗ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рд╕реЗрдЯрднрдиреНрджрд╛ рдкрдЫрд┐рд▓реНрд▓реЛ рд╕рдордп рдЕрд╡рдзрд┐ рд╕рдореЗрдЯреНрдЫ рддрд╛рдХрд┐ рдореЛрдбреЗрд▓рд▓реЗ рднрд╡рд┐рд╖реНрдпрдХреЛ рд╕рдордп рдЕрд╡рдзрд┐рдмрд╛рдЯ рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рд╛рдкреНрдд рдирдЧрд░реЛрд╕реНред

1. рд╕реЗрдкреНрдЯреЗрдореНрдмрд░ 1 рджреЗрдЦрд┐ рдЕрдХреНрдЯреЛрдмрд░ 31, 2014 рд╕рдореНрдордХреЛ рджреБрдИ рдорд╣рд┐рдирд╛рдХреЛ рдЕрд╡рдзрд┐ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рд╕реЗрдЯрд▓рд╛рдИ рдЫреБрдЯреНрдпрд╛рдЙрдиреБрд╣реЛрд╕реНред рдкрд░реАрдХреНрд╖рдг рд╕реЗрдЯрдорд╛ рдиреЛрднреЗрдореНрдмрд░ 1 рджреЗрдЦрд┐ рдбрд┐рд╕реЗрдореНрдмрд░ 31, 2014 рд╕рдореНрдордХреЛ рджреБрдИ рдорд╣рд┐рдирд╛рдХреЛ рдЕрд╡рдзрд┐ рд╕рдорд╛рд╡реЗрд╢ рд╣реБрдиреЗрдЫ:

    ```python
    train_start_dt = '2014-11-01 00:00:00'
    test_start_dt = '2014-12-30 00:00:00'
    ```

    рдпреЛ рдбрд╛рдЯрд╛рд▓реЗ рджреИрдирд┐рдХ рдКрд░реНрдЬрд╛ рдЦрдкрддрд▓рд╛рдИ рдкреНрд░рддрд┐рдмрд┐рдореНрдмрд┐рдд рдЧрд░реНрдиреЗ рднрдПрдХрд╛рд▓реЗ, рддреНрдпрд╣рд╛рдБ рдмрд▓рд┐рдпреЛ рдореМрд╕рдореА рдврд╛рдБрдЪрд╛ рдЫ, рддрд░ рдЦрдкрдд рд╣рд╛рд▓рдХрд╛ рджрд┐рдирд╣рд░реВрдХреЛ рдЦрдкрддрд╕рдБрдЧ рд╕рдмреИрднрдиреНрджрд╛ рдорд┐рд▓реНрджреЛрдЬреБрд▓реНрджреЛ рдЫред

1. рднрд┐рдиреНрдирддрд╛рд╣рд░реВрд▓рд╛рдИ рджреГрд╢реНрдпрд╛рддреНрдордХ рдмрдирд╛рдЙрдиреБрд╣реЛрд╕реН:

    ```python
    energy[(energy.index < test_start_dt) & (energy.index >= train_start_dt)][['load']].rename(columns={'load':'train'}) \
        .join(energy[test_start_dt:][['load']].rename(columns={'load':'test'}), how='outer') \
        .plot(y=['train', 'test'], figsize=(15, 8), fontsize=12)
    plt.xlabel('timestamp', fontsize=12)
    plt.ylabel('load', fontsize=12)
    plt.show()
    ```

    ![рдкреНрд░рд╢рд┐рдХреНрд╖рдг рд░ рдкрд░реАрдХреНрд╖рдг рдбрд╛рдЯрд╛](../../../../7-TimeSeries/2-ARIMA/images/train-test.png)

    рддреНрдпрд╕реИрд▓реЗ, рдбрд╛рдЯрд╛рд▓рд╛рдИ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рджрд┐рдирдХреЛ рд▓рд╛рдЧрд┐ рддреБрд▓рдирд╛рддреНрдордХ рд░реВрдкрдорд╛ рд╕рд╛рдиреЛ рд╕рдордпрдХреЛ рдЭреНрдпрд╛рд▓ рдкреНрд░рдпреЛрдЧ рдЧрд░реНрдиреБ рдкрд░реНрдпрд╛рдкреНрдд рд╣реБрдиреБрдкрд░реНрдЫред

    > рдиреЛрдЯ: ARIMA рдореЛрдбреЗрд▓ рдлрд┐рдЯ рдЧрд░реНрди рдкреНрд░рдпреЛрдЧ рдЧрд░рд┐рдиреЗ рдлрдВрдХреНрд╢рдирд▓реЗ рдлрд┐рдЯрд┐рдЩрдХреЛ рдХреНрд░рдордорд╛ рдЗрди-рд╕реНрдпрд╛рдореНрдкрд▓ рдорд╛рдиреНрдпрдХрд░рдг рдкреНрд░рдпреЛрдЧ рдЧрд░реНрдиреЗ рднрдПрдХрд╛рд▓реЗ, рд╣рд╛рдореА рдорд╛рдиреНрдпрдХрд░рдг рдбрд╛рдЯрд╛рд▓рд╛рдИ рдЫреЛрдбреНрдиреЗрдЫреМрдВред

### рдкреНрд░рд╢рд┐рдХреНрд╖рдгрдХреЛ рд▓рд╛рдЧрд┐ рдбрд╛рдЯрд╛ рддрдпрд╛рд░ рдЧрд░реНрдиреБрд╣реЛрд╕реН

рдЕрдм, рддрдкрд╛рдИрдВрд▓реЗ рдЖрдлреНрдиреЛ рдбрд╛рдЯрд╛рд▓рд╛рдИ рдлрд┐рд▓реНрдЯрд░ рд░ рд╕реНрдХреЗрд▓ рдЧрд░реЗрд░ рдкреНрд░рд╢рд┐рдХреНрд╖рдгрдХреЛ рд▓рд╛рдЧрд┐ рддрдпрд╛рд░ рдЧрд░реНрди рдЖрд╡рд╢реНрдпрдХ рдЫред рддрдкрд╛рдИрдВрдХреЛ рдбрд╛рдЯрд╛рд╕реЗрдЯрд▓рд╛рдИ рдЖрд╡рд╢реНрдпрдХ рд╕рдордп рдЕрд╡рдзрд┐рд╣рд░реВ рд░ рд╕реНрддрдореНрднрд╣рд░реВ рдорд╛рддреНрд░ рд╕рдорд╛рд╡реЗрд╢ рдЧрд░реНрди рдлрд┐рд▓реНрдЯрд░ рдЧрд░реНрдиреБрд╣реЛрд╕реН, рд░ рдбрд╛рдЯрд╛рд▓рд╛рдИ (0, 1) рдХреЛ рдЕрдиреНрддрд░рд╛рд▓рдорд╛ рдкреНрд░рдХреНрд╖реЗрдкрдг рдЧрд░реНрди рд╕реНрдХреЗрд▓ рдЧрд░реНрдиреБрд╣реЛрд╕реНред

1. рдореВрд▓ рдбрд╛рдЯрд╛рд╕реЗрдЯрд▓рд╛рдИ рдорд╛рдерд┐ рдЙрд▓реНрд▓рд┐рдЦрд┐рдд рд╕рдордп рдЕрд╡рдзрд┐рд╣рд░реВ рдкреНрд░рддрд┐ рд╕реЗрдЯ рд░ рдЖрд╡рд╢реНрдпрдХ рд╕реНрддрдореНрдн 'load' рд░ рдорд┐рддрд┐ рдорд╛рддреНрд░ рд╕рдорд╛рд╡реЗрд╢ рдЧрд░реНрди рдлрд┐рд▓реНрдЯрд░ рдЧрд░реНрдиреБрд╣реЛрд╕реН:

    ```python
    train = energy.copy()[(energy.index >= train_start_dt) & (energy.index < test_start_dt)][['load']]
    test = energy.copy()[energy.index >= test_start_dt][['load']]

    print('Training data shape: ', train.shape)
    print('Test data shape: ', test.shape)
    ```

    рддрдкрд╛рдИрдВ рдбрд╛рдЯрд╛рдХреЛ рдЖрдХрд╛рд░ рджреЗрдЦреНрди рд╕рдХреНрдиреБрд╣реБрдиреНрдЫ:

    ```output
    Training data shape:  (1416, 1)
    Test data shape:  (48, 1)
    ```

1. рдбрд╛рдЯрд╛рд▓рд╛рдИ (0, 1) рдХреЛ рджрд╛рдпрд░рд╛рдорд╛ рд╕реНрдХреЗрд▓ рдЧрд░реНрдиреБрд╣реЛрд╕реНред

    ```python
    scaler = MinMaxScaler()
    train['load'] = scaler.fit_transform(train)
    train.head(10)
    ```

1. рдореВрд▓ рдбрд╛рдЯрд╛ рд░ рд╕реНрдХреЗрд▓ рдЧрд░рд┐рдПрдХреЛ рдбрд╛рдЯрд╛рд▓рд╛рдИ рджреГрд╢реНрдпрд╛рддреНрдордХ рдмрдирд╛рдЙрдиреБрд╣реЛрд╕реН:

    ```python
    energy[(energy.index >= train_start_dt) & (energy.index < test_start_dt)][['load']].rename(columns={'load':'original load'}).plot.hist(bins=100, fontsize=12)
    train.rename(columns={'load':'scaled load'}).plot.hist(bins=100, fontsize=12)
    plt.show()
    ```

    ![рдореВрд▓](../../../../7-TimeSeries/2-ARIMA/images/original.png)

    > рдореВрд▓ рдбрд╛рдЯрд╛

    ![рд╕реНрдХреЗрд▓ рдЧрд░рд┐рдПрдХреЛ](../../../../7-TimeSeries/2-ARIMA/images/scaled.png)

    > рд╕реНрдХреЗрд▓ рдЧрд░рд┐рдПрдХреЛ рдбрд╛рдЯрд╛

1. рдЕрдм рддрдкрд╛рдИрдВрд▓реЗ рд╕реНрдХреЗрд▓ рдЧрд░рд┐рдПрдХреЛ рдбрд╛рдЯрд╛рд▓рд╛рдИ рдХреНрдпрд╛рд▓рд┐рдмреНрд░реЗрдЯ рдЧрд░реНрдиреБрднрдПрдХреЛ рдЫ, рддрдкрд╛рдИрдВ рдкрд░реАрдХреНрд╖рдг рдбрд╛рдЯрд╛рд▓рд╛рдИ рд╕реНрдХреЗрд▓ рдЧрд░реНрди рд╕рдХреНрдиреБрд╣реБрдиреНрдЫ:

    ```python
    test['load'] = scaler.transform(test)
    test.head()
    ```

### ARIMA рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдЧрд░реНрдиреБрд╣реЛрд╕реН

рдЕрдм ARIMA рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдЧрд░реНрдиреЗ рд╕рдордп рдЖрдПрдХреЛ рдЫ! рддрдкрд╛рдИрдВрд▓реЗ рдкрд╣рд┐рд▓реЗ рдЗрдиреНрд╕реНрдЯрд▓ рдЧрд░реНрдиреБрднрдПрдХреЛ `statsmodels` рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдкреНрд░рдпреЛрдЧ рдЧрд░реНрдиреБрд╣реЛрд╕реНред

рдЕрдм рддрдкрд╛рдИрдВрд▓реЗ рдХреЗрд╣реА рдЪрд░рдгрд╣рд░реВ рдкрд╛рд▓рдирд╛ рдЧрд░реНрдиреБрдкрд░реНрдЫ:

   1. `SARIMAX()` рдХрд▓ рдЧрд░реЗрд░ рд░ рдореЛрдбреЗрд▓рдХрд╛ рдкреНрдпрд╛рд░рд╛рдорд┐рдЯрд░рд╣рд░реВ: p, d, рд░ q рдкреНрдпрд╛рд░рд╛рдорд┐рдЯрд░рд╣рд░реВ, рд░ P, D, рд░ Q рдкреНрдпрд╛рд░рд╛рдорд┐рдЯрд░рд╣рд░реВ рдкрд╛рд╕ рдЧрд░реЗрд░ рдореЛрдбреЗрд▓ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдЧрд░реНрдиреБрд╣реЛрд╕реНред
   2. `fit()` рдлрдВрдХреНрд╢рди рдХрд▓ рдЧрд░реЗрд░ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдбрд╛рдЯрд╛рдХреЛ рд▓рд╛рдЧрд┐ рдореЛрдбреЗрд▓ рддрдпрд╛рд░ рдЧрд░реНрдиреБрд╣реЛрд╕реНред
   3. `forecast()` рдлрдВрдХреНрд╢рди рдХрд▓ рдЧрд░реЗрд░ рд░ рдкреВрд░реНрд╡рд╛рдиреБрдорд╛рди рдЧрд░реНрди рдЪрд░рдгрд╣рд░реВрдХреЛ рд╕рдВрдЦреНрдпрд╛ (рд╣реЛрд░рд╛рдЗрдЬрди) рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдЧрд░реЗрд░ рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА рдЧрд░реНрдиреБрд╣реЛрд╕реНред

> ЁЯОУ рдпреА рд╕рдмреИ рдкреНрдпрд╛рд░рд╛рдорд┐рдЯрд░рд╣рд░реВ рдХреЗрдХрд╛ рд▓рд╛рдЧрд┐ рд╣реБрдиреН? ARIMA рдореЛрдбреЗрд▓рдорд╛ 3 рд╡рдЯрд╛ рдкреНрдпрд╛рд░рд╛рдорд┐рдЯрд░рд╣рд░реВ рд╣реБрдиреНрдЫрдиреН рдЬрд╕рд▓реЗ рд╕рдордп рд╢реНрд░реГрдВрдЦрд▓рд╛рдХреЛ рдкреНрд░рдореБрдЦ рдкрдХреНрд╖рд╣рд░реВ рдореЛрдбреЗрд▓ рдЧрд░реНрди рдорджреНрджрдд рдЧрд░реНрдЫ: рдореМрд╕рдореАрдкрди, рдЯреНрд░реЗрдиреНрдб, рд░ рдЖрд╡рд╛рдЬред рдпреА рдкреНрдпрд╛рд░рд╛рдорд┐рдЯрд░рд╣рд░реВ рд╣реБрдиреН:

`p`: рдореЛрдбреЗрд▓рдХреЛ рдЕрдЯреЛ-рд░реЗрдЧреНрд░реЗрд╕рд┐рдн рдкрдХреНрд╖рд╕рдБрдЧ рд╕рдореНрдмрдиреНрдзрд┐рдд рдкреНрдпрд╛рд░рд╛рдорд┐рдЯрд░, рдЬрд╕рд▓реЗ *рдЕрдШрд┐рд▓реНрд▓рд╛* рдорд╛рдирд╣рд░реВ рд╕рдорд╛рд╡реЗрд╢ рдЧрд░реНрджрдЫред  
`d`: рдореЛрдбреЗрд▓рдХреЛ рдЗрдиреНрдЯрд┐рдЧреНрд░реЗрдЯреЗрдб рднрд╛рдЧрд╕рдБрдЧ рд╕рдореНрдмрдиреНрдзрд┐рдд рдкреНрдпрд╛рд░рд╛рдорд┐рдЯрд░, рдЬрд╕рд▓реЗ рд╕рдордп рд╢реНрд░реГрдВрдЦрд▓рд╛рдорд╛ *рдбрд┐рдлрд░реЗрдиреНрд╕рд┐рдЩ* (ЁЯОУ рдорд╛рдерд┐ рдбрд┐рдлрд░реЗрдиреНрд╕рд┐рдЩ рд╕рдореНрдЭрдиреБрд╣реЛрд╕реН ЁЯСЖ?) рдХреЛ рдорд╛рддреНрд░рд╛ рдкреНрд░рднрд╛рд╡рд┐рдд рдЧрд░реНрдЫред  
`q`: рдореЛрдбреЗрд▓рдХреЛ рдореБрднрд┐рдЩ-рдПрднрд░реЗрдЬ рднрд╛рдЧрд╕рдБрдЧ рд╕рдореНрдмрдиреНрдзрд┐рдд рдкреНрдпрд╛рд░рд╛рдорд┐рдЯрд░ред  

> рдиреЛрдЯ: рдпрджрд┐ рддрдкрд╛рдИрдВрдХреЛ рдбрд╛рдЯрд╛рдорд╛ рдореМрд╕рдореА рдкрдХреНрд╖ рдЫ - рдЬреБрди рдпрд╕рдорд╛ рдЫ - , рд╣рд╛рдореА рдореМрд╕рдореА ARIMA рдореЛрдбреЗрд▓ (SARIMA) рдкреНрд░рдпреЛрдЧ рдЧрд░реНрдЫреМрдВред рдпрд╕ рдЕрд╡рд╕реНрдерд╛рдорд╛ рддрдкрд╛рдИрдВрд▓реЗ рдЕрд░реНрдХреЛ рд╕реЗрдЯрдХрд╛ рдкреНрдпрд╛рд░рд╛рдорд┐рдЯрд░рд╣рд░реВ рдкреНрд░рдпреЛрдЧ рдЧрд░реНрдиреБрдкрд░реНрдЫ: `P`, `D`, рд░ `Q` рдЬрд╕рд▓реЗ `p`, `d`, рд░ `q` рдЬрд╕реНрддреИ рд╕рдореНрдмрдиреНрдзрд╣рд░реВ рд╡рд░реНрдгрди рдЧрд░реНрдЫрдиреН, рддрд░ рдореЛрдбреЗрд▓рдХрд╛ рдореМрд╕рдореА рдШрдЯрдХрд╣рд░реВрд╕рдБрдЧ рд╕рдореНрдмрдиреНрдзрд┐рдд рд╣реБрдиреНрдЫрдиреНред

1. рдЖрдлреНрдиреЛ рдордирдкрд░реНрдиреЗ рд╣реЛрд░рд╛рдЗрдЬрди рдорд╛рди рд╕реЗрдЯ рдЧрд░реЗрд░ рд╕реБрд░реБ рдЧрд░реНрдиреБрд╣реЛрд╕реНред 3 рдШрдгреНрдЯрд╛ рдкреНрд░рдпрд╛рд╕ рдЧрд░реМрдВ:

    ```python
    # Specify the number of steps to forecast ahead
    HORIZON = 3
    print('Forecasting horizon:', HORIZON, 'hours')
    ```

    ARIMA рдореЛрдбреЗрд▓рдХрд╛ рдкреНрдпрд╛рд░рд╛рдорд┐рдЯрд░рд╣рд░реВрдХреЛ рд▓рд╛рдЧрд┐ рдЙрддреНрддрдо рдорд╛рдирд╣рд░реВ рдЪрдпрди рдЧрд░реНрдиреБ рдЪреБрдиреМрддреАрдкреВрд░реНрдг рд╣реБрди рд╕рдХреНрдЫ рдХрд┐рдирднрдиреЗ рдпреЛ рдХреЗрд╣реА рд╣рджрд╕рдореНрдо рд╡реНрдпрдХреНрддрд┐рдкрд░рдХ рд░ рд╕рдордп рдЦрдкрдд рдЧрд░реНрдиреЗ рд╣реБрдиреНрдЫред рддрдкрд╛рдИрдВ [`pyramid` рд▓рд╛рдЗрдмреНрд░реЗрд░реА](https://alkaline-ml.com/pmdarima/0.9.0/modules/generated/pyramid.arima.auto_arima.html) рдмрд╛рдЯ `auto_arima()` рдлрдВрдХреНрд╢рди рдкреНрд░рдпреЛрдЧ рдЧрд░реНрди рд╡рд┐рдЪрд╛рд░ рдЧрд░реНрди рд╕рдХреНрдиреБрд╣реБрдиреНрдЫред

1. рдЕрд╣рд┐рд▓реЗрдХрд╛ рд▓рд╛рдЧрд┐ рд░рд╛рдореНрд░реЛ рдореЛрдбреЗрд▓ рдлреЗрд▓рд╛ рдкрд╛рд░реНрди рдХреЗрд╣реА рдореНрдпрд╛рдиреБрдЕрд▓ рдЪрдпрдирд╣рд░реВ рдкреНрд░рдпрд╛рд╕ рдЧрд░реНрдиреБрд╣реЛрд╕реНред

    ```python
    order = (4, 1, 0)
    seasonal_order = (1, 1, 0, 24)

    model = SARIMAX(endog=train, order=order, seasonal_order=seasonal_order)
    results = model.fit()

    print(results.summary())
    ```

    рдкрд░рд┐рдгрд╛рдорд╣рд░реВрдХреЛ рддрд╛рд▓рд┐рдХрд╛ рдкреНрд░рд┐рдиреНрдЯ рд╣реБрдиреНрдЫред

рддрдкрд╛рдИрдВрд▓реЗ рдЖрдлреНрдиреЛ рдкрд╣рд┐рд▓реЛ рдореЛрдбреЗрд▓ рдирд┐рд░реНрдорд╛рдг рдЧрд░реНрдиреБрднрдпреЛ! рдЕрдм рд╣рд╛рдореА рдпрд╕рд▓рд╛рдИ рдореВрд▓реНрдпрд╛рдЩреНрдХрди рдЧрд░реНрдиреЗ рддрд░рд┐рдХрд╛ рдлреЗрд▓рд╛ рдкрд╛рд░реНрди рдЖрд╡рд╢реНрдпрдХ рдЫред

### рдЖрдлреНрдиреЛ рдореЛрдбреЗрд▓ рдореВрд▓реНрдпрд╛рдЩреНрдХрди рдЧрд░реНрдиреБрд╣реЛрд╕реН

рддрдкрд╛рдИрдВрдХреЛ рдореЛрдбреЗрд▓ рдореВрд▓реНрдпрд╛рдЩреНрдХрди рдЧрд░реНрди, рддрдерд╛рдХрдерд┐рдд `walk forward` рдорд╛рдиреНрдпрдХрд░рдг рдкреНрд░рджрд░реНрд╢рди рдЧрд░реНрди рд╕рдХреНрдиреБрд╣реБрдиреНрдЫред рд╡реНрдпрд╡рд╣рд╛рд░рдорд╛, рд╕рдордп рд╢реНрд░реГрдВрдЦрд▓рд╛ рдореЛрдбреЗрд▓рд╣рд░реВ рдкреНрд░рддреНрдпреЗрдХ рдкрдЯрдХ рдирдпрд╛рдБ рдбрд╛рдЯрд╛ рдЙрдкрд▓рдмреНрдз рд╣реБрдБрджрд╛ рдкреБрди: рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдЧрд░рд┐рдиреНрдЫред рдпрд╕рд▓реЗ рдореЛрдбреЗрд▓рд▓рд╛рдИ рдкреНрд░рддреНрдпреЗрдХ рд╕рдордп рдЪрд░рдгрдорд╛ рдЙрддреНрддрдо рдкреВрд░реНрд╡рд╛рдиреБрдорд╛рди рдЧрд░реНрди рдЕрдиреБрдорддрд┐ рджрд┐рдиреНрдЫред

рдпрд╕ рдкреНрд░рд╡рд┐рдзрд┐ рдкреНрд░рдпреЛрдЧ рдЧрд░реЗрд░ рд╕рдордп рд╢реНрд░реГрдВрдЦрд▓рд╛рдХреЛ рд╕реБрд░реБрдорд╛, рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдбрд╛рдЯрд╛рд╕реЗрдЯрдорд╛ рдореЛрдбреЗрд▓ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдЧрд░реНрдиреБрд╣реЛрд╕реНред рддреНрдпрд╕рдкрдЫрд┐ рдЕрд░реНрдХреЛ рд╕рдордп рдЪрд░рдгрдорд╛ рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА рдЧрд░реНрдиреБрд╣реЛрд╕реНред рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреАрд▓рд╛рдИ рдЬреНрдЮрд╛рдд рдорд╛рдирд╕рдБрдЧ рддреБрд▓рдирд╛ рдЧрд░реЗрд░ рдореВрд▓реНрдпрд╛рдЩреНрдХрди рдЧрд░рд┐рдиреНрдЫред рддреНрдпрд╕рдкрдЫрд┐ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рд╕реЗрдЯрд▓рд╛рдИ рдЬреНрдЮрд╛рдд рдорд╛рди рд╕рдорд╛рд╡реЗрд╢ рдЧрд░реНрди рд╡рд┐рд╕реНрддрд╛рд░ рдЧрд░рд┐рдиреНрдЫ рд░ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рджреЛрд╣реЛрд░рд┐рдиреНрдЫред

> рдиреЛрдЯ: рддрдкрд╛рдИрдВрд▓реЗ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рд╕реЗрдЯрдХреЛ рдЭреНрдпрд╛рд▓рд▓рд╛рдИ рд╕реНрдерд┐рд░ рд░рд╛рдЦреНрдиреБрдкрд░реНрдЫ рддрд╛рдХрд┐ рдкреНрд░рддреНрдпреЗрдХ рдкрдЯрдХ рддрдкрд╛рдИрдВрд▓реЗ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рд╕реЗрдЯрдорд╛ рдирдпрд╛рдБ рдЕрд╡рд▓реЛрдХрди рдердкреНрджрд╛, рд╕реЗрдЯрдХреЛ рд╕реБрд░реБрдмрд╛рдЯ рдЕрд╡рд▓реЛрдХрди рд╣рдЯрд╛рдЙрдиреБрд╣реЛрд╕реНред

рдпреЛ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдореЛрдбреЗрд▓рд▓реЗ рд╡реНрдпрд╡рд╣рд╛рд░рдорд╛ рдХрд╕рд░реА рдкреНрд░рджрд░реНрд╢рди рдЧрд░реНрдиреЗрдЫ рднрдиреНрдиреЗ рдердк рдмрд▓рд┐рдпреЛ рдЕрдиреБрдорд╛рди рдкреНрд░рджрд╛рди рдЧрд░реНрджрдЫред рдпрджреНрдпрдкрд┐, рдпрд╕рд▓реЗ рдпрддрд┐ рдзреЗрд░реИ рдореЛрдбреЗрд▓рд╣рд░реВ рд╕рд┐рд░реНрдЬрдирд╛ рдЧрд░реНрдиреЗ рдХрдореНрдкреНрдпреБрдЯреЗрд╕рди рд▓рд╛рдЧрддрдорд╛ рдЖрдЙрдБрдЫред рдпрджрд┐ рдбрд╛рдЯрд╛ рд╕рд╛рдиреЛ рдЫ рд╡рд╛ рдореЛрдбреЗрд▓ рд╕рд░рд▓ рдЫ рднрдиреЗ рдпреЛ рд╕реНрд╡реАрдХрд╛рд░реНрдп рдЫ, рддрд░ рд╕реНрдХреЗрд▓рдорд╛ рд╕рдорд╕реНрдпрд╛ рд╣реБрди рд╕рдХреНрдЫред

Walk-forward рдорд╛рдиреНрдпрдХрд░рдг рд╕рдордп рд╢реНрд░реГрдВрдЦрд▓рд╛ рдореЛрдбреЗрд▓ рдореВрд▓реНрдпрд╛рдЩреНрдХрдирдХреЛ рд╕реБрдиреМрд▓реЛ рдорд╛рдирдХ рд╣реЛ рд░ рддрдкрд╛рдИрдВрдХрд╛ рдЖрдлреНрдиреИ рдкрд░рд┐рдпреЛрдЬрдирд╛рд╣рд░реВрдХрд╛ рд▓рд╛рдЧрд┐ рд╕рд┐рдлрд╛рд░рд┐рд╕ рдЧрд░рд┐рдиреНрдЫред

1. рдкреНрд░рддреНрдпреЗрдХ HORIZON рдЪрд░рдгрдХреЛ рд▓рд╛рдЧрд┐ рдкрд░реАрдХреНрд╖рдг рдбрд╛рдЯрд╛ рдкреЛрдЗрдиреНрдЯ рд╕рд┐рд░реНрдЬрдирд╛ рдЧрд░реНрдиреБрд╣реЛрд╕реНред

    ```python
    test_shifted = test.copy()

    for t in range(1, HORIZON+1):
        test_shifted['load+'+str(t)] = test_shifted['load'].shift(-t, freq='H')

    test_shifted = test_shifted.dropna(how='any')
    test_shifted.head(5)
    ```

    |            |          | load | load+1 | load+2 |  
    | ---------- | -------- | ---- | ------ | ------ |  
    | 2014-12-30 | 00:00:00 | 0.33 | 0.29   | 0.27   |  
    | 2014-12-30 | 01:00:00 | 0.29 | 0.27   | 0.27   |  
    | 2014-12-30 | 02:00:00 | 0.27 | 0.27   | 0.30   |  
    | 2014-12-30 | 03:00:00 | 0.27 | 0.30   | 0.41   |  
    | 2014-12-30 | 04:00:00 | 0.30 | 0.41   | 0.57   |  

    рдбрд╛рдЯрд╛рд▓рд╛рдИ рдпрд╕рдХреЛ рд╣реЛрд░рд╛рдЗрдЬрди рдкреЛрдЗрдиреНрдЯ рдЕрдиреБрд╕рд╛рд░ рддреЗрд░реНрд╕реЛ рд░реВрдкрдорд╛ рд╕рд┐рдлреНрдЯ рдЧрд░рд┐рдПрдХреЛ рдЫред

1. рдкрд░реАрдХреНрд╖рдг рдбрд╛рдЯрд╛рдорд╛ рд╕реНрд▓рд╛рдЗрдбрд┐рдЩ рд╡рд┐рдиреНрдбреЛ рджреГрд╖реНрдЯрд┐рдХреЛрдг рдкреНрд░рдпреЛрдЧ рдЧрд░реЗрд░ рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреАрд╣рд░реВ рдЧрд░реНрдиреБрд╣реЛрд╕реН:

    ```python
    %%time
    training_window = 720 # dedicate 30 days (720 hours) for training

    train_ts = train['load']
    test_ts = test_shifted

    history = [x for x in train_ts]
    history = history[(-training_window):]

    predictions = list()

    order = (2, 1, 0)
    seasonal_order = (1, 1, 0, 24)

    for t in range(test_ts.shape[0]):
        model = SARIMAX(endog=history, order=order, seasonal_order=seasonal_order)
        model_fit = model.fit()
        yhat = model_fit.forecast(steps = HORIZON)
        predictions.append(yhat)
        obs = list(test_ts.iloc[t])
        # move the training window
        history.append(obs[0])
        history.pop(0)
        print(test_ts.index[t])
        print(t+1, ': predicted =', yhat, 'expected =', obs)
    ```

    рддрдкрд╛рдИрдВ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рднрдЗрд░рд╣реЗрдХреЛ рд╣реЗрд░реНрди рд╕рдХреНрдиреБрд╣реБрдиреНрдЫ:

    ```output
    2014-12-30 00:00:00
    1 : predicted = [0.32 0.29 0.28] expected = [0.32945389435989236, 0.2900626678603402, 0.2739480752014323]

    2014-12-30 01:00:00
    2 : predicted = [0.3  0.29 0.3 ] expected = [0.2900626678603402, 0.2739480752014323, 0.26812891674127126]

    2014-12-30 02:00:00
    3 : predicted = [0.27 0.28 0.32] expected = [0.2739480752014323, 0.26812891674127126, 0.3025962399283795]
    ```

1. рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреАрд▓рд╛рдИ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд▓реЛрдбрд╕рдБрдЧ рддреБрд▓рдирд╛ рдЧрд░реНрдиреБрд╣реЛрд╕реН:

    ```python
    eval_df = pd.DataFrame(predictions, columns=['t+'+str(t) for t in range(1, HORIZON+1)])
    eval_df['timestamp'] = test.index[0:len(test.index)-HORIZON+1]
    eval_df = pd.melt(eval_df, id_vars='timestamp', value_name='prediction', var_name='h')
    eval_df['actual'] = np.array(np.transpose(test_ts)).ravel()
    eval_df[['prediction', 'actual']] = scaler.inverse_transform(eval_df[['prediction', 'actual']])
    eval_df.head()
    ```

    рдЖрдЙрдЯрдкреБрдЯ  
    |     |            | timestamp | h   | prediction | actual   |  
    | --- | ---------- | --------- | --- | ---------- | -------- |  
    | 0   | 2014-12-30 | 00:00:00  | t+1 | 3,008.74   | 3,023.00 |  
    | 1   | 2014-12-30 | 01:00:00  | t+1 | 2,955.53   | 2,935.00 |  
    | 2   | 2014-12-30 | 02:00:00  | t+1 | 2,900.17   | 2,899.00 |  
    | 3   | 2014-12-30 | 03:00:00  | t+1 | 2,917.69   | 2,886.00 |  
    | 4   | 2014-12-30 | 04:00:00  | t+1 | 2,946.99   | 2,963.00 |  

    рдШрдгреНрдЯрд╛рдХреЛ рдбрд╛рдЯрд╛рдХреЛ рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреАрд▓рд╛рдИ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд▓реЛрдбрд╕рдБрдЧ рддреБрд▓рдирд╛ рдЧрд░реНрдиреБрд╣реЛрд╕реНред рдпреЛ рдХрддреНрддрд┐рдХреЛ рд╕рдЯреАрдХ рдЫ?

### рдореЛрдбреЗрд▓рдХреЛ рд╕рдЯреАрдХрддрд╛ рдЬрд╛рдБрдЪ рдЧрд░реНрдиреБрд╣реЛрд╕реН

рддрдкрд╛рдИрдВрдХреЛ рдореЛрдбреЗрд▓рдХреЛ рд╕рдЯреАрдХрддрд╛ рдЬрд╛рдБрдЪ рдЧрд░реНрди рдпрд╕рдХреЛ рд╕рдмреИ рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреАрд╣рд░реВрдХреЛ рдФрд╕рдд рдкреНрд░рддрд┐рд╢рдд рддреНрд░реБрдЯрд┐ (MAPE) рдкрд░реАрдХреНрд╖рдг рдЧрд░реНрдиреБрд╣реЛрд╕реНред
> **ЁЯзо рдЧрдгрдирд╛ рджреЗрдЦрд╛рдЙрдиреБрд╣реЛрд╕реН**
>
> ![MAPE](../../../../7-TimeSeries/2-ARIMA/images/mape.png)
>
> [MAPE](https://www.linkedin.com/pulse/what-mape-mad-msd-time-series-allameh-statistics/) рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреАрдХреЛ рд╕рдЯреАрдХрддрд╛ рджреЗрдЦрд╛рдЙрди рдкреНрд░рдпреЛрдЧ рдЧрд░рд┐рдиреНрдЫ, рдЬреБрди рдорд╛рдерд┐рдХреЛ рд╕реВрддреНрд░рджреНрд╡рд╛рд░рд╛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдЕрдиреБрдкрд╛рдд рд╣реЛред рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд░ рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА рдЧрд░рд┐рдПрдХреЛ рдмреАрдЪрдХреЛ рднрд┐рдиреНрдирддрд╛рд▓рд╛рдИ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдорд╛рдирдмрд╛рдЯ рднрд╛рдЧ рд▓рдЧрд╛рдЗрдиреНрдЫред 
>
> "рдпрд╕ рдЧрдгрдирд╛рдорд╛ рд▓рд┐рдЗрдПрдХреЛ рдкрд░рд┐рдорд╛рдгрдХреЛ рдкреВрд░реНрдг рдорд╛рди рдкреНрд░рддреНрдпреЗрдХ рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА рдЧрд░рд┐рдПрдХреЛ рд╕рдордп рдмрд┐рдиреНрджреБрдХрд╛ рд▓рд╛рдЧрд┐ рдЬреЛрдбрд┐рдиреНрдЫ рд░ рдлрд┐рдЯ рдЧрд░рд┐рдПрдХрд╛ рдмрд┐рдиреНрджреБрд╣рд░реВрдХреЛ рд╕рдВрдЦреНрдпрд╛ n рдмрд╛рдЯ рднрд╛рдЧ рд▓рдЧрд╛рдЗрдиреНрдЫред" [wikipedia](https://wikipedia.org/wiki/Mean_absolute_percentage_error)
1. рдХреЛрдбрдорд╛ рд╕рдореАрдХрд░рдг рд╡реНрдпрдХреНрдд рдЧрд░реНрдиреБрд╣реЛрд╕реН:

    ```python
    if(HORIZON > 1):
        eval_df['APE'] = (eval_df['prediction'] - eval_df['actual']).abs() / eval_df['actual']
        print(eval_df.groupby('h')['APE'].mean())
    ```

1. рдПрдХ рдЪрд░рдгрдХреЛ MAPE рдЧрдгрдирд╛ рдЧрд░реНрдиреБрд╣реЛрд╕реН:

    ```python
    print('One step forecast MAPE: ', (mape(eval_df[eval_df['h'] == 't+1']['prediction'], eval_df[eval_df['h'] == 't+1']['actual']))*100, '%')
    ```

    рдПрдХ рдЪрд░рдгрдХреЛ рдкреВрд░реНрд╡рд╛рдиреБрдорд╛рди MAPE:  0.5570581332313952 %

1. рдмрд╣реБ-рдЪрд░рдгрдХреЛ рдкреВрд░реНрд╡рд╛рдиреБрдорд╛рди MAPE рдкреНрд░рд┐рдиреНрдЯ рдЧрд░реНрдиреБрд╣реЛрд╕реН:

    ```python
    print('Multi-step forecast MAPE: ', mape(eval_df['prediction'], eval_df['actual'])*100, '%')
    ```

    ```output
    Multi-step forecast MAPE:  1.1460048657704118 %
    ```

    рд░рд╛рдореНрд░реЛ рдХрдо рд╕рдВрдЦреНрдпрд╛ рдЙрддреНрддрдо рд╣реБрдиреНрдЫ: рд╡рд┐рдЪрд╛рд░ рдЧрд░реНрдиреБрд╣реЛрд╕реН рдХрд┐ 10 рдХреЛ MAPE рднрдПрдХреЛ рдкреВрд░реНрд╡рд╛рдиреБрдорд╛рди 10% рд▓реЗ рдЧрд▓рдд рдЫред

1. рддрд░ рд╕рдзреИрдВрдЭреИрдВ, рдпрд╕реНрддреЛ рд╕рдЯреАрдХрддрд╛ рдорд╛рдкрдирд▓рд╛рдИ рджреГрд╢реНрдпрд╛рддреНрдордХ рд░реВрдкрдорд╛ рд╣реЗрд░реНрди рд╕рдЬрд┐рд▓реЛ рд╣реБрдиреНрдЫ, рддреНрдпрд╕реИрд▓реЗ рдпрд╕рд▓рд╛рдИ рдкреНрд▓рдЯ рдЧрд░реМрдВ:

    ```python
     if(HORIZON == 1):
        ## Plotting single step forecast
        eval_df.plot(x='timestamp', y=['actual', 'prediction'], style=['r', 'b'], figsize=(15, 8))

    else:
        ## Plotting multi step forecast
        plot_df = eval_df[(eval_df.h=='t+1')][['timestamp', 'actual']]
        for t in range(1, HORIZON+1):
            plot_df['t+'+str(t)] = eval_df[(eval_df.h=='t+'+str(t))]['prediction'].values

        fig = plt.figure(figsize=(15, 8))
        ax = plt.plot(plot_df['timestamp'], plot_df['actual'], color='red', linewidth=4.0)
        ax = fig.add_subplot(111)
        for t in range(1, HORIZON+1):
            x = plot_df['timestamp'][(t-1):]
            y = plot_df['t+'+str(t)][0:len(x)]
            ax.plot(x, y, color='blue', linewidth=4*math.pow(.9,t), alpha=math.pow(0.8,t))

        ax.legend(loc='best')

    plt.xlabel('timestamp', fontsize=12)
    plt.ylabel('load', fontsize=12)
    plt.show()
    ```

    ![рдПрдХ рд╕рдордп рд╢реНрд░реГрдВрдЦрд▓рд╛ рдореЛрдбреЗрд▓](../../../../7-TimeSeries/2-ARIMA/images/accuracy.png)

ЁЯПЖ рдПрдХрджрдо рд░рд╛рдореНрд░реЛ рдкреНрд▓рдЯ, рдЬрд╕рд▓реЗ рд░рд╛рдореНрд░реЛ рд╕рдЯреАрдХрддрд╛ рднрдПрдХреЛ рдореЛрдбреЗрд▓ рджреЗрдЦрд╛рдЙрдБрдЫред рд░рд╛рдореНрд░реЛ рдХрд╛рдо!

---

## ЁЯЪАрдЪреБрдиреМрддреА

рд╕рдордп рд╢реНрд░реГрдВрдЦрд▓рд╛ рдореЛрдбреЗрд▓рдХреЛ рд╕рдЯреАрдХрддрд╛ рдкрд░реАрдХреНрд╖рдг рдЧрд░реНрдиреЗ рддрд░рд┐рдХрд╛рд╣рд░реВрдорд╛ рдЧрд╣рд┐рд░рд╛рдЗрдорд╛ рдЬрд╛рдиреБрд╣реЛрд╕реНред рдпрд╕ рдкрд╛рдардорд╛ рд╣рд╛рдореА MAPE рдХреЛ рдмрд╛рд░реЗрдорд╛ рдХреБрд░рд╛ рдЧрд░реНрдЫреМрдВ, рддрд░ рдХреЗ рдЕрдиреНрдп рд╡рд┐рдзрд┐рд╣рд░реВ рдЫрдиреН рдЬреБрди рддрдкрд╛рдИрдВ рдкреНрд░рдпреЛрдЧ рдЧрд░реНрди рд╕рдХреНрдиреБрд╣реБрдиреНрдЫ? рддрд┐рдиреАрд╣рд░реВрдХреЛ рдЕрдиреБрд╕рдиреНрдзрд╛рди рдЧрд░реНрдиреБрд╣реЛрд╕реН рд░ рддрд┐рдиреАрд╣рд░реВрд▓рд╛рдИ рд╡реНрдпрд╛рдЦреНрдпрд╛ рдЧрд░реНрдиреБрд╣реЛрд╕реНред [рдпрд╣рд╛рдБ](https://otexts.com/fpp2/accuracy.html) рдПрдЙрдЯрд╛ рдЙрдкрдпреЛрдЧреА рджрд╕реНрддрд╛рд╡реЗрдЬ рдлреЗрд▓рд╛ рдкрд╛рд░реНрди рд╕рдХрд┐рдиреНрдЫред

## [рдкрд╛рда-рдкрдЫрд┐рдХреЛ рдкреНрд░рд╢реНрдиреЛрддреНрддрд░реА](https://ff-quizzes.netlify.app/en/ml/)

## рд╕рдореАрдХреНрд╖рд╛ рд░ рдЖрддреНрдо-рдЕрдзреНрдпрдпрди

рдпреЛ рдкрд╛рдард▓реЗ ARIMA рд╕рдБрдЧ рд╕рдордп рд╢реНрд░реГрдВрдЦрд▓рд╛ рдкреВрд░реНрд╡рд╛рдиреБрдорд╛рдирдХреЛ рдХреЗрд╡рд▓ рдЖрдзрд╛рд░рднреВрдд рдХреБрд░рд╛рд╣рд░реВ рд╕рдореЗрдЯреНрдЫред [рдпрд╕ рд░рд┐рдкреЛрдЬрд┐рдЯрд░реА](https://microsoft.github.io/forecasting/) рд░ рдпрд╕рдХреЛ рд╡рд┐рднрд┐рдиреНрди рдореЛрдбреЗрд▓ рдкреНрд░рдХрд╛рд░рд╣рд░реВрдорд╛ рдЧрд╣рд┐рд░рд╛рдЗрдорд╛ рдЬрд╛рди рд╕рдордп рд▓рд┐рдиреБрд╣реЛрд╕реН рдЕрдиреНрдп рддрд░рд┐рдХрд╛рд╣рд░реВ рд╕рд┐рдХреНрди рд╕рдордп рд╢реНрд░реГрдВрдЦрд▓рд╛ рдореЛрдбреЗрд▓рд╣рд░реВ рдирд┐рд░реНрдорд╛рдг рдЧрд░реНрдиред

## рдЕрд╕рд╛рдЗрдирдореЗрдиреНрдЯ

[рдирдпрд╛рдБ ARIMA рдореЛрдбреЗрд▓](assignment.md)

---

**рдЕрд╕реНрд╡реАрдХрд░рдг**:  
рдпреЛ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ AI рдЕрдиреБрд╡рд╛рдж рд╕реЗрд╡рд╛ [Co-op Translator](https://github.com/Azure/co-op-translator) рдкреНрд░рдпреЛрдЧ рдЧрд░реА рдЕрдиреБрд╡рд╛рдж рдЧрд░рд┐рдПрдХреЛ рд╣реЛред рд╣рд╛рдореА рдпрдерд╛рд╕рдореНрднрд╡ рд╕рдЯреАрдХрддрд╛ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдЧрд░реНрди рдкреНрд░рдпрд╛рд╕ рдЧрд░реНрдЫреМрдВ, рддрд░ рдХреГрдкрдпрд╛ рдзреНрдпрд╛рди рджрд┐рдиреБрд╣реЛрд╕реН рдХрд┐ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдЕрдиреБрд╡рд╛рджрд╣рд░реВрдорд╛ рддреНрд░реБрдЯрд┐ рд╡рд╛ рдЕрд╢реБрджреНрдзрддрд╛ рд╣реБрди рд╕рдХреНрдЫред рдпрд╕рдХреЛ рдореВрд▓ рднрд╛рд╖рд╛рдорд╛ рд░рд╣реЗрдХреЛ рдореВрд▓ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝рд▓рд╛рдИ рдЖрдзрд┐рдХрд╛рд░рд┐рдХ рд╕реНрд░реЛрдд рдорд╛рдирд┐рдиреБрдкрд░реНрдЫред рдорд╣рддреНрддреНрд╡рдкреВрд░реНрдг рдЬрд╛рдирдХрд╛рд░реАрдХрд╛ рд▓рд╛рдЧрд┐, рд╡реНрдпрд╛рд╡рд╕рд╛рдпрд┐рдХ рдорд╛рдирд╡ рдЕрдиреБрд╡рд╛рдж рд╕рд┐рдлрд╛рд░рд┐рд╕ рдЧрд░рд┐рдиреНрдЫред рдпрд╕ рдЕрдиреБрд╡рд╛рджрдХреЛ рдкреНрд░рдпреЛрдЧрдмрд╛рдЯ рдЙрддреНрдкрдиреНрди рд╣реБрдиреЗ рдХреБрдиреИ рдкрдирд┐ рдЧрд▓рддрдлрд╣рдореА рд╡рд╛ рдЧрд▓рдд рд╡реНрдпрд╛рдЦреНрдпрд╛рдХреЛ рд▓рд╛рдЧрд┐ рд╣рд╛рдореА рдЬрд┐рдореНрдореЗрд╡рд╛рд░ рд╣реБрдиреЗ рдЫреИрдиреМрдВред