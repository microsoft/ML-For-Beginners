<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "7cdd17338d9bbd7e2171c2cd462eb081",
  "translation_date": "2025-09-06T06:31:09+00:00",
  "source_file": "5-Clustering/2-K-Means/README.md",
  "language_code": "ne"
}
-->
# K-Means рдХреНрд▓рд╕реНрдЯрд░рд┐рдЩ

## [Pre-lecture quiz](https://ff-quizzes.netlify.app/en/ml/)

рдпрд╕ рдкрд╛рдардорд╛, рддрдкрд╛рдИрдВрд▓реЗ Scikit-learn рд░ рдкрд╣рд┐рд▓реЗ рдЖрдпрд╛рдд рдЧрд░рд┐рдПрдХреЛ рдирд╛рдЗрдЬреЗрд░рд┐рдпрди рд╕рдВрдЧреАрдд рдбреЗрдЯрд╛рд╕реЗрдЯ рдкреНрд░рдпреЛрдЧ рдЧрд░реЗрд░ рдХреНрд▓рд╕реНрдЯрд░рд╣рд░реВ рдХрд╕рд░реА рдмрдирд╛рдЙрдиреЗ рднрдиреНрдиреЗ рдХреБрд░рд╛ рд╕рд┐рдХреНрдиреБрд╣реБрдиреЗрдЫред рд╣рд╛рдореА рдХреНрд▓рд╕реНрдЯрд░рд┐рдЩрдХрд╛ рд▓рд╛рдЧрд┐ K-Means рдХреЛ рдЖрдзрд╛рд░рднреВрдд рдХреБрд░рд╛рд╣рд░реВ рдХрднрд░ рдЧрд░реНрдиреЗрдЫреМрдВред рдзреНрдпрд╛рди рджрд┐рдиреБрд╣реЛрд╕реН рдХрд┐, рдЬрд╕реНрддреИ рддрдкрд╛рдИрдВрд▓реЗ рдЕрдШрд┐рд▓реНрд▓реЛ рдкрд╛рдардорд╛ рд╕рд┐рдХреНрдиреБрднрдпреЛ, рдХреНрд▓рд╕реНрдЯрд░рд╣рд░реВрд╕рдБрдЧ рдХрд╛рдо рдЧрд░реНрдиреЗ рдзреЗрд░реИ рддрд░рд┐рдХрд╛рд╣рд░реВ рдЫрдиреН, рд░ рддрдкрд╛рдИрдВрд▓реЗ рдкреНрд░рдпреЛрдЧ рдЧрд░реНрдиреЗ рд╡рд┐рдзрд┐ рддрдкрд╛рдИрдВрдХреЛ рдбреЗрдЯрд╛рдорд╛ рдирд┐рд░реНрднрд░ рдЧрд░реНрджрдЫред рд╣рд╛рдореА K-Means рдкреНрд░рдпрд╛рд╕ рдЧрд░реНрдиреЗрдЫреМрдВ рдХрд┐рдирдХрд┐ рдпреЛ рд╕рдмреИрднрдиреНрджрд╛ рд╕рд╛рдорд╛рдиреНрдп рдХреНрд▓рд╕реНрдЯрд░рд┐рдЩ рдкреНрд░рд╡рд┐рдзрд┐ рд╣реЛред рд╕реБрд░реБ рдЧрд░реМрдВ!

рддрдкрд╛рдИрдВрд▓реЗ рд╕рд┐рдХреНрдиреЗ рд╢рдмреНрджрд╣рд░реВ:

- рд╕рд┐рд▓реНрд╣реБрдПрдЯ рд╕реНрдХреЛрд░рд┐рдЩ
- рдПрд▓реНрдмреЛ рд╡рд┐рдзрд┐
- рдЗрдирд░реНрд╢рд┐рдпрд╛
- рднреЗрд░рд┐рдпрдиреНрд╕

## рдкрд░рд┐рдЪрдп

[K-Means Clustering](https://wikipedia.org/wiki/K-means_clustering) рд╕рд┐рдЧреНрдирд▓ рдкреНрд░реЛрд╕реЗрд╕рд┐рдЩрдХреЛ рдХреНрд╖реЗрддреНрд░рдмрд╛рдЯ рд╡реНрдпреБрддреНрдкрдиреНрди рд╡рд┐рдзрд┐ рд╣реЛред рдпреЛ 'k' рдХреНрд▓рд╕реНрдЯрд░рд╣рд░реВрдорд╛ рдбреЗрдЯрд╛ рд╕рдореВрд╣рд╣рд░реВ рд╡рд┐рднрд╛рдЬрди рд░ рд╡рд┐рднрд╛рдЬрди рдЧрд░реНрди рдкреНрд░рдпреЛрдЧ рдЧрд░рд┐рдиреНрдЫред рдкреНрд░рддреНрдпреЗрдХ рдЕрд╡рд▓реЛрдХрдирд▓реЗ рдХреНрд▓рд╕реНрдЯрд░рдХреЛ рдХреЗрдиреНрджреНрд░ рдмрд┐рдиреНрджреБ рд╡рд╛ 'рдореАрди' рдирдЬрд┐рдХрдХреЛ рдбреЗрдЯрд╛рдкреЛрдЗрдиреНрдЯрд▓рд╛рдИ рд╕рдореВрд╣ рдЧрд░реНрди рдХрд╛рдо рдЧрд░реНрджрдЫред

рдХреНрд▓рд╕реНрдЯрд░рд╣рд░реВрд▓рд╛рдИ [Voronoi diagrams](https://wikipedia.org/wiki/Voronoi_diagram) рдХреЛ рд░реВрдкрдорд╛ рджреЗрдЦрд╛рдЙрди рд╕рдХрд┐рдиреНрдЫ, рдЬрд╕рдорд╛ рдПрдХ рдмрд┐рдиреНрджреБ (рд╡рд╛ 'рдмреАрдЬ') рд░ рдпрд╕рдХреЛ рд╕рдореНрдмрдиреНрдзрд┐рдд рдХреНрд╖реЗрддреНрд░ рд╕рдорд╛рд╡реЗрд╢ рд╣реБрдиреНрдЫред

![voronoi diagram](../../../../5-Clustering/2-K-Means/images/voronoi.png)

> [Jen Looper](https://twitter.com/jenlooper) рджреНрд╡рд╛рд░рд╛ рдЗрдиреНрдлреЛрдЧреНрд░рд╛рдлрд┐рдХ

K-Means рдХреНрд▓рд╕реНрдЯрд░рд┐рдЩ рдкреНрд░рдХреНрд░рд┐рдпрд╛ [рддреАрди рдЪрд░рдгрдХреЛ рдкреНрд░рдХреНрд░рд┐рдпрд╛рдорд╛ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рд╣реБрдиреНрдЫ](https://scikit-learn.org/stable/modules/clustering.html#k-means):

1. рдПрд▓реНрдЧреЛрд░рд┐рджрдорд▓реЗ рдбреЗрдЯрд╛рд╕реЗрдЯрдмрд╛рдЯ рдирдореВрдирд╛ рд▓рд┐рдПрд░ k-рдирдореНрдмрд░рдХреЛ рдХреЗрдиреНрджреНрд░ рдмрд┐рдиреНрджреБ рдЪрдпрди рдЧрд░реНрджрдЫред рддреНрдпрд╕рдкрдЫрд┐ рдпреЛ рд▓реВрдк рдЧрд░реНрдЫ:
    1. рдпреЛ рдкреНрд░рддреНрдпреЗрдХ рдирдореВрдирд╛рд▓рд╛рдИ рдирдЬрд┐рдХрдХреЛ рд╕реЗрдиреНрдЯреНрд░реЛрдЗрдбрдорд╛ рдЕрд╕рд╛рдЗрди рдЧрд░реНрджрдЫред
    2. рдпреЛ рдирдпрд╛рдБ рд╕реЗрдиреНрдЯреНрд░реЛрдЗрдбрд╣рд░реВ рдмрдирд╛рдЙрдБрдЫ, рдЕрдШрд┐рд▓реНрд▓реЛ рд╕реЗрдиреНрдЯреНрд░реЛрдЗрдбрд╣рд░реВрдорд╛ рдЕрд╕рд╛рдЗрди рдЧрд░рд┐рдПрдХрд╛ рд╕рдмреИ рдирдореВрдирд╛рд╣рд░реВрдХреЛ рдФрд╕рдд рдорд╛рди рд▓рд┐рдБрджреИред
    3. рддреНрдпрд╕рдкрдЫрд┐, рдпреЛ рдирдпрд╛рдБ рд░ рдкреБрд░рд╛рдиреЛ рд╕реЗрдиреНрдЯреНрд░реЛрдЗрдбрд╣рд░реВ рдмреАрдЪрдХреЛ рднрд┐рдиреНрдирддрд╛ рдЧрдгрдирд╛ рдЧрд░реНрджрдЫ рд░ рд╕реЗрдиреНрдЯреНрд░реЛрдЗрдбрд╣рд░реВ рд╕реНрдерд┐рд░ рдирднрдПрд╕рдореНрдо рджреЛрд╣реЛрд░реНрдпрд╛рдЙрдБрдЫред

K-Means рдкреНрд░рдпреЛрдЧ рдЧрд░реНрджрд╛ рдПрдХ рдХрдордЬреЛрд░реА рднрдиреЗрдХреЛ рддрдкрд╛рдИрдВрд▓реЗ 'k' рд╕реНрдерд╛рдкрдирд╛ рдЧрд░реНрди рдЖрд╡рд╢реНрдпрдХ рдЫ, рдЕрд░реНрдерд╛рдд рд╕реЗрдиреНрдЯреНрд░реЛрдЗрдбрд╣рд░реВрдХреЛ рд╕рдВрдЦреНрдпрд╛ред рднрд╛рдЧреНрдпрд╡рд╢, 'рдПрд▓реНрдмреЛ рд╡рд┐рдзрд┐' рд▓реЗ 'k' рдХреЛ рд▓рд╛рдЧрд┐ рд░рд╛рдореНрд░реЛ рд╕реБрд░реБрд╡рд╛рдд рдорд╛рди рдЕрдиреБрдорд╛рди рдЧрд░реНрди рдорджреНрджрдд рдЧрд░реНрджрдЫред рддрдкрд╛рдИрдВрд▓реЗ рдпрд╕рд▓рд╛рдИ рдХреЗрд╣реА рд╕рдордпрдкрдЫрд┐ рдкреНрд░рдпрд╛рд╕ рдЧрд░реНрдиреБрд╣реБрдиреЗрдЫред

## рдкреВрд░реНрд╡рд╛рдкреЗрдХреНрд╖рд╛

рддрдкрд╛рдИрдВрд▓реЗ рдпрд╕ рдкрд╛рдардХреЛ [_notebook.ipynb_](https://github.com/microsoft/ML-For-Beginners/blob/main/5-Clustering/2-K-Means/notebook.ipynb) рдлрд╛рдЗрд▓рдорд╛ рдХрд╛рдо рдЧрд░реНрдиреБрд╣реБрдиреЗрдЫ рдЬрд╕рдорд╛ рдЕрдШрд┐рд▓реНрд▓реЛ рдкрд╛рдардорд╛ рдЧрд░рд┐рдПрдХреЛ рдбреЗрдЯрд╛ рдЖрдпрд╛рдд рд░ рдкреНрд░рд╛рд░рдореНрднрд┐рдХ рд╕рдлрд╛рдЗ рд╕рдорд╛рд╡реЗрд╢ рдЫред

## рдЕрднреНрдпрд╛рд╕ - рддрдпрд╛рд░реА

рдЧреАрддрд╣рд░реВрдХреЛ рдбреЗрдЯрд╛рд▓рд╛рдИ рдлреЗрд░рд┐ рд╣реЗрд░реНрди рд╕реБрд░реБ рдЧрд░реНрдиреБрд╣реЛрд╕реНред

1. рдкреНрд░рддреНрдпреЗрдХ рд╕реНрддрдореНрднрдХреЛ рд▓рд╛рдЧрд┐ `boxplot()` рдХрд▓ рдЧрд░реНрджреИ рдмрдХреНрд╕рдкреНрд▓рдЯ рдмрдирд╛рдЙрдиреБрд╣реЛрд╕реН:

    ```python
    plt.figure(figsize=(20,20), dpi=200)
    
    plt.subplot(4,3,1)
    sns.boxplot(x = 'popularity', data = df)
    
    plt.subplot(4,3,2)
    sns.boxplot(x = 'acousticness', data = df)
    
    plt.subplot(4,3,3)
    sns.boxplot(x = 'energy', data = df)
    
    plt.subplot(4,3,4)
    sns.boxplot(x = 'instrumentalness', data = df)
    
    plt.subplot(4,3,5)
    sns.boxplot(x = 'liveness', data = df)
    
    plt.subplot(4,3,6)
    sns.boxplot(x = 'loudness', data = df)
    
    plt.subplot(4,3,7)
    sns.boxplot(x = 'speechiness', data = df)
    
    plt.subplot(4,3,8)
    sns.boxplot(x = 'tempo', data = df)
    
    plt.subplot(4,3,9)
    sns.boxplot(x = 'time_signature', data = df)
    
    plt.subplot(4,3,10)
    sns.boxplot(x = 'danceability', data = df)
    
    plt.subplot(4,3,11)
    sns.boxplot(x = 'length', data = df)
    
    plt.subplot(4,3,12)
    sns.boxplot(x = 'release_date', data = df)
    ```

    рдпреЛ рдбреЗрдЯрд╛ рдЕрд▓рд┐ рдзреЗрд░реИ рд╢реЛрд░рдпреБрдХреНрдд рдЫ: рдкреНрд░рддреНрдпреЗрдХ рд╕реНрддрдореНрднрд▓рд╛рдИ рдмрдХреНрд╕рдкреНрд▓рдЯрдХреЛ рд░реВрдкрдорд╛ рдЕрд╡рд▓реЛрдХрди рдЧрд░реНрджрд╛, рддрдкрд╛рдИрдВрд▓реЗ рдЖрдЙрдЯрд▓рд╛рдпрд░реНрд╕ рджреЗрдЦреНрди рд╕рдХреНрдиреБрд╣реБрдиреНрдЫред

    ![outliers](../../../../5-Clustering/2-K-Means/images/boxplots.png)

рддрдкрд╛рдИрдВ рдбреЗрдЯрд╛рд╕реЗрдЯрдмрд╛рдЯ рдпреА рдЖрдЙрдЯрд▓рд╛рдпрд░реНрд╕ рд╣рдЯрд╛рдЙрди рд╕рдХреНрдиреБрд╣реБрдиреНрдЫ, рддрд░ рдпрд╕рд▓реЗ рдбреЗрдЯрд╛рд▓рд╛рдИ рдзреЗрд░реИ рдиреНрдпреВрдирддрдо рдмрдирд╛рдЙрдиреЗрдЫред

1. рдЕрд╣рд┐рд▓реЗрдХреЛ рд▓рд╛рдЧрд┐, рддрдкрд╛рдИрдВрд▓реЗ рдХреНрд▓рд╕реНрдЯрд░рд┐рдЩ рдЕрднреНрдпрд╛рд╕рдХреЛ рд▓рд╛рдЧрд┐ рдХреБрди рд╕реНрддрдореНрднрд╣рд░реВ рдкреНрд░рдпреЛрдЧ рдЧрд░реНрдиреЗ рдЫрдиреЛрдЯ рдЧрд░реНрдиреБрд╣реЛрд╕реНред рд╕рдорд╛рди рджрд╛рдпрд░рд╛рд╣рд░реВ рднрдПрдХрд╛ рд╕реНрддрдореНрднрд╣рд░реВ рдЪрдпрди рдЧрд░реНрдиреБрд╣реЛрд╕реН рд░ `artist_top_genre` рд╕реНрддрдореНрднрд▓рд╛рдИ рд╕рдВрдЦреНрдпрд╛рддреНрдордХ рдбреЗрдЯрд╛рдХреЛ рд░реВрдкрдорд╛ рдПрдиреНрдХреЛрдб рдЧрд░реНрдиреБрд╣реЛрд╕реН:

    ```python
    from sklearn.preprocessing import LabelEncoder
    le = LabelEncoder()
    
    X = df.loc[:, ('artist_top_genre','popularity','danceability','acousticness','loudness','energy')]
    
    y = df['artist_top_genre']
    
    X['artist_top_genre'] = le.fit_transform(X['artist_top_genre'])
    
    y = le.transform(y)
    ```

1. рдЕрдм рддрдкрд╛рдИрдВрд▓реЗ рдХрддрд┐ рдХреНрд▓рд╕реНрдЯрд░рд╣рд░реВ рд▓рдХреНрд╖рд┐рдд рдЧрд░реНрдиреЗ рдЫрдиреЛрдЯ рдЧрд░реНрди рдЖрд╡рд╢реНрдпрдХ рдЫред рддрдкрд╛рдИрдВрд▓рд╛рдИ рдерд╛рд╣рд╛ рдЫ рдХрд┐ рдбреЗрдЯрд╛рд╕реЗрдЯрдмрд╛рдЯ рд╣рд╛рдореАрд▓реЗ 3 рдЧреАрдд рд╢реИрд▓реАрд╣рд░реВ рдирд┐рдХрд╛рд▓реЗрдХрд╛ рдЫреМрдВ, рддреНрдпрд╕реИрд▓реЗ 3 рдкреНрд░рдпрд╛рд╕ рдЧрд░реМрдВ:

    ```python
    from sklearn.cluster import KMeans
    
    nclusters = 3 
    seed = 0
    
    km = KMeans(n_clusters=nclusters, random_state=seed)
    km.fit(X)
    
    # Predict the cluster for each data point
    
    y_cluster_kmeans = km.predict(X)
    y_cluster_kmeans
    ```

рддрдкрд╛рдИрдВрд▓реЗ рдбреЗрдЯрд╛ рдлреНрд░реЗрдордХреЛ рдкреНрд░рддреНрдпреЗрдХ рдкрдЩреНрдХреНрддрд┐рдХреЛ рд▓рд╛рдЧрд┐ рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА рдЧрд░рд┐рдПрдХреЛ рдХреНрд▓рд╕реНрдЯрд░рд╣рд░реВрдХреЛ (0, 1, рд╡рд╛ 2) рдПрд░реЗ рдкреНрд░рд┐рдиреНрдЯ рднрдПрдХреЛ рджреЗрдЦреНрдиреБрд╣реБрдиреНрдЫред

1. рдпреЛ рдПрд░реЗ рдкреНрд░рдпреЛрдЧ рдЧрд░реЗрд░ 'рд╕рд┐рд▓реНрд╣реБрдПрдЯ рд╕реНрдХреЛрд░' рдЧрдгрдирд╛ рдЧрд░реНрдиреБрд╣реЛрд╕реН:

    ```python
    from sklearn import metrics
    score = metrics.silhouette_score(X, y_cluster_kmeans)
    score
    ```

## рд╕рд┐рд▓реНрд╣реБрдПрдЯ рд╕реНрдХреЛрд░

рд╕рд┐рд▓реНрд╣реБрдПрдЯ рд╕реНрдХреЛрд░ 1 рдирдЬрд┐рдХ рдЦреЛрдЬреНрдиреБрд╣реЛрд╕реНред рдпреЛ рд╕реНрдХреЛрд░ -1 рджреЗрдЦрд┐ 1 рд╕рдореНрдо рдлрд░рдХ рд╣реБрдиреНрдЫ, рд░ рдпрджрд┐ рд╕реНрдХреЛрд░ 1 рдЫ рднрдиреЗ, рдХреНрд▓рд╕реНрдЯрд░ рдШрдирд╛ рд░ рдЕрдиреНрдп рдХреНрд▓рд╕реНрдЯрд░рд╣рд░реВрдмрд╛рдЯ рд░рд╛рдореНрд░реЛрд╕рдБрдЧ рдЫреБрдЯреНрдЯрд┐рдПрдХреЛ рд╣реБрдиреНрдЫред 0 рдирдЬрд┐рдХрдХреЛ рдорд╛рдирд▓реЗ рдЫрд┐рдореЗрдХреА рдХреНрд▓рд╕реНрдЯрд░рд╣рд░реВрдХреЛ рдирд┐рд░реНрдгрдп рд╕реАрдорд╛ рдирдЬрд┐рдХ рдирдореВрдирд╛рд╣рд░реВ рднрдПрдХреЛ рдУрднрд░рд▓реНрдпрд╛рдк рдХреНрд▓рд╕реНрдЯрд░рд╣рд░реВ рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдЧрд░реНрджрдЫред [(рд╕реНрд░реЛрдд)](https://dzone.com/articles/kmeans-silhouette-score-explained-with-python-exam)

рд╣рд╛рдореНрд░реЛ рд╕реНрдХреЛрд░ **.53** рдЫ, рддреНрдпрд╕реИрд▓реЗ рдареАрдХ рдмреАрдЪрдорд╛ред рдпрд╕рд▓реЗ рд╕рдВрдХреЗрдд рдЧрд░реНрджрдЫ рдХрд┐ рд╣рд╛рдореНрд░реЛ рдбреЗрдЯрд╛ рдпреЛ рдкреНрд░рдХрд╛рд░рдХреЛ рдХреНрд▓рд╕реНрдЯрд░рд┐рдЩрдХреЛ рд▓рд╛рдЧрд┐ рд╡рд┐рд╢реЗрд╖ рд░реВрдкрдорд╛ рдЙрдкрдпреБрдХреНрдд рдЫреИрди, рддрд░ рдЕрдЧрд╛рдбрд┐ рдмрдвреМрдВред

### рдЕрднреНрдпрд╛рд╕ - рдореЛрдбреЗрд▓ рдирд┐рд░реНрдорд╛рдг рдЧрд░реНрдиреБрд╣реЛрд╕реН

1. `KMeans` рдЖрдпрд╛рдд рдЧрд░реНрдиреБрд╣реЛрд╕реН рд░ рдХреНрд▓рд╕реНрдЯрд░рд┐рдЩ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рд╕реБрд░реБ рдЧрд░реНрдиреБрд╣реЛрд╕реНред

    ```python
    from sklearn.cluster import KMeans
    wcss = []
    
    for i in range(1, 11):
        kmeans = KMeans(n_clusters = i, init = 'k-means++', random_state = 42)
        kmeans.fit(X)
        wcss.append(kmeans.inertia_)
    
    ```

    рдпрд╣рд╛рдБ рдХреЗрд╣реА рднрд╛рдЧрд╣рд░реВ рдЫрдиреН рдЬрд╕рдХреЛ рд╡реНрдпрд╛рдЦреНрдпрд╛ рдЧрд░реНрди рдЖрд╡рд╢реНрдпрдХ рдЫред

    > ЁЯОУ range: рдпреА рдХреНрд▓рд╕реНрдЯрд░рд┐рдЩ рдкреНрд░рдХреНрд░рд┐рдпрд╛рдХрд╛ рдкреБрдирд░рд╛рд╡реГрддреНрддрд┐рд╣рд░реВ рд╣реБрдиреНред

    > ЁЯОУ random_state: "рд╕реЗрдиреНрдЯреНрд░реЛрдЗрдб рдЗрдирд┐рд╕рд┐рдпрд▓рд╛рдЗрдЬреЗрд╕рдирдХреЛ рд▓рд╛рдЧрд┐ рд░реНрдпрд╛рдиреНрдбрдо рдирдореНрдмрд░ рдЬреЗрдиреЗрд░реЗрд╕рди рдирд┐рд░реНрдзрд╛рд░рдг рдЧрд░реНрджрдЫред" [рд╕реНрд░реЛрдд](https://scikit-learn.org/stable/modules/generated/sklearn.cluster.KMeans.html#sklearn.cluster.KMeans)

    > ЁЯОУ WCSS: "within-cluster sums of squares" рд▓реЗ рдХреНрд▓рд╕реНрдЯрд░ рд╕реЗрдиреНрдЯреНрд░реЛрдЗрдбрдХреЛ рд▓рд╛рдЧрд┐ рдХреНрд▓рд╕реНрдЯрд░ рднрд┐рддреНрд░рдХрд╛ рд╕рдмреИ рдмрд┐рдиреНрджреБрд╣рд░реВрдХреЛ рдФрд╕рдд рджреВрд░реА рдорд╛рдкрди рдЧрд░реНрджрдЫред [рд╕реНрд░реЛрдд](https://medium.com/@ODSC/unsupervised-learning-evaluating-clusters-bd47eed175ce)

    > ЁЯОУ Inertia: K-Means рдПрд▓реНрдЧреЛрд░рд┐рджрдорд▓реЗ 'рдЗрдирд░реНрд╢рд┐рдпрд╛' рдХрдо рдЧрд░реНрди рд╕реЗрдиреНрдЯреНрд░реЛрдЗрдбрд╣рд░реВ рдЪрдпрди рдЧрд░реНрдиреЗ рдкреНрд░рдпрд╛рд╕ рдЧрд░реНрджрдЫ, "рдХреНрд▓рд╕реНрдЯрд░рд╣рд░реВ рдЖрдиреНрддрд░рд┐рдХ рд░реВрдкрдорд╛ рдХрддрд┐ рд╕реБрд╕рдВрдЧрдд рдЫрдиреН рднрдиреНрдиреЗ рдорд╛рдкрдиред" [рд╕реНрд░реЛрдд](https://scikit-learn.org/stable/modules/clustering.html)ред рдорд╛рди рдкреНрд░рддреНрдпреЗрдХ рдкреБрдирд░рд╛рд╡реГрддреНрддрд┐рдорд╛ wcss рднреЗрд░рд┐рдПрдмрд▓рдорд╛ рдердкрд┐рдиреНрдЫред

    > ЁЯОУ k-means++: [Scikit-learn](https://scikit-learn.org/stable/modules/clustering.html#k-means) рдорд╛ рддрдкрд╛рдИрдВ 'k-means++' рдЕрдкреНрдЯрд┐рдорд╛рдЗрдЬреЗрд╕рди рдкреНрд░рдпреЛрдЧ рдЧрд░реНрди рд╕рдХреНрдиреБрд╣реБрдиреНрдЫ, рдЬрд╕рд▓реЗ "рд╕реЗрдиреНрдЯреНрд░реЛрдЗрдбрд╣рд░реВрд▓рд╛рдИ рд╕рд╛рдорд╛рдиреНрдпрддрдпрд╛ рдПрдХрдЕрд░реНрдХрд╛рдмрд╛рдЯ рдЯрд╛рдврд╛ рдЗрдирд┐рд╕рд┐рдпрд▓рд╛рдЗрдЬ рдЧрд░реНрджрдЫ, рдЬрд╕рд▓реЗ рд╕рдореНрднрд╡рддрдГ рд░реНрдпрд╛рдиреНрдбрдо рдЗрдирд┐рд╕рд┐рдпрд▓рд╛рдЗрдЬреЗрд╕рди рднрдиреНрджрд╛ рд░рд╛рдореНрд░реЛ рдкрд░рд┐рдгрд╛рдорд╣рд░реВ рджрд┐рдиреНрдЫред"

### рдПрд▓реНрдмреЛ рд╡рд┐рдзрд┐

рдкрд╣рд┐рд▓реЗ, рддрдкрд╛рдИрдВрд▓реЗ рдЕрдиреБрдорд╛рди рдЧрд░реНрдиреБрднрдпреЛ рдХрд┐, рдХрд┐рдирднрдиреЗ рддрдкрд╛рдИрдВрд▓реЗ 3 рдЧреАрдд рд╢реИрд▓реАрд╣рд░реВ рд▓рдХреНрд╖рд┐рдд рдЧрд░реНрдиреБрднрдПрдХреЛ рдЫ, рддрдкрд╛рдИрдВрд▓реЗ 3 рдХреНрд▓рд╕реНрдЯрд░рд╣рд░реВ рдЪрдпрди рдЧрд░реНрдиреБрдкрд░реНрдЫред рддрд░ рдХреЗ рдпреЛ рд╕рд╣реА рд╣реЛ?

1. 'рдПрд▓реНрдмреЛ рд╡рд┐рдзрд┐' рдкреНрд░рдпреЛрдЧ рдЧрд░реЗрд░ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдЧрд░реНрдиреБрд╣реЛрд╕реНред

    ```python
    plt.figure(figsize=(10,5))
    sns.lineplot(x=range(1, 11), y=wcss, marker='o', color='red')
    plt.title('Elbow')
    plt.xlabel('Number of clusters')
    plt.ylabel('WCSS')
    plt.show()
    ```

    рддрдкрд╛рдИрдВрд▓реЗ рдЕрдШрд┐рд▓реНрд▓реЛ рдЪрд░рдгрдорд╛ рдирд┐рд░реНрдорд╛рдг рдЧрд░реЗрдХреЛ `wcss` рднреЗрд░рд┐рдПрдмрд▓ рдкреНрд░рдпреЛрдЧ рдЧрд░реЗрд░ рдЪрд╛рд░реНрдЯ рдмрдирд╛рдЙрдиреБрд╣реЛрд╕реН рдЬрд╕рд▓реЗ рдПрд▓реНрдмреЛрдХреЛ 'рдмреЗрдВрдб' рдХрд╣рд╛рдБ рдЫ рджреЗрдЦрд╛рдЙрдБрдЫ, рдЬрд╕рд▓реЗ рдХреНрд▓рд╕реНрдЯрд░рд╣рд░реВрдХреЛ рдЗрд╖реНрдЯрддрдо рд╕рдВрдЦреНрдпрд╛ рд╕рдВрдХреЗрдд рдЧрд░реНрджрдЫред рд╕рд╛рдпрдж рдпреЛ **3** рдиреИ рд╣реЛ!

    ![elbow method](../../../../5-Clustering/2-K-Means/images/elbow.png)

## рдЕрднреНрдпрд╛рд╕ - рдХреНрд▓рд╕реНрдЯрд░рд╣рд░реВ рдкреНрд░рджрд░реНрд╢рди рдЧрд░реНрдиреБрд╣реЛрд╕реН

1. рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдлреЗрд░рд┐ рдкреНрд░рдпрд╛рд╕ рдЧрд░реНрдиреБрд╣реЛрд╕реН, рдпрд╕ рдкрдЯрдХ рддреАрди рдХреНрд▓рд╕реНрдЯрд░ рд╕реЗрдЯ рдЧрд░реНрджреИ, рд░ рдХреНрд▓рд╕реНрдЯрд░рд╣рд░реВрд▓рд╛рдИ рд╕реНрдХреНрдпрд╛рдЯрд░рдкреНрд▓рдЯрдХреЛ рд░реВрдкрдорд╛ рдкреНрд░рджрд░реНрд╢рди рдЧрд░реНрдиреБрд╣реЛрд╕реН:

    ```python
    from sklearn.cluster import KMeans
    kmeans = KMeans(n_clusters = 3)
    kmeans.fit(X)
    labels = kmeans.predict(X)
    plt.scatter(df['popularity'],df['danceability'],c = labels)
    plt.xlabel('popularity')
    plt.ylabel('danceability')
    plt.show()
    ```

1. рдореЛрдбреЗрд▓рдХреЛ рд╢реБрджреНрдзрддрд╛ рдЬрд╛рдБрдЪ рдЧрд░реНрдиреБрд╣реЛрд╕реН:

    ```python
    labels = kmeans.labels_
    
    correct_labels = sum(y == labels)
    
    print("Result: %d out of %d samples were correctly labeled." % (correct_labels, y.size))
    
    print('Accuracy score: {0:0.2f}'. format(correct_labels/float(y.size)))
    ```

    рдпреЛ рдореЛрдбреЗрд▓рдХреЛ рд╢реБрджреНрдзрддрд╛ рдзреЗрд░реИ рд░рд╛рдореНрд░реЛ рдЫреИрди, рд░ рдХреНрд▓рд╕реНрдЯрд░рд╣рд░реВрдХреЛ рдЖрдХрд╛рд░рд▓реЗ рддрдкрд╛рдИрдВрд▓рд╛рдИ рдХрд┐рдирдХреЛ рд╕рдВрдХреЗрдд рджрд┐рдиреНрдЫред

    ![clusters](../../../../5-Clustering/2-K-Means/images/clusters.png)

    рдпреЛ рдбреЗрдЯрд╛ рдзреЗрд░реИ рдЕрд╕рдиреНрддреБрд▓рд┐рдд рдЫ, рдзреЗрд░реИ рдХрдо рд╕рдореНрдмрдиреНрдзрд┐рдд рдЫ, рд░ рд╕реНрддрдореНрдн рдорд╛рдирд╣рд░реВ рдмреАрдЪ рдзреЗрд░реИ рднрд┐рдиреНрдирддрд╛ рдЫ рдЬрд╕рд▓реЗ рд░рд╛рдореНрд░реЛрд╕рдБрдЧ рдХреНрд▓рд╕реНрдЯрд░ рдЧрд░реНрди рд╕рдХреНрджреИрдиред рд╡рд╛рд╕реНрддрд╡рдорд╛, рдмрдирд╛рдЗрдПрдХрд╛ рдХреНрд▓рд╕реНрдЯрд░рд╣рд░реВ рд╕рдореНрднрд╡рддрдГ рдорд╛рдерд┐ рдкрд░рд┐рднрд╛рд╖рд┐рдд рддреАрди рд╢реИрд▓реА рд╡рд░реНрдЧрд╣рд░реВрджреНрд╡рд╛рд░рд╛ рдзреЗрд░реИ рдкреНрд░рднрд╛рд╡рд┐рдд рд╡рд╛ рдЭреБрдХрд╛рд╡ рднрдПрдХрд╛ рдЫрдиреНред рдпреЛ рд╕рд┐рдХреНрдиреЗ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдерд┐рдпреЛ!

    Scikit-learn рдХреЛ рджрд╕реНрддрд╛рд╡реЗрдЬрдорд╛, рддрдкрд╛рдИрдВ рджреЗрдЦреНрди рд╕рдХреНрдиреБрд╣реБрдиреНрдЫ рдХрд┐ рдпрд╕реНрддреЛ рдореЛрдбреЗрд▓, рдЬрд╕рдХреЛ рдХреНрд▓рд╕реНрдЯрд░рд╣рд░реВ рдзреЗрд░реИ рд░рд╛рдореНрд░реЛрд╕рдБрдЧ рдЫреБрдЯреНрдЯрд┐рдПрдХрд╛ рдЫреИрдирдиреН, 'рднреЗрд░рд┐рдпрдиреНрд╕' рд╕рдорд╕реНрдпрд╛ рдЫ:

    ![problem models](../../../../5-Clustering/2-K-Means/images/problems.png)
    > Scikit-learn рдмрд╛рдЯ рдЗрдиреНрдлреЛрдЧреНрд░рд╛рдлрд┐рдХ

## рднреЗрд░рд┐рдпрдиреНрд╕

рднреЗрд░рд┐рдпрдиреНрд╕рд▓рд╛рдИ "рдореАрдирдмрд╛рдЯ рд╡рд░реНрдЧреАрдп рднрд┐рдиреНрдирддрд╛рд╣рд░реВрдХреЛ рдФрд╕рдд" рднрдиреЗрд░ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдЧрд░рд┐рдПрдХреЛ рдЫ [(рд╕реНрд░реЛрдд)](https://www.mathsisfun.com/data/standard-deviation.html)ред рдпрд╕ рдХреНрд▓рд╕реНрдЯрд░рд┐рдЩ рд╕рдорд╕реНрдпрд╛рдХреЛ рд╕рдиреНрджрд░реНрднрдорд╛, рдпрд╕рд▓реЗ рд╣рд╛рдореНрд░реЛ рдбреЗрдЯрд╛рд╕реЗрдЯрдХрд╛ рд╕рдВрдЦреНрдпрд╛рд╣рд░реВ рдореАрдирдмрд╛рдЯ рдзреЗрд░реИ рдЯрд╛рдврд╛ рд╣реБрдиреЗ рдкреНрд░рд╡реГрддреНрддрд┐рд▓рд╛рдИ рдЬрдирд╛рдЙрдБрдЫред

тЬЕ рдпреЛ рд╕рдорд╕реНрдпрд╛ рд╕реБрдзрд╛рд░ рдЧрд░реНрди рд╕рдХреНрдиреЗ рд╕рдмреИ рддрд░рд┐рдХрд╛рд╣рд░реВрдХреЛ рдмрд╛рд░реЗрдорд╛ рд╕реЛрдЪреНрдиреЗ рд░рд╛рдореНрд░реЛ рд╕рдордп рд╣реЛред рдбреЗрдЯрд╛рд▓рд╛рдИ рдЕрд▓рд┐ рдмрдвреА рдкрд░рд┐рдорд╛рд░реНрдЬрди рдЧрд░реНрдиреЗ? рдлрд░рдХ рд╕реНрддрдореНрднрд╣рд░реВ рдкреНрд░рдпреЛрдЧ рдЧрд░реНрдиреЗ? рдлрд░рдХ рдПрд▓реНрдЧреЛрд░рд┐рджрдо рдкреНрд░рдпреЛрдЧ рдЧрд░реНрдиреЗ? рд╕рдВрдХреЗрдд: [рддрдкрд╛рдИрдВрдХреЛ рдбреЗрдЯрд╛рд▓рд╛рдИ рд╕реНрдХреЗрд▓ рдЧрд░реНрдиреЗ рдкреНрд░рдпрд╛рд╕ рдЧрд░реНрдиреБрд╣реЛрд╕реН](https://www.mygreatlearning.com/blog/learning-data-science-with-k-means-clustering/) рд░ рдЕрдиреНрдп рд╕реНрддрдореНрднрд╣рд░реВ рдкрд░реАрдХреНрд╖рдг рдЧрд░реНрдиреБрд╣реЛрд╕реНред

> рдпреЛ '[рднреЗрд░рд┐рдпрдиреНрд╕ рдХреНрдпрд╛рд▓реНрдХреБрд▓реЗрдЯрд░](https://www.calculatorsoup.com/calculators/statistics/variance-calculator.php)' рдкреНрд░рдпрд╛рд╕ рдЧрд░реЗрд░ рдЕрд╡рдзрд╛рд░рдгрд╛рд▓рд╛рдИ рдЕрд▓рд┐ рдмрдвреА рдмреБрдЭреНрдиреЗ рдкреНрд░рдпрд╛рд╕ рдЧрд░реНрдиреБрд╣реЛрд╕реНред

---

## ЁЯЪАрдЪреБрдиреМрддреА

рдпрд╕ рдиреЛрдЯрдмреБрдХрд╕рдБрдЧ рдХреЗрд╣реА рд╕рдордп рдмрд┐рддрд╛рдЙрдиреБрд╣реЛрд╕реН, рдкреНрдпрд╛рд░рд╛рдорд┐рдЯрд░рд╣рд░реВ рдкрд░рд┐рдорд╛рд░реНрдЬрди рдЧрд░реНрджреИред рдХреЗ рддрдкрд╛рдИрдВ рдЖрдЙрдЯрд▓рд╛рдпрд░реНрд╕ рд╣рдЯрд╛рдПрд░, рдЙрджрд╛рд╣рд░рдгрдХрд╛ рд▓рд╛рдЧрд┐, рдбреЗрдЯрд╛ рд╕рдлрд╛ рдЧрд░реЗрд░ рдореЛрдбреЗрд▓рдХреЛ рд╢реБрджреНрдзрддрд╛ рд╕реБрдзрд╛рд░ рдЧрд░реНрди рд╕рдХреНрдиреБрд╣реБрдиреНрдЫ? рддрдкрд╛рдИрдВрд▓реЗ рдХреЗрд╣реА рдбреЗрдЯрд╛ рдирдореВрдирд╛рд╣рд░реВрд▓рд╛рдИ рдмрдвреА рддреМрд▓ рджрд┐рди рддреМрд▓рд╣рд░реВ рдкреНрд░рдпреЛрдЧ рдЧрд░реНрди рд╕рдХреНрдиреБрд╣реБрдиреНрдЫред рд░рд╛рдореНрд░реЛ рдХреНрд▓рд╕реНрдЯрд░рд╣рд░реВ рдмрдирд╛рдЙрди рдХреЗ рдЧрд░реНрди рд╕рдХреНрдиреБрд╣реБрдиреНрдЫ?

рд╕рдВрдХреЗрдд: рддрдкрд╛рдИрдВрдХреЛ рдбреЗрдЯрд╛рд▓рд╛рдИ рд╕реНрдХреЗрд▓ рдЧрд░реНрдиреЗ рдкреНрд░рдпрд╛рд╕ рдЧрд░реНрдиреБрд╣реЛрд╕реНред рдиреЛрдЯрдмреБрдХрдорд╛ рдЯрд┐рдкреНрдкрдгреА рдЧрд░рд┐рдПрдХреЛ рдХреЛрдб рдЫ рдЬрд╕рд▓реЗ рдорд╛рдирдХ рд╕реНрдХреЗрд▓рд┐рдЩ рдердкреНрдЫ рддрд╛рдХрд┐ рдбреЗрдЯрд╛ рд╕реНрддрдореНрднрд╣рд░реВ рджрд╛рдпрд░рд╛рдХреЛ рд╕рдиреНрджрд░реНрднрдорд╛ рдПрдХрдЕрд░реНрдХрд╛рд╕рдБрдЧ рдмрдвреА рдирдЬрд┐рдХ рджреЗрдЦрд┐рдиреНрдЫрдиреНред рддрдкрд╛рдИрдВрд▓реЗ рдкрд╛рдЙрдиреБрд╣реБрдиреЗрдЫ рдХрд┐ рд╕рд┐рд▓реНрд╣реБрдПрдЯ рд╕реНрдХреЛрд░ рддрд▓ рдЬрд╛рдиреНрдЫ, рддрд░ рдПрд▓реНрдмреЛ рдЧреНрд░рд╛рдлрдХреЛ 'рдХрд┐рдВрдХ' рдирд░рдо рд╣реБрдиреНрдЫред рдпреЛ рдХрд┐рдирднрдиреЗ рдбреЗрдЯрд╛рд▓рд╛рдИ рдЕрдирд╕реНрдХреЗрд▓ рдЫреЛрдбреНрджрд╛ рдХрдо рднреЗрд░рд┐рдпрдиреНрд╕ рднрдПрдХреЛ рдбреЗрдЯрд╛рд▓реЗ рдмрдвреА рддреМрд▓ рдмреЛрдХреНрди рдЕрдиреБрдорддрд┐ рджрд┐рдиреНрдЫред рдпрд╕ рд╕рдорд╕реНрдпрд╛рдХреЛ рдмрд╛рд░реЗрдорд╛ [рдпрд╣рд╛рдБ](https://stats.stackexchange.com/questions/21222/are-mean-normalization-and-feature-scaling-needed-for-k-means-clustering/21226#21226) рдЕрд▓рд┐ рдмрдвреА рдкрдвреНрдиреБрд╣реЛрд╕реНред

## [Post-lecture quiz](https://ff-quizzes.netlify.app/en/ml/)

## рд╕рдореАрдХреНрд╖рд╛ рд░ рдЖрддреНрдо рдЕрдзреНрдпрдпрди

K-Means рд╕рд┐рдореБрд▓реЗрдЯрд░ [рдЬрд╕реНрддреИ рдпреЛ](https://user.ceng.metu.edu.tr/~akifakkus/courses/ceng574/k-means/) рд╣реЗрд░реНрдиреБрд╣реЛрд╕реНред рддрдкрд╛рдИрдВрд▓реЗ рдпреЛ рдЙрдкрдХрд░рдг рдкреНрд░рдпреЛрдЧ рдЧрд░реЗрд░ рдирдореВрдирд╛ рдбреЗрдЯрд╛ рдмрд┐рдиреНрджреБрд╣рд░реВ рджреЗрдЦрд╛рдЙрди рд░ рдпрд╕рдХреЛ рд╕реЗрдиреНрдЯреНрд░реЛрдЗрдбрд╣рд░реВ рдирд┐рд░реНрдзрд╛рд░рдг рдЧрд░реНрди рд╕рдХреНрдиреБрд╣реБрдиреНрдЫред рддрдкрд╛рдИрдВрд▓реЗ рдбреЗрдЯрд╛рдХреЛ рд░реНрдпрд╛рдиреНрдбрдордиреЗрд╕, рдХреНрд▓рд╕реНрдЯрд░рд╣рд░реВрдХреЛ рд╕рдВрдЦреНрдпрд╛ рд░ рд╕реЗрдиреНрдЯреНрд░реЛрдЗрдбрд╣рд░реВрдХреЛ рд╕рдВрдЦреНрдпрд╛ рд╕рдореНрдкрд╛рджрди рдЧрд░реНрди рд╕рдХреНрдиреБрд╣реБрдиреНрдЫред рдХреЗ рдпрд╕рд▓реЗ рддрдкрд╛рдИрдВрд▓рд╛рдИ рдбреЗрдЯрд╛рд▓рд╛рдИ рдХрд╕рд░реА рд╕рдореВрд╣ рдЧрд░реНрди рд╕рдХрд┐рдиреНрдЫ рднрдиреНрдиреЗ рд╡рд┐рдЪрд╛рд░ рджрд┐рди рдорджреНрджрдд рдЧрд░реНрджрдЫ?

рд╕рд╛рдереИ, [Stanford рдХреЛ K-Means рд╕рдореНрдмрдиреНрдзреА рдпреЛ рд╣реНрдпрд╛рдиреНрдбрдЖрдЙрдЯ](https://stanford.edu/~cpiech/cs221/handouts/kmeans.html) рд╣реЗрд░реНрдиреБрд╣реЛрд╕реНред

## рдЕрд╕рд╛рдЗрдирдореЗрдиреНрдЯ

[рд╡рд┐рднрд┐рдиреНрди рдХреНрд▓рд╕реНрдЯрд░рд┐рдЩ рд╡рд┐рдзрд┐рд╣рд░реВ рдкреНрд░рдпрд╛рд╕ рдЧрд░реНрдиреБрд╣реЛрд╕реН](assignment.md)

---

**рдЕрд╕реНрд╡реАрдХрд░рдг**:  
рдпреЛ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ AI рдЕрдиреБрд╡рд╛рдж рд╕реЗрд╡рд╛ [Co-op Translator](https://github.com/Azure/co-op-translator) рдкреНрд░рдпреЛрдЧ рдЧрд░реЗрд░ рдЕрдиреБрд╡рд╛рдж рдЧрд░рд┐рдПрдХреЛ рд╣реЛред рд╣рд╛рдореА рд╢реБрджреНрдзрддрд╛рдХреЛ рд▓рд╛рдЧрд┐ рдкреНрд░рдпрд╛рд╕ рдЧрд░реНрдЫреМрдВ, рддрд░ рдХреГрдкрдпрд╛ рдзреНрдпрд╛рди рджрд┐рдиреБрд╣реЛрд╕реН рдХрд┐ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдЕрдиреБрд╡рд╛рджрдорд╛ рддреНрд░реБрдЯрд┐рд╣рд░реВ рд╡рд╛ рдЕрд╢реБрджреНрдзрддрд╛рд╣рд░реВ рд╣реБрди рд╕рдХреНрдЫред рдпрд╕рдХреЛ рдореВрд▓ рднрд╛рд╖рд╛ рдорд╛ рд░рд╣реЗрдХреЛ рдореВрд▓ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝рд▓рд╛рдИ рдЖрдзрд┐рдХрд╛рд░рд┐рдХ рд╕реНрд░реЛрдд рдорд╛рдирд┐рдиреБрдкрд░реНрдЫред рдорд╣рддреНрд╡рдкреВрд░реНрдг рдЬрд╛рдирдХрд╛рд░реАрдХреЛ рд▓рд╛рдЧрд┐, рд╡реНрдпрд╛рд╡рд╕рд╛рдпрд┐рдХ рдорд╛рдирд╡ рдЕрдиреБрд╡рд╛рдж рд╕рд┐рдлрд╛рд░рд┐рд╕ рдЧрд░рд┐рдиреНрдЫред рдпрд╕ рдЕрдиреБрд╡рд╛рджрдХреЛ рдкреНрд░рдпреЛрдЧрдмрд╛рдЯ рдЙрддреНрдкрдиреНрди рд╣реБрдиреЗ рдХреБрдиреИ рдкрдирд┐ рдЧрд▓рддрдлрд╣рдореА рд╡рд╛ рдЧрд▓рдд рд╡реНрдпрд╛рдЦреНрдпрд╛рдХреЛ рд▓рд╛рдЧрд┐ рд╣рд╛рдореА рдЬрд┐рдореНрдореЗрд╡рд╛рд░ рд╣реБрдиреЗ рдЫреИрдиреМрдВред