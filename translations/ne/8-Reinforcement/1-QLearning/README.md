<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "911efd5e595089000cb3c16fce1beab8",
  "translation_date": "2025-09-06T06:39:07+00:00",
  "source_file": "8-Reinforcement/1-QLearning/README.md",
  "language_code": "ne"
}
-->
# рдкрд░рд┐рдЪрдп: рд░рд┐рдЗрдиреНрдлреЛрд░реНрд╕рдореЗрдиреНрдЯ рд▓рд░реНрдирд┐рдЩ рд░ Q-рд▓рд░реНрдирд┐рдЩ

![рдореЗрд╕рд┐рди рд▓рд░реНрдирд┐рдЩрдорд╛ рд░рд┐рдЗрдиреНрдлреЛрд░реНрд╕рдореЗрдиреНрдЯрдХреЛ рд╕рд╛рд░рд╛рдВрд╢ рд╕реНрдХреЗрдЪ рдиреЛрдЯрдорд╛](../../../../sketchnotes/ml-reinforcement.png)
> рд╕реНрдХреЗрдЪ рдиреЛрдЯ [Tomomi Imura](https://www.twitter.com/girlie_mac) рджреНрд╡рд╛рд░рд╛

рд░рд┐рдЗрдиреНрдлреЛрд░реНрд╕рдореЗрдиреНрдЯ рд▓рд░реНрдирд┐рдЩ рддреАрди рдорд╣рддреНрддреНрд╡рдкреВрд░реНрдг рдЕрд╡рдзрд╛рд░рдгрд╛рд╣рд░реВрдорд╛ рдЖрдзрд╛рд░рд┐рдд рдЫ: рдПрдЬреЗрдиреНрдЯ, рдХреЗрд╣реА рдЕрд╡рд╕реНрдерд╛рд╣рд░реВ, рд░ рдкреНрд░рддреНрдпреЗрдХ рдЕрд╡рд╕реНрдерд╛рдХрд╛ рд▓рд╛рдЧрд┐ рдХрд╛рд░реНрдпрд╣рд░реВрдХреЛ рд╕реЗрдЯред рдХреБрдиреИ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдЕрд╡рд╕реНрдерд╛рдорд╛ рдХрд╛рд░реНрдп рд╕рдореНрдкрд╛рджрди рдЧрд░реНрджрд╛, рдПрдЬреЗрдиреНрдЯрд▓рд╛рдИ рдкреБрд░рд╕реНрдХрд╛рд░ рджрд┐рдЗрдиреНрдЫред рдлреЗрд░рд┐ рдХрдореНрдкреНрдпреБрдЯрд░ рдЧреЗрдо рд╕реБрдкрд░ рдорд╛рд░рд┐рдпреЛрдХреЛ рдХрд▓реНрдкрдирд╛ рдЧрд░реНрдиреБрд╣реЛрд╕реНред рддрдкрд╛рдИрдВ рдорд╛рд░рд┐рдпреЛ рд╣реБрдиреБрд╣реБрдиреНрдЫ, рддрдкрд╛рдИрдВ рдЧреЗрдордХреЛ рд╕реНрддрд░рдорд╛ рд╣реБрдиреБрд╣реБрдиреНрдЫ, рдЪрдЯреНрдЯрд╛рдирдХреЛ рдЫреЗрдЙрдорд╛ рдЙрднрд┐рдПрдХреЛред рддрдкрд╛рдИрдВрдХреЛ рдорд╛рдерд┐ рдПрдЙрдЯрд╛ рд╕рд┐рдХреНрдХрд╛ рдЫред рддрдкрд╛рдИрдВ рдорд╛рд░рд┐рдпреЛ рд╣реБрдиреБрд╣реБрдиреНрдЫ, рдЧреЗрдордХреЛ рд╕реНрддрд░рдорд╛, рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ рд╕реНрдерд╛рдирдорд╛ ... рдпреЛ рддрдкрд╛рдИрдВрдХреЛ рдЕрд╡рд╕реНрдерд╛ рд╣реЛред рджрд╛рдпрд╛рдБрддрд┐рд░ рдПрдХ рдХрджрдо рдЪрд╛рд▓реНрдиреБ (рдПрдХ рдХрд╛рд░реНрдп) рддрдкрд╛рдИрдВрд▓рд╛рдИ рдЪрдЯреНрдЯрд╛рдирдмрд╛рдЯ рддрд▓ рд▓реИрдЬрд╛рдиреНрдЫ, рд░ рдпрд╕рд▓реЗ рддрдкрд╛рдИрдВрд▓рд╛рдИ рдХрдо рд╕рдВрдЦреНрдпрд╛рддреНрдордХ рд╕реНрдХреЛрд░ рджрд┐рдиреНрдЫред рддрд░, рдЬрдореНрдк рдмрдЯрди рдерд┐рдЪреНрджрд╛ рддрдкрд╛рдИрдВрд▓реЗ рдПрдХ рдЕрдВрдХ рдкреНрд░рд╛рдкреНрдд рдЧрд░реНрдиреБрд╣реБрдиреЗрдЫ рд░ рдЬреАрд╡рд┐рдд рд░рд╣рдиреБрд╣реБрдиреЗрдЫред рдпреЛ рд╕рдХрд╛рд░рд╛рддреНрдордХ рдкрд░рд┐рдгрд╛рдо рд╣реЛ рд░ рдпрд╕рд▓реЗ рддрдкрд╛рдИрдВрд▓рд╛рдИ рд╕рдХрд╛рд░рд╛рддреНрдордХ рд╕рдВрдЦреНрдпрд╛рддреНрдордХ рд╕реНрдХреЛрд░ рджрд┐рдиреБрдкрд░реНрдЫред

рд░рд┐рдЗрдиреНрдлреЛрд░реНрд╕рдореЗрдиреНрдЯ рд▓рд░реНрдирд┐рдЩ рд░ рд╕рд┐рдореБрд▓реЗрдЯрд░ (рдЧреЗрдо) рдкреНрд░рдпреЛрдЧ рдЧрд░реЗрд░, рддрдкрд╛рдИрдВрд▓реЗ рдЬреАрд╡рд┐рдд рд░рд╣рдиреБ рд░ рд╕рдХреЗрд╕рдореНрдо рдзреЗрд░реИ рдЕрдВрдХ рдкреНрд░рд╛рдкреНрдд рдЧрд░реНрди рдЦреЗрд▓ рдЦреЗрд▓реНрди рд╕рд┐рдХреНрди рд╕рдХреНрдиреБрд╣реБрдиреНрдЫред

[![рд░рд┐рдЗрдиреНрдлреЛрд░реНрд╕рдореЗрдиреНрдЯ рд▓рд░реНрдирд┐рдЩрдХреЛ рдкрд░рд┐рдЪрдп](https://img.youtube.com/vi/lDq_en8RNOo/0.jpg)](https://www.youtube.com/watch?v=lDq_en8RNOo)

> ЁЯОе рдорд╛рдерд┐рдХреЛ рддрд╕реНрдмрд┐рд░рдорд╛ рдХреНрд▓рд┐рдХ рдЧрд░реЗрд░ Dmitry рдмрд╛рдЯ рд░рд┐рдЗрдиреНрдлреЛрд░реНрд╕рдореЗрдиреНрдЯ рд▓рд░реНрдирд┐рдЩрдХреЛ рдЪрд░реНрдЪрд╛ рд╕реБрдиреНрдиреБрд╣реЛрд╕реН

## [рдкрд╛рда рдЕрдШрд┐ рдХреНрд╡рд┐рдЬ](https://ff-quizzes.netlify.app/en/ml/)

## рдкреВрд░реНрд╡рдЖрд╡рд╢реНрдпрдХрддрд╛ рд░ рд╕реЗрдЯрдЕрдк

рдпрд╕ рдкрд╛рдардорд╛, рд╣рд╛рдореА Python рдорд╛ рдХреЗрд╣реА рдХреЛрдбрдХреЛ рдкреНрд░рдпреЛрдЧ рдЧрд░реНрдиреЗрдЫреМрдВред рддрдкрд╛рдИрдВрд▓реЗ рдпреЛ рдкрд╛рдардХреЛ Jupyter Notebook рдХреЛрдб рдЖрдлреНрдиреЛ рдХрдореНрдкреНрдпреБрдЯрд░рдорд╛ рд╡рд╛ рдХреНрд▓рд╛рдЙрдбрдорд╛ рдЪрд▓рд╛рдЙрди рд╕рдХреНрд╖рдо рд╣реБрдиреБрдкрд░реНрдЫред

рддрдкрд╛рдИрдВ [рдкрд╛рда рдиреЛрдЯрдмреБрдХ](https://github.com/microsoft/ML-For-Beginners/blob/main/8-Reinforcement/1-QLearning/notebook.ipynb) рдЦреЛрд▓реНрди рд╕рдХреНрдиреБрд╣реБрдиреНрдЫ рд░ рдпрд╕ рдкрд╛рдард▓рд╛рдИ рдирд┐рд░реНрдорд╛рдг рдЧрд░реНрди рд╕рдХреНрдиреБрд╣реБрдиреНрдЫред

> **рдиреЛрдЯ:** рдпрджрд┐ рддрдкрд╛рдИрдВрд▓реЗ рдпреЛ рдХреЛрдб рдХреНрд▓рд╛рдЙрдбрдмрд╛рдЯ рдЦреЛрд▓реНрджреИ рд╣реБрдиреБрд╣реБрдиреНрдЫ рднрдиреЗ, рддрдкрд╛рдИрдВрд▓реЗ [`rlboard.py`](https://github.com/microsoft/ML-For-Beginners/blob/main/8-Reinforcement/1-QLearning/rlboard.py) рдлрд╛рдЗрд▓ рдкрдирд┐ рд▓реНрдпрд╛рдЙрди рдЖрд╡рд╢реНрдпрдХ рдЫ, рдЬреБрди рдиреЛрдЯрдмреБрдХ рдХреЛрдбрдорд╛ рдкреНрд░рдпреЛрдЧ рдЧрд░рд┐рдПрдХреЛ рдЫред рдпрд╕рд▓рд╛рдИ рдиреЛрдЯрдмреБрдХрдХреЛ рд╕рдорд╛рди рдбрд╛рдЗрд░реЗрдХреНрдЯрд░реАрдорд╛ рдердкреНрдиреБрд╣реЛрд╕реНред

## рдкрд░рд┐рдЪрдп

рдпрд╕ рдкрд╛рдардорд╛, рд╣рд╛рдореА **[Peter and the Wolf](https://en.wikipedia.org/wiki/Peter_and_the_Wolf)** рдХреЛ рд╕рдВрд╕рд╛рд░ рдЕрдиреНрд╡реЗрд╖рдг рдЧрд░реНрдиреЗрдЫреМрдВ, рдЬреБрди рд░реВрд╕реА рд╕рдВрдЧреАрддрдХрд╛рд░ [Sergei Prokofiev](https://en.wikipedia.org/wiki/Sergei_Prokofiev) рджреНрд╡рд╛рд░рд╛ рдкреНрд░реЗрд░рд┐рдд рдПрдХ рд╕рдВрдЧреАрдд рдкрд░реА рдХрдерд╛ рд╣реЛред рд╣рд╛рдореА **рд░рд┐рдЗрдиреНрдлреЛрд░реНрд╕рдореЗрдиреНрдЯ рд▓рд░реНрдирд┐рдЩ** рдкреНрд░рдпреЛрдЧ рдЧрд░реЗрд░ рдкрд┐рдЯрд░рд▓рд╛рдИ рдЙрд╕рдХреЛ рд╡рд╛рддрд╛рд╡рд░рдг рдЕрдиреНрд╡реЗрд╖рдг рдЧрд░реНрди, рд╕реНрд╡рд╛рджрд┐рд╖реНрдЯ рд╕реНрдпрд╛рдЙрд╣рд░реВ рд╕рдВрдХрд▓рди рдЧрд░реНрди рд░ рднреЗрдбрд┐рдпрд╛рд╕рдБрдЧ рднреЗрдЯреНрдирдмрд╛рдЯ рдмрдЪреНрди рджрд┐рдиреЗрдЫреМрдВред

**рд░рд┐рдЗрдиреНрдлреЛрд░реНрд╕рдореЗрдиреНрдЯ рд▓рд░реНрдирд┐рдЩ** (RL) рдПрдХ рд╕рд┐рдХреНрдиреЗ рдкреНрд░рд╡рд┐рдзрд┐ рд╣реЛ рдЬрд╕рд▓реЗ рд╣рд╛рдореАрд▓рд╛рдИ **рдПрдЬреЗрдиреНрдЯ** рдХреЛ рдХреБрдиреИ **рд╡рд╛рддрд╛рд╡рд░рдг** рдорд╛ рдЗрд╖реНрдЯрддрдо рд╡реНрдпрд╡рд╣рд╛рд░ рд╕рд┐рдХреНрди рдЕрдиреБрдорддрд┐ рджрд┐рдиреНрдЫ рдзреЗрд░реИ рдкреНрд░рдпреЛрдЧрд╣рд░реВ рдЪрд▓рд╛рдПрд░ред рдпрд╕ рд╡рд╛рддрд╛рд╡рд░рдгрдорд╛ рдПрдЬреЗрдиреНрдЯрдХреЛ рдХреЗрд╣реА **рд▓рдХреНрд╖реНрдп** рд╣реБрдиреБрдкрд░реНрдЫ, рдЬреБрди **рдкреБрд░рд╕реНрдХрд╛рд░ рдХрд╛рд░реНрдп** рджреНрд╡рд╛рд░рд╛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рд╣реБрдиреНрдЫред

## рд╡рд╛рддрд╛рд╡рд░рдг

рд╕рд░рд▓рддрд╛рдХреЛ рд▓рд╛рдЧрд┐, рдкрд┐рдЯрд░рдХреЛ рд╕рдВрд╕рд╛рд░рд▓рд╛рдИ `width` x `height` рдЖрдХрд╛рд░рдХреЛ рд╡рд░реНрдЧ рдмреЛрд░реНрдб рдорд╛рдиреМрдВ, рдпрд╕ рдкреНрд░рдХрд╛рд░:

![рдкрд┐рдЯрд░рдХреЛ рд╡рд╛рддрд╛рд╡рд░рдг](../../../../8-Reinforcement/1-QLearning/images/environment.png)

рдпрд╕ рдмреЛрд░реНрдбрдХреЛ рдкреНрд░рддреНрдпреЗрдХ рд╕реЗрд▓ рдирд┐рдореНрдирдордзреНрдпреЗ рдХреБрдиреИ рдПрдХ рд╣реБрди рд╕рдХреНрдЫ:

* **рдЬрдорд┐рди**, рдЬрд╣рд╛рдБ рдкрд┐рдЯрд░ рд░ рдЕрдиреНрдп рдкреНрд░рд╛рдгреАрд╣рд░реВ рд╣рд┐рдБрдбреНрди рд╕рдХреНрдЫрдиреНред
* **рдкрд╛рдиреА**, рдЬрд╣рд╛рдБ рд╕реНрдкрд╖реНрдЯ рд░реВрдкрдорд╛ рд╣рд┐рдБрдбреНрди рд╕рдХрд┐рдБрджреИрдиред
* **рд░реБрдЦ** рд╡рд╛ **рдШрд╛рдБрд╕**, рдЬрд╣рд╛рдБ рдЖрд░рд╛рдо рдЧрд░реНрди рд╕рдХрд┐рдиреНрдЫред
* **рд╕реНрдпрд╛рдЙ**, рдЬреБрди рдкрд┐рдЯрд░рд▓реЗ рдЖрдлреВрд▓рд╛рдИ рдЦреБрд╡рд╛рдЙрди рдкрд╛рдЙрдБрджрд╛ рдЦреБрд╕реА рд╣реБрдиреЗ рдХреБрд░рд╛ рд╣реЛред
* **рднреЗрдбрд┐рдпрд╛**, рдЬреБрди рдЦрддрд░рдирд╛рдХ рдЫ рд░ рдмрдЪреНрдиреБрдкрд░реНрдЫред

рдПрдХ рдЕрд▓рдЧ Python рдореЛрдбреНрдпреБрд▓, [`rlboard.py`](https://github.com/microsoft/ML-For-Beginners/blob/main/8-Reinforcement/1-QLearning/rlboard.py), рдпрд╕ рд╡рд╛рддрд╛рд╡рд░рдгрд╕рдБрдЧ рдХрд╛рдо рдЧрд░реНрди рдХреЛрдб рд╕рдорд╛рд╡реЗрд╢ рдЧрд░реНрджрдЫред рдХрд┐рдирдХрд┐ рдпреЛ рдХреЛрдб рд╣рд╛рдореНрд░реЛ рдЕрд╡рдзрд╛рд░рдгрд╛рд╣рд░реВ рдмреБрдЭреНрди рдорд╣рддреНрддреНрд╡рдкреВрд░реНрдг рдЫреИрди, рд╣рд╛рдореА рдореЛрдбреНрдпреБрд▓ рдЖрдпрд╛рдд рдЧрд░реНрдиреЗрдЫреМрдВ рд░ рдирдореВрдирд╛ рдмреЛрд░реНрдб рд╕рд┐рд░реНрдЬрдирд╛ рдЧрд░реНрди рдкреНрд░рдпреЛрдЧ рдЧрд░реНрдиреЗрдЫреМрдВ (рдХреЛрдб рдмреНрд▓рдХ 1):

```python
from rlboard import *

width, height = 8,8
m = Board(width,height)
m.randomize(seed=13)
m.plot()
```

рдпрд╕ рдХреЛрдбрд▓реЗ рдорд╛рдерд┐рдХреЛ рдЬрд╕реНрддреИ рд╡рд╛рддрд╛рд╡рд░рдгрдХреЛ рдЪрд┐рддреНрд░ рдкреНрд░рд┐рдиреНрдЯ рдЧрд░реНрдиреБрдкрд░реНрдЫред

## рдХрд╛рд░реНрдпрд╣рд░реВ рд░ рдиреАрддрд┐

рд╣рд╛рдореНрд░реЛ рдЙрджрд╛рд╣рд░рдгрдорд╛, рдкрд┐рдЯрд░рдХреЛ рд▓рдХреНрд╖реНрдп рд╕реНрдпрд╛рдЙ рдлреЗрд▓рд╛ рдкрд╛рд░реНрдиреБ рд╣реЛ, рднреЗрдбрд┐рдпрд╛ рд░ рдЕрдиреНрдп рдмрд╛рдзрд╛рд╣рд░реВрдмрд╛рдЯ рдмрдЪреНрджреИред рдпрд╕рдХрд╛ рд▓рд╛рдЧрд┐, рдЙрд╕рд▓реЗ рд╕реНрдпрд╛рдЙ рдлреЗрд▓рд╛ рдкрд╛рд░реНрджрд╛рд╕рдореНрдо рд╡рд░рд┐рдкрд░рд┐ рд╣рд┐рдБрдбреНрди рд╕рдХреНрдЫред

рддреНрдпрд╕реИрд▓реЗ, рдХреБрдиреИ рдкрдирд┐ рд╕реНрдерд╛рдирдорд╛, рдЙрд╕рд▓реЗ рдирд┐рдореНрди рдХрд╛рд░реНрдпрд╣рд░реВ рдордзреНрдпреЗ рдПрдХ рдЪрдпрди рдЧрд░реНрди рд╕рдХреНрдЫ: рдорд╛рдерд┐, рддрд▓, рдмрд╛рдпрд╛рдБ рд░ рджрд╛рдпрд╛рдБред

рд╣рд╛рдореА рддреА рдХрд╛рд░реНрдпрд╣рд░реВрд▓рд╛рдИ рдбрд┐рдХреНрд╕рдирд░реАрдХреЛ рд░реВрдкрдорд╛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдЧрд░реНрдиреЗрдЫреМрдВ, рд░ рддрд┐рдиреАрд╣рд░реВрд▓рд╛рдИ рд╕рдореНрдмрдиреНрдзрд┐рдд рд╕рдордиреНрд╡рдп рдкрд░рд┐рд╡рд░реНрддрдирд╣рд░реВрдХреЛ рдЬреЛрдбреАрдорд╛ рдореНрдпрд╛рдк рдЧрд░реНрдиреЗрдЫреМрдВред рдЙрджрд╛рд╣рд░рдгрдХрд╛ рд▓рд╛рдЧрд┐, рджрд╛рдпрд╛рдБрддрд┐рд░ рд╕рд░реНрдиреЗ (`R`) рдЬреЛрдбреА `(1,0)` рд╕рдБрдЧ рдореЗрд▓ рдЦрд╛рдиреЗрдЫред (рдХреЛрдб рдмреНрд▓рдХ 2):

```python
actions = { "U" : (0,-1), "D" : (0,1), "L" : (-1,0), "R" : (1,0) }
action_idx = { a : i for i,a in enumerate(actions.keys()) }
```

рдпрд╕ рдкрд░рд┐рджреГрд╢реНрдпрдХреЛ рд░рдгрдиреАрддрд┐ рд░ рд▓рдХреНрд╖реНрдпрд▓рд╛рдИ рд╕рдВрдХреНрд╖реЗрдкрдорд╛ рднрдиреНрдиреБрдкрд░реНрджрд╛:

- **рд░рдгрдиреАрддрд┐**, рд╣рд╛рдореНрд░реЛ рдПрдЬреЗрдиреНрдЯ (рдкрд┐рдЯрд░) рдХреЛ **рдиреАрддрд┐** рджреНрд╡рд╛рд░рд╛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдЧрд░рд┐рдПрдХреЛ рдЫред рдиреАрддрд┐ рдПрдХ рдХрд╛рд░реНрдп рд╣реЛ рдЬрд╕рд▓реЗ рдХреБрдиреИ рдкрдирд┐ рджрд┐рдЗрдПрдХреЛ рдЕрд╡рд╕реНрдерд╛рдорд╛ рдХрд╛рд░реНрдп рдлрд┐рд░реНрддрд╛ рдЧрд░реНрджрдЫред рд╣рд╛рдореНрд░реЛ рдорд╛рдорд▓рд╛рдорд╛, рд╕рдорд╕реНрдпрд╛рдХреЛ рдЕрд╡рд╕реНрдерд╛ рдмреЛрд░реНрдбрджреНрд╡рд╛рд░рд╛ рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдЧрд░рд┐рдПрдХреЛ рдЫ, рдЬрд╕рдорд╛ рдЦреЗрд▓рд╛рдбреАрдХреЛ рд╡рд░реНрддрдорд╛рди рд╕реНрдерд┐рддрд┐ рд╕рдорд╛рд╡реЗрд╢ рдЫред

- **рд▓рдХреНрд╖реНрдп**, рд░рд┐рдЗрдиреНрдлреЛрд░реНрд╕рдореЗрдиреНрдЯ рд▓рд░реНрдирд┐рдЩрдХреЛ рдЕрдиреНрддрддрдГ рд░рд╛рдореНрд░реЛ рдиреАрддрд┐ рд╕рд┐рдХреНрдиреБ рд╣реЛ рдЬрд╕рд▓реЗ рд╣рд╛рдореАрд▓рд╛рдИ рд╕рдорд╕реНрдпрд╛ рдХреБрд╢рд▓рддрд╛рдкреВрд░реНрд╡рдХ рд╕рдорд╛рдзрд╛рди рдЧрд░реНрди рдЕрдиреБрдорддрд┐ рджрд┐рдиреЗрдЫред рддрд░, рдЖрдзрд╛рд░рднреВрдд рд░реВрдкрдорд╛, рд╕рдмреИрднрдиреНрджрд╛ рд╕рд░рд▓ рдиреАрддрд┐ **рд░реНрдпрд╛рдиреНрдбрдо рд╡рд╛рдХ** рдорд╛рдиреМрдВред

## рд░реНрдпрд╛рдиреНрдбрдо рд╡рд╛рдХ

рдкрд╣рд┐рд▓рд╛, рд╣рд╛рдореА рд░реНрдпрд╛рдиреНрдбрдо рд╡рд╛рдХ рд░рдгрдиреАрддрд┐ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдЧрд░реЗрд░ рд╣рд╛рдореНрд░реЛ рд╕рдорд╕реНрдпрд╛ рд╕рдорд╛рдзрд╛рди рдЧрд░реНрдиреЗрдЫреМрдВред рд░реНрдпрд╛рдиреНрдбрдо рд╡рд╛рдХрдорд╛, рд╣рд╛рдореА рдЕрдиреБрдорддрд┐ рдкреНрд░рд╛рдкреНрдд рдХрд╛рд░реНрдпрд╣рд░реВрдмрд╛рдЯ рдЕрд░реНрдХреЛ рдХрд╛рд░реНрдп рдЕрдирд┐рдпрдорд┐рдд рд░реВрдкрдорд╛ рдЪрдпрди рдЧрд░реНрдиреЗрдЫреМрдВ, рдЬрдмрд╕рдореНрдо рд╣рд╛рдореА рд╕реНрдпрд╛рдЙрдорд╛ рдкреБрдЧреНрджреИрдиреМрдВ (рдХреЛрдб рдмреНрд▓рдХ 3)ред

1. рддрд▓рдХреЛ рдХреЛрдб рдкреНрд░рдпреЛрдЧ рдЧрд░реЗрд░ рд░реНрдпрд╛рдиреНрдбрдо рд╡рд╛рдХ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдЧрд░реНрдиреБрд╣реЛрд╕реН:

    ```python
    def random_policy(m):
        return random.choice(list(actions))
    
    def walk(m,policy,start_position=None):
        n = 0 # number of steps
        # set initial position
        if start_position:
            m.human = start_position 
        else:
            m.random_start()
        while True:
            if m.at() == Board.Cell.apple:
                return n # success!
            if m.at() in [Board.Cell.wolf, Board.Cell.water]:
                return -1 # eaten by wolf or drowned
            while True:
                a = actions[policy(m)]
                new_pos = m.move_pos(m.human,a)
                if m.is_valid(new_pos) and m.at(new_pos)!=Board.Cell.water:
                    m.move(a) # do the actual move
                    break
            n+=1
    
    walk(m,random_policy)
    ```

    `walk` рдХреЛ рдХрд▓рд▓реЗ рд╕рдореНрдмрдиреНрдзрд┐рдд рдкрдердХреЛ рд▓рдореНрдмрд╛рдЗ рдлрд┐рд░реНрддрд╛ рдЧрд░реНрдиреБрдкрд░реНрдЫ, рдЬреБрди рдПрдХ рд░рдирдмрд╛рдЯ рдЕрд░реНрдХреЛрдорд╛ рдлрд░рдХ рд╣реБрди рд╕рдХреНрдЫред

1. рд╡рд╛рдХ рдкреНрд░рдпреЛрдЧ рдзреЗрд░реИ рдкрдЯрдХ рдЪрд▓рд╛рдЙрдиреБрд╣реЛрд╕реН (рднрдиреМрдВ, 100 рдкрдЯрдХ), рд░ рдкрд░рд┐рдгрд╛рдореА рддрдереНрдпрд╛рдВрдХ рдкреНрд░рд┐рдиреНрдЯ рдЧрд░реНрдиреБрд╣реЛрд╕реН (рдХреЛрдб рдмреНрд▓рдХ 4):

    ```python
    def print_statistics(policy):
        s,w,n = 0,0,0
        for _ in range(100):
            z = walk(m,policy)
            if z<0:
                w+=1
            else:
                s += z
                n += 1
        print(f"Average path length = {s/n}, eaten by wolf: {w} times")
    
    print_statistics(random_policy)
    ```

    рдзреНрдпрд╛рди рджрд┐рдиреБрд╣реЛрд╕реН рдХрд┐ рдкрдердХреЛ рдФрд╕рдд рд▓рдореНрдмрд╛рдЗ рд▓рдЧрднрдЧ 30-40 рдЪрд░рдг рд╣реЛ, рдЬреБрди рдзреЗрд░реИ рд╣реЛ, рдХрд┐рдирдХрд┐ рдирдЬрд┐рдХрдХреЛ рд╕реНрдпрд╛рдЙрд╕рдореНрдордХреЛ рдФрд╕рдд рджреВрд░реА рд▓рдЧрднрдЧ 5-6 рдЪрд░рдг рд╣реЛред

    рддрдкрд╛рдИрдВрд▓реЗ рдкрд┐рдЯрд░рдХреЛ рд░реНрдпрд╛рдиреНрдбрдо рд╡рд╛рдХрдХреЛ рдХреНрд░рдордорд╛ рдЙрд╕рдХреЛ рдЪрд╛рд▓ рдХрд╕реНрддреЛ рджреЗрдЦрд┐рдиреНрдЫ рднрдиреЗрд░ рдкрдирд┐ рд╣реЗрд░реНрди рд╕рдХреНрдиреБрд╣реБрдиреНрдЫ:

    ![рдкрд┐рдЯрд░рдХреЛ рд░реНрдпрд╛рдиреНрдбрдо рд╡рд╛рдХ](../../../../8-Reinforcement/1-QLearning/images/random_walk.gif)

## рдкреБрд░рд╕реНрдХрд╛рд░ рдХрд╛рд░реНрдп

рд╣рд╛рдореНрд░реЛ рдиреАрддрд┐ рдЕрдЭ рдмреМрджреНрдзрд┐рдХ рдмрдирд╛рдЙрди, рд╣рд╛рдореАрд▓реЗ рдмреБрдЭреНрдиреБрдкрд░реНрдЫ рдХрд┐ рдХреБрди рдЪрд╛рд▓рд╣рд░реВ рдЕрд░реВрднрдиреНрджрд╛ "рд░рд╛рдореНрд░реЛ" рдЫрдиреНред рдпрд╕рдХрд╛ рд▓рд╛рдЧрд┐, рд╣рд╛рдореАрд▓реЗ рд╣рд╛рдореНрд░реЛ рд▓рдХреНрд╖реНрдп рдкрд░рд┐рднрд╛рд╖рд┐рдд рдЧрд░реНрдиреБрдкрд░реНрдЫред

рд▓рдХреНрд╖реНрдпрд▓рд╛рдИ **рдкреБрд░рд╕реНрдХрд╛рд░ рдХрд╛рд░реНрдп** рдХреЛ рд╕рдиреНрджрд░реНрднрдорд╛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдЧрд░реНрди рд╕рдХрд┐рдиреНрдЫ, рдЬрд╕рд▓реЗ рдкреНрд░рддреНрдпреЗрдХ рдЕрд╡рд╕реНрдерд╛рдХреЛ рд▓рд╛рдЧрд┐ рдХреЗрд╣реА рд╕реНрдХреЛрд░ рдорд╛рди рдлрд┐рд░реНрддрд╛ рдЧрд░реНрджрдЫред рд╕рдВрдЦреНрдпрд╛ рдЬрддрд┐ рдЙрдЪреНрдЪ рдЫ, рдкреБрд░рд╕реНрдХрд╛рд░ рдХрд╛рд░реНрдп рддреНрдпрддрд┐ рд░рд╛рдореНрд░реЛ рд╣реБрдиреНрдЫред (рдХреЛрдб рдмреНрд▓рдХ 5)

```python
move_reward = -0.1
goal_reward = 10
end_reward = -10

def reward(m,pos=None):
    pos = pos or m.human
    if not m.is_valid(pos):
        return end_reward
    x = m.at(pos)
    if x==Board.Cell.water or x == Board.Cell.wolf:
        return end_reward
    if x==Board.Cell.apple:
        return goal_reward
    return move_reward
```

рдкреБрд░рд╕реНрдХрд╛рд░ рдХрд╛рд░реНрдпрд╣рд░реВрдХреЛ рдмрд╛рд░реЗрдорд╛ рд░реЛрдЪрдХ рдХреБрд░рд╛ рдпреЛ рд╣реЛ рдХрд┐ рдЕрдзрд┐рдХрд╛рдВрд╢ рдЕрд╡рд╕реНрдерд╛рдорд╛, *рд╣рд╛рдореАрд▓рд╛рдИ рдЦреЗрд▓рдХреЛ рдЕрдиреНрддреНрдпрдорд╛ рдорд╛рддреНрд░ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдкреБрд░рд╕реНрдХрд╛рд░ рджрд┐рдЗрдиреНрдЫред* рдпрд╕рдХреЛ рдорддрд▓рдм рд╣рд╛рдореНрд░реЛ рдПрд▓реНрдЧреЛрд░рд┐рджрдорд▓реЗ рд╕рдХрд╛рд░рд╛рддреНрдордХ рдкреБрд░рд╕реНрдХрд╛рд░рдорд╛ рдкреБрдЧреНрди "рд░рд╛рдореНрд░реЛ" рдЪрд░рдгрд╣рд░реВ рд╕рдореНрдЭрдиреБрдкрд░реНрдЫ рд░ рддрд┐рдиреАрд╣рд░реВрдХреЛ рдорд╣рддреНрддреНрд╡ рдмрдврд╛рдЙрдиреБрдкрд░реНрдЫред рддреНрдпрд╕реНрддреИ, рдЦрд░рд╛рдм рдкрд░рд┐рдгрд╛рдорд╣рд░реВрдорд╛ рдкреБрдЧреНрдиреЗ рд╕рдмреИ рдЪрд╛рд▓рд╣рд░реВрд▓рд╛рдИ рдирд┐рд░реБрддреНрд╕рд╛рд╣рд┐рдд рдЧрд░реНрдиреБрдкрд░реНрдЫред

## Q-рд▓рд░реНрдирд┐рдЩ

рд╣рд╛рдореА рдпрд╣рд╛рдБ рдЫрд▓рдлрд▓ рдЧрд░реНрдиреЗ рдПрд▓реНрдЧреЛрд░рд┐рджрдорд▓рд╛рдИ **Q-рд▓рд░реНрдирд┐рдЩ** рднрдирд┐рдиреНрдЫред рдпрд╕ рдПрд▓реНрдЧреЛрд░рд┐рджрдордорд╛, рдиреАрддрд┐ рдПрдХ рдХрд╛рд░реНрдп (рд╡рд╛ рдбреЗрдЯрд╛ рд╕рдВрд░рдЪрдирд╛) рджреНрд╡рд╛рд░рд╛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдЧрд░рд┐рдПрдХреЛ рдЫ рдЬрд╕рд▓рд╛рдИ **Q-рдЯреЗрдмрд▓** рднрдирд┐рдиреНрдЫред рдпрд╕рд▓реЗ рджрд┐рдЗрдПрдХреЛ рдЕрд╡рд╕реНрдерд╛рдорд╛ рдкреНрд░рддреНрдпреЗрдХ рдХрд╛рд░реНрдпрдХреЛ "рд░рд╛рдореНрд░реЛрдкрди" рд░реЗрдХрд░реНрдб рдЧрд░реНрджрдЫред

рдпрд╕рд▓рд╛рдИ Q-рдЯреЗрдмрд▓ рднрдирд┐рдиреНрдЫ рдХрд┐рдирднрдиреЗ рдпрд╕рд▓рд╛рдИ рддрд╛рд▓рд┐рдХрд╛ рд╡рд╛ рдмрд╣реБ-рдЖрдпрд╛рдорд┐рдХ рдПрд░реЗрдХреЛ рд░реВрдкрдорд╛ рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдЧрд░реНрдиреБ рд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рд╣реБрдиреНрдЫред рдХрд┐рдирднрдиреЗ рд╣рд╛рдореНрд░реЛ рдмреЛрд░реНрдбрдХреЛ рдЖрдпрд╛рдо `width` x `height` рдЫ, рд╣рд╛рдореА Q-рдЯреЗрдмрд▓рд▓рд╛рдИ `width` x `height` x `len(actions)` рдЖрдХрд╛рд░рдХреЛ numpy рдПрд░реЗ рдкреНрд░рдпреЛрдЧ рдЧрд░реЗрд░ рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдЧрд░реНрди рд╕рдХреНрдЫреМрдВ: (рдХреЛрдб рдмреНрд▓рдХ 6)

```python
Q = np.ones((width,height,len(actions)),dtype=np.float)*1.0/len(actions)
```

рдзреНрдпрд╛рди рджрд┐рдиреБрд╣реЛрд╕реН рдХрд┐ рд╣рд╛рдореА Q-рдЯреЗрдмрд▓рдХрд╛ рд╕рдмреИ рдорд╛рдирд╣рд░реВ рд╕рдорд╛рди рдорд╛рдирд▓реЗ рдЖрд░рдореНрдн рдЧрд░реНрдЫреМрдВ, рд╣рд╛рдореНрд░реЛ рдорд╛рдорд▓рд╛рдорд╛ - 0.25ред рдпрд╕рд▓реЗ "рд░реНрдпрд╛рдиреНрдбрдо рд╡рд╛рдХ" рдиреАрддрд┐рд▓рд╛рдИ рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдЧрд░реНрджрдЫ, рдХрд┐рдирднрдиреЗ рдкреНрд░рддреНрдпреЗрдХ рдЕрд╡рд╕реНрдерд╛рдорд╛ рд╕рдмреИ рдЪрд╛рд▓рд╣рд░реВ рд╕рдорд╛рди рд░реВрдкрдорд╛ рд░рд╛рдореНрд░реЛ рдЫрдиреНред рд╣рд╛рдореА рдмреЛрд░реНрдбрдорд╛ рддрд╛рд▓рд┐рдХрд╛ рджреЗрдЦрд╛рдЙрди `plot` рдХрд╛рд░реНрдпрдорд╛ Q-рдЯреЗрдмрд▓ рдкрд╛рд╕ рдЧрд░реНрди рд╕рдХреНрдЫреМрдВ: `m.plot(Q)`ред

![рдкрд┐рдЯрд░рдХреЛ рд╡рд╛рддрд╛рд╡рд░рдг](../../../../8-Reinforcement/1-QLearning/images/env_init.png)

рдкреНрд░рддреНрдпреЗрдХ рд╕реЗрд▓рдХреЛ рдХреЗрдиреНрджреНрд░рдорд╛ рдПрдЙрдЯрд╛ "рддреАрд░" рдЫ рдЬрд╕рд▓реЗ рдЪрд╛рд▓рдХреЛ рдкреНрд░рд╛рдердорд┐рдХ рджрд┐рд╢рд╛ рд╕рдВрдХреЗрдд рдЧрд░реНрджрдЫред рдХрд┐рдирднрдиреЗ рд╕рдмреИ рджрд┐рд╢рд╛рд╣рд░реВ рд╕рдорд╛рди рдЫрдиреН, рдПрдЙрдЯрд╛ рдмрд┐рдиреНрджреБ рджреЗрдЦрд╛рдЗрдПрдХреЛ рдЫред

рдЕрдм рд╣рд╛рдореАрд▓реЗ рд╕рд┐рдореБрд▓реЗрд╢рди рдЪрд▓рд╛рдЙрди, рд╣рд╛рдореНрд░реЛ рд╡рд╛рддрд╛рд╡рд░рдг рдЕрдиреНрд╡реЗрд╖рдг рдЧрд░реНрди, рд░ Q-рдЯреЗрдмрд▓ рдорд╛рдирд╣рд░реВрдХреЛ рд░рд╛рдореНрд░реЛ рд╡рд┐рддрд░рдг рд╕рд┐рдХреНрди рдЖрд╡рд╢реНрдпрдХ рдЫ, рдЬрд╕рд▓реЗ рд╣рд╛рдореАрд▓рд╛рдИ рд╕реНрдпрд╛рдЙрд╕рдореНрдордХреЛ рдмрд╛рдЯреЛ рдзреЗрд░реИ рдЫрд┐рдЯреЛ рдлреЗрд▓рд╛ рдкрд╛рд░реНрди рдЕрдиреБрдорддрд┐ рджрд┐рдиреЗрдЫред

## Q-рд▓рд░реНрдирд┐рдЩрдХреЛ рд╕рд╛рд░: рдмреЗрд▓рдореНрдпрд╛рди рд╕рдореАрдХрд░рдг

рдПрдХрдкрдЯрдХ рд╣рд╛рдореА рдЪрд╛рд▓ рд╕реБрд░реБ рдЧрд░реЗрдкрдЫрд┐, рдкреНрд░рддреНрдпреЗрдХ рдХрд╛рд░реНрдпрд╕рдБрдЧ рд╕рдореНрдмрдиреНрдзрд┐рдд рдкреБрд░рд╕реНрдХрд╛рд░ рд╣реБрдиреЗрдЫ, рдЕрд░реНрдерд╛рддреН рд╣рд╛рдореА рд╕реИрджреНрдзрд╛рдиреНрддрд┐рдХ рд░реВрдкрдорд╛ рдЙрдЪреНрдЪ рддрддреНрдХрд╛рд▓ рдкреБрд░рд╕реНрдХрд╛рд░рдХреЛ рдЖрдзрд╛рд░рдорд╛ рдЕрд░реНрдХреЛ рдХрд╛рд░реНрдп рдЪрдпрди рдЧрд░реНрди рд╕рдХреНрдЫреМрдВред рддрд░, рдЕрдзрд┐рдХрд╛рдВрд╢ рдЕрд╡рд╕реНрдерд╛рд╣рд░реВрдорд╛, рдЪрд╛рд▓рд▓реЗ рд╣рд╛рдореНрд░реЛ рд▓рдХреНрд╖реНрдп рдкреНрд░рд╛рдкреНрдд рдЧрд░реНрджреИрди, рд░ рддреНрдпрд╕реИрд▓реЗ рд╣рд╛рдореА рддреБрд░реБрдиреНрддреИ рдирд┐рд░реНрдгрдп рдЧрд░реНрди рд╕рдХреНрджреИрдиреМрдВ рдХрд┐ рдХреБрди рджрд┐рд╢рд╛ рд░рд╛рдореНрд░реЛ рд╣реЛред

> рдпрд╛рдж рдЧрд░реНрдиреБрд╣реЛрд╕реН рдХрд┐ рддрддреНрдХрд╛рд▓ рдкрд░рд┐рдгрд╛рдо рдорд╣рддреНрддреНрд╡рдкреВрд░реНрдг рдЫреИрди, рдмрд░реБ рдЕрдиреНрддрд┐рдо рдкрд░рд┐рдгрд╛рдо рдорд╣рддреНрддреНрд╡рдкреВрд░реНрдг рдЫ, рдЬреБрди рд╣рд╛рдореАрд▓реЗ рд╕рд┐рдореБрд▓реЗрд╢рдирдХреЛ рдЕрдиреНрддреНрдпрдорд╛ рдкреНрд░рд╛рдкреНрдд рдЧрд░реНрдиреЗрдЫреМрдВред

рдпреЛ рд╡рд┐рд▓рдореНрдмрд┐рдд рдкреБрд░рд╕реНрдХрд╛рд░рд▓рд╛рдИ рдзреНрдпрд╛рдирдорд╛ рд░рд╛рдЦреНрди, рд╣рд╛рдореАрд▓реЗ **[рдбрд╛рдпрдирд╛рдорд┐рдХ рдкреНрд░реЛрдЧреНрд░рд╛рдорд┐рдЩ](https://en.wikipedia.org/wiki/Dynamic_programming)** рдХреЛ рд╕рд┐рджреНрдзрд╛рдиреНрддрд╣рд░реВ рдкреНрд░рдпреЛрдЧ рдЧрд░реНрди рдЖрд╡рд╢реНрдпрдХ рдЫ, рдЬрд╕рд▓реЗ рд╣рд╛рдореАрд▓рд╛рдИ рд╣рд╛рдореНрд░реЛ рд╕рдорд╕реНрдпрд╛рд▓рд╛рдИ рдкреБрдирд░рд╛рд╡реГрддреНрдд рд░реВрдкрдорд╛ рд╕реЛрдЪреНрди рдЕрдиреБрдорддрд┐ рджрд┐рдиреНрдЫред

рдорд╛рдиреМрдВ рд╣рд╛рдореА рдЕрд╣рд┐рд▓реЗ рдЕрд╡рд╕реНрдерд╛ *s* рдорд╛ рдЫреМрдВ, рд░ рд╣рд╛рдореА рдЕрд░реНрдХреЛ рдЕрд╡рд╕реНрдерд╛ *s'* рдорд╛ рдЬрд╛рди рдЪрд╛рд╣рдиреНрдЫреМрдВред рдпрд╕реЛ рдЧрд░реНрджрд╛, рд╣рд╛рдореАрд▓реЗ рддрддреНрдХрд╛рд▓ рдкреБрд░рд╕реНрдХрд╛рд░ *r(s,a)* рдкреНрд░рд╛рдкреНрдд рдЧрд░реНрдиреЗрдЫреМрдВ, рдЬреБрди рдкреБрд░рд╕реНрдХрд╛рд░ рдХрд╛рд░реНрдпрджреНрд╡рд╛рд░рд╛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдЧрд░рд┐рдПрдХреЛ рдЫ, рд╕рд╛рдереИ рдХреЗрд╣реА рднрд╡рд┐рд╖реНрдпрдХреЛ рдкреБрд░рд╕реНрдХрд╛рд░ред рдпрджрд┐ рд╣рд╛рдореА рдорд╛рдиреМрдВ рдХрд┐ рд╣рд╛рдореНрд░реЛ Q-рдЯреЗрдмрд▓рд▓реЗ рдкреНрд░рддреНрдпреЗрдХ рдХрд╛рд░реНрдпрдХреЛ "рдЖрдХрд░реНрд╖рдг" рд╕рд╣реА рд░реВрдкрдорд╛ рдкреНрд░рддрд┐рдмрд┐рдореНрдмрд┐рдд рдЧрд░реНрджрдЫ, рднрдиреЗ рдЕрд╡рд╕реНрдерд╛ *s'* рдорд╛ рд╣рд╛рдореАрд▓реЗ рдХрд╛рд░реНрдп *a'* рдЪрдпрди рдЧрд░реНрдиреЗрдЫреМрдВ, рдЬреБрди *Q(s',a')* рдХреЛ рдЕрдзрд┐рдХрддрдо рдорд╛рдирд╕рдБрдЧ рдореЗрд▓ рдЦрд╛рдиреНрдЫред рдпрд╕рд░реА, рдЕрд╡рд╕реНрдерд╛ *s* рдорд╛ рд╣рд╛рдореАрд▓реЗ рдкреНрд░рд╛рдкреНрдд рдЧрд░реНрди рд╕рдХреНрдиреЗ рд╕рдмреИрднрдиреНрджрд╛ рд░рд╛рдореНрд░реЛ рд╕рдореНрднрд╛рд╡рд┐рдд рднрд╡рд┐рд╖реНрдпрдХреЛ рдкреБрд░рд╕реНрдХрд╛рд░ `max` рджреНрд╡рд╛рд░рд╛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рд╣реБрдиреЗрдЫред

## рдиреАрддрд┐ рдЬрд╛рдБрдЪ рдЧрд░реНрджреИ

Q-Table рд▓реЗ рдкреНрд░рддреНрдпреЗрдХ рдЕрд╡рд╕реНрдерд╛рдорд╛ рдкреНрд░рддреНрдпреЗрдХ рдХреНрд░рд┐рдпрд╛рдХреЛ "рдЖрдХрд░реНрд╖рдг" рд╕реВрдЪреАрдмрджреНрдз рдЧрд░реНрдиреЗ рднрдПрдХрд╛рд▓реЗ, рд╣рд╛рдореНрд░реЛ рд╕рдВрд╕рд╛рд░рдорд╛ рдкреНрд░рднрд╛рд╡рдХрд╛рд░реА рдиреЗрднрд┐рдЧреЗрд╕рди рдкрд░рд┐рднрд╛рд╖рд┐рдд рдЧрд░реНрди рдпрд╕рд▓рд╛рдИ рдкреНрд░рдпреЛрдЧ рдЧрд░реНрди рд╕рдЬрд┐рд▓реЛ рдЫред рд╕рдмреИрднрдиреНрджрд╛ рд╕рд╛рдзрд╛рд░рдг рдЕрд╡рд╕реНрдерд╛рдорд╛, рд╣рд╛рдореА Q-Table рдорд╛ рд╕рдмреИрднрдиреНрджрд╛ рдЙрдЪреНрдЪ рдорд╛рдирд╕рдБрдЧ рдореЗрд▓ рдЦрд╛рдиреЗ рдХреНрд░рд┐рдпрд╛ рдЪрдпрди рдЧрд░реНрди рд╕рдХреНрдЫреМрдВ: (рдХреЛрдб рдмреНрд▓рдХ 9)

```python
def qpolicy_strict(m):
        x,y = m.human
        v = probs(Q[x,y])
        a = list(actions)[np.argmax(v)]
        return a

walk(m,qpolicy_strict)
```

> рдорд╛рдерд┐рдХреЛ рдХреЛрдбрд▓рд╛рдИ рдзреЗрд░реИ рдкрдЯрдХ рдЪрд▓рд╛рдЙрдБрджрд╛, рдХрд╣рд┐рд▓реЗрдХрд╛рд╣реАрдБ рдпреЛ "рдЕрдбреНрдХрд┐рдиреНрдЫ" рднрдиреНрдиреЗ рдХреБрд░рд╛ рддрдкрд╛рдИрдВрд▓реЗ рджреЗрдЦреНрди рд╕рдХреНрдиреБрд╣реБрдиреНрдЫ, рд░ рдпрд╕рд▓рд╛рдИ рд░реЛрдХреНрди рдиреЛрдЯрдмреБрдХрдорд╛ STOP рдмрдЯрди рдерд┐рдЪреНрдиреБрдкрд░реНрдиреЗ рд╣реБрдиреНрдЫред рдпрд╕реНрддреЛ рдХрд┐рди рд╣реБрдиреНрдЫ рднрдиреЗ, рдХрд╣рд┐рд▓реЗрдХрд╛рд╣реАрдБ рджреБрдИ рдЕрд╡рд╕реНрдерд╛рд▓реЗ рдПрдХрдЕрд░реНрдХрд╛рд▓рд╛рдИ "рд╕рд░реНрд╡реЛрддреНрддрдо Q-Value" рдХреЛ рд╣рд┐рд╕рд╛рдмрд▓реЗ рджреЗрдЦрд╛рдЙрдБрдЫрдиреН, рдЬрд╕рд▓реЗ рдЧрд░реНрджрд╛ рдПрдЬреЗрдиреНрдЯ рддреА рдЕрд╡рд╕реНрдерд╛рд╣рд░реВ рдмреАрдЪ рдЕрдирдиреНрдд рд░реВрдкрдорд╛ рдШреБрдорд┐рд░рд╣рдиреНрдЫред

## ЁЯЪАрдЪреБрдиреМрддреА

> **рдХрд╛рд░реНрдп 1:** `walk` рдлрдЩреНрд╕рдирд▓рд╛рдИ рдкрд░рд┐рдорд╛рд░реНрдЬрди рдЧрд░реЗрд░ рдорд╛рд░реНрдЧрдХреЛ рдЕрдзрд┐рдХрддрдо рд▓рдореНрдмрд╛рдЗрд▓рд╛рдИ рдирд┐рд╢реНрдЪрд┐рдд рдЪрд░рдгрд╣рд░реВрдХреЛ рд╕рдВрдЦреНрдпрд╛рд▓реЗ (рдЬрд╕реНрддреИ, 100) рд╕реАрдорд┐рдд рдЧрд░реНрдиреБрд╣реЛрд╕реН, рд░ рдорд╛рдерд┐рдХреЛ рдХреЛрдбрд▓реЗ рд╕рдордп-рд╕рдордпрдорд╛ рдпреЛ рдорд╛рди рдлрд┐рд░реНрддрд╛ рд▓реНрдпрд╛рдПрдХреЛ рд╣реЗрд░реНрдиреБрд╣реЛрд╕реНред

> **рдХрд╛рд░реНрдп 2:** `walk` рдлрдЩреНрд╕рдирд▓рд╛рдИ рдкрд░рд┐рдорд╛рд░реНрдЬрди рдЧрд░реЗрд░ рдпрд╕рд▓реЗ рдкрд╣рд┐рд▓реЗ рдиреИ рдкреБрдЧреЗрдХреЛ рд╕реНрдерд╛рдирдорд╛ рдкреБрди: рдирдЬрд╛рдиреЗ рдмрдирд╛рдЙрдиреБрд╣реЛрд╕реНред рдпрд╕рд▓реЗ `walk` рд▓рд╛рдИ рд▓реВрдк рд╣реБрдирдмрд╛рдЯ рд░реЛрдХреНрдиреЗрдЫ, рддрд░ рдПрдЬреЗрдиреНрдЯ рдЕрдЭреИ рдкрдирд┐ рдпрд╕реНрддреЛ рд╕реНрдерд╛рдирдорд╛ "рдлрд╕реНрди" рд╕рдХреНрдиреЗрдЫ рдЬрд╣рд╛рдБрдмрд╛рдЯ рдмрд╛рд╣рд┐рд░ рдирд┐рд╕реНрдХрди рдЕрд╕рдорд░реНрде рд╣реБрдиреНрдЫред

## рдиреЗрднрд┐рдЧреЗрд╕рди

рдкреНрд░рд╢рд┐рдХреНрд╖рдгрдХреЛ рд╕рдордпрдорд╛ рдкреНрд░рдпреЛрдЧ рдЧрд░рд┐рдПрдХреЛ рдиреАрддрд┐ рдЕрдЭ рд░рд╛рдореНрд░реЛ рдиреЗрднрд┐рдЧреЗрд╕рди рдиреАрддрд┐ рд╣реБрдиреЗрдЫ, рдЬрд╕рд▓реЗ рд╢реЛрд╖рдг рд░ рдЕрдиреНрд╡реЗрд╖рдгрд▓рд╛рдИ рд╕рдВрдпреЛрдЬрди рдЧрд░реНрджрдЫред рдпрд╕ рдиреАрддрд┐рдорд╛, рд╣рд╛рдореА рдкреНрд░рддреНрдпреЗрдХ рдХреНрд░рд┐рдпрд╛рд▓рд╛рдИ рдирд┐рд╢реНрдЪрд┐рдд рд╕рдореНрднрд╛рд╡рдирд╛рдХреЛ рд╕рд╛рде рдЪрдпрди рдЧрд░реНрдиреЗрдЫреМрдВ, рдЬреБрди Q-Table рдорд╛ рд░рд╣реЗрдХрд╛ рдорд╛рдирд╣рд░реВрдХреЛ рдЕрдиреБрдкрд╛рддрдорд╛ рдЖрдзрд╛рд░рд┐рдд рд╣реБрдиреЗрдЫред рдпреЛ рд░рдгрдиреАрддрд┐рд▓реЗ рдЕрдЭреИ рдкрдирд┐ рдПрдЬреЗрдиреНрдЯрд▓рд╛рдИ рдкрд╣рд┐рд▓реЗ рдиреИ рдЕрдиреНрд╡реЗрд╖рдг рдЧрд░рд┐рдПрдХреЛ рд╕реНрдерд╛рдирдорд╛ рдлрд░реНрдХрди рд╕рдХреНрдиреЗ рдмрдирд╛рдЙрдБрдЫ, рддрд░ рддрд▓рдХреЛ рдХреЛрдбрдмрд╛рдЯ рджреЗрдЦреНрди рд╕рдХрд┐рдиреНрдЫ, рдпрд╕рд▓реЗ рдЪрд╛рд╣рд┐рдПрдХреЛ рд╕реНрдерд╛рдирд╕рдореНрдо рдкреБрдЧреНрди рдФрд╕рдд рдорд╛рд░реНрдЧрд▓рд╛рдИ рдзреЗрд░реИ рдЫреЛрдЯреЛ рдмрдирд╛рдЙрдБрдЫ (рдпрд╛рдж рдЧрд░реНрдиреБрд╣реЛрд╕реН рдХрд┐ `print_statistics` рд▓реЗ 100 рдкрдЯрдХ рд╕рд┐рдореБрд▓реЗрд╢рди рдЪрд▓рд╛рдЙрдБрдЫ): (рдХреЛрдб рдмреНрд▓рдХ 10)

```python
def qpolicy(m):
        x,y = m.human
        v = probs(Q[x,y])
        a = random.choices(list(actions),weights=v)[0]
        return a

print_statistics(qpolicy)
```

рдпреЛ рдХреЛрдб рдЪрд▓рд╛рдПрдкрдЫрд┐, рддрдкрд╛рдИрдВрд▓реЗ рдкрд╣рд┐рд▓реЗрдХреЛ рднрдиреНрджрд╛ рдзреЗрд░реИ рд╕рд╛рдиреЛ рдФрд╕рдд рдорд╛рд░реНрдЧ рд▓рдореНрдмрд╛рдЗ рдкреНрд░рд╛рдкреНрдд рдЧрд░реНрдиреБрд╣реБрдиреЗрдЫ, рдЬреБрди 3-6 рдХреЛ рджрд╛рдпрд░рд╛рдорд╛ рд╣реБрдиреЗрдЫред

## рд╕рд┐рдХрд╛рдЗ рдкреНрд░рдХреНрд░рд┐рдпрд╛рдХреЛ рдЕрдиреБрд╕рдиреНрдзрд╛рди рдЧрд░реНрджреИ

рдЬрд╕рд░реА рд╣рд╛рдореАрд▓реЗ рдЙрд▓реНрд▓реЗрдЦ рдЧрд░реНрдпреМрдВ, рд╕рд┐рдХрд╛рдЗ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдЕрдиреНрд╡реЗрд╖рдг рд░ рд╕рдорд╕реНрдпрд╛ рдХреНрд╖реЗрддреНрд░рдХреЛ рд╕рдВрд░рдЪрдирд╛рдХреЛ рдмрд╛рд░реЗрдорд╛ рдкреНрд░рд╛рдкреНрдд рдЬреНрдЮрд╛рдирдХреЛ рдЕрдиреНрд╡реЗрд╖рдгрдХреЛ рдмреАрдЪрдХреЛ рд╕рдиреНрддреБрд▓рди рд╣реЛред рд╣рд╛рдореАрд▓реЗ рджреЗрдЦреНрдпреМрдВ рдХрд┐ рд╕рд┐рдХрд╛рдЗрдХреЛ рдкрд░рд┐рдгрд╛рдо (рдПрдЬреЗрдиреНрдЯрд▓рд╛рдИ рд▓рдХреНрд╖реНрдпрд╕рдореНрдо рдЫреЛрдЯреЛ рдорд╛рд░реНрдЧ рдкрддреНрддрд╛ рд▓рдЧрд╛рдЙрди рдорджреНрджрдд рдЧрд░реНрдиреЗ рдХреНрд╖рдорддрд╛) рд╕реБрдзрд╛рд░ рднрдПрдХреЛ рдЫ, рддрд░ рд╕рд┐рдХрд╛рдЗ рдкреНрд░рдХреНрд░рд┐рдпрд╛рдХреЛ рдХреНрд░рдордорд╛ рдФрд╕рдд рдорд╛рд░реНрдЧ рд▓рдореНрдмрд╛рдЗ рдХрд╕рд░реА рд╡реНрдпрд╡рд╣рд╛рд░ рдЧрд░реНрдЫ рднрдиреНрдиреЗ рдХреБрд░рд╛ рдкрдирд┐ рд╣реЗрд░реНрди рд░реЛрдЪрдХ рдЫ:

### рд╕рд┐рдХрд╛рдЗрдХреЛ рд╕рд╛рд░рд╛рдВрд╢:

- **рдФрд╕рдд рдорд╛рд░реНрдЧ рд▓рдореНрдмрд╛рдЗ рдмрдвреНрдЫ**ред рд╕реБрд░реБрдорд╛ рдФрд╕рдд рдорд╛рд░реНрдЧ рд▓рдореНрдмрд╛рдЗ рдмрдвреЗрдХреЛ рджреЗрдЦрд┐рдиреНрдЫред рдпрд╕рдХреЛ рдХрд╛рд░рдг рдХреЗ рд╣реЛ рднрдиреЗ рдЬрдм рд╣рд╛рдореА рд╡рд╛рддрд╛рд╡рд░рдгрдХреЛ рдмрд╛рд░реЗрдорд╛ рдХреЗрд╣реА рдкрдирд┐ рдерд╛рд╣рд╛ рдкрд╛рдЙрдБрджреИрдиреМрдВ, рд╣рд╛рдореА рдЦрд░рд╛рдм рдЕрд╡рд╕реНрдерд╛рд╣рд░реВ, рдкрд╛рдиреА рд╡рд╛ рднреЗрдбрд┐рдпрд╛рдорд╛ рдлрд╕реНрди рд╕рдХреНрдЫреМрдВред рдЬрдм рд╣рд╛рдореА рдердк рд╕рд┐рдХреНрдЫреМрдВ рд░ рдпреЛ рдЬреНрдЮрд╛рди рдкреНрд░рдпреЛрдЧ рдЧрд░реНрди рдерд╛рд▓реНрдЫреМрдВ, рд╣рд╛рдореА рд╡рд╛рддрд╛рд╡рд░рдгрд▓рд╛рдИ рд▓рд╛рдореЛ рд╕рдордпрд╕рдореНрдо рдЕрдиреНрд╡реЗрд╖рдг рдЧрд░реНрди рд╕рдХреНрдЫреМрдВ, рддрд░ рдЕрдЭреИ рдкрдирд┐ рд╕реНрдпрд╛рдЙрд╣рд░реВ рдХрд╣рд╛рдБ рдЫрдиреН рднрдиреНрдиреЗ рдХреБрд░рд╛ рд░рд╛рдореНрд░реЛрд╕рдБрдЧ рдерд╛рд╣рд╛ рдЫреИрдиред

- **рдорд╛рд░реНрдЧ рд▓рдореНрдмрд╛рдЗ рдШрдЯреНрдЫ, рдЬрдм рд╣рд╛рдореА рдердк рд╕рд┐рдХреНрдЫреМрдВ**ред рдкрд░реНрдпрд╛рдкреНрдд рд╕рд┐рдХреЗрдкрдЫрд┐, рдПрдЬреЗрдиреНрдЯрд▓рд╛рдИ рд▓рдХреНрд╖реНрдп рдкреНрд░рд╛рдкреНрдд рдЧрд░реНрди рд╕рдЬрд┐рд▓реЛ рд╣реБрдиреНрдЫ, рд░ рдорд╛рд░реНрдЧ рд▓рдореНрдмрд╛рдЗ рдШрдЯреНрди рдерд╛рд▓реНрдЫред рддрд░, рд╣рд╛рдореА рдЕрдЭреИ рдкрдирд┐ рдЕрдиреНрд╡реЗрд╖рдгрдХрд╛ рд▓рд╛рдЧрд┐ рдЦреБрд▓рд╛ рдЫреМрдВ, рддреНрдпрд╕реИрд▓реЗ рд╣рд╛рдореА рдкреНрд░рд╛рдпрдГ рдЙрддреНрддрдо рдорд╛рд░реНрдЧрдмрд╛рдЯ рдЯрд╛рдврд╛ рдЬрд╛рдиреНрдЫреМрдВ, рд░ рдирдпрд╛рдБ рд╡рд┐рдХрд▓реНрдкрд╣рд░реВ рдЕрдиреНрд╡реЗрд╖рдг рдЧрд░реНрдЫреМрдВ, рдЬрд╕рд▓реЗ рдорд╛рд░реНрдЧрд▓рд╛рдИ рдЖрджрд░реНрд╢рднрдиреНрджрд╛ рд▓рд╛рдореЛ рдмрдирд╛рдЙрдБрдЫред

- **рд▓рдореНрдмрд╛рдЗ рдЕрдЪрд╛рдирдХ рдмрдвреНрдЫ**ред рдЧреНрд░рд╛рдлрдорд╛ рджреЗрдЦрд┐рдПрдХреЛ рдЕрд░реНрдХреЛ рдХреБрд░рд╛ рдХреЗ рд╣реЛ рднрдиреЗ рдХреБрдиреИ рдмрд┐рдиреНрджреБрдорд╛ рд▓рдореНрдмрд╛рдЗ рдЕрдЪрд╛рдирдХ рдмрдвреНрдЫред рдпрд╕рд▓реЗ рдкреНрд░рдХреНрд░рд┐рдпрд╛рдХреЛ рд╕реНрдЯреЛрдХреЗрд╕реНрдЯрд┐рдХ рдкреНрд░рдХреГрддрд┐ рд╕рдВрдХреЗрдд рдЧрд░реНрджрдЫ, рд░ рдХреБрдиреИ рдмрд┐рдиреНрджреБрдорд╛ рд╣рд╛рдореА Q-Table рдХрд╛ рдорд╛рдирд╣рд░реВ рдирдпрд╛рдБ рдорд╛рдирд╣рд░реВрд▓реЗ рдУрднрд░рд░рд╛рдЗрдЯ рдЧрд░реЗрд░ "рдмрд┐рдЧрд╛рд░реНрди" рд╕рдХреНрдЫреМрдВред рдпреЛ рдЖрджрд░реНрд╢ рд░реВрдкрдорд╛ рд╕рд┐рдХрд╛рдЗ рджрд░ рдШрдЯрд╛рдПрд░ рдиреНрдпреВрдирддрдо рдЧрд░реНрдиреБрдкрд░реНрдЫ (рдЙрджрд╛рд╣рд░рдгрдХрд╛ рд▓рд╛рдЧрд┐, рдкреНрд░рд╢рд┐рдХреНрд╖рдгрдХреЛ рдЕрдиреНрддреНрдпрддрд┐рд░, рд╣рд╛рдореА Q-Table рдХрд╛ рдорд╛рдирд╣рд░реВрд▓рд╛рдИ рд╕рд╛рдиреЛ рдорд╛рдирд▓реЗ рдорд╛рддреНрд░ рд╕рдорд╛рдпреЛрдЬрди рдЧрд░реНрдЫреМрдВ)ред

### рдорд╣рддреНрддреНрд╡рдкреВрд░реНрдг рдХреБрд░рд╛:

рд╕рд┐рдХрд╛рдЗ рдкреНрд░рдХреНрд░рд┐рдпрд╛рдХреЛ рд╕рдлрд▓рддрд╛ рд░ рдЧреБрдгрд╕реНрддрд░ рд╕рд┐рдХрд╛рдЗ рджрд░, рд╕рд┐рдХрд╛рдЗ рджрд░рдХреЛ рдХрдореА, рд░ рдбрд┐рд╕реНрдХрд╛рдЙрдиреНрдЯ рдлреНрдпрд╛рдХреНрдЯрд░ рдЬрд╕реНрддрд╛ рдкреНрдпрд╛рд░рд╛рдорд┐рдЯрд░рд╣рд░реВрдорд╛ рдзреЗрд░реИ рдирд┐рд░реНрднрд░ рдЧрд░реНрджрдЫред рдпреАрд▓рд╛рдИ рдкреНрд░рд╛рдпрдГ **рд╣рд╛рдЗрдкрд░рдкреНрдпрд╛рд░рд╛рдорд┐рдЯрд░рд╣рд░реВ** рднрдирд┐рдиреНрдЫ, рдЬрд╕рд▓реЗ **рдкреНрдпрд╛рд░рд╛рдорд┐рдЯрд░рд╣рд░реВ** рдмрд╛рдЯ рдлрд░рдХ рдкрд╛рд░реНрдЫ, рдЬреБрди рд╣рд╛рдореА рдкреНрд░рд╢рд┐рдХреНрд╖рдгрдХреЛ рдХреНрд░рдордорд╛ рдЕрдиреБрдХреВрд▓рд┐рдд рдЧрд░реНрдЫреМрдВ (рдЬрд╕реНрддреИ, Q-Table рдХрд╛ рдорд╛рдирд╣рд░реВ)ред рдЙрддреНрддрдо рд╣рд╛рдЗрдкрд░рдкреНрдпрд╛рд░рд╛рдорд┐рдЯрд░ рдорд╛рдирд╣рд░реВ рдкрддреНрддрд╛ рд▓рдЧрд╛рдЙрдиреЗ рдкреНрд░рдХреНрд░рд┐рдпрд╛ **рд╣рд╛рдЗрдкрд░рдкреНрдпрд╛рд░рд╛рдорд┐рдЯрд░ рдЕрдиреБрдХреВрд▓рди** рднрдирд┐рдиреНрдЫ, рд░ рдпрд╕рд▓реЗ рдЫреБрдЯреНрдЯреИ рд╡рд┐рд╖рдпрдХреЛ рдпреЛрдЧреНрдп рдЫред

## [рдкреЛрд╕реНрдЯ-рд╡реНрдпрд╛рдЦреНрдпрд╛рди рдХреНрд╡рд┐рдЬ](https://ff-quizzes.netlify.app/en/ml/)

## рдЕрд╕рд╛рдЗрдирдореЗрдиреНрдЯ 
[рдЕрдЭ рдпрдерд╛рд░реНрдердкрд░рдХ рд╕рдВрд╕рд╛рд░](assignment.md)

---

**рдЕрд╕реНрд╡реАрдХрд░рдг**:  
рдпреЛ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ AI рдЕрдиреБрд╡рд╛рдж рд╕реЗрд╡рд╛ [Co-op Translator](https://github.com/Azure/co-op-translator) рдкреНрд░рдпреЛрдЧ рдЧрд░реЗрд░ рдЕрдиреБрд╡рд╛рдж рдЧрд░рд┐рдПрдХреЛ рдЫред рд╣рд╛рдореА рд╢реБрджреНрдзрддрд╛рдХреЛ рд▓рд╛рдЧрд┐ рдкреНрд░рдпрд╛рд╕ рдЧрд░реНрдЫреМрдВ, рддрд░ рдХреГрдкрдпрд╛ рдзреНрдпрд╛рди рджрд┐рдиреБрд╣реЛрд╕реН рдХрд┐ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдЕрдиреБрд╡рд╛рджрдорд╛ рддреНрд░реБрдЯрд┐рд╣рд░реВ рд╡рд╛ рдЕрд╢реБрджреНрдзрддрд╛рд╣рд░реВ рд╣реБрди рд╕рдХреНрдЫред рдпрд╕рдХреЛ рдореВрд▓ рднрд╛рд╖рд╛ рдорд╛ рд░рд╣реЗрдХреЛ рдореВрд▓ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝рд▓рд╛рдИ рдЖрдзрд┐рдХрд╛рд░рд┐рдХ рд╕реНрд░реЛрдд рдорд╛рдирд┐рдиреБрдкрд░реНрдЫред рдорд╣рддреНрд╡рдкреВрд░реНрдг рдЬрд╛рдирдХрд╛рд░реАрдХреЛ рд▓рд╛рдЧрд┐, рд╡реНрдпрд╛рд╡рд╕рд╛рдпрд┐рдХ рдорд╛рдирд╡ рдЕрдиреБрд╡рд╛рдж рд╕рд┐рдлрд╛рд░рд┐рд╕ рдЧрд░рд┐рдиреНрдЫред рдпрд╕ рдЕрдиреБрд╡рд╛рджрдХреЛ рдкреНрд░рдпреЛрдЧрдмрд╛рдЯ рдЙрддреНрдкрдиреНрди рд╣реБрдиреЗ рдХреБрдиреИ рдкрдирд┐ рдЧрд▓рддрдлрд╣рдореА рд╡рд╛ рдЧрд▓рдд рд╡реНрдпрд╛рдЦреНрдпрд╛рдХреЛ рд▓рд╛рдЧрд┐ рд╣рд╛рдореА рдЬрд┐рдореНрдореЗрд╡рд╛рд░ рд╣реБрдиреЗ рдЫреИрдиреМрдВред