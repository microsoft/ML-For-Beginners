<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "9660fbd80845c59c15715cb418cd6e23",
  "translation_date": "2025-08-29T18:15:18+00:00",
  "source_file": "8-Reinforcement/2-Gym/README.md",
  "language_code": "ne"
}
-->
## рдХрд╛рд░реНрдЯрдкреЛрд▓ рд╕реНрдХреЗрдЯрд┐рдЩ

рдЕрдШрд┐рд▓реНрд▓реЛ рдкрд╛рдардорд╛ рд╣рд╛рдореАрд▓реЗ рд╕рдорд╛рдзрд╛рди рдЧрд░реЗрдХреЛ рд╕рдорд╕реНрдпрд╛ рдЦреЗрд▓реМрдирд╛ рдЬрд╕реНрддреЛ рджреЗрдЦрд┐рди рд╕рдХреНрдЫ, рддрд░ рдпреЛ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдЬреАрд╡рдирдХрд╛ рд╕рдорд╕реНрдпрд╛рд╣рд░реВрдорд╛ рдкрдирд┐ рд▓рд╛рдЧреВ рд╣реБрдиреНрдЫред рдзреЗрд░реИ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд╕рдорд╕реНрдпрд╛рд╣рд░реВ рдкрдирд┐ рдпрд╕реНрддреИ рдкреНрд░рдХреГрддрд┐рдХрд╛ рд╣реБрдиреНрдЫрдиреН - рдЬрд╕реНрддреИ рдЪреЗрд╕ рд╡рд╛ рдЧреЛ рдЦреЗрд▓реНрдиред рдпреА рд╕рдорд╕реНрдпрд╛рд╣рд░реВ рд╕рдорд╛рди рдЫрдиреН, рдХрд┐рдирднрдиреЗ рд╣рд╛рдореАрд╕рдБрдЧ рдкрдирд┐ рдирд┐рдпрдорд╣рд░реВ рднрдПрдХреЛ рдмреЛрд░реНрдб рд░ **рдбрд┐рд╕реНрдХреНрд░рд┐рдЯ рдЕрд╡рд╕реНрдерд╛** рд╣реБрдиреНрдЫред

## [рдкрд╛рда рдЕрдШрд┐ рдХреНрд╡рд┐рдЬ](https://gray-sand-07a10f403.1.azurestaticapps.net/quiz/47/)

## рдкрд░рд┐рдЪрдп

рдпрд╕ рдкрд╛рдардорд╛ рд╣рд╛рдореА Q-Learning рдХрд╛ рд╕рд┐рджреНрдзрд╛рдиреНрддрд╣рд░реВрд▓рд╛рдИ **рдХрдиреНрдЯрд┐рдиреНрдпреБрдЕрд╕ рд╕реНрдЯреЗрдЯ** рднрдПрдХреЛ рд╕рдорд╕реНрдпрд╛рдорд╛ рд▓рд╛рдЧреВ рдЧрд░реНрдиреЗрдЫреМрдВ, рдЕрд░реНрдерд╛рддреН рдпрд╕реНрддреЛ рдЕрд╡рд╕реНрдерд╛ рдЬреБрди рдПрдХ рд╡рд╛ рдзреЗрд░реИ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд╕рдВрдЦреНрдпрд╛рд╣рд░реВрд▓реЗ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдЧрд░реНрдЫред рд╣рд╛рдореА рдирд┐рдореНрди рд╕рдорд╕реНрдпрд╛рдорд╛ рдХрд╛рдо рдЧрд░реНрдиреЗрдЫреМрдВ:

> **рд╕рдорд╕реНрдпрд╛**: рдпрджрд┐ рдкрд┐рдЯрд░рд▓реЗ рдмреНрд╡рд╛рдБрд╕рд╛рдмрд╛рдЯ рднрд╛рдЧреНрди рдЪрд╛рд╣рдиреНрдЫ рднрдиреЗ, рдЙрд╕рд▓реЗ рдЫрд┐рдЯреЛ рдЪрд▓реНрди рд╕рдХреНрдиреБрдкрд░реНрдЫред рд╣рд╛рдореА рд╣реЗрд░реНрдиреЗрдЫреМрдВ рдХрд┐ рдкрд┐рдЯрд░рд▓реЗ Q-Learning рдкреНрд░рдпреЛрдЧ рдЧрд░реЗрд░ рд╕реНрдХреЗрдЯрд┐рдЩ, рд╡рд┐рд╢реЗрд╖ рдЧрд░реА рд╕рдиреНрддреБрд▓рди рд░рд╛рдЦреНрди рдХрд╕рд░реА рд╕рд┐рдХреНрди рд╕рдХреНрдЫред

![рдорд╣рд╛рди рднрд╛рдЧрджреМрдб!](../../../../translated_images/escape.18862db9930337e3fce23a9b6a76a06445f229dadea2268e12a6f0a1fde12115.ne.png)

> рдкрд┐рдЯрд░ рд░ рдЙрд╕рдХрд╛ рд╕рд╛рдереАрд╣рд░реВрд▓реЗ рдмреНрд╡рд╛рдБрд╕рд╛рдмрд╛рдЯ рднрд╛рдЧреНрди рд╕рд┐рд░реНрдЬрдирд╛рддреНрдордХ рдЙрдкрд╛рдп рдЕрдкрдирд╛рдЙрдБрдЫрдиреН! рдЪрд┐рддреНрд░: [рдЬреЗрди рд▓реВрдкрд░](https://twitter.com/jenlooper)

рд╣рд╛рдореА рд╕рдиреНрддреБрд▓рдирдХреЛ рдПрдХ рд╕рд░рд▓ рд╕рдВрд╕реНрдХрд░рдг рдкреНрд░рдпреЛрдЧ рдЧрд░реНрдиреЗрдЫреМрдВ рдЬрд╕рд▓рд╛рдИ **рдХрд╛рд░реНрдЯрдкреЛрд▓** рд╕рдорд╕реНрдпрд╛ рднрдирд┐рдиреНрдЫред рдХрд╛рд░реНрдЯрдкреЛрд▓ рд╕рдВрд╕рд╛рд░рдорд╛, рд╣рд╛рдореАрд╕рдБрдЧ рдПрдЙрдЯрд╛ рддреЗрд░реНрд╕реЛ рд╕реНрд▓рд╛рдЗрдбрд░ рдЫ, рдЬрд╕рд▓реЗ рдмрд╛рдпрд╛рдБ рд╡рд╛ рджрд╛рдпрд╛рдБ рд╕рд░реНрди рд╕рдХреНрдЫ, рд░ рд▓рдХреНрд╖реНрдп рд╕реНрд▓рд╛рдЗрдбрд░рдХреЛ рдорд╛рдерд┐ рдард╛рдбреЛ рдкреЛрд▓рд▓рд╛рдИ рд╕рдиреНрддреБрд▓рдирдорд╛ рд░рд╛рдЦреНрдиреБ рд╣реЛред

## рдЖрд╡рд╢реНрдпрдХрддрд╛рд╣рд░реВ

рдпрд╕ рдкрд╛рдардорд╛, рд╣рд╛рдореА **OpenAI Gym** рдирд╛рдордХ рдкреБрд╕реНрддрдХрд╛рд▓рдп рдкреНрд░рдпреЛрдЧ рдЧрд░реНрдиреЗрдЫреМрдВ, рдЬрд╕рд▓реЗ рд╡рд┐рднрд┐рдиреНрди **рдкрд░рд┐рд╡реЗрд╢рд╣рд░реВ** рдЕрдиреБрдХрд░рдг рдЧрд░реНрди рдорджреНрджрдд рдЧрд░реНрдЫред рддрдкрд╛рдИрдВ рдпреЛ рдкрд╛рдардХреЛ рдХреЛрдб рд╕реНрдерд╛рдиреАрдп рд░реВрдкрдорд╛ (рдЬрд╕реНрддреИ Visual Studio Code рдмрд╛рдЯ) рдЪрд▓рд╛рдЙрди рд╕рдХреНрдиреБрд╣реБрдиреНрдЫ, рдЬрд╕рдорд╛ рдЕрдиреБрдХрд░рдг рдирдпрд╛рдБ рдЭреНрдпрд╛рд▓рдорд╛ рдЦреБрд▓реНрдЫред рдЕрдирд▓рд╛рдЗрди рдХреЛрдб рдЪрд▓рд╛рдЙрдБрджрд╛, рддрдкрд╛рдИрдВрд▓реЗ рдХреЛрдбрдорд╛ рдХреЗрд╣реА рдкрд░рд┐рдорд╛рд░реНрдЬрди рдЧрд░реНрдиреБрдкрд░реНрдиреЗ рд╣реБрди рд╕рдХреНрдЫ, рдЬрд╕реНрддреИ [рдпрд╣рд╛рдБ](https://towardsdatascience.com/rendering-openai-gym-envs-on-binder-and-google-colab-536f99391cc7) рд╡рд░реНрдгрди рдЧрд░рд┐рдПрдХреЛ рдЫред

## OpenAI Gym

рдЕрдШрд┐рд▓реНрд▓реЛ рдкрд╛рдардорд╛, рдЦреЗрд▓рдХрд╛ рдирд┐рдпрдорд╣рд░реВ рд░ рдЕрд╡рд╕реНрдерд╛ `Board` рд╡рд░реНрдЧрджреНрд╡рд╛рд░рд╛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдЧрд░рд┐рдПрдХреЛ рдерд┐рдпреЛ, рдЬреБрди рд╣рд╛рдореАрд▓реЗ рдЖрдлреИрдВрд▓реЗ рдмрдирд╛рдПрдХрд╛ рдерд┐рдпреМрдВред рдпрд╣рд╛рдБ рд╣рд╛рдореА рдПрдХ рд╡рд┐рд╢реЗрд╖ **рдЕрдиреБрдХрд░рдг рдкрд░рд┐рд╡реЗрд╢** рдкреНрд░рдпреЛрдЧ рдЧрд░реНрдиреЗрдЫреМрдВ, рдЬрд╕рд▓реЗ рд╕рдиреНрддреБрд▓рди рдкреЛрд▓рдХреЛ рднреМрддрд┐рдХреА рдЕрдиреБрдХрд░рдг рдЧрд░реНрдиреЗрдЫред рдкреНрд░рдмрд▓рди рд╢рд┐рдХреНрд╖рдг рдПрд▓реНрдЧреЛрд░рд┐рджрдорд╣рд░реВ рдкреНрд░рд╢рд┐рдХреНрд╖рдгрдХрд╛ рд▓рд╛рдЧрд┐ рд╕рдмреИрднрдиреНрджрд╛ рд▓реЛрдХрдкреНрд░рд┐рдп рдЕрдиреБрдХрд░рдг рдкрд░рд┐рд╡реЗрд╢рд╣рд░реВрдордзреНрдпреЗ рдПрдХ [Gym](https://gym.openai.com/) рд╣реЛ, рдЬрд╕рд▓рд╛рдИ [OpenAI](https://openai.com/) рд▓реЗ рдорд░реНрдордд рдЧрд░реНрдЫред рдпрд╕ рдЬрд┐рдордХреЛ рдкреНрд░рдпреЛрдЧ рдЧрд░реЗрд░ рд╣рд╛рдореА рдХрд╛рд░реНрдЯрдкреЛрд▓ рдЕрдиреБрдХрд░рдгрджреЗрдЦрд┐ рдПрдЯрд╛рд░реА рдЦреЗрд▓рд╕рдореНрдордХрд╛ рд╡рд┐рднрд┐рдиреНрди **рдкрд░рд┐рд╡реЗрд╢рд╣рд░реВ** рд╕рд┐рд░реНрдЬрдирд╛ рдЧрд░реНрди рд╕рдХреНрдЫреМрдВред

> **рдиреЛрдЯ**: OpenAI Gym рдорд╛ рдЙрдкрд▓рдмреНрдз рдЕрдиреНрдп рдкрд░рд┐рд╡реЗрд╢рд╣рд░реВ [рдпрд╣рд╛рдБ](https://gym.openai.com/envs/#classic_control) рд╣реЗрд░реНрди рд╕рдХреНрдиреБрд╣реБрдиреНрдЫред

рдкрд╣рд┐рд▓реЗ, рдЬрд┐рдо рд╕реНрдерд╛рдкрдирд╛ рдЧрд░реМрдВ рд░ рдЖрд╡рд╢реНрдпрдХ рдкреБрд╕реНрддрдХрд╛рд▓рдпрд╣рд░реВ рдЖрдпрд╛рдд рдЧрд░реМрдВ (рдХреЛрдб рдмреНрд▓рдХ 1):

```python
import sys
!{sys.executable} -m pip install gym 

import gym
import matplotlib.pyplot as plt
import numpy as np
import random
```

## рдЕрднреНрдпрд╛рд╕ - рдХрд╛рд░реНрдЯрдкреЛрд▓ рдкрд░рд┐рд╡реЗрд╢ рд╕реБрд░реБ рдЧрд░реНрдиреБрд╣реЛрд╕реН

рдХрд╛рд░реНрдЯрдкреЛрд▓ рд╕рдиреНрддреБрд▓рди рд╕рдорд╕реНрдпрд╛рдорд╛ рдХрд╛рдо рдЧрд░реНрди, рд╣рд╛рдореАрд▓реЗ рд╕рдореНрдмрдиреНрдзрд┐рдд рдкрд░рд┐рд╡реЗрд╢ рд╕реБрд░реБ рдЧрд░реНрдиреБрдкрд░реНрдЫред рдкреНрд░рддреНрдпреЗрдХ рдкрд░рд┐рд╡реЗрд╢рд╕рдБрдЧ рдирд┐рдореНрди рд╣реБрдиреНрдЫ:

- **рдЕрд╡рд▓реЛрдХрди рд╕реНрдерд╛рди**: рдпрд╕рд▓реЗ рдкрд░рд┐рд╡реЗрд╢рдмрд╛рдЯ рдкреНрд░рд╛рдкреНрдд рд╣реБрдиреЗ рдЬрд╛рдирдХрд╛рд░реАрдХреЛ рд╕рдВрд░рдЪрдирд╛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдЧрд░реНрдЫред рдХрд╛рд░реНрдЯрдкреЛрд▓ рд╕рдорд╕реНрдпрд╛рдорд╛, рд╣рд╛рдореА рдкреЛрд▓рдХреЛ рд╕реНрдерд┐рддрд┐, рд╡реЗрдЧ рд░ рдЕрдиреНрдп рдХреЗрд╣реА рдорд╛рдирд╣рд░реВ рдкреНрд░рд╛рдкреНрдд рдЧрд░реНрдЫреМрдВред

- **рдХрд╛рд░реНрдп рд╕реНрдерд╛рди**: рдпрд╕рд▓реЗ рд╕рдореНрднрд╛рд╡рд┐рдд рдХрд╛рд░реНрдпрд╣рд░реВ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдЧрд░реНрдЫред рд╣рд╛рдореНрд░реЛ рдЕрд╡рд╕реНрдерд╛рдорд╛, рдХрд╛рд░реНрдп рд╕реНрдерд╛рди рдбрд┐рд╕реНрдХреНрд░рд┐рдЯ рдЫ, рд░ рджреБрдИ рдХрд╛рд░реНрдпрд╣рд░реВ рд╕рдорд╛рд╡реЗрд╢ рдЫрдиреН - **рдмрд╛рдпрд╛рдБ** рд░ **рджрд╛рдпрд╛рдБ**ред (рдХреЛрдб рдмреНрд▓рдХ 2)

1. рд╕реБрд░реБ рдЧрд░реНрди, рдирд┐рдореНрди рдХреЛрдб рдЯрд╛рдЗрдк рдЧрд░реНрдиреБрд╣реЛрд╕реН:

    ```python
    env = gym.make("CartPole-v1")
    print(env.action_space)
    print(env.observation_space)
    print(env.action_space.sample())
    ```

рдкрд░рд┐рд╡реЗрд╢ рдХрд╕рд░реА рдХрд╛рдо рдЧрд░реНрдЫ рд╣реЗрд░реНрди, 100 рдЪрд░рдгрд╣рд░реВрдХреЛ рд▓рд╛рдЧрд┐ рд╕рд╛рдиреЛ рдЕрдиреБрдХрд░рдг рдЪрд▓рд╛рдФрдВред рдкреНрд░рддреНрдпреЗрдХ рдЪрд░рдгрдорд╛, рд╣рд╛рдореАрд▓реЗ рдПрдЙрдЯрд╛ рдХрд╛рд░реНрдп рдкреНрд░рджрд╛рди рдЧрд░реНрдиреБрдкрд░реНрдЫ - рдпрд╕ рдЕрдиреБрдХрд░рдгрдорд╛ рд╣рд╛рдореА `action_space` рдмрд╛рдЯ рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рд░реВрдкрдорд╛ рдХрд╛рд░реНрдп рдЪрдпрди рдЧрд░реНрдЫреМрдВред

1. рддрд▓рдХреЛ рдХреЛрдб рдЪрд▓рд╛рдЙрдиреБрд╣реЛрд╕реН рд░ рдпрд╕рд▓реЗ рдХреЗ рдкрд░рд┐рдгрд╛рдо рджрд┐рдиреНрдЫ рд╣реЗрд░реНрдиреБрд╣реЛрд╕реНред

    тЬЕ рдпреЛ рдХреЛрдб рд╕реНрдерд╛рдиреАрдп Python рд╕реНрдерд╛рдкрдирд╛ рдорд╛ рдЪрд▓рд╛рдЙрдиреБ рд░рд╛рдореНрд░реЛ рд╣реБрдиреНрдЫ! (рдХреЛрдб рдмреНрд▓рдХ 3)

    ```python
    env.reset()
    
    for i in range(100):
       env.render()
       env.step(env.action_space.sample())
    env.close()
    ```

    рддрдкрд╛рдИрдВрд▓реЗ рдирд┐рдореНрди рдЬрд╕реНрддреЛ рдХреЗрд╣реА рджреЗрдЦреНрдиреБрд╣реБрдиреЗрдЫ:

    ![рд╕рдиреНрддреБрд▓рди рдирдЧрд░реНрдиреЗ рдХрд╛рд░реНрдЯрдкреЛрд▓](../../../../8-Reinforcement/2-Gym/images/cartpole-nobalance.gif)

1. рдЕрдиреБрдХрд░рдгрдХреЛ рдХреНрд░рдордорд╛, рд╣рд╛рдореАрд▓реЗ рдХрд╕рд░реА рдХрд╛рд░реНрдп рдЧрд░реНрдиреЗ рдирд┐рд░реНрдгрдп рдЧрд░реНрди рдЕрд╡рд▓реЛрдХрдирд╣рд░реВ рдкреНрд░рд╛рдкреНрдд рдЧрд░реНрдиреБрдкрд░реНрдЫред рд╡рд╛рд╕реНрддрд╡рдорд╛, `step` рдХрд╛рд░реНрдпрд▓реЗ рд╣рд╛рд▓рдХреЛ рдЕрд╡рд▓реЛрдХрдирд╣рд░реВ, рдкреБрд░рд╕реНрдХрд╛рд░ рдХрд╛рд░реНрдп, рд░ `done` рдЭрдгреНрдбрд╛ рдлрд┐рд░реНрддрд╛ рдЧрд░реНрдЫ, рдЬрд╕рд▓реЗ рдЕрдиреБрдХрд░рдг рдЬрд╛рд░реА рд░рд╛рдЦреНрди рдЙрдкрдпреБрдХреНрдд рдЫ рдХрд┐ рдЫреИрди рднрдиреЗрд░ рдЬрдирд╛рдЙрдБрдЫ: (рдХреЛрдб рдмреНрд▓рдХ 4)

    ```python
    env.reset()
    
    done = False
    while not done:
       env.render()
       obs, rew, done, info = env.step(env.action_space.sample())
       print(f"{obs} -> {rew}")
    env.close()
    ```

    рддрдкрд╛рдИрдВрд▓реЗ рдиреЛрдЯрдмреБрдХрдХреЛ рдЖрдЙрдЯрдкреБрдЯрдорд╛ рдирд┐рдореНрди рдЬрд╕реНрддреЛ рдХреЗрд╣реА рджреЗрдЦреНрдиреБрд╣реБрдиреЗрдЫ:

    ```text
    [ 0.03403272 -0.24301182  0.02669811  0.2895829 ] -> 1.0
    [ 0.02917248 -0.04828055  0.03248977  0.00543839] -> 1.0
    [ 0.02820687  0.14636075  0.03259854 -0.27681916] -> 1.0
    [ 0.03113408  0.34100283  0.02706215 -0.55904489] -> 1.0
    [ 0.03795414  0.53573468  0.01588125 -0.84308041] -> 1.0
    ...
    [ 0.17299878  0.15868546 -0.20754175 -0.55975453] -> 1.0
    [ 0.17617249  0.35602306 -0.21873684 -0.90998894] -> 1.0
    ```

    рдЕрдиреБрдХрд░рдгрдХреЛ рдкреНрд░рддреНрдпреЗрдХ рдЪрд░рдгрдорд╛ рдлрд┐рд░реНрддрд╛ рдЧрд░рд┐рдиреЗ рдЕрд╡рд▓реЛрдХрди рднреЗрдХреНрдЯрд░рдорд╛ рдирд┐рдореНрди рдорд╛рдирд╣рд░реВ рд╕рдорд╛рд╡реЗрд╢ рдЫрдиреН:
    - рдХрд╛рд░реНрдЯрдХреЛ рд╕реНрдерд┐рддрд┐
    - рдХрд╛рд░реНрдЯрдХреЛ рд╡реЗрдЧ
    - рдкреЛрд▓рдХреЛ рдХреЛрдг
    - рдкреЛрд▓рдХреЛ рдШреБрдорд╛рдЙрдиреЗ рджрд░

1. рддреА рд╕рдВрдЦреНрдпрд╛рд╣рд░реВрдХреЛ рдиреНрдпреВрдирддрдо рд░ рдЕрдзрд┐рдХрддрдо рдорд╛рди рдкреНрд░рд╛рдкреНрдд рдЧрд░реНрдиреБрд╣реЛрд╕реН: (рдХреЛрдб рдмреНрд▓рдХ 5)

    ```python
    print(env.observation_space.low)
    print(env.observation_space.high)
    ```

    рддрдкрд╛рдИрдВрд▓реЗ рдпреЛ рдкрдирд┐ рджреЗрдЦреНрди рд╕рдХреНрдиреБрд╣реБрдиреНрдЫ рдХрд┐ рдкреНрд░рддреНрдпреЗрдХ рдЕрдиреБрдХрд░рдг рдЪрд░рдгрдорд╛ рдкреБрд░рд╕реНрдХрд╛рд░ рдорд╛рди рд╕рдзреИрдВ 1 рд╣реБрдиреНрдЫред рдпрд╕рдХреЛ рдХрд╛рд░рдг рд╣рд╛рдореНрд░реЛ рд▓рдХреНрд╖реНрдп рдпрдерд╛рд╕рдореНрднрд╡ рд▓рд╛рдореЛ рд╕рдордпрд╕рдореНрдо рдмрд╛рдБрдЪреНрдиреБ рд╣реЛ, рдЕрд░реНрдерд╛рддреН рдкреЛрд▓рд▓рд╛рдИ рдард╛рдбреЛ рд╕реНрдерд┐рддрд┐рдорд╛ рд▓рд╛рдореЛ рд╕рдордпрд╕рдореНрдо рд░рд╛рдЦреНрдиреБред

    тЬЕ рд╡рд╛рд╕реНрддрд╡рдорд╛, рдпрджрд┐ рд╣рд╛рдореА 100 рд▓рдЧрд╛рддрд╛рд░ рдкреНрд░рдпрд╛рд╕рд╣рд░реВрдорд╛ 195 рдХреЛ рдФрд╕рдд рдкреБрд░рд╕реНрдХрд╛рд░ рдкреНрд░рд╛рдкреНрдд рдЧрд░реНрди рд╕рдлрд▓ рд╣реБрдиреНрдЫреМрдВ рднрдиреЗ рдХрд╛рд░реНрдЯрдкреЛрд▓ рдЕрдиреБрдХрд░рдг рд╕рдорд╛рдзрд╛рди рднрдПрдХреЛ рдорд╛рдирд┐рдиреНрдЫред

## рдЕрд╡рд╕реНрдерд╛ рдбрд┐рд╕реНрдХреНрд░рд┐рдЯрд╛рдЗрдЬреЗрд╕рди

Q-Learning рдорд╛, рд╣рд╛рдореАрд▓реЗ Q-Table рдирд┐рд░реНрдорд╛рдг рдЧрд░реНрдиреБрдкрд░реНрдЫ, рдЬрд╕рд▓реЗ рдкреНрд░рддреНрдпреЗрдХ рдЕрд╡рд╕реНрдерд╛рдорд╛ рдХреЗ рдЧрд░реНрдиреЗ рднрдиреЗрд░ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдЧрд░реНрдЫред рдпреЛ рдЧрд░реНрдирдХрд╛ рд▓рд╛рдЧрд┐, рдЕрд╡рд╕реНрдерд╛ **рдбрд┐рд╕реНрдХреНрд░рд┐рдЯ** рд╣реБрдиреБрдкрд░реНрдЫ, рдЕрд░реНрдерд╛рддреН рдпрд╕рдорд╛ рд╕реАрдорд┐рдд рд╕рдВрдЦреНрдпрд╛рдХрд╛ рдбрд┐рд╕реНрдХреНрд░рд┐рдЯ рдорд╛рдирд╣рд░реВ рд╕рдорд╛рд╡реЗрд╢ рд╣реБрдиреБрдкрд░реНрдЫред рддреНрдпрд╕реИрд▓реЗ, рд╣рд╛рдореАрд▓реЗ рдХреБрдиреИ рдкреНрд░рдХрд╛рд░рд▓реЗ рд╣рд╛рдореНрд░реЛ рдЕрд╡рд▓реЛрдХрдирд╣рд░реВрд▓рд╛рдИ **рдбрд┐рд╕реНрдХреНрд░рд┐рдЯрд╛рдЗрдЬ** рдЧрд░реНрдиреБрдкрд░реНрдЫ, рддрд┐рдиреАрд╣рд░реВрд▓рд╛рдИ рд╕реАрдорд┐рдд рдЕрд╡рд╕реНрдерд╛рд╣рд░реВрдХреЛ рд╕реЗрдЯрдорд╛ рдореНрдпрд╛рдк рдЧрд░реНрджреИред

рдпрд╕рдХрд╛ рд▓рд╛рдЧрд┐ рдХреЗрд╣реА рддрд░рд┐рдХрд╛рд╣рд░реВ рдЫрдиреН:

- **рдмрд┐рдирд╣рд░реВрдорд╛ рд╡рд┐рднрд╛рдЬрди рдЧрд░реНрдиреБрд╣реЛрд╕реН**ред рдпрджрд┐ рд╣рд╛рдореАрд▓рд╛рдИ рдХреБрдиреИ рдорд╛рдирдХреЛ рдЕрдиреНрддрд░рд╛рд▓ рдерд╛рд╣рд╛ рдЫ рднрдиреЗ, рд╣рд╛рдореА рдпрд╕рд▓рд╛рдИ рдХреЗрд╣реА **рдмрд┐рдирд╣рд░реВ** рдорд╛ рд╡рд┐рднрд╛рдЬрди рдЧрд░реНрди рд╕рдХреНрдЫреМрдВ, рд░ рддреНрдпрд╕рдкрдЫрд┐ рдорд╛рдирд▓рд╛рдИ рддреНрдпрд╕ рдмрд┐рди рдирдореНрдмрд░рд▓реЗ рдкреНрд░рддрд┐рд╕реНрдерд╛рдкрди рдЧрд░реНрди рд╕рдХреНрдЫреМрдВред рдпреЛ numpy рдХреЛ [`digitize`](https://numpy.org/doc/stable/reference/generated/numpy.digitize.html) рд╡рд┐рдзрд┐ рдкреНрд░рдпреЛрдЧ рдЧрд░реЗрд░ рдЧрд░реНрди рд╕рдХрд┐рдиреНрдЫред рдпрд╕ рдЕрд╡рд╕реНрдерд╛рдорд╛, рд╣рд╛рдореАрд▓рд╛рдИ рдЕрд╡рд╕реНрдерд╛рдХреЛ рдЖрдХрд╛рд░ рдерд╛рд╣рд╛ рд╣реБрдиреЗрдЫ, рдХрд┐рдирднрдиреЗ рдпреЛ рдбрд┐рдЬрд┐рдЯрд▓рд╛рдЗрдЬреЗрд╕рдирдХрд╛ рд▓рд╛рдЧрд┐ рдЪрдпрди рдЧрд░рд┐рдПрдХреЛ рдмрд┐рдирд╣рд░реВрдХреЛ рд╕рдВрдЦреНрдпрд╛рдорд╛ рдирд┐рд░реНрднрд░ рдЧрд░реНрджрдЫред

тЬЕ рд╣рд╛рдореА рд░реЗрдЦреАрдп рдЕрдиреНрддрд░рдкреЛрд▓рд╕рди рдкреНрд░рдпреЛрдЧ рдЧрд░реЗрд░ рдорд╛рдирд╣рд░реВрд▓рд╛рдИ рдХреЗрд╣реА рд╕реАрдорд┐рдд рдЕрдиреНрддрд░рд╛рд▓ (рдЬрд╕реНрддреИ, -20 рджреЗрдЦрд┐ 20) рдорд╛ рд▓реНрдпрд╛рдЙрди рд╕рдХреНрдЫреМрдВ, рд░ рддреНрдпрд╕рдкрдЫрд┐ рддреА рд╕рдВрдЦреНрдпрд╛рд╣рд░реВрд▓рд╛рдИ рдЧреЛрд▓ рдЧрд░реЗрд░ рдкреВрд░реНрдгрд╛рдВрдХрдорд╛ рд░реВрдкрд╛рдиреНрддрд░рдг рдЧрд░реНрди рд╕рдХреНрдЫреМрдВред рдпрд╕рд▓реЗ рдЕрд╡рд╕реНрдерд╛рдХреЛ рдЖрдХрд╛рд░рдорд╛ рдереЛрд░реИ рдирд┐рдпрдиреНрддреНрд░рдг рджрд┐рдиреНрдЫ, рд╡рд┐рд╢реЗрд╖ рдЧрд░реА рдпрджрд┐ рд╣рд╛рдореАрд▓рд╛рдИ рдЗрдирдкреБрдЯ рдорд╛рдирд╣рд░реВрдХреЛ рдареНрдпрд╛рдХреНрдХреИ рджрд╛рдпрд░рд╛ рдерд╛рд╣рд╛ рдЫреИрди рднрдиреЗред рдЙрджрд╛рд╣рд░рдгрдХрд╛ рд▓рд╛рдЧрд┐, рд╣рд╛рдореНрд░реЛ рдЕрд╡рд╕реНрдерд╛рдорд╛ 4 рдордзреНрдпреЗ 2 рдорд╛рдирд╣рд░реВрдХреЛ рдорд╛рдерд┐рд▓реНрд▓реЛ/рддрд▓реНрд▓реЛ рд╕реАрдорд╛ рдЫреИрди, рдЬрд╕рд▓реЗ рдЕрд╕реАрдорд┐рдд рдЕрд╡рд╕реНрдерд╛рд╣рд░реВрдХреЛ рдкрд░рд┐рдгрд╛рдо рджрд┐рди рд╕рдХреНрдЫред

рд╣рд╛рдореНрд░реЛ рдЙрджрд╛рд╣рд░рдгрдорд╛, рд╣рд╛рдореА рджреЛрд╕реНрд░реЛ рджреГрд╖реНрдЯрд┐рдХреЛрдг рдЕрдкрдирд╛рдЙрдиреЗрдЫреМрдВред рддрдкрд╛рдИрдВрд▓реЗ рдкрдЫрд┐ рджреЗрдЦреНрди рд╕рдХреНрдиреБрд╣реБрдиреЗрдЫ, рдЕрдкрд░рд┐рднрд╛рд╖рд┐рдд рдорд╛рдерд┐рд▓реНрд▓реЛ/рддрд▓реНрд▓реЛ рд╕реАрдорд╛рд╣рд░реВ рднрдП рдкрдирд┐, рддреА рдорд╛рдирд╣рд░реВ рд╡рд┐рд░рд▓реИ рдирд┐рд╢реНрдЪрд┐рдд рд╕реАрдорд┐рдд рдЕрдиреНрддрд░рд╛рд▓ рдмрд╛рд╣рд┐рд░ рдЬрд╛рдиреНрдЫрдиреН, рддреНрдпрд╕реИрд▓реЗ рддреА рдЪрд░рдо рдорд╛рдирд╣рд░реВ рднрдПрдХрд╛ рдЕрд╡рд╕реНрдерд╛рд╣рд░реВ рдзреЗрд░реИ рджреБрд░реНрд▓рдн рд╣реБрдиреЗрдЫрдиреНред

1. рдпрд╣рд╛рдБ рдПрдЙрдЯрд╛ рдХрд╛рд░реНрдп рдЫ, рдЬрд╕рд▓реЗ рд╣рд╛рдореНрд░реЛ рдореЛрдбреЗрд▓рдмрд╛рдЯ рдЕрд╡рд▓реЛрдХрди рд▓рд┐рдиреНрдЫ рд░ 4 рдкреВрд░реНрдгрд╛рдВрдХ рдорд╛рдирд╣рд░реВрдХреЛ рдЯрдкрд▓ рдЙрддреНрдкрд╛рджрди рдЧрд░реНрдЫ: (рдХреЛрдб рдмреНрд▓рдХ 6)

    ```python
    def discretize(x):
        return tuple((x/np.array([0.25, 0.25, 0.01, 0.1])).astype(np.int))
    ```

1. рдмрд┐рдирд╣рд░реВ рдкреНрд░рдпреЛрдЧ рдЧрд░реЗрд░ рдЕрд░реНрдХреЛ рдбрд┐рд╕реНрдХреНрд░рд┐рдЯрд╛рдЗрдЬреЗрд╕рди рд╡рд┐рдзрд┐ рдкрдирд┐ рдЕрдиреНрд╡реЗрд╖рдг рдЧрд░реМрдВ: (рдХреЛрдб рдмреНрд▓рдХ 7)

    ```python
    def create_bins(i,num):
        return np.arange(num+1)*(i[1]-i[0])/num+i[0]
    
    print("Sample bins for interval (-5,5) with 10 bins\n",create_bins((-5,5),10))
    
    ints = [(-5,5),(-2,2),(-0.5,0.5),(-2,2)] # intervals of values for each parameter
    nbins = [20,20,10,10] # number of bins for each parameter
    bins = [create_bins(ints[i],nbins[i]) for i in range(4)]
    
    def discretize_bins(x):
        return tuple(np.digitize(x[i],bins[i]) for i in range(4))
    ```

1. рдЕрдм рд╕рд╛рдиреЛ рдЕрдиреБрдХрд░рдг рдЪрд▓рд╛рдФрдВ рд░ рддреА рдбрд┐рд╕реНрдХреНрд░рд┐рдЯ рдкрд░рд┐рд╡реЗрд╢ рдорд╛рдирд╣рд░реВ рдЕрд╡рд▓реЛрдХрди рдЧрд░реМрдВред `discretize` рд░ `discretize_bins` рджреБрд╡реИ рдкреНрд░рдпрд╛рд╕ рдЧрд░реНрди рд╕реНрд╡рддрдиреНрддреНрд░ рдорд╣рд╕реБрд╕ рдЧрд░реНрдиреБрд╣реЛрд╕реН рд░ рдХреБрдиреИ рднрд┐рдиреНрдирддрд╛ рдЫ рдХрд┐ рдЫреИрди рд╣реЗрд░реНрдиреБрд╣реЛрд╕реНред

    тЬЕ `discretize_bins` рд▓реЗ рдмрд┐рди рдирдореНрдмрд░ рдлрд┐рд░реНрддрд╛ рдЧрд░реНрдЫ, рдЬреБрди 0-рдЖрдзрд╛рд░рд┐рдд рд╣реБрдиреНрдЫред рддреНрдпрд╕реИрд▓реЗ рдЗрдирдкреБрдЯ рднреЗрд░рд┐рдПрдмрд▓рдХреЛ рдорд╛рди 0 рдХреЛ рд╡рд░рд┐рдкрд░рд┐ рд╣реБрдБрджрд╛ рдпрд╕рд▓реЗ рдЕрдиреНрддрд░рд╛рд▓рдХреЛ рдмреАрдЪрдХреЛ рдирдореНрдмрд░ (10) рдлрд┐рд░реНрддрд╛ рдЧрд░реНрдЫред `discretize` рдорд╛, рд╣рд╛рдореАрд▓реЗ рдЖрдЙрдЯрдкреБрдЯ рдорд╛рдирд╣рд░реВрдХреЛ рджрд╛рдпрд░рд╛рдХреЛ рдмрд╛рд░реЗрдорд╛ рдзреНрдпрд╛рди рджрд┐рдПрдиреМрдВ, рддрд┐рдиреАрд╣рд░реВрд▓рд╛рдИ рдирдХрд╛рд░рд╛рддреНрдордХ рд╣реБрди рдЕрдиреБрдорддрд┐ рджрд┐рдБрджреИ, рддреНрдпрд╕реИрд▓реЗ рдЕрд╡рд╕реНрдерд╛ рдорд╛рдирд╣рд░реВ рд╕рд░реЗрдХрд╛ рдЫреИрдирдиреН, рд░ 0 рд▓реЗ 0 рд▓рд╛рдИ рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдЧрд░реНрдЫред (рдХреЛрдб рдмреНрд▓рдХ 8)

    ```python
    env.reset()
    
    done = False
    while not done:
       #env.render()
       obs, rew, done, info = env.step(env.action_space.sample())
       #print(discretize_bins(obs))
       print(discretize(obs))
    env.close()
    ```

    тЬЕ рдпрджрд┐ рддрдкрд╛рдИрдВ рдкрд░рд┐рд╡реЗрд╢ рдХрд╕рд░реА рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рд╣реБрдиреНрдЫ рд╣реЗрд░реНрди рдЪрд╛рд╣рдиреБрд╣реБрдиреНрдЫ рднрдиреЗ `env.render` рдмрд╛рдЯ рд╕реБрд░реБ рд╣реБрдиреЗ рд▓рд╛рдЗрди рдЕрдирдХрдореЗрдгреНрдЯ рдЧрд░реНрдиреБрд╣реЛрд╕реНред рдЕрдиреНрдпрдерд╛, рддрдкрд╛рдИрдВ рдпрд╕рд▓рд╛рдИ рдкреГрд╖реНрдарднреВрдорд┐рдорд╛ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдЧрд░реНрди рд╕рдХреНрдиреБрд╣реБрдиреНрдЫ, рдЬреБрди рдЫрд┐рдЯреЛ рд╣реБрдиреНрдЫред рд╣рд╛рдореА Q-Learning рдкреНрд░рдХреНрд░рд┐рдпрд╛рдХреЛ рдХреНрд░рдордорд╛ рдпреЛ "рдЕрджреГрд╢реНрдп" рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдкреНрд░рдпреЛрдЧ рдЧрд░реНрдиреЗрдЫреМрдВред

## Q-Table рдХреЛ рд╕рдВрд░рдЪрдирд╛

рдЕрдШрд┐рд▓реНрд▓реЛ рдкрд╛рдардорд╛, рдЕрд╡рд╕реНрдерд╛ 0 рджреЗрдЦрд┐ 8 рд╕рдореНрдордХрд╛ рджреБрдИ рд╕рдВрдЦреНрдпрд╛рд╣рд░реВрдХреЛ рд╕рд╛рдзрд╛рд░рдг рдЬреЛрдбреА рдерд┐рдпреЛ, рд░ рддреНрдпрд╕реИрд▓реЗ Q-Table рд▓рд╛рдИ 8x8x2 рдЖрдХрд╛рд░рдХреЛ numpy рдЯреЗрдиреНрд╕рд░рджреНрд╡рд╛рд░рд╛ рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдЧрд░реНрдиреБ рд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рдерд┐рдпреЛред рдпрджрд┐ рд╣рд╛рдореА рдмрд┐рди рдбрд┐рд╕реНрдХреНрд░рд┐рдЯрд╛рдЗрдЬреЗрд╕рди рдкреНрд░рдпреЛрдЧ рдЧрд░реНрдЫреМрдВ рднрдиреЗ, рд╣рд╛рдореНрд░реЛ рдЕрд╡рд╕реНрдерд╛ рднреЗрдХреНрдЯрд░рдХреЛ рдЖрдХрд╛рд░ рдкрдирд┐ рдерд╛рд╣рд╛ рд╣реБрдиреНрдЫ, рддреНрдпрд╕реИрд▓реЗ рд╣рд╛рдореА рдЙрд╕реНрддреИ рджреГрд╖реНрдЯрд┐рдХреЛрдг рдкреНрд░рдпреЛрдЧ рдЧрд░реНрди рд╕рдХреНрдЫреМрдВ рд░ рдЕрд╡рд╕реНрдерд╛рд▓рд╛рдИ 20x20x10x10x2 рдЖрдХрд╛рд░рдХреЛ рдПрд░реЗрджреНрд╡рд╛рд░рд╛ рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдЧрд░реНрди рд╕рдХреНрдЫреМрдВ (рдпрд╣рд╛рдБ 2 рдХрд╛рд░реНрдп рд╕реНрдерд╛рдирдХреЛ рдЖрдпрд╛рдо рд╣реЛ, рд░ рдкрд╣рд┐рд▓реЛ рдЖрдпрд╛рдорд╣рд░реВ рдЕрд╡рд▓реЛрдХрди рд╕реНрдерд╛рдирдорд╛ рдкреНрд░рдпреЛрдЧ рдЧрд░рд┐рдПрдХрд╛ рдкреНрд░рддреНрдпреЗрдХ рдкреНрдпрд╛рд░рд╛рдорд┐рдЯрд░рдХрд╛ рд▓рд╛рдЧрд┐ рдЪрдпрди рдЧрд░рд┐рдПрдХреЛ рдмрд┐рдирд╣рд░реВрдХреЛ рд╕рдВрдЦреНрдпрд╛рд▓рд╛рдИ рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдЧрд░реНрдЫ)ред

рддрд░, рдХрд╣рд┐рд▓реЗрдХрд╛рд╣реАрдВ рдЕрд╡рд▓реЛрдХрди рд╕реНрдерд╛рдирдХреЛ рдареНрдпрд╛рдХреНрдХреИ рдЖрдпрд╛рдорд╣рд░реВ рдерд╛рд╣рд╛ рд╣реБрдБрджреИрдиред `discretize` рдХрд╛рд░реНрдпрдХреЛ рдЕрд╡рд╕реНрдерд╛рдорд╛, рд╣рд╛рдореА рдХрд╣рд┐рд▓реНрдпреИ рдкрдХреНрдХрд╛ рд╣реБрди рд╕рдХреНрджреИрдиреМрдВ рдХрд┐ рд╣рд╛рдореНрд░реЛ рдЕрд╡рд╕реНрдерд╛ рдирд┐рд╢реНрдЪрд┐рдд рд╕реАрдорд╛рднрд┐рддреНрд░ рд░рд╣рдиреНрдЫ, рдХрд┐рдирднрдиреЗ рдХреЗрд╣реА рдореВрд▓ рдорд╛рдирд╣рд░реВ рд╕реАрдорд┐рдд рдЫреИрдирдиреНред рддреНрдпрд╕реИрд▓реЗ, рд╣рд╛рдореА рдЕрд▓рд┐ рдлрд░рдХ рджреГрд╖реНрдЯрд┐рдХреЛрдг рдЕрдкрдирд╛рдЙрдиреЗрдЫреМрдВ рд░ Q-Table рд▓рд╛рдИ рдбрд┐рдХреНрд╕рдирд░реАрджреНрд╡рд╛рд░рд╛ рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдЧрд░реНрдиреЗрдЫреМрдВред

1. рдЬреЛрдбреА *(state, action)* рд▓рд╛рдИ рдбрд┐рдХреНрд╕рдирд░реА рдХреБрдЮреНрдЬреАрдХреЛ рд░реВрдкрдорд╛ рдкреНрд░рдпреЛрдЧ рдЧрд░реНрдиреБрд╣реЛрд╕реН, рд░ рдорд╛рди Q-Table рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐рдХреЛ рдорд╛рдирд╕рдБрдЧ рд╕рдореНрдмрдиреНрдзрд┐рдд рд╣реБрдиреЗрдЫред (рдХреЛрдб рдмреНрд▓рдХ 9)

    ```python
    Q = {}
    actions = (0,1)
    
    def qvalues(state):
        return [Q.get((state,a),0) for a in actions]
    ```

    рдпрд╣рд╛рдБ рд╣рд╛рдореАрд▓реЗ `qvalues()` рдирд╛рдордХ рдХрд╛рд░реНрдп рдкрдирд┐ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдЧрд░реЗрдХрд╛ рдЫреМрдВ, рдЬрд╕рд▓реЗ Q-Table рдХрд╛ рдорд╛рдирд╣рд░реВрдХреЛ рд╕реВрдЪреА рдлрд┐рд░реНрддрд╛ рдЧрд░реНрдЫ, рдЬреБрди рджрд┐рдЗрдПрдХреЛ рдЕрд╡рд╕реНрдерд╛рдХрд╛ рд▓рд╛рдЧрд┐ рд╕рдмреИ рд╕рдореНрднрд╛рд╡рд┐рдд рдХрд╛рд░реНрдпрд╣рд░реВрд╕рдБрдЧ рд╕рдореНрдмрдиреНрдзрд┐рдд рд╣реБрдиреНрдЫред рдпрджрд┐ рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐ Q-Table рдорд╛ рдЙрдкрд╕реНрдерд┐рдд рдЫреИрди рднрдиреЗ, рд╣рд╛рдореА рдбрд┐рдлрд▓реНрдЯ рдорд╛рдирдХреЛ рд░реВрдкрдорд╛ 0 рдлрд┐рд░реНрддрд╛ рдЧрд░реНрдиреЗрдЫреМрдВред

## Q-Learning рд╕реБрд░реБ рдЧрд░реМрдВ

рдЕрдм рд╣рд╛рдореА рдкрд┐рдЯрд░рд▓рд╛рдИ рд╕рдиреНрддреБрд▓рди рд╕рд┐рдХрд╛рдЙрди рддрдпрд╛рд░ рдЫреМрдВ!

1. рдкрд╣рд┐рд▓реЗ, рдХреЗрд╣реА рд╣рд╛рдЗрдкрд░рдкреНрдпрд╛рд░рд╛рдорд┐рдЯрд░рд╣рд░реВ рд╕реЗрдЯ рдЧрд░реМрдВ: (рдХреЛрдб рдмреНрд▓рдХ 10)

    ```python
    # hyperparameters
    alpha = 0.3
    gamma = 0.9
    epsilon = 0.90
    ```

    рдпрд╣рд╛рдБ, `alpha` **рд▓рд░реНрдирд┐рдЩ рджрд░** рд╣реЛ, рдЬрд╕рд▓реЗ рдкреНрд░рддреНрдпреЗрдХ рдЪрд░рдгрдорд╛ Q-Table рдХрд╛ рд╣рд╛рд▓рдХрд╛ рдорд╛рдирд╣рд░реВрд▓рд╛рдИ рдХрддрд┐ рд╣рджрд╕рдореНрдо рд╕рдорд╛рдпреЛрдЬрди рдЧрд░реНрдиреБрдкрд░реНрдЫ рднрдиреЗрд░ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдЧрд░реНрдЫред рдЕрдШрд┐рд▓реНрд▓реЛ рдкрд╛рдардорд╛ рд╣рд╛рдореАрд▓реЗ 1 рдмрд╛рдЯ рд╕реБрд░реБ рдЧрд░реЗрдХрд╛ рдерд┐рдпреМрдВ, рд░ рддреНрдпрд╕рдкрдЫрд┐ `alpha` рд▓рд╛рдИ рдкреНрд░рд╢рд┐рдХреНрд╖рдгрдХреЛ рдХреНрд░рдордорд╛ рдХрдо рдорд╛рдирд╣рд░реВрдорд╛ рдШрдЯрд╛рдПрдХрд╛ рдерд┐рдпреМрдВред рдпрд╕ рдЙрджрд╛рд╣рд░рдгрдорд╛, рд╣рд╛рдореА рдпрд╕рд▓рд╛рдИ рд╕реНрдерд┐рд░ рд░рд╛рдЦреНрдиреЗрдЫреМрдВ, рд░ рддрдкрд╛рдИрдВ рдкрдЫрд┐ `alpha` рдорд╛рдирд╣рд░реВ рд╕рдорд╛рдпреЛрдЬрди рдЧрд░реЗрд░ рдкреНрд░рдпреЛрдЧ рдЧрд░реНрди рд╕рдХреНрдиреБрд╣реБрдиреНрдЫред

    `gamma` **рдбрд┐рд╕реНрдХрд╛рдЙрдиреНрдЯ рдлреНрдпрд╛рдХреНрдЯрд░** рд╣реЛ, рдЬрд╕рд▓реЗ рднрд╡рд┐рд╖реНрдпрдХреЛ рдкреБрд░рд╕реНрдХрд╛рд░рд▓рд╛рдИ рд╣рд╛рд▓рдХреЛ рдкреБрд░рд╕реНрдХрд╛рд░рднрдиреНрджрд╛ рдХрддрд┐ рдкреНрд░рд╛рдердорд┐рдХрддрд╛ рджрд┐рдиреБрдкрд░реНрдЫ рднрдиреЗрд░ рджреЗрдЦрд╛рдЙрдБрдЫред

    `epsilon` **рдЕрдиреНрд╡реЗрд╖рдг/рд╢реЛрд╖рдг рдХрд╛рд░рдХ** рд╣реЛ, рдЬрд╕рд▓реЗ рдЕрдиреНрд╡реЗрд╖рдгрд▓рд╛рдИ рд╢реЛрд╖рдгрднрдиреНрджрд╛ рдкреНрд░рд╛рдердорд┐рдХрддрд╛ рджрд┐рдиреБрдкрд░реНрдЫ рдХрд┐ рдЫреИрди рднрдиреЗрд░ рдирд┐рд░реНрдзрд╛рд░рдг рдЧрд░реНрдЫред рд╣рд╛рдореНрд░реЛ рдПрд▓реНрдЧреЛрд░рд┐рджрдордорд╛, рд╣рд╛рдореА `epsilon` рдкреНрд░рддрд┐рд╢рдд рдЕрд╡рд╕реНрдерд╛рдорд╛ Q-Table рдорд╛рдирд╣рд░реВ рдЕрдиреБрд╕рд╛рд░ рдЕрд░реНрдХреЛ рдХрд╛рд░реНрдп рдЪрдпрди рдЧрд░реНрдиреЗрдЫреМрдВ, рд░ рдмрд╛рдБрдХреА рдЕрд╡рд╕реНрдерд╛рдорд╛ рд╣рд╛рдореА рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рдХрд╛рд░реНрдп рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдЧрд░реНрдиреЗрдЫреМрдВред рдпрд╕рд▓реЗ рд╣рд╛рдореАрд▓рд╛рдИ рдкрд╣рд┐рд▓реЗ рдХрд╣рд┐рд▓реНрдпреИ рдирджреЗрдЦрд┐рдПрдХреЛ рдЦреЛрдЬ рд╕реНрдерд╛рдирдХрд╛ рдХреНрд╖реЗрддреНрд░рд╣рд░реВ рдЕрдиреНрд╡реЗрд╖рдг рдЧрд░реНрди рдЕрдиреБрдорддрд┐ рджрд┐рдиреЗрдЫред

    тЬЕ рд╕рдиреНрддреБрд▓рдирдХреЛ рд╕рдиреНрджрд░реНрднрдорд╛ - рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рдХрд╛рд░реНрдп (рдЕрдиреНрд╡реЗрд╖рдг) рдЪрдпрди рдЧрд░реНрдиреБ рднрдиреЗрдХреЛ рдЧрд▓рдд рджрд┐рд╢рд╛рдорд╛ рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рдзрдХреНрдХрд╛ рдЬрд╕реНрддреИ рд╣реБрдиреЗрдЫ, рд░ рдкреЛрд▓рд▓реЗ рддреА "рдЧрд▓реНрддреАрд╣рд░реВ" рдмрд╛рдЯ рд╕рдиреНрддреБрд▓рди рдкреБрдирдГрдкреНрд░рд╛рдкреНрдд рдЧрд░реНрди рд╕рд┐рдХреНрдиреБрдкрд░реНрдиреЗрдЫред

### рдПрд▓реНрдЧреЛрд░рд┐рджрдо рд╕реБрдзрд╛рд░ рдЧрд░реНрдиреБрд╣реЛрд╕реН

рд╣рд╛рдореА рдЕрдШрд┐рд▓реНрд▓реЛ рдкрд╛рдардХреЛ рдПрд▓реНрдЧреЛрд░рд┐рджрдордорд╛ рджреБрдИ рд╕реБрдзрд╛рд░рд╣рд░реВ рдкрдирд┐ рдЧрд░реНрди рд╕рдХреНрдЫреМрдВ:

- **рдФрд╕рдд рд╕рдВрдЪрдпреА рдкреБрд░рд╕реНрдХрд╛рд░ рдЧрдгрдирд╛ рдЧрд░реНрдиреБрд╣реЛрд╕реН**, рдзреЗрд░реИ рдЕрдиреБрдХрд░рдгрд╣рд░реВрдорд╛ред рд╣рд╛рдореА рдкреНрд░рддреНрдпреЗрдХ 5000 рдкреБрдирд░рд╛рд╡реГрддреНрддрд┐рдорд╛ рдкреНрд░рдЧрддрд┐ рдкреНрд░рд┐рдиреНрдЯ рдЧрд░реНрдиреЗрдЫреМрдВ, рд░ рд╣рд╛рдореА рд╣рд╛рдореНрд░реЛ рд╕рдВрдЪрдпреА рдкреБрд░рд╕реНрдХрд╛рд░рд▓рд╛рдИ рддреНрдпрд╕ рдЕрд╡рдзрд┐рдХреЛ рдФрд╕рдд рдирд┐рдХрд╛рд▓реНрдиреЗрдЫреМрдВред рдпрд╕рдХреЛ рдорддрд▓рдм, рдпрджрд┐ рд╣рд╛рдореАрд▓реЗ 195 рднрдиреНрджрд╛ рдмрдвреА рдЕрдВрдХ рдкреНрд░рд╛рдкреНрдд рдЧрд░реНрдпреМрдВ рднрдиреЗ - рд╣рд╛рдореАрд▓реЗ рд╕рдорд╕реНрдпрд╛ рд╕рдорд╛рдзрд╛рди рднрдПрдХреЛ рдорд╛рдиреНрди рд╕рдХреНрдЫреМрдВ, рддреНрдпреЛ рдкрдирд┐ рдЖрд╡рд╢реНрдпрдХрддрд╛рднрдиреНрджрд╛ рдЙрдЪреНрдЪ рдЧреБрдгрд╕реНрддрд░рдорд╛ред

- **рдЕрдзрд┐рдХрддрдо рдФрд╕рдд рд╕рдВрдЪрдпреА рдкрд░рд┐рдгрд╛рдо рдЧрдгрдирд╛ рдЧрд░реНрдиреБрд╣реЛрд╕реН**, `Qmax`, рд░ рд╣рд╛рдореА рдкреНрд░рд╢рд┐рдХреНрд╖рдгрдХреЛ рдХреНрд░рдордорд╛ рджреЗрдЦрд┐рдПрдХреЛ рд╕рдмреИрднрдиреНрджрд╛ рд░рд╛рдореНрд░реЛ рдореЛрдбреЗрд▓рд╕рдБрдЧ рд╕рдореНрдмрдиреНрдзрд┐рдд Q-Table рднрдгреНрдбрд╛рд░рдг рдЧрд░реНрдиреЗрдЫреМрдВред рдЬрдм рддрдкрд╛рдИрдВ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдЪрд▓рд╛рдЙрдиреБрд╣реБрдиреНрдЫ, рддрдкрд╛рдИрдВрд▓реЗ рджреЗрдЦреНрдиреБрд╣реБрдиреЗрдЫ рдХрд┐ рдХрд╣рд┐рд▓реЗрдХрд╛рд╣реАрдВ рдФрд╕рдд рд╕рдВрдЪрдпреА рдкрд░рд┐рдгрд╛рдо рдШрдЯреНрди рдерд╛рд▓реНрдЫ, рд░ рд╣рд╛рдореАрд▓реЗ Q-Table рдХрд╛ рддреА рдорд╛рдирд╣рд░реВ рд░рд╛рдЦреНрди рдЪрд╛рд╣рдиреНрдЫреМрдВ, рдЬреБрди рдкреНрд░рд╢рд┐рдХреНрд╖рдгрдХреЛ рдХреНрд░рдордорд╛ рджреЗрдЦрд┐рдПрдХреЛ рд╕рдмреИрднрдиреНрджрд╛ рд░рд╛рдореНрд░реЛ рдореЛрдбреЗрд▓рд╕рдБрдЧ рд╕рдореНрдмрдиреНрдзрд┐рдд рд╣реБрдиреНрдЫред

1. рдкреНрд░рддреНрдпреЗрдХ рдЕрдиреБрдХрд░рдгрдорд╛ рд╕рдВрдЪрдпреА рдкреБрд░рд╕реНрдХрд╛рд░рд╣рд░реВ `rewards` рднреЗрдХреНрдЯрд░рдорд╛ рд╕рдЩреНрдХрд▓рди рдЧрд░реНрдиреБрд╣реЛрд╕реН, рдкрдЫрд┐ рдкреНрд▓рдЯрд┐рдЩрдХрд╛ рд▓рд╛рдЧрд┐ред (рдХреЛрдб рдмреНрд▓рдХ 11)

    ```python
    def probs(v,eps=1e-4):
        v = v-v.min()+eps
        v = v/v.sum()
        return v
    
    Qmax = 0
    cum_rewards = []
    rewards = []
    for epoch in range(100000):
        obs = env.reset()
        done = False
        cum_reward=0
        # == do the simulation ==
        while not done:
            s = discretize(obs)
            if random.random()<epsilon:
                # exploitation - chose the action according to Q-Table probabilities
                v = probs(np.array(qvalues(s)))
                a = random.choices(actions,weights=v)[0]
            else:
                # exploration - randomly chose the action
                a = np.random.randint(env.action_space.n)
    
            obs, rew, done, info = env.step(a)
            cum_reward+=rew
            ns = discretize(obs)
            Q[(s,a)] = (1 - alpha) * Q.get((s,a),0) + alpha * (rew + gamma * max(qvalues(ns)))
        cum_rewards.append(cum_reward)
        rewards.append(cum_reward)
        # == Periodically print results and calculate average reward ==
        if epoch%5000==0:
            print(f"{epoch}: {np.average(cum_rewards)}, alpha={alpha}, epsilon={epsilon}")
            if np.average(cum_rewards) > Qmax:
                Qmax = np.average(cum_rewards)
                Qbest = Q
            cum_rewards=[]
    ```

рддрдкрд╛рдИрдВрд▓реЗ рддреА рдкрд░рд┐рдгрд╛рдорд╣рд░реВрдмрд╛рдЯ рдХреЗ рджреЗрдЦреНрди рд╕рдХреНрдиреБрд╣реБрдиреНрдЫ:

- **рд╣рд╛рдореНрд░реЛ рд▓рдХреНрд╖реНрдп рдирдЬрд┐рдХ**ред рд╣рд╛рдореА 100+ рд▓рдЧрд╛рддрд╛рд░ рдЕрдиреБрдХрд░рдгрд╣рд░реВрдХреЛ рд▓рд╛рдЧрд┐ 195 рд╕рдВрдЪрдпреА рдкреБрд░рд╕реНрдХрд╛рд░ рдкреНрд░рд╛рдкреНрдд рдЧрд░реНрдиреЗ рд▓рдХреНрд╖реНрдпрдорд╛ рдзреЗрд░реИ рдирдЬрд┐рдХ рдЫреМрдВ, рд╡рд╛ рд╣рд╛рдореАрд▓реЗ рд╡рд╛рд╕реНрддрд╡рдорд╛ рдпреЛ рдкреНрд░рд╛рдкреНрдд рдЧрд░рд┐рд╕рдХреНрдпреМрдВ! рдпрджрд┐ рд╣рд╛рдореАрд▓реЗ рд╕рд╛рдирд╛ рд╕рдЩреНрдЦреНрдпрд╛рд╣рд░реВ рдкреНрд░рд╛рдкреНрдд рдЧрд░реНрдпреМрдВ рднрдиреЗ рдкрдирд┐, рд╣рд╛рдореА рдЕрдЭреИ рдерд╛рд╣рд╛ рдкрд╛рдЙрдБрджреИрдиреМрдВ, рдХрд┐рдирднрдиреЗ рд╣рд╛рдореА 5000 рд░рдирд╣рд░реВрдХреЛ рдФрд╕рдд рдирд┐рдХрд╛рд▓реНрдЫреМрдВ, рд░ рдФрдкрдЪрд╛рд░рд┐рдХ рдорд╛рдкрджрдгреНрдбрдорд╛ рдХреЗрд╡рд▓ 100 рд░рди рдЖрд╡рд╢реНрдпрдХ рдЫред

- **рдкреБрд░рд╕реНрдХрд╛рд░ рдШрдЯреНрди рдерд╛рд▓реНрдЫ**ред рдХрд╣рд┐рд▓реЗрдХрд╛рд╣реАрдВ рдкреБрд░рд╕реНрдХрд╛рд░ рдШрдЯреНрди рдерд╛рд▓реНрдЫ, рдЬрд╕рдХреЛ рдорддрд▓рдм рд╣рд╛рдореАрд▓реЗ Q-Table рдорд╛ рдкрд╣рд┐рд▓реЗ рд╕рд┐рдХреЗрдХрд╛ рдорд╛рдирд╣рд░реВрд▓рд╛рдИ рдмрд┐рдЧрд╛рд░реНрди рд╕рдХреНрдЫреМрдВ, рдЬрд╕рд▓реЗ рд╕реНрдерд┐рддрд┐ рдЭрдиреН рдЦрд░рд╛рдм рдмрдирд╛рдЙрдБрдЫред

рдпреЛ рдЕрд╡рд▓реЛрдХрди рдЕрдЭ рд╕реНрдкрд╖реНрдЯ рд░реВрдкрдорд╛ рджреЗрдЦрд┐рдиреНрдЫ рдпрджрд┐ рд╣рд╛рдореА рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдкреНрд░рдЧрддрд┐ рдкреНрд▓рдЯ рдЧрд░реНрдЫреМрдВред

## рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдкреНрд░рдЧрддрд┐ рдкреНрд▓рдЯрд┐рдЩ

рдкреНрд░рд╢рд┐рдХреНрд╖рдгрдХреЛ рдХреНрд░рдордорд╛, рд╣рд╛рдореАрд▓реЗ рдкреНрд░рддреНрдпреЗрдХ рдкреБрдирд░рд╛рд╡реГрддреНрддрд┐рдорд╛ рд╕рдВрдЪрдпреА рдкреБрд░рд╕реНрдХрд╛рд░ рдорд╛рдирд▓рд╛рдИ `rewards` рднреЗрдХреНрдЯрд░рдорд╛ рд╕рдЩреНрдХрд▓рди рдЧрд░реЗрдХрд╛ рдЫреМрдВред рдпреЛ рдкреБрдирд░рд╛рд╡реГрддреНрддрд┐ рд╕рдЩреНрдЦреНрдпрд╛рдХреЛ рд╡рд┐рд░реБрджреНрдз рдкреНрд▓рдЯ рдЧрд░реНрджрд╛ рдпрд╕рд░реА рджреЗрдЦрд┐рдиреНрдЫ:

```python
plt.plot(rewards)
```

![рдХрдЪреНрдЪрд╛ рдкреНрд░рдЧрддрд┐](../../../../translated_images/train_progress_raw.2adfdf2daea09c596fc786fa347a23e9aceffe1b463e2257d20a9505794823ec.ne.png)

рдпрд╕ рдЧреНрд░рд╛рдлрдмрд╛рдЯ рдХреЗрд╣реА рднрдиреНрди рд╕рдореНрднрд╡ рдЫреИрди, рдХрд┐рдирднрдиреЗ рд╕реНрдЯреЛрдХрд╛рд╕реНрдЯрд┐рдХ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдкреНрд░рдХреНрд░рд┐рдпрд╛рдХреЛ рдкреНрд░рдХреГрддрд┐рдХрд╛ рдХрд╛рд░рдг рдкреНрд░рд╢рд┐рдХреНрд╖рдг рд╕рддреНрд░рд╣рд░реВрдХреЛ рд▓рдореНрдмрд╛рдЗ рдзреЗрд░реИ рдлрд░рдХ рд╣реБрдиреНрдЫред рдпрд╕ рдЧреНрд░рд╛рдлрд▓рд╛рдИ рдЕрдЭ рдЕрд░реНрдердкреВрд░реНрдг рдмрдирд╛рдЙрди, рд╣рд╛рдореА 100 рдЬрд╕реНрддреИ рдкреНрд░рдпреЛрдЧрд╣рд░реВрдХреЛ рд╢реНрд░реГрдЩреНрдЦрд▓рд╛рдорд╛ **рдЪрд▓рд┐рд░рд╣реЗрдХреЛ рдФрд╕рдд** рдЧрдгрдирд╛ рдЧрд░реНрди рд╕рдХреНрдЫреМрдВред рдпреЛ `np.convolve` рдкреНрд░рдпреЛрдЧ рдЧрд░реЗрд░ рд╕рдЬрд┐рд▓реИ рдЧрд░реНрди рд╕рдХрд┐рдиреНрдЫ: (рдХреЛрдб рдмреНрд▓рдХ 12)

```python
def running_average(x,window):
    return np.convolve(x,np.ones(window)/window,mode='valid')

plt.plot(running_average(rewards,100))
```

![рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдкреНрд░рдЧрддрд┐](../../../../translated_images/train_progress_runav.c71694a8fa9ab35935aff6f109e5ecdfdbdf1b0ae265da49479a81b5fae8f0aa.ne.png)

## рд╣рд╛рдЗрдкрд░рдкреНрдпрд╛рд░рд╛рдорд┐рдЯрд░рд╣рд░реВ рдлрд░рдХ рдкрд╛рд░реНрджреИ

рдкреНрд░рд╢рд┐рдХреНрд╖рдгрд▓рд╛рдИ рдЕрдЭ рд╕реНрдерд┐рд░ рдмрдирд╛рдЙрди, рдкреНрд░рд╢рд┐рдХреНрд╖рдгрдХреЛ рдХреНрд░рдордорд╛ рдХреЗрд╣реА рд╣рд╛рдЗрдкрд░рдкреНрдпрд╛рд░рд╛рдорд┐рдЯрд░рд╣рд░реВ рд╕рдорд╛рдпреЛрдЬрди рдЧрд░реНрдиреБ рдЙрдЪрд┐рдд рд╣реБрдиреНрдЫред рд╡рд┐рд╢реЗрд╖ рдЧрд░реА:

- **рд▓рд░реНрдирд┐рдЩ рджрд░рдХрд╛ рд▓рд╛рдЧрд┐**, `alpha`, рд╣рд╛рдореА 1 рдирдЬрд┐рдХрдХрд╛ рдорд╛рдирд╣рд░реВрдмрд╛рдЯ рд╕реБрд░реБ рдЧрд░реНрди рд╕рдХреНрдЫреМрдВ, рд░ рддреНрдпрд╕рдкрдЫрд┐ рдпреЛ рдкреНрдпрд╛рд░рд╛рдорд┐рдЯрд░ рдШрдЯрд╛рдЙрдБрджреИ рдЬрд╛рди рд╕рдХреНрдЫреМрдВред рд╕рдордпрд╕рдБрдЧреИ, рд╣рд╛рдореА Q-Table рдорд╛ рд░рд╛рдореНрд░реЛ рд╕рдореНрднрд╛рд╡реНрдпрддрд╛ рдорд╛рдирд╣рд░реВ рдкреНрд░рд╛рдкреНрдд рдЧрд░реНрджреИ рдЬрд╛рдиреЗрдЫреМрдВ, рд░ рддреНрдпрд╕реИрд▓реЗ рд╣рд╛рдореАрд▓реЗ рддрд┐рдиреАрд╣рд░реВрд▓рд╛рдИ рдереЛрд░реИ рд╕рдорд╛рдпреЛрдЬрди рдЧрд░реНрдиреБрдкрд░реНрдЫ, рд░ рдирдпрд╛рдБ рдорд╛рдирд╣рд░реВрд╕рдБрдЧ рдкреВрд░реНрдг рд░реВрдкрдорд╛ рдУрднрд░рд░рд╛рдЗрдЯ рдЧрд░реНрдиреБ рд╣реБрдБрджреИрдиред

- **epsilon рдмрдврд╛рдЙрдиреБрд╣реЛрд╕реН**ред рд╣рд╛рдореАрд▓реЗ `epsilon` рд▓рд╛рдИ рдмрд┐рд╕реНрддрд╛рд░реИ рдмрдврд╛рдЙрди рдЪрд╛рд╣рди рд╕рдХреНрдЫреМрдВ, рддрд╛рдХрд┐ рдХрдо рдЕрдиреНрд╡реЗрд╖рдг рд░ рдмрдвреА рд╢реЛрд╖рдг рдЧрд░реНрди рд╕рдХрд┐рдпреЛрд╕реНред рд╕рд╛рдпрдж `epsilon` рдХреЛ рдХрдо рдорд╛рдирдмрд╛рдЯ рд╕реБрд░реБ рдЧрд░реЗрд░, рд░ рд▓рдЧрднрдЧ 1 рд╕рдореНрдо рдмрдврд╛рдЙрдиреБ рдЙрдЪрд┐рдд рд╣реБрдиреНрдЫред
> **рдХрд╛рд░реНрдп рез**: рд╣рд╛рдЗрдкрд░рдкреНрдпрд╛рд░рд╛рдорд┐рдЯрд░рдХрд╛ рдорд╛рдирд╣рд░реВ рдкрд░рд┐рд╡рд░реНрддрди рдЧрд░реЗрд░ рдЦреЗрд▓реНрдиреБрд╣реЛрд╕реН рд░ рдЙрдЪреНрдЪ рдХреНрдпреБрдореБрд▓реЗрдЯрд┐рдн рдЗрдирд╛рдо рдкреНрд░рд╛рдкреНрдд рдЧрд░реНрди рд╕рдХреНрдиреБрд╣реБрдиреНрдЫ рдХрд┐ рд╣реЗрд░реНрдиреБрд╣реЛрд╕реНред рдХреЗ рддрдкрд╛рдИрдВ резрепрел рднрдиреНрджрд╛ рдорд╛рдерд┐ рдкреНрд░рд╛рдкреНрдд рдЧрд░реНрджреИ рд╣реБрдиреБрд╣реБрдиреНрдЫ?
> **рдХрд╛рд░реНрдп реи**: рд╕рдорд╕реНрдпрд╛рд▓рд╛рдИ рдФрдкрдЪрд╛рд░рд┐рдХ рд░реВрдкрдорд╛ рд╕рдорд╛рдзрд╛рди рдЧрд░реНрди, рддрдкрд╛рдИрдВрд▓реЗ резрежреж рд▓рдЧрд╛рддрд╛рд░ рд░рдирд╣рд░реВрдорд╛ резрепрел рдФрд╕рдд рдЗрдирд╛рдо рдкреНрд░рд╛рдкреНрдд рдЧрд░реНрдиреБрдкрд░реНрдиреЗрдЫред рдкреНрд░рд╢рд┐рдХреНрд╖рдгрдХреЛ рдХреНрд░рдордорд╛ рдпреЛ рдорд╛рдкрди рдЧрд░реНрдиреБрд╣реЛрд╕реН рд░ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдЧрд░реНрдиреБрд╣реЛрд╕реН рдХрд┐ рддрдкрд╛рдИрдВрд▓реЗ рд╕рдорд╕реНрдпрд╛рд▓рд╛рдИ рдФрдкрдЪрд╛рд░рд┐рдХ рд░реВрдкрдорд╛ рд╕рдорд╛рдзрд╛рди рдЧрд░реНрдиреБрднрдПрдХреЛ рдЫ!

## рдирддрд┐рдЬрд╛ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрдирдорд╛ рд╣реЗрд░реНрджреИ

рдпреЛ рд╣реЗрд░реНрди рд░реЛрдЪрдХ рд╣реБрдиреЗрдЫ рдХрд┐ рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдореЛрдбреЗрд▓ рдХрд╕рд░реА рд╡реНрдпрд╡рд╣рд╛рд░ рдЧрд░реНрдЫред рдЖрдЙрдиреБрд╣реЛрд╕реН, рд╕рд┐рдореБрд▓реЗрд╢рди рдЪрд▓рд╛рдЙрдБрдЫреМрдВ рд░ рдкреНрд░рд╢рд┐рдХреНрд╖рдгрдХреЛ рд╕рдордпрдорд╛ рдЬрд╕реНрддреИ рдХрд╛рд░реНрдп рдЪрдпрди рд░рдгрдиреАрддрд┐ рдЕрдиреБрд╕рд░рдг рдЧрд░реМрдВ, Q-Table рдорд╛ рд╕рдореНрднрд╛рд╡реНрдпрддрд╛ рд╡рд┐рддрд░рдг рдЕрдиреБрд╕рд╛рд░ рдирдореВрдирд╛ рд▓рд┐рдИ: (рдХреЛрдб рдмреНрд▓рдХ резрей)

```python
obs = env.reset()
done = False
while not done:
   s = discretize(obs)
   env.render()
   v = probs(np.array(qvalues(s)))
   a = random.choices(actions,weights=v)[0]
   obs,_,done,_ = env.step(a)
env.close()
```

рддрдкрд╛рдИрдВрд▓реЗ рдпрд╕ рдкреНрд░рдХрд╛рд░рдХреЛ рдХреЗрд╣реА рджреЗрдЦреНрдиреБрд╣реБрдиреЗрдЫ:

![рдПрдХ рд╕рдиреНрддреБрд▓рд┐рдд рдХрд╛рд░реНрдЯрдкреЛрд▓](../../../../8-Reinforcement/2-Gym/images/cartpole-balance.gif)

---

## ЁЯЪАрдЪреБрдиреМрддреА

> **рдХрд╛рд░реНрдп рей**: рдпрд╣рд╛рдБ, рд╣рд╛рдореА Q-Table рдХреЛ рдЕрдиреНрддрд┐рдо рдкреНрд░рддрд┐рд▓рд┐рдкрд┐ рдкреНрд░рдпреЛрдЧ рдЧрд░рд┐рд░рд╣реЗрдХрд╛ рдерд┐рдпреМрдВ, рдЬреБрди рд╕рдзреИрдВ рдЙрддреНрддрдо рдирд╣реБрди рд╕рдХреНрдЫред рд╕рдореНрдЭрдиреБрд╣реЛрд╕реН рдХрд┐ рд╣рд╛рдореАрд▓реЗ рд╕рдмреИрднрдиреНрджрд╛ рд░рд╛рдореНрд░реЛ рдкреНрд░рджрд░реНрд╢рди рдЧрд░реНрдиреЗ Q-Table рд▓рд╛рдИ `Qbest` рднреЗрд░рд┐рдПрдмрд▓рдорд╛ рднрдгреНрдбрд╛рд░рдг рдЧрд░реЗрдХрд╛ рдЫреМрдВ! `Qbest` рд▓рд╛рдИ `Q` рдорд╛ рдкреНрд░рддрд┐рд▓рд┐рдкрд┐ рдЧрд░реЗрд░, рддреНрдпрд╣реА рдЙрджрд╛рд╣рд░рдг рдкреНрд░рдпрд╛рд╕ рдЧрд░реНрдиреБрд╣реЛрд╕реН рд░ рдХреЗ рдлрд░рдХ рджреЗрдЦрд┐рдиреНрдЫ рдХрд┐ рднрдиреЗрд░ рд╣реЗрд░реНрдиреБрд╣реЛрд╕реНред

> **рдХрд╛рд░реНрдп рек**: рдпрд╣рд╛рдБ рд╣рд╛рдореА рдкреНрд░рддреНрдпреЗрдХ рдЪрд░рдгрдорд╛ рд╕рдмреИрднрдиреНрджрд╛ рд░рд╛рдореНрд░реЛ рдХрд╛рд░реНрдп рдЪрдпрди рдЧрд░рд┐рд░рд╣реЗрдХрд╛ рдерд┐рдПрдиреМрдВ, рдмрд░реБ рд╕рдореНрдмрдиреНрдзрд┐рдд рд╕рдореНрднрд╛рд╡реНрдпрддрд╛ рд╡рд┐рддрд░рдгрд╕рдБрдЧ рдирдореВрдирд╛ рд▓рд┐рдЗрд░рд╣реЗрдХрд╛ рдерд┐рдпреМрдВред рдХреЗ рдпреЛ рд╕рдзреИрдВ Q-Table рдХреЛ рдЙрдЪреНрдЪрддрдо рдорд╛рди рднрдПрдХреЛ рд╕рдмреИрднрдиреНрджрд╛ рд░рд╛рдореНрд░реЛ рдХрд╛рд░реНрдп рдЪрдпрди рдЧрд░реНрди рдЕрдзрд┐рдХ рдЙрдкрдпреБрдХреНрдд рд╣реБрдиреЗрдЫ? рдпреЛ `np.argmax` рдлрдВрдХреНрд╢рди рдкреНрд░рдпреЛрдЧ рдЧрд░реЗрд░, Q-Table рдХреЛ рдЙрдЪреНрдЪрддрдо рдорд╛рдирд╕рдБрдЧ рд╕рдореНрдмрдиреНрдзрд┐рдд рдХрд╛рд░реНрдп рдирдореНрдмрд░ рдкрддреНрддрд╛ рд▓рдЧрд╛рдЙрди рд╕рдХрд┐рдиреНрдЫред рдпреЛ рд░рдгрдиреАрддрд┐ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдЧрд░реНрдиреБрд╣реЛрд╕реН рд░ рдпрд╕рд▓реЗ рд╕рдиреНрддреБрд▓рди рд╕реБрдзрд╛рд░ рдЧрд░реНрдЫ рдХрд┐ рднрдиреЗрд░ рд╣реЗрд░реНрдиреБрд╣реЛрд╕реНред

## [рдкреЛрд╕реНрдЯ-рд╡реНрдпрд╛рдЦреНрдпрд╛рди рдХреНрд╡рд┐рдЬ](https://gray-sand-07a10f403.1.azurestaticapps.net/quiz/48/)

## рдЕрд╕рд╛рдЗрдирдореЗрдиреНрдЯ
[рдорд╛рдЙрдиреНрдЯреЗрди рдХрд╛рд░рд▓рд╛рдИ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рджрд┐рдиреБрд╣реЛрд╕реН](assignment.md)

## рдирд┐рд╖реНрдХрд░реНрд╖

рд╣рд╛рдореАрд▓реЗ рдЕрдм рдПрдЬреЗрдиреНрдЯрд╣рд░реВрд▓рд╛рдИ рд░рд╛рдореНрд░реЛ рдирддрд┐рдЬрд╛ рдкреНрд░рд╛рдкреНрдд рдЧрд░реНрди рдХрд╕рд░реА рдкреНрд░рд╢рд┐рдХреНрд╖рдг рджрд┐рдиреЗ рднрдиреЗрд░ рд╕рд┐рдХреЗрдХрд╛ рдЫреМрдВ, рдХреЗрд╡рд▓ рддрд┐рдиреАрд╣рд░реВрд▓рд╛рдИ рдЦреЗрд▓рдХреЛ рдЗрдЪреНрдЫрд┐рдд рдЕрд╡рд╕реНрдерд╛рд▓рд╛рдИ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдЧрд░реНрдиреЗ рдЗрдирд╛рдо рдлрдВрдХреНрд╢рди рдкреНрд░рджрд╛рди рдЧрд░реЗрд░, рд░ рддрд┐рдиреАрд╣рд░реВрд▓рд╛рдИ рдЦреЛрдЬ рд╕реНрдерд╛рдирд▓рд╛рдИ рдмреБрджреНрдзрд┐рдорд╛рдиреАрдкреВрд░реНрд╡рдХ рдЕрдиреНрд╡реЗрд╖рдг рдЧрд░реНрдиреЗ рдЕрд╡рд╕рд░ рджрд┐рдПрд░ред рд╣рд╛рдореАрд▓реЗ Q-Learning рдПрд▓реНрдЧреЛрд░рд┐рджрдорд▓рд╛рдИ рдЫреБрдЯреНрдЯреИ рд░ рдирд┐рд░рдиреНрддрд░ рд╡рд╛рддрд╛рд╡рд░рдгрд╣рд░реВрдХреЛ рдЕрд╡рд╕реНрдерд╛рдорд╛ рд╕рдлрд▓рддрд╛рдкреВрд░реНрд╡рдХ рд▓рд╛рдЧреВ рдЧрд░реЗрдХрд╛ рдЫреМрдВ, рддрд░ рдЫреБрдЯреНрдЯреИ рдХрд╛рд░реНрдпрд╣рд░реВрд╕рдБрдЧред

рдпреЛ рдкрдирд┐ рдЕрдзреНрдпрдпрди рдЧрд░реНрдиреБ рдорд╣рддреНрддреНрд╡рдкреВрд░реНрдг рдЫ рдХрд┐ рдХрд╛рд░реНрдп рдЕрд╡рд╕реНрдерд╛ рдкрдирд┐ рдирд┐рд░рдиреНрддрд░ рд╣реБрдБрджрд╛, рд░ рдЕрд╡рд▓реЛрдХрди рд╕реНрдерд╛рди рдзреЗрд░реИ рдЬрдЯрд┐рд▓ рд╣реБрдБрджрд╛, рдЬрд╕реНрддреИ Atari рдЦреЗрд▓рдХреЛ рд╕реНрдХреНрд░рд┐рдирдмрд╛рдЯ рдЫрд╡рд┐ред рдпрд╕реНрддрд╛ рд╕рдорд╕реНрдпрд╛рд╣рд░реВрдорд╛ рд╣рд╛рдореА рдкреНрд░рд╛рдпрдГ рд░рд╛рдореНрд░реЛ рдирддрд┐рдЬрд╛ рдкреНрд░рд╛рдкреНрдд рдЧрд░реНрди рдердк рд╢рдХреНрддрд┐рд╢рд╛рд▓реА рдореЗрд╕рд┐рди рд▓рд░реНрдирд┐рдЩ рдкреНрд░рд╡рд┐рдзрд┐рд╣рд░реВ, рдЬрд╕реНрддреИ рдиреНрдпреВрд░рд▓ рдиреЗрдЯрд╡рд░реНрдХрд╣рд░реВ, рдкреНрд░рдпреЛрдЧ рдЧрд░реНрди рдЖрд╡рд╢реНрдпрдХ рдкрд░реНрдЫред рддреА рдердк рдЙрдиреНрдирдд рд╡рд┐рд╖рдпрд╡рд╕реНрддреБрд╣рд░реВ рд╣рд╛рдореНрд░реЛ рдЖрдЧрд╛рдореА рдЙрдиреНрдирдд AI рдкрд╛рдареНрдпрдХреНрд░рдордХреЛ рд╡рд┐рд╖рдпрд╡рд╕реНрддреБ рд╣реБрдиреНред

---

**рдЕрд╕реНрд╡реАрдХрд░рдг**:  
рдпреЛ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ AI рдЕрдиреБрд╡рд╛рдж рд╕реЗрд╡рд╛ [Co-op Translator](https://github.com/Azure/co-op-translator) рдкреНрд░рдпреЛрдЧ рдЧрд░реА рдЕрдиреБрд╡рд╛рдж рдЧрд░рд┐рдПрдХреЛ рд╣реЛред рд╣рд╛рдореА рдпрдерд╛рд╕рдореНрднрд╡ рд╕рдЯреАрдХрддрд╛ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдЧрд░реНрди рдкреНрд░рдпрд╛рд╕ рдЧрд░реНрдЫреМрдВ, рддрд░ рдХреГрдкрдпрд╛ рдзреНрдпрд╛рди рджрд┐рдиреБрд╣реЛрд╕реН рдХрд┐ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдЕрдиреБрд╡рд╛рджрд╣рд░реВрдорд╛ рддреНрд░реБрдЯрд┐ рд╡рд╛ рдЕрд╢реБрджреНрдзрддрд╛ рд╣реБрди рд╕рдХреНрдЫред рдпрд╕рдХреЛ рдореВрд▓ рднрд╛рд╖рд╛рдорд╛ рд░рд╣реЗрдХреЛ рдореВрд▓ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝рд▓рд╛рдИ рдЖрдзрд┐рдХрд╛рд░рд┐рдХ рд╕реНрд░реЛрдд рдорд╛рдирд┐рдиреБрдкрд░реНрдЫред рдорд╣рддреНрддреНрд╡рдкреВрд░реНрдг рдЬрд╛рдирдХрд╛рд░реАрдХрд╛ рд▓рд╛рдЧрд┐, рд╡реНрдпрд╛рд╡рд╕рд╛рдпрд┐рдХ рдорд╛рдирд╡ рдЕрдиреБрд╡рд╛рдж рд╕рд┐рдлрд╛рд░рд┐рд╕ рдЧрд░рд┐рдиреНрдЫред рдпрд╕ рдЕрдиреБрд╡рд╛рджрдХреЛ рдкреНрд░рдпреЛрдЧрдмрд╛рдЯ рдЙрддреНрдкрдиреНрди рд╣реБрдиреЗ рдХреБрдиреИ рдкрдирд┐ рдЧрд▓рддрдлрд╣рдореА рд╡рд╛ рдЧрд▓рдд рд╡реНрдпрд╛рдЦреНрдпрд╛рдХрд╛ рд▓рд╛рдЧрд┐ рд╣рд╛рдореА рдЬрд┐рдореНрдореЗрд╡рд╛рд░ рд╣реБрдиреЗ рдЫреИрдиреМрдВред  