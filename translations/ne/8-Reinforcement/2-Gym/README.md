<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "107d5bb29da8a562e7ae72262d251a75",
  "translation_date": "2025-09-06T06:39:45+00:00",
  "source_file": "8-Reinforcement/2-Gym/README.md",
  "language_code": "ne"
}
-->
## рдЖрд╡рд╢реНрдпрдХрддрд╛рд╣рд░реВ

рдпрд╕ рдкрд╛рдардорд╛, рд╣рд╛рдореА **OpenAI Gym** рдирд╛рдордХ рдкреБрд╕реНрддрдХрд╛рд▓рдп рдкреНрд░рдпреЛрдЧ рдЧрд░реНрдиреЗрдЫреМрдВ рд╡рд┐рднрд┐рдиреНрди **рдкрд░реНрдпрд╛рд╡рд░рдгрд╣рд░реВ** рдЕрдиреБрдХрд░рдг рдЧрд░реНрдиред рддрдкрд╛рдИрдВ рдпреЛ рдкрд╛рдардХреЛ рдХреЛрдб рд╕реНрдерд╛рдиреАрдп рд░реВрдкрдорд╛ (рдЬрд╕реНрддреИ Visual Studio Code рдмрд╛рдЯ) рдЪрд▓рд╛рдЙрди рд╕рдХреНрдиреБрд╣реБрдиреНрдЫ, рдЬрд╕рдорд╛ рдЕрдиреБрдХрд░рдг рдирдпрд╛рдБ рд╡рд┐рдиреНрдбреЛрдорд╛ рдЦреБрд▓реНрдЫред рдЕрдирд▓рд╛рдЗрди рдХреЛрдб рдЪрд▓рд╛рдЙрдБрджрд╛, рддрдкрд╛рдИрдВрд▓реЗ рдХреЛрдбрдорд╛ рдХреЗрд╣реА рдкрд░рд┐рд╡рд░реНрддрди рдЧрд░реНрдиреБрдкрд░реНрдиреЗ рд╣реБрди рд╕рдХреНрдЫ, рдЬрд╕реНрддреИ [рдпрд╣рд╛рдБ](https://towardsdatascience.com/rendering-openai-gym-envs-on-binder-and-google-colab-536f99391cc7) рд╡рд░реНрдгрди рдЧрд░рд┐рдПрдХреЛ рдЫред

## OpenAI Gym

рдЕрдШрд┐рд▓реНрд▓реЛ рдкрд╛рдардорд╛, рдЦреЗрд▓рдХрд╛ рдирд┐рдпрдорд╣рд░реВ рд░ рдЕрд╡рд╕реНрдерд╛ `Board` рд╡рд░реНрдЧрджреНрд╡рд╛рд░рд╛ рджрд┐рдЗрдПрдХреЛ рдерд┐рдпреЛ рдЬреБрди рд╣рд╛рдореАрд▓реЗ рдЖрдлреИрдВ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдЧрд░реЗрдХрд╛ рдерд┐рдпреМрдВред рдпрд╣рд╛рдБ рд╣рд╛рдореА рдПрдХ рд╡рд┐рд╢реЗрд╖ **рдЕрдиреБрдХрд░рдг рд╡рд╛рддрд╛рд╡рд░рдг** рдкреНрд░рдпреЛрдЧ рдЧрд░реНрдиреЗрдЫреМрдВ, рдЬрд╕рд▓реЗ рд╕рдиреНрддреБрд▓рди рдкреЛрд▓рдХреЛ рднреМрддрд┐рдХреА рдЕрдиреБрдХрд░рдг рдЧрд░реНрдиреЗрдЫред рд╕реБрджреГрдвреАрдХрд░рдг рд╕рд┐рдХрд╛рдЗ рдПрд▓реНрдЧреЛрд░рд┐рджрдорд╣рд░реВ рдкреНрд░рд╢рд┐рдХреНрд╖рдгрдХрд╛ рд▓рд╛рдЧрд┐ рд╕рдмреИрднрдиреНрджрд╛ рд▓реЛрдХрдкреНрд░рд┐рдп рдЕрдиреБрдХрд░рдг рд╡рд╛рддрд╛рд╡рд░рдгрд╣рд░реВ рдордзреНрдпреЗ рдПрдХрд▓рд╛рдИ [Gym](https://gym.openai.com/) рднрдирд┐рдиреНрдЫ, рдЬреБрди [OpenAI](https://openai.com/) рджреНрд╡рд╛рд░рд╛ рд╡реНрдпрд╡рд╕реНрдерд╛рдкрди рдЧрд░рд┐рдиреНрдЫред рдпрд╕ рдЬрд┐рдо рдкреНрд░рдпреЛрдЧ рдЧрд░реЗрд░ рд╣рд╛рдореА рд╡рд┐рднрд┐рдиреНрди **рдкрд░реНрдпрд╛рд╡рд░рдгрд╣рд░реВ** рд╕рд┐рд░реНрдЬрдирд╛ рдЧрд░реНрди рд╕рдХреНрдЫреМрдВ, рдЬрд╕реНрддреИ cartpole рдЕрдиреБрдХрд░рдгрджреЗрдЦрд┐ Atari рдЦреЗрд▓рд╣рд░реВрд╕рдореНрдоред

> **Note**: рддрдкрд╛рдИрдВ OpenAI Gym рдмрд╛рдЯ рдЙрдкрд▓рдмреНрдз рдЕрдиреНрдп рд╡рд╛рддрд╛рд╡рд░рдгрд╣рд░реВ [рдпрд╣рд╛рдБ](https://gym.openai.com/envs/#classic_control) рд╣реЗрд░реНрди рд╕рдХреНрдиреБрд╣реБрдиреНрдЫред

рдкрд╣рд┐рд▓реЗ, рдЬрд┐рдо рд╕реНрдерд╛рдкрдирд╛ рдЧрд░реМрдВ рд░ рдЖрд╡рд╢реНрдпрдХ рдкреБрд╕реНрддрдХрд╛рд▓рдпрд╣рд░реВ рдЖрдпрд╛рдд рдЧрд░реМрдВ (рдХреЛрдб рдмреНрд▓рдХ 1):

```python
import sys
!{sys.executable} -m pip install gym 

import gym
import matplotlib.pyplot as plt
import numpy as np
import random
```

## рдЕрднреНрдпрд╛рд╕ - cartpole рд╡рд╛рддрд╛рд╡рд░рдг рдЖрд░рдореНрдн рдЧрд░реНрдиреБрд╣реЛрд╕реН

cartpole рд╕рдиреНрддреБрд▓рди рд╕рдорд╕реНрдпрд╛рдорд╛ рдХрд╛рдо рдЧрд░реНрди, рд╣рд╛рдореАрд▓реЗ рд╕рдореНрдмрдиреНрдзрд┐рдд рд╡рд╛рддрд╛рд╡рд░рдг рдЖрд░рдореНрдн рдЧрд░реНрди рдЖрд╡рд╢реНрдпрдХ рдЫред рдкреНрд░рддреНрдпреЗрдХ рд╡рд╛рддрд╛рд╡рд░рдгрд╕рдБрдЧ рдирд┐рдореНрди рдХреБрд░рд╛ рд╕рдореНрдмрдиреНрдзрд┐рдд рд╣реБрдиреНрдЫ:

- **Observation space** рдЬрд╕рд▓реЗ рд╡рд╛рддрд╛рд╡рд░рдгрдмрд╛рдЯ рдкреНрд░рд╛рдкреНрдд рд╣реБрдиреЗ рдЬрд╛рдирдХрд╛рд░реАрдХреЛ рд╕рдВрд░рдЪрдирд╛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдЧрд░реНрджрдЫред cartpole рд╕рдорд╕реНрдпрд╛рдХреЛ рд▓рд╛рдЧрд┐, рд╣рд╛рдореА рдкреЛрд▓рдХреЛ рд╕реНрдерд┐рддрд┐, рд╡реЗрдЧ рд░ рдХреЗрд╣реА рдЕрдиреНрдп рдорд╛рдирд╣рд░реВ рдкреНрд░рд╛рдкреНрдд рдЧрд░реНрдЫреМрдВред

- **Action space** рдЬрд╕рд▓реЗ рд╕рдореНрднрд╛рд╡рд┐рдд рдХрд╛рд░реНрдпрд╣рд░реВ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдЧрд░реНрджрдЫред рд╣рд╛рдореНрд░реЛ рдХреЗрд╕рдорд╛, action space discrete рдЫ, рд░ рджреБрдИ рдХрд╛рд░реНрдпрд╣рд░реВ рд╕рдорд╛рд╡реЗрд╢ рдЧрд░реНрджрдЫ - **рдмрд╛рдпрд╛рдБ** рд░ **рджрд╛рдпрд╛рдБ**ред (рдХреЛрдб рдмреНрд▓рдХ 2)

1. рдЖрд░рдореНрдн рдЧрд░реНрди, рдирд┐рдореНрди рдХреЛрдб рдЯрд╛рдЗрдк рдЧрд░реНрдиреБрд╣реЛрд╕реН:

    ```python
    env = gym.make("CartPole-v1")
    print(env.action_space)
    print(env.observation_space)
    print(env.action_space.sample())
    ```

рд╡рд╛рддрд╛рд╡рд░рдг рдХрд╕рд░реА рдХрд╛рдо рдЧрд░реНрдЫ рд╣реЗрд░реНрди, 100 рдЪрд░рдгрд╣рд░реВрдХреЛ рд▓рд╛рдЧрд┐ рдЫреЛрдЯреЛ рдЕрдиреБрдХрд░рдг рдЪрд▓рд╛рдФрдВред рдкреНрд░рддреНрдпреЗрдХ рдЪрд░рдгрдорд╛, рд╣рд╛рдореАрд▓реЗ рдХрд╛рд░реНрдпрд╣рд░реВ рдкреНрд░рджрд╛рди рдЧрд░реНрдиреБрдкрд░реНрдЫ - рдпрд╕ рдЕрдиреБрдХрд░рдгрдорд╛ рд╣рд╛рдореА `action_space` рдмрд╛рдЯ рдЬрд╕реНрддреЛрд╕реБрдХреИ рдХрд╛рд░реНрдп рдЪрдпрди рдЧрд░реНрдЫреМрдВред

1. рддрд▓рдХреЛ рдХреЛрдб рдЪрд▓рд╛рдЙрдиреБрд╣реЛрд╕реН рд░ рдпрд╕рд▓реЗ рдХреЗ рдкрд░рд┐рдгрд╛рдо рджрд┐рдиреНрдЫ рд╣реЗрд░реНрдиреБрд╣реЛрд╕реНред

    тЬЕ рдпреЛ рдХреЛрдб рд╕реНрдерд╛рдиреАрдп Python рд╕реНрдерд╛рдкрдирд╛ рдорд╛ рдЪрд▓рд╛рдЙрдиреБ рд░рд╛рдореНрд░реЛ рд╣реБрдиреНрдЫ! (рдХреЛрдб рдмреНрд▓рдХ 3)

    ```python
    env.reset()
    
    for i in range(100):
       env.render()
       env.step(env.action_space.sample())
    env.close()
    ```

    рддрдкрд╛рдИрдВрд▓реЗ рдирд┐рдореНрди рдЪрд┐рддреНрд░ рдЬрд╕реНрддреИ рдХреЗрд╣реА рджреЗрдЦреНрдиреБрдкрд░реНрдЫ:

    ![non-balancing cartpole](../../../../8-Reinforcement/2-Gym/images/cartpole-nobalance.gif)

1. рдЕрдиреБрдХрд░рдгрдХреЛ рдХреНрд░рдордорд╛, рд╣рд╛рдореАрд▓реЗ рдирд┐рд░реНрдгрдп рдЧрд░реНрдирдХреЛ рд▓рд╛рдЧрд┐ рдЕрд╡рд▓реЛрдХрдирд╣рд░реВ рдкреНрд░рд╛рдкреНрдд рдЧрд░реНрди рдЖрд╡рд╢реНрдпрдХ рдЫред рд╡рд╛рд╕реНрддрд╡рдорд╛, `step` рдХрд╛рд░реНрдпрд▓реЗ рд╡рд░реНрддрдорд╛рди рдЕрд╡рд▓реЛрдХрдирд╣рд░реВ, рдкреБрд░рд╕реНрдХрд╛рд░ рдХрд╛рд░реНрдп, рд░ `done` рдлреНрд▓реНрдпрд╛рдЧ рдлрд░реНрдХрд╛рдЙрдБрдЫ рдЬрд╕рд▓реЗ рд╕рдВрдХреЗрдд рдЧрд░реНрджрдЫ рдХрд┐ рдЕрдиреБрдХрд░рдг рдЬрд╛рд░реА рд░рд╛рдЦреНрди рдЙрдкрдпреБрдХреНрдд рдЫ рдХрд┐ рдЫреИрди: (рдХреЛрдб рдмреНрд▓рдХ 4)

    ```python
    env.reset()
    
    done = False
    while not done:
       env.render()
       obs, rew, done, info = env.step(env.action_space.sample())
       print(f"{obs} -> {rew}")
    env.close()
    ```

    рддрдкрд╛рдИрдВрд▓реЗ рдиреЛрдЯрдмреБрдХрдХреЛ рдЖрдЙрдЯрдкреБрдЯрдорд╛ рдирд┐рдореНрди рдЬрд╕реНрддреИ рдХреЗрд╣реА рджреЗрдЦреНрдиреБрд╣реБрдиреЗрдЫ:

    ```text
    [ 0.03403272 -0.24301182  0.02669811  0.2895829 ] -> 1.0
    [ 0.02917248 -0.04828055  0.03248977  0.00543839] -> 1.0
    [ 0.02820687  0.14636075  0.03259854 -0.27681916] -> 1.0
    [ 0.03113408  0.34100283  0.02706215 -0.55904489] -> 1.0
    [ 0.03795414  0.53573468  0.01588125 -0.84308041] -> 1.0
    ...
    [ 0.17299878  0.15868546 -0.20754175 -0.55975453] -> 1.0
    [ 0.17617249  0.35602306 -0.21873684 -0.90998894] -> 1.0
    ```

    рдЕрдиреБрдХрд░рдгрдХреЛ рдкреНрд░рддреНрдпреЗрдХ рдЪрд░рдгрдорд╛ рдлрд░реНрдХрд╛рдЗрдПрдХреЛ рдЕрд╡рд▓реЛрдХрди рднреЗрдХреНрдЯрд░рд▓реЗ рдирд┐рдореНрди рдорд╛рдирд╣рд░реВ рд╕рдорд╛рд╡реЗрд╢ рдЧрд░реНрджрдЫ:
    - рдХрд╛рд░реНрдЯрдХреЛ рд╕реНрдерд┐рддрд┐
    - рдХрд╛рд░реНрдЯрдХреЛ рд╡реЗрдЧ
    - рдкреЛрд▓рдХреЛ рдХреЛрдг
    - рдкреЛрд▓рдХреЛ рдШреБрдорд╛рдЙрдиреЗ рджрд░

1. рддреА рд╕рдВрдЦреНрдпрд╛рд╣рд░реВрдХреЛ рдиреНрдпреВрдирддрдо рд░ рдЕрдзрд┐рдХрддрдо рдорд╛рди рдкреНрд░рд╛рдкреНрдд рдЧрд░реНрдиреБрд╣реЛрд╕реН: (рдХреЛрдб рдмреНрд▓рдХ 5)

    ```python
    print(env.observation_space.low)
    print(env.observation_space.high)
    ```

    рддрдкрд╛рдИрдВрд▓реЗ рдпреЛ рдкрдирд┐ рджреЗрдЦреНрди рд╕рдХреНрдиреБрд╣реБрдиреНрдЫ рдХрд┐ рдкреНрд░рддреНрдпреЗрдХ рдЕрдиреБрдХрд░рдг рдЪрд░рдгрдорд╛ рдкреБрд░рд╕реНрдХрд╛рд░ рдорд╛рди рд╕рдзреИрдВ 1 рд╣реБрдиреНрдЫред рдпрд╕рдХреЛ рдХрд╛рд░рдг рд╣рд╛рдореНрд░реЛ рд▓рдХреНрд╖реНрдп рдпрдерд╛рд╕рдореНрднрд╡ рд▓рд╛рдореЛ рд╕рдордпрд╕рдореНрдо рдЬреАрд╡рд┐рдд рд░рд╣рдиреБ рд╣реЛ, рдЕрд░реНрдерд╛рдд рдкреЛрд▓рд▓рд╛рдИ рдпрдерд╛рд╕рдореНрднрд╡ рдард╛рдбреЛ рд╕реНрдерд┐рддрд┐рдорд╛ рд░рд╛рдЦреНрдиреБред

    тЬЕ рд╡рд╛рд╕реНрддрд╡рдорд╛, CartPole рдЕрдиреБрдХрд░рдгрд▓рд╛рдИ рд╕рдорд╛рдзрд╛рди рдЧрд░рд┐рдПрдХреЛ рдорд╛рдирд┐рдиреНрдЫ рдпрджрд┐ рд╣рд╛рдореАрд▓реЗ 100 рд▓рдЧрд╛рддрд╛рд░ рдкреНрд░рдпрд╛рд╕рд╣рд░реВрдорд╛ 195 рдХреЛ рдФрд╕рдд рдкреБрд░рд╕реНрдХрд╛рд░ рдкреНрд░рд╛рдкреНрдд рдЧрд░реНрди рд╕рдлрд▓ рднрдпреМрдВред

## рдЕрд╡рд╕реНрдерд╛ рдбрд┐рд╕реНрдХреНрд░рд┐рдЯрд╛рдЗрдЬреЗрд╕рди

Q-Learning рдорд╛, рд╣рд╛рдореАрд▓реЗ Q-Table рдирд┐рд░реНрдорд╛рдг рдЧрд░реНрди рдЖрд╡рд╢реНрдпрдХ рдЫ рдЬрд╕рд▓реЗ рдкреНрд░рддреНрдпреЗрдХ рдЕрд╡рд╕реНрдерд╛рдорд╛ рдХреЗ рдЧрд░реНрдиреЗ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдЧрд░реНрджрдЫред рдпреЛ рдЧрд░реНрдирдХреЛ рд▓рд╛рдЧрд┐, рдЕрд╡рд╕реНрдерд╛ **рдбрд┐рд╕реНрдХреНрд░рд┐рдЯ** рд╣реБрдиреБрдкрд░реНрдЫ, рдЕрдзрд┐рдХ рд╕реНрдкрд╖реНрдЯ рд░реВрдкрдорд╛, рдпрд╕рд▓реЗ рд╕реАрдорд┐рдд рд╕рдВрдЦреНрдпрд╛рдХрд╛ рдбрд┐рд╕реНрдХреНрд░рд┐рдЯ рдорд╛рдирд╣рд░реВ рд╕рдорд╛рд╡реЗрд╢ рдЧрд░реНрдиреБрдкрд░реНрдЫред рддреНрдпрд╕реИрд▓реЗ, рд╣рд╛рдореАрд▓реЗ рдХреБрдиреИ рдкреНрд░рдХрд╛рд░рд▓реЗ рд╣рд╛рдореНрд░реЛ рдЕрд╡рд▓реЛрдХрдирд╣рд░реВ **рдбрд┐рд╕реНрдХреНрд░рд┐рдЯрд╛рдЗрдЬ** рдЧрд░реНрди рдЖрд╡рд╢реНрдпрдХ рдЫ, рддрд┐рдиреАрд╣рд░реВрд▓рд╛рдИ рд╕реАрдорд┐рдд рд╕реЗрдЯрдХреЛ рдЕрд╡рд╕реНрдерд╛рд╣рд░реВрдорд╛ рдореНрдпрд╛рдк рдЧрд░реНрджреИред

рдпрд╕рд▓рд╛рдИ рдЧрд░реНрдирдХрд╛ рд▓рд╛рдЧрд┐ рдХреЗрд╣реА рддрд░рд┐рдХрд╛рд╣рд░реВ рдЫрдиреН:

- **рдмрд┐рдирд╣рд░реВрдорд╛ рд╡рд┐рднрд╛рдЬрди рдЧрд░реНрдиреБрд╣реЛрд╕реН**ред рдпрджрд┐ рд╣рд╛рдореАрд▓рд╛рдИ рдХреБрдиреИ рдорд╛рдирдХреЛ рдЕрдиреНрддрд░рд╛рд▓ рдерд╛рд╣рд╛ рдЫ рднрдиреЗ, рд╣рд╛рдореА рдпрд╕ рдЕрдиреНрддрд░рд╛рд▓рд▓рд╛рдИ рдХреЗрд╣реА **рдмрд┐рдирд╣рд░реВ** рдорд╛ рд╡рд┐рднрд╛рдЬрди рдЧрд░реНрди рд╕рдХреНрдЫреМрдВ, рд░ рддреНрдпрд╕рдкрдЫрд┐ рдорд╛рдирд▓рд╛рдИ рдпреЛ рдмрд┐рди рдирдореНрдмрд░рд▓реЗ рдкреНрд░рддрд┐рд╕реНрдерд╛рдкрди рдЧрд░реНрди рд╕рдХреНрдЫреМрдВред рдпреЛ numpy [`digitize`](https://numpy.org/doc/stable/reference/generated/numpy.digitize.html) рд╡рд┐рдзрд┐ рдкреНрд░рдпреЛрдЧ рдЧрд░реЗрд░ рдЧрд░реНрди рд╕рдХрд┐рдиреНрдЫред рдпрд╕ рдЕрд╡рд╕реНрдерд╛рдорд╛, рд╣рд╛рдореАрд▓рд╛рдИ рд░рд╛рдЬреНрдпрдХреЛ рдЖрдХрд╛рд░ рдареАрдХрд╕рдБрдЧ рдерд╛рд╣рд╛ рд╣реБрдиреЗрдЫ, рдХрд┐рдирдХрд┐ рдпреЛ рдбрд┐рдЬрд┐рдЯрд▓рд╛рдЗрдЬреЗрд╕рдирдХрд╛ рд▓рд╛рдЧрд┐ рдЪрдпрди рдЧрд░рд┐рдПрдХреЛ рдмрд┐рдирд╣рд░реВрдХреЛ рд╕рдВрдЦреНрдпрд╛рдорд╛ рдирд┐рд░реНрднрд░ рд╣реБрдиреЗрдЫред

тЬЕ рд╣рд╛рдореАрд▓реЗ рдорд╛рдирд╣рд░реВрд▓рд╛рдИ рдХреЗрд╣реА рд╕реАрдорд┐рдд рдЕрдиреНрддрд░рд╛рд▓рдорд╛ (рдЬрд╕реНрддреИ, -20 рджреЗрдЦрд┐ 20 рд╕рдореНрдо) рд▓реНрдпрд╛рдЙрди рд░ рддреНрдпрд╕рдкрдЫрд┐ рддреА рд╕рдВрдЦреНрдпрд╛рд╣рд░реВрд▓рд╛рдИ рдЧреЛрд▓ рдЧрд░реЗрд░ рдкреВрд░реНрдгрд╛рдВрдХрдорд╛ рд░реВрдкрд╛рдиреНрддрд░рдг рдЧрд░реНрди рд░реЗрдЦреАрдп рдЗрдиреНрдЯрд░рдкреЛрд▓реЗрд╢рди рдкреНрд░рдпреЛрдЧ рдЧрд░реНрди рд╕рдХреНрдЫреМрдВред рдпрд╕рд▓реЗ рд░рд╛рдЬреНрдпрдХреЛ рдЖрдХрд╛рд░рдорд╛ рдереЛрд░реИ рдХрдо рдирд┐рдпрдиреНрддреНрд░рдг рджрд┐рдиреНрдЫ, рд╡рд┐рд╢реЗрд╖ рдЧрд░реА рдпрджрд┐ рд╣рд╛рдореАрд▓рд╛рдИ рдЗрдирдкреБрдЯ рдорд╛рдирд╣рд░реВрдХреЛ рд╕рдЯреАрдХ рджрд╛рдпрд░рд╛ рдерд╛рд╣рд╛ рдЫреИрдиред рдЙрджрд╛рд╣рд░рдгрдХрд╛ рд▓рд╛рдЧрд┐, рд╣рд╛рдореНрд░реЛ рдХреЗрд╕рдорд╛ 4 рдордзреНрдпреЗ 2 рдорд╛рдирд╣рд░реВрдХреЛ рдорд╛рдерд┐рд▓реНрд▓реЛ/рддрд▓реНрд▓реЛ рд╕реАрдорд╛ рдЫреИрди, рдЬрд╕рд▓реЗ рдЕрд╕реАрдорд┐рдд рд╕рдВрдЦреНрдпрд╛рдХрд╛ рдЕрд╡рд╕реНрдерд╛рд╣рд░реВ рдкрд░рд┐рдгрд╛рдо рджрд┐рди рд╕рдХреНрдЫред

рд╣рд╛рдореНрд░реЛ рдЙрджрд╛рд╣рд░рдгрдорд╛, рд╣рд╛рдореА рджреЛрд╕реНрд░реЛ рджреГрд╖реНрдЯрд┐рдХреЛрдг рдЕрдкрдирд╛рдЙрдиреЗрдЫреМрдВред рддрдкрд╛рдИрдВрд▓реЗ рдкрдЫрд┐ рджреЗрдЦреНрди рд╕рдХреНрдиреБрд╣реБрдиреЗрдЫ, рдЕрдкрд░рд┐рднрд╛рд╖рд┐рдд рдорд╛рдерд┐рд▓реНрд▓реЛ/рддрд▓реНрд▓реЛ рд╕реАрдорд╛рд╣рд░реВрдХреЛ рдмрд╛рдмрдЬреБрдж, рддреА рдорд╛рдирд╣рд░реВ рд╡рд┐рд░рд▓реИ рдирд┐рд╢реНрдЪрд┐рдд рд╕реАрдорд┐рдд рдЕрдиреНрддрд░рд╛рд▓ рдмрд╛рд╣рд┐рд░ рдорд╛рдирд╣рд░реВ рд▓рд┐рдиреНрдЫрдиреН, рддреНрдпрд╕реИрд▓реЗ рддреА рдЪрд░рдо рдорд╛рдирд╣рд░реВ рднрдПрдХрд╛ рдЕрд╡рд╕реНрдерд╛рд╣рд░реВ рдзреЗрд░реИ рджреБрд░реНрд▓рдн рд╣реБрдиреЗрдЫрдиреНред

1. рдпрд╣рд╛рдБ рдПрдЙрдЯрд╛ рдХрд╛рд░реНрдп рдЫ рдЬрд╕рд▓реЗ рд╣рд╛рдореНрд░реЛ рдореЛрдбреЗрд▓рдмрд╛рдЯ рдЕрд╡рд▓реЛрдХрди рд▓рд┐рдиреНрдЫ рд░ 4 рдкреВрд░реНрдгрд╛рдВрдХ рдорд╛рдирд╣рд░реВрдХреЛ рдЯрдкрд▓ рдЙрддреНрдкрд╛рджрди рдЧрд░реНрджрдЫ: (рдХреЛрдб рдмреНрд▓рдХ 6)

    ```python
    def discretize(x):
        return tuple((x/np.array([0.25, 0.25, 0.01, 0.1])).astype(np.int))
    ```

1. рдмрд┐рдирд╣рд░реВ рдкреНрд░рдпреЛрдЧ рдЧрд░реЗрд░ рдЕрд░реНрдХреЛ рдбрд┐рд╕реНрдХреНрд░рд┐рдЯрд╛рдЗрдЬреЗрд╕рди рд╡рд┐рдзрд┐ рдЕрдиреНрд╡реЗрд╖рдг рдЧрд░реМрдВ: (рдХреЛрдб рдмреНрд▓рдХ 7)

    ```python
    def create_bins(i,num):
        return np.arange(num+1)*(i[1]-i[0])/num+i[0]
    
    print("Sample bins for interval (-5,5) with 10 bins\n",create_bins((-5,5),10))
    
    ints = [(-5,5),(-2,2),(-0.5,0.5),(-2,2)] # intervals of values for each parameter
    nbins = [20,20,10,10] # number of bins for each parameter
    bins = [create_bins(ints[i],nbins[i]) for i in range(4)]
    
    def discretize_bins(x):
        return tuple(np.digitize(x[i],bins[i]) for i in range(4))
    ```

1. рдЕрдм рдЫреЛрдЯреЛ рдЕрдиреБрдХрд░рдг рдЪрд▓рд╛рдФрдВ рд░ рддреА рдбрд┐рд╕реНрдХреНрд░рд┐рдЯ рд╡рд╛рддрд╛рд╡рд░рдг рдорд╛рдирд╣рд░реВ рдЕрд╡рд▓реЛрдХрди рдЧрд░реМрдВред `discretize` рд░ `discretize_bins` рджреБрд╡реИ рдкреНрд░рдпрд╛рд╕ рдЧрд░реНрди рд╕реНрд╡рддрдиреНрддреНрд░ рдорд╣рд╕реБрд╕ рдЧрд░реНрдиреБрд╣реЛрд╕реН рд░ рдХреБрдиреИ рднрд┐рдиреНрдирддрд╛ рдЫ рдХрд┐ рдЫреИрди рд╣реЗрд░реНрдиреБрд╣реЛрд╕реНред

    тЬЕ `discretize_bins` рдмрд┐рди рдирдореНрдмрд░ рдлрд░реНрдХрд╛рдЙрдБрдЫ, рдЬреБрди 0-рдЖрдзрд╛рд░рд┐рдд рд╣реБрдиреНрдЫред рддреНрдпрд╕реИрд▓реЗ рдЗрдирдкреБрдЯ рдЪрд░рдХреЛ рдорд╛рдирд╣рд░реВ 0 рд╡рд░рд┐рдкрд░рд┐ рд╣реБрдБрджрд╛ рдпрд╕рд▓реЗ рдЕрдиреНрддрд░рд╛рд▓рдХреЛ рдмреАрдЪрдмрд╛рдЯ рдирдореНрдмрд░ рдлрд░реНрдХрд╛рдЙрдБрдЫ (10)ред `discretize` рдорд╛, рд╣рд╛рдореАрд▓реЗ рдЖрдЙрдЯрдкреБрдЯ рдорд╛рдирд╣рд░реВрдХреЛ рджрд╛рдпрд░рд╛рдХреЛ рдмрд╛рд░реЗрдорд╛ рдзреНрдпрд╛рди рджрд┐рдПрдиреМрдВ, рддрд┐рдиреАрд╣рд░реВрд▓рд╛рдИ рдирдХрд╛рд░рд╛рддреНрдордХ рд╣реБрди рдЕрдиреБрдорддрд┐ рджрд┐рдБрджреИ, рддреНрдпрд╕реИрд▓реЗ рд░рд╛рдЬреНрдп рдорд╛рдирд╣рд░реВ рд╕рд░реЗрдХрд╛ рдЫреИрдирдиреН, рд░ 0 0 рд╕рдБрдЧ рдореЗрд▓ рдЦрд╛рдиреНрдЫред (рдХреЛрдб рдмреНрд▓рдХ 8)

    ```python
    env.reset()
    
    done = False
    while not done:
       #env.render()
       obs, rew, done, info = env.step(env.action_space.sample())
       #print(discretize_bins(obs))
       print(discretize(obs))
    env.close()
    ```

    тЬЕ `env.render` рдмрд╛рдЯ рд╕реБрд░реБ рд╣реБрдиреЗ рд▓рд╛рдЗрди рдЕрдирдХрдореЗрдгреНрдЯ рдЧрд░реНрдиреБрд╣реЛрд╕реН рдпрджрд┐ рддрдкрд╛рдИрдВ рд╡рд╛рддрд╛рд╡рд░рдг рдХрд╕рд░реА рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рд╣реБрдиреНрдЫ рд╣реЗрд░реНрди рдЪрд╛рд╣рдиреБрд╣реБрдиреНрдЫред рдЕрдиреНрдпрдерд╛ рддрдкрд╛рдИрдВ рдпрд╕рд▓рд╛рдИ рдкреГрд╖реНрдарднреВрдорд┐рдорд╛ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдЧрд░реНрди рд╕рдХреНрдиреБрд╣реБрдиреНрдЫ, рдЬреБрди рдЫрд┐рдЯреЛ рд╣реБрдиреНрдЫред рд╣рд╛рдореА рд╣рд╛рдореНрд░реЛ Q-Learning рдкреНрд░рдХреНрд░рд┐рдпрд╛рдХреЛ рдХреНрд░рдордорд╛ рдпреЛ "рдЕрджреГрд╢реНрдп" рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдкреНрд░рдпреЛрдЧ рдЧрд░реНрдиреЗрдЫреМрдВред

## Q-Table рд╕рдВрд░рдЪрдирд╛

рдЕрдШрд┐рд▓реНрд▓реЛ рдкрд╛рдардорд╛, рдЕрд╡рд╕реНрдерд╛ 0 рджреЗрдЦрд┐ 8 рд╕рдореНрдордХрд╛ рд╕рдВрдЦреНрдпрд╛рд╣рд░реВрдХреЛ рд╕рд╛рдзрд╛рд░рдг рдЬреЛрдбреА рдерд┐рдпреЛ, рд░ рдпрд╕реИрд▓реЗ Q-Table рд▓рд╛рдИ 8x8x2 рдЖрдХрд╛рд░рдХреЛ numpy рдЯреЗрдиреНрд╕рд░рджреНрд╡рд╛рд░рд╛ рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдЧрд░реНрди рд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рдерд┐рдпреЛред рдпрджрд┐ рд╣рд╛рдореА рдмрд┐рди рдбрд┐рд╕реНрдХреНрд░рд┐рдЯрд╛рдЗрдЬреЗрд╕рди рдкреНрд░рдпреЛрдЧ рдЧрд░реНрдЫреМрдВ рднрдиреЗ, рд╣рд╛рдореНрд░реЛ рд░рд╛рдЬреНрдп рднреЗрдХреНрдЯрд░рдХреЛ рдЖрдХрд╛рд░ рдкрдирд┐ рдерд╛рд╣рд╛ рдЫ, рддреНрдпрд╕реИрд▓реЗ рд╣рд╛рдореА рд╕рдорд╛рди рджреГрд╖реНрдЯрд┐рдХреЛрдг рдкреНрд░рдпреЛрдЧ рдЧрд░реНрди рд╕рдХреНрдЫреМрдВ рд░ рд░рд╛рдЬреНрдпрд▓рд╛рдИ 20x20x10x10x2 рдЖрдХрд╛рд░рдХреЛ рдПрд░реЗрджреНрд╡рд╛рд░рд╛ рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдЧрд░реНрди рд╕рдХреНрдЫреМрдВ (рдпрд╣рд╛рдБ 2 рдХрд╛рд░реНрдп рд╕реНрдерд╛рдирдХреЛ рдЖрдпрд╛рдо рд╣реЛ, рд░ рдкрд╣рд┐рд▓реЛ рдЖрдпрд╛рдорд╣рд░реВ рдЕрд╡рд▓реЛрдХрди рд╕реНрдерд╛рдирдорд╛ рдкреНрд░рддреНрдпреЗрдХ рдкреНрдпрд╛рд░рд╛рдорд┐рдЯрд░рдХреЛ рд▓рд╛рдЧрд┐ рдЪрдпрди рдЧрд░рд┐рдПрдХреЛ рдмрд┐рдирд╣рд░реВрдХреЛ рд╕рдВрдЦреНрдпрд╛рд▓рд╛рдИ рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдЧрд░реНрджрдЫ)ред

рддрд░, рдХрд╣рд┐рд▓реЗрдХрд╛рд╣реАрдВ рдЕрд╡рд▓реЛрдХрди рд╕реНрдерд╛рдирдХреЛ рд╕рдЯреАрдХ рдЖрдпрд╛рдорд╣рд░реВ рдерд╛рд╣рд╛ рд╣реБрдБрджреИрдиред `discretize` рдХрд╛рд░реНрдпрдХреЛ рдорд╛рдорд▓рд╛рдорд╛, рд╣рд╛рдореА рдХрд╣рд┐рд▓реНрдпреИ рдирд┐рд╢реНрдЪрд┐рдд рд╣реБрди рд╕рдХреНрджреИрдиреМрдВ рдХрд┐ рд╣рд╛рдореНрд░реЛ рдЕрд╡рд╕реНрдерд╛ рдирд┐рд╢реНрдЪрд┐рдд рд╕реАрдорд╛рд╣рд░реВ рднрд┐рддреНрд░ рд░рд╣рдиреНрдЫ, рдХрд┐рдирдХрд┐ рдХреЗрд╣реА рдореВрд▓ рдорд╛рдирд╣рд░реВ рдмрд╛рдзрд┐рдд рдЫреИрдирдиреНред рддреНрдпрд╕реИрд▓реЗ, рд╣рд╛рдореА рдЕрд▓рд┐ рдлрд░рдХ рджреГрд╖реНрдЯрд┐рдХреЛрдг рдкреНрд░рдпреЛрдЧ рдЧрд░реНрдиреЗрдЫреМрдВ рд░ Q-Table рд▓рд╛рдИ рд╢рдмреНрджрдХреЛрд╢рджреНрд╡рд╛рд░рд╛ рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдЧрд░реНрдиреЗрдЫреМрдВред

1. рдЬреЛрдбреА *(state,action)* рд▓рд╛рдИ рд╢рдмреНрджрдХреЛрд╢ рдХреБрдЮреНрдЬреАрдХреЛ рд░реВрдкрдорд╛ рдкреНрд░рдпреЛрдЧ рдЧрд░реНрдиреБрд╣реЛрд╕реН, рд░ рдорд╛рди Q-Table рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐ рдорд╛рдирд╕рдБрдЧ рдореЗрд▓ рдЦрд╛рдиреЗрдЫред (рдХреЛрдб рдмреНрд▓рдХ 9)

    ```python
    Q = {}
    actions = (0,1)
    
    def qvalues(state):
        return [Q.get((state,a),0) for a in actions]
    ```

    рдпрд╣рд╛рдБ рд╣рд╛рдореАрд▓реЗ `qvalues()` рдирд╛рдордХ рдХрд╛рд░реНрдп рдкрдирд┐ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдЧрд░реЗрдХрд╛ рдЫреМрдВ, рдЬрд╕рд▓реЗ Q-Table рдорд╛рдирд╣рд░реВрдХреЛ рд╕реВрдЪреА рдлрд░реНрдХрд╛рдЙрдБрдЫ рдЬреБрди рджрд┐рдЗрдПрдХреЛ рдЕрд╡рд╕реНрдерд╛рдХрд╛ рд▓рд╛рдЧрд┐ рд╕рдмреИ рд╕рдореНрднрд╛рд╡рд┐рдд рдХрд╛рд░реНрдпрд╣рд░реВрд╕рдБрдЧ рдореЗрд▓ рдЦрд╛рдиреНрдЫред рдпрджрд┐ рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐ Q-Table рдорд╛ рдЙрдкрд╕реНрдерд┐рдд рдЫреИрди рднрдиреЗ, рд╣рд╛рдореА рдбрд┐рдлрд▓реНрдЯрдХреЛ рд░реВрдкрдорд╛ 0 рдлрд░реНрдХрд╛рдЙрдиреЗрдЫреМрдВред

## рдЕрдм Q-Learning рд╕реБрд░реБ рдЧрд░реМрдВ

рдЕрдм рд╣рд╛рдореА рдкрд┐рдЯрд░рд▓рд╛рдИ рд╕рдиреНрддреБрд▓рди рд╕рд┐рдХрд╛рдЙрди рддрдпрд╛рд░ рдЫреМрдВ!

1. рдкрд╣рд┐рд▓реЗ, рдХреЗрд╣реА рд╣рд╛рдЗрдкрд░рдкреНрдпрд╛рд░рд╛рдорд┐рдЯрд░рд╣рд░реВ рд╕реЗрдЯ рдЧрд░реМрдВ: (рдХреЛрдб рдмреНрд▓рдХ 10)

    ```python
    # hyperparameters
    alpha = 0.3
    gamma = 0.9
    epsilon = 0.90
    ```

    рдпрд╣рд╛рдБ, `alpha` **рд╕рд┐рдХрд╛рдЗ рджрд░** рд╣реЛ рдЬрд╕рд▓реЗ рдкреНрд░рддреНрдпреЗрдХ рдЪрд░рдгрдорд╛ Q-Table рдХреЛ рд╡рд░реНрддрдорд╛рди рдорд╛рдирд╣рд░реВ рдХрддрд┐ рд╣рджрд╕рдореНрдо рд╕рдорд╛рдпреЛрдЬрди рдЧрд░реНрдиреБрдкрд░реНрдЫ рднрдиреЗрд░ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдЧрд░реНрджрдЫред рдЕрдШрд┐рд▓реНрд▓реЛ рдкрд╛рдардорд╛ рд╣рд╛рдореАрд▓реЗ 1 рдмрд╛рдЯ рд╕реБрд░реБ рдЧрд░реЗрдХрд╛ рдерд┐рдпреМрдВ, рд░ рддреНрдпрд╕рдкрдЫрд┐ рдкреНрд░рд╢рд┐рдХреНрд╖рдгрдХреЛ рдХреНрд░рдордорд╛ `alpha` рд▓рд╛рдИ рдХрдо рдорд╛рдирд╣рд░реВрдорд╛ рдШрдЯрд╛рдПрдХрд╛ рдерд┐рдпреМрдВред рдпрд╕ рдЙрджрд╛рд╣рд░рдгрдорд╛ рд╣рд╛рдореА рдпрд╕рд▓рд╛рдИ рд╕реНрдерд┐рд░ рд░рд╛рдЦреНрдиреЗрдЫреМрдВ рдХреЗрд╡рд▓ рд╕рд░рд▓рддрд╛рдХреЛ рд▓рд╛рдЧрд┐, рд░ рддрдкрд╛рдИрдВ рдкрдЫрд┐ `alpha` рдорд╛рдирд╣рд░реВ рд╕рдорд╛рдпреЛрдЬрди рдЧрд░реЗрд░ рдкреНрд░рдпреЛрдЧ рдЧрд░реНрди рд╕рдХреНрдиреБрд╣реБрдиреНрдЫред

    `gamma` **рдбрд┐рд╕реНрдХрд╛рдЙрдиреНрдЯ рдлреНрдпрд╛рдХреНрдЯрд░** рд╣реЛ рдЬрд╕рд▓реЗ рднрд╡рд┐рд╖реНрдпрдХреЛ рдкреБрд░рд╕реНрдХрд╛рд░рд▓рд╛рдИ рд╡рд░реНрддрдорд╛рди рдкреБрд░рд╕реНрдХрд╛рд░рднрдиреНрджрд╛ рдХрддрд┐ рдкреНрд░рд╛рдердорд┐рдХрддрд╛ рджрд┐рдиреБрдкрд░реНрдЫ рднрдиреЗрд░ рджреЗрдЦрд╛рдЙрдБрдЫред

    `epsilon` **рдЕрдиреНрд╡реЗрд╖рдг/рд╢реЛрд╖рдг рдлреНрдпрд╛рдХреНрдЯрд░** рд╣реЛ рдЬрд╕рд▓реЗ рд╣рд╛рдореАрд▓реЗ рдЕрдиреНрд╡реЗрд╖рдгрд▓рд╛рдИ рд╢реЛрд╖рдгрдорд╛ рдкреНрд░рд╛рдердорд┐рдХрддрд╛ рджрд┐рдиреБрдкрд░реНрдЫ рдХрд┐ рдЙрд▓реНрдЯреЛ рднрдиреЗрд░ рдирд┐рд░реНрдзрд╛рд░рдг рдЧрд░реНрджрдЫред рд╣рд╛рдореНрд░реЛ рдПрд▓реНрдЧреЛрд░рд┐рджрдордорд╛, рд╣рд╛рдореА `epsilon` рдкреНрд░рддрд┐рд╢рдд рдХреЗрд╕рд╣рд░реВрдорд╛ Q-Table рдорд╛рдирд╣рд░реВ рдЕрдиреБрд╕рд╛рд░ рдЕрд░реНрдХреЛ рдХрд╛рд░реНрдп рдЪрдпрди рдЧрд░реНрдиреЗрдЫреМрдВ, рд░ рдмрд╛рдБрдХреА рдХреЗрд╕рд╣рд░реВрдорд╛ рд╣рд╛рдореА рдЬрд╕реНрддреЛрд╕реБрдХреИ рдХрд╛рд░реНрдп рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдЧрд░реНрдиреЗрдЫреМрдВред рдпрд╕рд▓реЗ рд╣рд╛рдореАрд▓рд╛рдИ рдЦреЛрдЬ рд╕реНрдерд╛рдирдХрд╛ рдХреНрд╖реЗрддреНрд░рд╣рд░реВ рдЕрдиреНрд╡реЗрд╖рдг рдЧрд░реНрди рдЕрдиреБрдорддрд┐ рджрд┐рдиреЗрдЫ рдЬреБрди рд╣рд╛рдореАрд▓реЗ рдкрд╣рд┐рд▓реЗ рдХрд╣рд┐рд▓реНрдпреИ рджреЗрдЦреЗрдХрд╛ рдЫреИрдиреМрдВред

    тЬЕ рд╕рдиреНрддреБрд▓рдирдХреЛ рд╕рдиреНрджрд░реНрднрдорд╛ - рдЬрд╕реНрддреЛрд╕реБрдХреИ рдХрд╛рд░реНрдп рдЪрдпрди рдЧрд░реНрдиреБ (рдЕрдиреНрд╡реЗрд╖рдг) рдЧрд▓рдд рджрд┐рд╢рд╛рдорд╛ рдПрдХ рдкреНрд░рдХрд╛рд░рдХреЛ рдЕрдирд┐рдпрдорд┐рдд рдзрдХреНрдХрд╛ рдЬрд╕реНрддреИ рдХрд╛рд░реНрдп рдЧрд░реНрдиреЗрдЫ, рд░ рдкреЛрд▓рд▓реЗ рддреА "рдЧрд▓реНрддреАрд╣рд░реВ" рдмрд╛рдЯ рд╕рдиреНрддреБрд▓рди рдкреБрди: рдкреНрд░рд╛рдкреНрдд рдЧрд░реНрди рд╕рд┐рдХреНрдиреБрдкрд░реНрдиреЗрдЫред

### рдПрд▓реНрдЧреЛрд░рд┐рджрдо рд╕реБрдзрд╛рд░ рдЧрд░реНрдиреБрд╣реЛрд╕реН

рд╣рд╛рдореА рдЕрдШрд┐рд▓реНрд▓реЛ рдкрд╛рдардмрд╛рдЯ рд╣рд╛рдореНрд░реЛ рдПрд▓реНрдЧреЛрд░рд┐рджрдордорд╛ рджреБрдИ рд╕реБрдзрд╛рд░рд╣рд░реВ рдЧрд░реНрди рд╕рдХреНрдЫреМрдВ:

- **рдФрд╕рдд рд╕рдВрдЪрдпреА рдкреБрд░рд╕реНрдХрд╛рд░ рдЧрдгрдирд╛ рдЧрд░реНрдиреБрд╣реЛрд╕реН**, рдзреЗрд░реИ рдЕрдиреБрдХрд░рдгрд╣рд░реВрдорд╛ред рд╣рд╛рдореА рдкреНрд░рддреНрдпреЗрдХ 5000 рдкреБрдирд░рд╛рд╡реГрддреНрддрд┐рдорд╛ рдкреНрд░рдЧрддрд┐ рдкреНрд░рд┐рдиреНрдЯ рдЧрд░реНрдиреЗрдЫреМрдВ, рд░ рд╣рд╛рдореА рддреНрдпрд╕ рдЕрд╡рдзрд┐рдХреЛ рд╕рдордпрдХреЛ рд▓рд╛рдЧрд┐ рд╣рд╛рдореНрд░реЛ рд╕рдВрдЪрдпреА рдкреБрд░рд╕реНрдХрд╛рд░рд▓рд╛рдИ рдФрд╕рдд рдЧрд░реНрдиреЗрдЫреМрдВред рдпрд╕рдХреЛ рдорддрд▓рдм рдпрджрд┐ рд╣рд╛рдореАрд▓реЗ 195 рднрдиреНрджрд╛ рдмрдвреА рдЕрдВрдХ рдкреНрд░рд╛рдкреНрдд рдЧрд░реНрдпреМрдВ рднрдиреЗ - рд╣рд╛рдореАрд▓реЗ рд╕рдорд╕реНрдпрд╛ рд╕рдорд╛рдзрд╛рди рдЧрд░реЗрдХреЛ рдорд╛рдиреНрди рд╕рдХреНрдЫреМрдВ, рдЖрд╡рд╢реНрдпрдХрддрд╛рднрдиреНрджрд╛ рдЙрдЪреНрдЪ рдЧреБрдгрд╕реНрддрд░рдХреЛ рд╕рд╛рдеред

- **рдЕрдзрд┐рдХрддрдо рдФрд╕рдд рд╕рдВрдЪрдпреА рдкрд░рд┐рдгрд╛рдо рдЧрдгрдирд╛ рдЧрд░реНрдиреБрд╣реЛрд╕реН**, `Qmax`, рд░ рд╣рд╛рдореАрд▓реЗ рдкреНрд░рд╢рд┐рдХреНрд╖рдгрдХреЛ рдХреНрд░рдордорд╛ рджреЗрдЦрд┐рдПрдХреЛ рд╕рдмреИрднрдиреНрджрд╛ рд░рд╛рдореНрд░реЛ рдореЛрдбреЗрд▓рд╕рдБрдЧ рдореЗрд▓ рдЦрд╛рдиреЗ Q-Table рднрдгреНрдбрд╛рд░рдг рдЧрд░реНрдиреЗрдЫреМрдВред рдЬрдм рддрдкрд╛рдИрдВрд▓реЗ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдЪрд▓рд╛рдЙрдиреБрд╣реБрдиреНрдЫ, рддрдкрд╛рдИрдВрд▓реЗ рджреЗрдЦреНрдиреБрд╣реБрдиреЗрдЫ рдХрд┐ рдХрд╣рд┐рд▓реЗрдХрд╛рд╣реАрдВ рдФрд╕рдд рд╕рдВрдЪрдпреА рдкрд░рд┐рдгрд╛рдо рдШрдЯреНрди рдерд╛рд▓реНрдЫ, рд░ рд╣рд╛рдореАрд▓реЗ Q-Table рдХреЛ рдорд╛рдирд╣рд░реВ рд░рд╛рдЦреНрди рдЪрд╛рд╣рдиреНрдЫреМрдВ рдЬреБрди рдЦрд░рд╛рдм рд╕реНрдерд┐рддрд┐ рдмрдирд╛рдЙрдиреЗ рдорд╛рдирд╣рд░реВрд╕рдБрдЧ рдореЗрд▓ рдЦрд╛рдиреНрдЫред

1. рдкреНрд░рддреНрдпреЗрдХ рдЕрдиреБрдХрд░рдгрдорд╛ рд╕рдВрдЪрдпреА рдкреБрд░рд╕реНрдХрд╛рд░рд╣рд░реВ `rewards` рднреЗрдХреНрдЯрд░рдорд╛ рд╕рдВрдХрд▓рди рдЧрд░реНрдиреБрд╣реЛрд╕реН рднрд╡рд┐рд╖реНрдпрдорд╛ рдкреНрд▓рдЯрд┐рдЩрдХреЛ рд▓рд╛рдЧрд┐ред (рдХреЛрдб рдмреНрд▓рдХ 11)

    ```python
    def probs(v,eps=1e-4):
        v = v-v.min()+eps
        v = v/v.sum()
        return v
    
    Qmax = 0
    cum_rewards = []
    rewards = []
    for epoch in range(100000):
        obs = env.reset()
        done = False
        cum_reward=0
        # == do the simulation ==
        while not done:
            s = discretize(obs)
            if random.random()<epsilon:
                # exploitation - chose the action according to Q-Table probabilities
                v = probs(np.array(qvalues(s)))
                a = random.choices(actions,weights=v)[0]
            else:
                # exploration - randomly chose the action
                a = np.random.randint(env.action_space.n)
    
            obs, rew, done, info = env.step(a)
            cum_reward+=rew
            ns = discretize(obs)
            Q[(s,a)] = (1 - alpha) * Q.get((s,a),0) + alpha * (rew + gamma * max(qvalues(ns)))
        cum_rewards.append(cum_reward)
        rewards.append(cum_reward)
        # == Periodically print results and calculate average reward ==
        if epoch%5000==0:
            print(f"{epoch}: {np.average(cum_rewards)}, alpha={alpha}, epsilon={epsilon}")
            if np.average(cum_rewards) > Qmax:
                Qmax = np.average(cum_rewards)
                Qbest = Q
            cum_rewards=[]
    ```

рддрдкрд╛рдИрдВрд▓реЗ рддреА рдкрд░рд┐рдгрд╛рдорд╣рд░реВрдмрд╛рдЯ рдирд┐рдореНрди рдХреБрд░рд╛ рджреЗрдЦреНрди рд╕рдХреНрдиреБрд╣реБрдиреНрдЫ:

- **рд╣рд╛рдореНрд░реЛ рд▓рдХреНрд╖реНрдп рдирдЬрд┐рдХ**ред рд╣рд╛рдореА 100+ рд▓рдЧрд╛рддрд╛рд░ рдЕрдиреБрдХрд░рдгрд╣рд░реВрдХреЛ рдФрд╕рдд рдкреБрд░рд╕реНрдХрд╛рд░ 195 рдкреНрд░рд╛рдкреНрдд рдЧрд░реНрдиреЗ рд▓рдХреНрд╖реНрдп рдкреНрд░рд╛рдкреНрдд рдЧрд░реНрди рдзреЗрд░реИ рдирдЬрд┐рдХ рдЫреМрдВ, рд╡рд╛ рд╣рд╛рдореАрд▓реЗ рд╡рд╛рд╕реНрддрд╡рдорд╛ рдпрд╕рд▓рд╛рдИ рдкреНрд░рд╛рдкреНрдд рдЧрд░реНрдпреМрдВ! рдпрджрд┐ рд╣рд╛рдореАрд▓реЗ рд╕рд╛рдирд╛ рд╕рдВрдЦреНрдпрд╛рд╣рд░реВ рдкреНрд░рд╛рдкреНрдд рдЧрд░реНрдпреМрдВ рднрдиреЗ рдкрдирд┐, рд╣рд╛рдореА рдЕрдЭреИ рдерд╛рд╣рд╛ рдкрд╛рдЙрдБрджреИрдиреМрдВ, рдХрд┐рдирдХрд┐ рд╣рд╛рдореА 5000 рд░рдирд╣рд░реВрдорд╛ рдФрд╕рдд рдЧрд░реНрдЫреМрдВ, рд░ рдФрдкрдЪрд╛рд░рд┐рдХ рдорд╛рдкрджрдгреНрдбрдорд╛ рдХреЗрд╡рд▓ 100 рд░рди рдЖрд╡рд╢реНрдпрдХ рдЫред

- **рдкреБрд░рд╕реНрдХрд╛рд░ рдШрдЯреНрди рдерд╛рд▓реНрдЫ**ред рдХрд╣рд┐рд▓реЗрдХрд╛рд╣реАрдВ рдкреБрд░рд╕реНрдХрд╛рд░ рдШрдЯреНрди рдерд╛рд▓реНрдЫ, рдЬрд╕рдХреЛ рдорддрд▓рдм рд╣рд╛рдореАрд▓реЗ Q-Table рдорд╛ рдкрд╣рд┐рд▓реЗ рд╕рд┐рдХреЗрдХрд╛ рдорд╛рдирд╣рд░реВрд▓рд╛рдИ "рдирд╖реНрдЯ" рдЧрд░реНрди рд╕рдХреНрдЫреМрдВ рдЬрд╕рд▓реЗ рд╕реНрдерд┐рддрд┐ рдЦрд░рд╛рдм рдмрдирд╛рдЙрдиреЗ рдорд╛рдирд╣рд░реВрд╕рдБрдЧ рдореЗрд▓ рдЦрд╛рдиреНрдЫред

рдпреЛ рдЕрд╡рд▓реЛрдХрди рдЕрдЭ рд╕реНрдкрд╖реНрдЯ рд░реВрдкрдорд╛ рджреЗрдЦрд┐рдиреНрдЫ рдпрджрд┐ рд╣рд╛рдореА рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдкреНрд░рдЧрддрд┐ рдкреНрд▓рдЯ рдЧрд░реНрдЫреМрдВред

## рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдкреНрд░рдЧрддрд┐ рдкреНрд▓рдЯрд┐рдЩ

рдкреНрд░рд╢рд┐рдХреНрд╖рдгрдХреЛ рдХреНрд░рдордорд╛, рд╣рд╛рдореАрд▓реЗ рдкреНрд░рддреНрдпреЗрдХ рдкреБрдирд░рд╛рд╡реГрддреНрддрд┐рдорд╛ рд╕рдВрдЪрдпреА рдкреБрд░рд╕реНрдХрд╛рд░ рдорд╛рдирд▓рд╛рдИ `rewards` рднреЗрдХреНрдЯрд░рдорд╛ рд╕рдВрдХрд▓рди рдЧрд░реЗрдХрд╛ рдЫреМрдВред рдпрд╣рд╛рдБ рдпреЛ рдкреБрдирд░рд╛рд╡реГрддреНрддрд┐ рдирдореНрдмрд░рдХреЛ рд╡рд┐рд░реБрджреНрдзрдорд╛ рдкреНрд▓рдЯ рдЧрд░реНрджрд╛ рдХрд╕реНрддреЛ рджреЗрдЦрд┐рдиреНрдЫ:

```python
plt.plot(rewards)
```

![raw progress](../../../../8-Reinforcement/2-Gym/images/train_progress_raw.png)

рдпрд╕ рдЧреНрд░рд╛рдлрдмрд╛рдЯ рдХреЗрд╣реА рднрдиреНрди рд╕рдореНрднрд╡ рдЫреИрди, рдХрд┐рдирдХрд┐ рд╕реНрдЯреЛрдХреЗрд╕реНрдЯрд┐рдХ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдкреНрд░рдХреНрд░рд┐рдпрд╛рдХреЛ рдкреНрд░рдХреГрддрд┐рдХрд╛ рдХрд╛рд░рдг рдкреНрд░рд╢рд┐рдХреНрд╖рдг рд╕рддреНрд░рд╣рд░реВрдХреЛ рд▓рдореНрдмрд╛рдЗ рдзреЗрд░реИ рднрд┐рдиреНрди рд╣реБрдиреНрдЫред рдпрд╕ рдЧреНрд░рд╛рдлрд▓рд╛рдИ рдЕрдЭ рдЕрд░реНрдердкреВрд░реНрдг рдмрдирд╛рдЙрди, рд╣рд╛рдореА 100 рдЬрд╕реНрддреИ рдкреНрд░рдпреЛрдЧрд╣рд░реВрдХреЛ рд╢реНрд░реГрдВрдЦрд▓рд╛рдорд╛ **рдЪрд▓рд┐рд░рд╣реЗрдХреЛ рдФрд╕рдд** рдЧрдгрдирд╛ рдЧрд░реНрди рд╕рдХреНрдЫреМрдВред рдпреЛ `np.convolve` рдкреНрд░рдпреЛрдЧ рдЧрд░реЗрд░ рд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рд░реВрдкрдорд╛ рдЧрд░реНрди рд╕рдХрд┐рдиреНрдЫ: (рдХреЛрдб рдмреНрд▓рдХ 12)

```python
def running_average(x,window):
    return np.convolve(x,np.ones(window)/window,mode='valid')

plt.plot(running_average(rewards,100))
```

![training progress](../../../../8-Reinforcement/2-Gym/images/train_progress_runav.png)

## рд╣рд╛рдЗрдкрд░рдкреНрдпрд╛рд░рд╛рдорд┐рдЯрд░рд╣рд░реВ рдлрд░рдХ рдкрд╛рд░реНрджреИ

рд╕рд┐рдХрд╛рдЗрд▓рд╛рдИ рдЕрдЭ рд╕реНрдерд┐рд░ рдмрдирд╛рдЙрди, рдкреНрд░рд╢рд┐рдХреНрд╖рдгрдХреЛ рдХреНрд░рдордорд╛ рдХреЗрд╣реА рд╣рд╛рдЗрдкрд░рдкреНрдпрд╛рд░рд╛рдорд┐рдЯрд░рд╣рд░реВ рд╕рдорд╛рдпреЛрдЬрди рдЧрд░реНрдиреБ рдЙрдкрдпреБрдХреНрдд рд╣реБрдиреНрдЫред рд╡рд┐рд╢реЗрд╖ рдЧрд░реА:

- **рд╕рд┐рдХрд╛рдЗ рджрд░рдХреЛ рд▓рд╛рдЧрд┐**, `alpha`, рд╣рд╛рдореА 1 рдирдЬрд┐рдХрдХреЛ рдорд╛рдирдмрд╛рдЯ рд╕реБрд░реБ рдЧрд░реНрди рд╕рдХреНрдЫреМрдВ, рд░ рддреНрдпрд╕рдкрдЫрд┐ рдкреНрдпрд╛рд░рд╛рдорд┐рдЯрд░ рдШрдЯрд╛рдЙрди рдЬрд╛рд░реА рд░рд╛рдЦреНрди рд╕рдХреНрдЫреМрдВред рд╕рдордпрд╕рдБрдЧреИ, рд╣рд╛рдореАрд▓реЗ Q-Table рдорд╛ рд░рд╛рдореНрд░реЛ рд╕рдореНрднрд╛рд╡рдирд╛ рдорд╛рдирд╣рд░реВ рдкреНрд░рд╛рдкреНрдд рдЧрд░реНрдиреЗрдЫреМрдВ, рд░ рддреНрдпрд╕реИрд▓реЗ рд╣рд╛рдореАрд▓реЗ рддрд┐рдиреАрд╣рд░реВрд▓рд╛рдИ рдереЛрд░реИ рд╕рдорд╛рдпреЛрдЬрди рдЧрд░реНрдиреБрдкрд░реНрдЫ, рд░ рдирдпрд╛рдБ рдорд╛рдирд╣рд░реВрд╕рдБрдЧ рдкреВрд░реНрдг рд░реВрдкрдорд╛ рдУрднрд░рд░рд╛рдЗрдЯ рдЧрд░реНрдиреБ рд╣реБрдБрджреИрдиред

- **epsilon рдмрдврд╛рдЙрдиреБрд╣реЛрд╕реН**ред рд╣рд╛рдореАрд▓реЗ `epsilon` рд▓рд╛рдИ рдмрд┐рд╕реНрддрд╛рд░реИ рдмрдврд╛рдЙрди рдЪрд╛рд╣рди рд╕рдХреНрдЫреМрдВ, рдХрдо рдЕрдиреНрд╡реЗрд╖рдг рдЧрд░реНрди рд░ рдмрдвреА рд╢реЛрд╖рдг рдЧрд░реНрдиред рд╕рдореНрднрд╡рддрдГ `epsilon` рдХреЛ рдХрдо рдорд╛рдирдмрд╛рдЯ рд╕реБрд░реБ рдЧрд░реНрдиреБ рд░ рд▓рдЧрднрдЧ 1 рд╕рдореНрдо рдмрдврд╛рдЙрдиреБ рдЙрдкрдпреБрдХреНрдд рд╣реБрдиреНрдЫред
> **рдХрд╛рд░реНрдп рез**: рд╣рд╛рдЗрдкрд░рдкреНрдпрд╛рд░рд╛рдорд┐рдЯрд░рдХрд╛ рдорд╛рдирд╣рд░реВ рдкрд░рд┐рд╡рд░реНрддрди рдЧрд░реЗрд░ рдЦреЗрд▓реНрдиреБрд╣реЛрд╕реН рд░ рдЙрдЪреНрдЪ рдХреНрдпреБрдореБрд▓реЗрдЯрд┐рдн рдкреБрд░рд╕реНрдХрд╛рд░ рдкреНрд░рд╛рдкреНрдд рдЧрд░реНрди рд╕рдХреНрдиреБрд╣реБрдиреНрдЫ рдХрд┐ рд╣реЗрд░реНрдиреБрд╣реЛрд╕реНред рдХреЗ рддрдкрд╛рдИрдВ резрепрел рднрдиреНрджрд╛ рдорд╛рдерд┐ рдкреНрд░рд╛рдкреНрдд рдЧрд░реНрджреИ рд╣реБрдиреБрд╣реБрдиреНрдЫ?
> **рдХрд╛рд░реНрдп реи**: рд╕рдорд╕реНрдпрд╛рд▓рд╛рдИ рдФрдкрдЪрд╛рд░рд┐рдХ рд░реВрдкрдорд╛ рд╕рдорд╛рдзрд╛рди рдЧрд░реНрди, рддрдкрд╛рдИрдВрд▓реЗ резрежреж рд▓рдЧрд╛рддрд╛рд░ рд░рдирд╣рд░реВрдорд╛ резрепрел рдФрд╕рдд рдЗрдирд╛рдо рдкреНрд░рд╛рдкреНрдд рдЧрд░реНрдиреБрдкрд░реНрдиреЗрдЫред рдкреНрд░рд╢рд┐рдХреНрд╖рдгрдХреЛ рдХреНрд░рдордорд╛ рдпреЛ рдорд╛рдкрди рдЧрд░реНрдиреБрд╣реЛрд╕реН рд░ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдЧрд░реНрдиреБрд╣реЛрд╕реН рдХрд┐ рддрдкрд╛рдИрдВрд▓реЗ рд╕рдорд╕реНрдпрд╛рд▓рд╛рдИ рдФрдкрдЪрд╛рд░рд┐рдХ рд░реВрдкрдорд╛ рд╕рдорд╛рдзрд╛рди рдЧрд░реНрдиреБрднрдПрдХреЛ рдЫ!

## рдирддрд┐рдЬрд╛ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрдирдорд╛ рд╣реЗрд░реНрджреИ

рдпреЛ рд╣реЗрд░реНрди рд░реЛрдЪрдХ рд╣реБрдиреЗрдЫ рдХрд┐ рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдореЛрдбреЗрд▓ рдХрд╕рд░реА рд╡реНрдпрд╡рд╣рд╛рд░ рдЧрд░реНрдЫред рдЖрдЙрдиреБрд╣реЛрд╕реН, рд╕рд┐рдореБрд▓реЗрд╢рди рдЪрд▓рд╛рдЙрдБрдЫреМрдВ рд░ рдкреНрд░рд╢рд┐рдХреНрд╖рдгрдХреЛ рдХреНрд░рдордорд╛ рдЬрд╕реНрддреИ рдХрд╛рд░реНрдп рдЪрдпрди рд░рдгрдиреАрддрд┐ рдЕрдиреБрд╕рд░рдг рдЧрд░реМрдВ, Q-Table рдорд╛ рд░рд╣реЗрдХреЛ рд╕рдореНрднрд╛рд╡реНрдпрддрд╛ рд╡рд┐рддрд░рдг рдЕрдиреБрд╕рд╛рд░ рдирдореВрдирд╛ рд▓рд┐рдФрдВ: (рдХреЛрдб рдмреНрд▓рдХ резрей)

```python
obs = env.reset()
done = False
while not done:
   s = discretize(obs)
   env.render()
   v = probs(np.array(qvalues(s)))
   a = random.choices(actions,weights=v)[0]
   obs,_,done,_ = env.step(a)
env.close()
```

рддрдкрд╛рдИрдВрд▓реЗ рдХреЗрд╣реА рдпрд╕ рдкреНрд░рдХрд╛рд░рдХреЛ рджреЗрдЦреНрдиреБрд╣реБрдиреЗрдЫ:

![рдПрдХ рд╕рдиреНрддреБрд▓рд┐рдд рдХрд╛рд░реНрдЯрдкреЛрд▓](../../../../8-Reinforcement/2-Gym/images/cartpole-balance.gif)

---

## ЁЯЪАрдЪреБрдиреМрддреА

> **рдХрд╛рд░реНрдп рей**: рдпрд╣рд╛рдБ рд╣рд╛рдореАрд▓реЗ Q-Table рдХреЛ рдЕрдиреНрддрд┐рдо рдкреНрд░рддрд┐рд▓рд┐рдкрд┐ рдкреНрд░рдпреЛрдЧ рдЧрд░рд┐рд░рд╣реЗрдХрд╛ рдерд┐рдпреМрдВ, рдЬреБрди рд╕рдзреИрдВ рдЙрддреНрддрдо рдирд╣реБрди рд╕рдХреНрдЫред рд╕рдореНрдЭрдиреБрд╣реЛрд╕реН рдХрд┐ рд╣рд╛рдореАрд▓реЗ рд╕рдмреИрднрдиреНрджрд╛ рд░рд╛рдореНрд░реЛ рдкреНрд░рджрд░реНрд╢рди рдЧрд░реНрдиреЗ Q-Table рд▓рд╛рдИ `Qbest` рднреЗрд░рд┐рдПрдмрд▓рдорд╛ рднрдгреНрдбрд╛рд░рдг рдЧрд░реЗрдХрд╛ рдЫреМрдВ! `Qbest` рд▓рд╛рдИ `Q` рдорд╛ рдкреНрд░рддрд┐рд▓рд┐рдкрд┐ рдЧрд░реЗрд░, рдЙрд╣реА рдЙрджрд╛рд╣рд░рдг рдкреНрд░рдпрд╛рд╕ рдЧрд░реНрдиреБрд╣реЛрд╕реН рд░ рдХреЗ рддрдкрд╛рдИрдВрд▓реЗ рдХреБрдиреИ рдлрд░рдХ рджреЗрдЦреНрдиреБрд╣реБрдиреНрдЫ рдХрд┐ рд╣реЗрд░реНрдиреБрд╣реЛрд╕реНред

> **рдХрд╛рд░реНрдп рек**: рдпрд╣рд╛рдБ рд╣рд╛рдореАрд▓реЗ рдкреНрд░рддреНрдпреЗрдХ рдЪрд░рдгрдорд╛ рд╕рдмреИрднрдиреНрджрд╛ рд░рд╛рдореНрд░реЛ рдХрд╛рд░реНрдп рдЪрдпрди рдЧрд░рд┐рд░рд╣реЗрдХрд╛ рдерд┐рдПрдиреМрдВ, рдмрд░реБ рд╕рдореНрдмрдиреНрдзрд┐рдд рд╕рдореНрднрд╛рд╡реНрдпрддрд╛ рд╡рд┐рддрд░рдгрд╕рдБрдЧ рдирдореВрдирд╛ рд▓рд┐рдЗрд░рд╣реЗрдХрд╛ рдерд┐рдпреМрдВред рдХреЗ рдпреЛ рд╕рдзреИрдВ рд╕рдмреИрднрдиреНрджрд╛ рд░рд╛рдореНрд░реЛ рдХрд╛рд░реНрдп рдЪрдпрди рдЧрд░реНрди рдЕрдзрд┐рдХ рдЙрдкрдпреБрдХреНрдд рд╣реБрдиреЗрдЫ, рдЬрд╕рдХреЛ Q-Table рдорд╛рди рд╕рдмреИрднрдиреНрджрд╛ рдЙрдЪреНрдЪ рдЫ? рдпреЛ `np.argmax` рдлрдВрдХреНрд╢рди рдкреНрд░рдпреЛрдЧ рдЧрд░реЗрд░, рд╕рдмреИрднрдиреНрджрд╛ рдЙрдЪреНрдЪ Q-Table рдорд╛рдирд╕рдБрдЧ рд╕рдореНрдмрдиреНрдзрд┐рдд рдХрд╛рд░реНрдп рдирдореНрдмрд░ рдкрддреНрддрд╛ рд▓рдЧрд╛рдПрд░ рдЧрд░реНрди рд╕рдХрд┐рдиреНрдЫред рдпреЛ рд░рдгрдиреАрддрд┐ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдЧрд░реНрдиреБрд╣реЛрд╕реН рд░ рдХреЗ рдпрд╕рд▓реЗ рд╕рдиреНрддреБрд▓рди рд╕реБрдзрд╛рд░ рдЧрд░реНрдЫ рдХрд┐ рд╣реЗрд░реНрдиреБрд╣реЛрд╕реНред

## [рдкреЛрд╕реНрдЯ-рд╡реНрдпрд╛рдЦреНрдпрд╛рди рдХреНрд╡рд┐рдЬ](https://ff-quizzes.netlify.app/en/ml/)

## рдЕрд╕рд╛рдЗрдирдореЗрдиреНрдЯ
[рдорд╛рдЙрдиреНрдЯреЗрди рдХрд╛рд░рд▓рд╛рдИ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рджрд┐рдиреБрд╣реЛрд╕реН](assignment.md)

## рдирд┐рд╖реНрдХрд░реНрд╖

рд╣рд╛рдореАрд▓реЗ рдЕрдм рдПрдЬреЗрдиреНрдЯрд╣рд░реВрд▓рд╛рдИ рд░рд╛рдореНрд░реЛ рдирддрд┐рдЬрд╛ рдкреНрд░рд╛рдкреНрдд рдЧрд░реНрди рдХрд╕рд░реА рдкреНрд░рд╢рд┐рдХреНрд╖рдг рджрд┐рдиреЗ рднрдиреЗрд░ рд╕рд┐рдХреЗрдХрд╛ рдЫреМрдВ, рдХреЗрд╡рд▓ рддрд┐рдиреАрд╣рд░реВрд▓рд╛рдИ рдЦреЗрд▓рдХреЛ рдЗрдЪреНрдЫрд┐рдд рдЕрд╡рд╕реНрдерд╛рд▓рд╛рдИ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдЧрд░реНрдиреЗ рдЗрдирд╛рдо рдлрдВрдХреНрд╢рди рдкреНрд░рджрд╛рди рдЧрд░реЗрд░, рд░ рддрд┐рдиреАрд╣рд░реВрд▓рд╛рдИ рдЦреЛрдЬ рд╕реНрдерд╛рдирд▓рд╛рдИ рдмреБрджреНрдзрд┐рдорд╛рдиреАрдкреВрд░реНрд╡рдХ рдЕрдиреНрд╡реЗрд╖рдг рдЧрд░реНрдиреЗ рдЕрд╡рд╕рд░ рджрд┐рдПрд░ред рд╣рд╛рдореАрд▓реЗ Q-Learning рдПрд▓реНрдЧреЛрд░рд┐рджрдорд▓рд╛рдИ рдЫреБрдЯреНрдЯреИ рд░ рдирд┐рд░рдиреНрддрд░ рд╡рд╛рддрд╛рд╡рд░рдгрд╣рд░реВрдХреЛ рдЕрд╡рд╕реНрдерд╛рдорд╛ рд╕рдлрд▓рддрд╛рдкреВрд░реНрд╡рдХ рд▓рд╛рдЧреВ рдЧрд░реЗрдХрд╛ рдЫреМрдВ, рддрд░ рдЫреБрдЯреНрдЯреИ рдХрд╛рд░реНрдпрд╣рд░реВрд╕рдБрдЧред

рдпреЛ рдкрдирд┐ рдЕрдзреНрдпрдпрди рдЧрд░реНрдиреБ рдорд╣рддреНрддреНрд╡рдкреВрд░реНрдг рдЫ рдХрд┐ рдЬрд╣рд╛рдБ рдХрд╛рд░реНрдп рдЕрд╡рд╕реНрдерд╛ рдкрдирд┐ рдирд┐рд░рдиреНрддрд░ рд╣реБрдиреНрдЫ, рд░ рдЕрд╡рд▓реЛрдХрди рд╕реНрдерд╛рди рдзреЗрд░реИ рдЬрдЯрд┐рд▓ рд╣реБрдиреНрдЫ, рдЬрд╕реНрддреИ Atari рдЦреЗрд▓рдХреЛ рд╕реНрдХреНрд░рд┐рдирдмрд╛рдЯ рдЖрдПрдХреЛ рдЫрд╡рд┐ред рдпрд╕реНрддрд╛ рд╕рдорд╕реНрдпрд╛рд╣рд░реВрдорд╛ рд╣рд╛рдореАрд▓реЗ рдкреНрд░рд╛рдпрдГ рд░рд╛рдореНрд░реЛ рдирддрд┐рдЬрд╛ рдкреНрд░рд╛рдкреНрдд рдЧрд░реНрди рдердк рд╢рдХреНрддрд┐рд╢рд╛рд▓реА рдореЗрд╕рд┐рди рд▓рд░реНрдирд┐рдЩ рдкреНрд░рд╡рд┐рдзрд┐рд╣рд░реВ, рдЬрд╕реНрддреИ рдиреНрдпреВрд░рд▓ рдиреЗрдЯрд╡рд░реНрдХрд╣рд░реВ, рдкреНрд░рдпреЛрдЧ рдЧрд░реНрди рдЖрд╡рд╢реНрдпрдХ рдкрд░реНрдЫред рддреА рдердк рдЙрдиреНрдирдд рд╡рд┐рд╖рдпрд╡рд╕реНрддреБрд╣рд░реВ рд╣рд╛рдореНрд░реЛ рдЖрдЧрд╛рдореА рдЙрдиреНрдирдд AI рдкрд╛рдареНрдпрдХреНрд░рдордХреЛ рд╡рд┐рд╖рдпрд╡рд╕реНрддреБ рд╣реБрдиреНред

---

**рдЕрд╕реНрд╡реАрдХрд░рдг**:  
рдпреЛ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ AI рдЕрдиреБрд╡рд╛рдж рд╕реЗрд╡рд╛ [Co-op Translator](https://github.com/Azure/co-op-translator) рдкреНрд░рдпреЛрдЧ рдЧрд░реЗрд░ рдЕрдиреБрд╡рд╛рдж рдЧрд░рд┐рдПрдХреЛ рдЫред рд╣рд╛рдореА рд╢реБрджреНрдзрддрд╛рдХреЛ рд▓рд╛рдЧрд┐ рдкреНрд░рдпрд╛рд╕ рдЧрд░реНрдЫреМрдВ, рддрд░ рдХреГрдкрдпрд╛ рдзреНрдпрд╛рди рджрд┐рдиреБрд╣реЛрд╕реН рдХрд┐ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдЕрдиреБрд╡рд╛рджрдорд╛ рддреНрд░реБрдЯрд┐рд╣рд░реВ рд╡рд╛ рдЕрд╢реБрджреНрдзрддрд╛рд╣рд░реВ рд╣реБрди рд╕рдХреНрдЫред рдпрд╕рдХреЛ рдореВрд▓ рднрд╛рд╖рд╛ рдорд╛ рд░рд╣реЗрдХреЛ рдореВрд▓ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝рд▓рд╛рдИ рдЖрдзрд┐рдХрд╛рд░рд┐рдХ рд╕реНрд░реЛрдд рдорд╛рдирд┐рдиреБрдкрд░реНрдЫред рдорд╣рддреНрд╡рдкреВрд░реНрдг рдЬрд╛рдирдХрд╛рд░реАрдХреЛ рд▓рд╛рдЧрд┐, рд╡реНрдпрд╛рд╡рд╕рд╛рдпрд┐рдХ рдорд╛рдирд╡ рдЕрдиреБрд╡рд╛рдж рд╕рд┐рдлрд╛рд░рд┐рд╕ рдЧрд░рд┐рдиреНрдЫред рдпрд╕ рдЕрдиреБрд╡рд╛рджрдХреЛ рдкреНрд░рдпреЛрдЧрдмрд╛рдЯ рдЙрддреНрдкрдиреНрди рд╣реБрдиреЗ рдХреБрдиреИ рдкрдирд┐ рдЧрд▓рддрдлрд╣рдореА рд╡рд╛ рдЧрд▓рдд рд╡реНрдпрд╛рдЦреНрдпрд╛рдХреЛ рд▓рд╛рдЧрд┐ рд╣рд╛рдореА рдЬрд┐рдореНрдореЗрд╡рд╛рд░ рд╣реБрдиреЗ рдЫреИрдиреМрдВред