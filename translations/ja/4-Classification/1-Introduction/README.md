# åˆ†é¡ã®ç´¹ä»‹

ã“ã®4ã¤ã®ãƒ¬ãƒƒã‚¹ãƒ³ã§ã¯ã€ã‚¯ãƒ©ã‚·ãƒƒã‚¯ãªæ©Ÿæ¢°å­¦ç¿’ã®åŸºæœ¬çš„ãªç„¦ç‚¹ã§ã‚ã‚‹_åˆ†é¡_ã«ã¤ã„ã¦æ¢ã‚Šã¾ã™ã€‚ã‚¢ã‚¸ã‚¢ã¨ã‚¤ãƒ³ãƒ‰ã®ç´ æ™´ã‚‰ã—ã„æ–™ç†ã«é–¢ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’ä½¿ç”¨ã—ã¦ã€ã•ã¾ã–ã¾ãªåˆ†é¡ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚’ä½¿ç”¨ã™ã‚‹æ–¹æ³•ã‚’èª¬æ˜ã—ã¾ã™ã€‚ãŠè…¹ãŒç©ºã„ã¦ãã¾ã—ãŸã‹ï¼Ÿ

![just a pinch!](../../../../translated_images/pinch.1b035ec9ba7e0d408313b551b60c721c9c290b2dd2094115bc87e6ddacd114c9.ja.png)

> ã“ã‚Œã‚‰ã®ãƒ¬ãƒƒã‚¹ãƒ³ã§ãƒ‘ãƒ³ã‚¢ã‚¸ã‚¢æ–™ç†ã‚’ç¥ãŠã†ï¼ç”»åƒæä¾›ï¼š[Jen Looper](https://twitter.com/jenlooper)

åˆ†é¡ã¯ã€å›å¸°æŠ€è¡“ã¨å¤šãã®å…±é€šç‚¹ã‚’æŒã¤[æ•™å¸«ã‚ã‚Šå­¦ç¿’](https://wikipedia.org/wiki/Supervised_learning)ã®ä¸€å½¢æ…‹ã§ã™ã€‚æ©Ÿæ¢°å­¦ç¿’ãŒãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’ä½¿ç”¨ã—ã¦å€¤ã‚„åå‰ã‚’äºˆæ¸¬ã™ã‚‹ã“ã¨ã«é–¢ã™ã‚‹ã‚‚ã®ã§ã‚ã‚‹ãªã‚‰ã°ã€åˆ†é¡ã¯ä¸€èˆ¬çš„ã«2ã¤ã®ã‚°ãƒ«ãƒ¼ãƒ—ã«åˆ†ã‹ã‚Œã¾ã™ï¼š_äºŒå€¤åˆ†é¡_ã¨_å¤šã‚¯ãƒ©ã‚¹åˆ†é¡_ã§ã™ã€‚

[![Introduction to classification](https://img.youtube.com/vi/eg8DJYwdMyg/0.jpg)](https://youtu.be/eg8DJYwdMyg "Introduction to classification")

> ğŸ¥ ä¸Šã®ç”»åƒã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ãƒ“ãƒ‡ã‚ªã‚’è¦–è´ï¼šMITã®John GuttagãŒåˆ†é¡ã‚’ç´¹ä»‹

è¦šãˆã¦ãŠã„ã¦ãã ã•ã„ï¼š

- **ç·šå½¢å›å¸°**ã¯ã€å¤‰æ•°é–“ã®é–¢ä¿‚ã‚’äºˆæ¸¬ã—ã€æ–°ã—ã„ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒˆãŒãã®ç·šã¨ã©ã®ã‚ˆã†ã«é–¢ä¿‚ã™ã‚‹ã‹ã‚’æ­£ç¢ºã«äºˆæ¸¬ã™ã‚‹ã®ã«å½¹ç«‹ã¡ã¾ã—ãŸã€‚ä¾‹ãˆã°ã€_9æœˆã¨12æœˆã®ã‚«ãƒœãƒãƒ£ã®ä¾¡æ ¼_ã‚’äºˆæ¸¬ã™ã‚‹ã“ã¨ãŒã§ãã¾ã—ãŸã€‚
- **ãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯å›å¸°**ã¯ã€ã€ŒäºŒå€¤ã‚«ãƒ†ã‚´ãƒªã€ã‚’ç™ºè¦‹ã™ã‚‹ã®ã«å½¹ç«‹ã¡ã¾ã—ãŸï¼šã“ã®ä¾¡æ ¼å¸¯ã§ã¯ã€_ã“ã®ã‚«ãƒœãƒãƒ£ã¯ã‚ªãƒ¬ãƒ³ã‚¸è‰²ã‹ã€ã‚ªãƒ¬ãƒ³ã‚¸è‰²ã§ãªã„ã‹_ï¼Ÿ

åˆ†é¡ã¯ã€ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒˆã®ãƒ©ãƒ™ãƒ«ã‚„ã‚¯ãƒ©ã‚¹ã‚’æ±ºå®šã™ã‚‹ãŸã‚ã«ã•ã¾ã–ã¾ãªã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚ã“ã®æ–™ç†ãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ç”¨ã—ã¦ã€ææ–™ã®ã‚°ãƒ«ãƒ¼ãƒ—ã‚’è¦³å¯Ÿã™ã‚‹ã“ã¨ã§ã€ãã®æ–™ç†ã®èµ·æºã‚’ç‰¹å®šã§ãã‚‹ã‹ã©ã†ã‹ã‚’è¦‹ã¦ã¿ã¾ã—ã‚‡ã†ã€‚

## [äº‹å‰ã‚¯ã‚¤ã‚º](https://gray-sand-07a10f403.1.azurestaticapps.net/quiz/19/)

> ### [ã“ã®ãƒ¬ãƒƒã‚¹ãƒ³ã¯Rã§ã‚‚åˆ©ç”¨å¯èƒ½ã§ã™ï¼](../../../../4-Classification/1-Introduction/solution/R/lesson_10.html)

### ã¯ã˜ã‚ã«

åˆ†é¡ã¯ã€æ©Ÿæ¢°å­¦ç¿’ç ”ç©¶è€…ã‚„ãƒ‡ãƒ¼ã‚¿ã‚µã‚¤ã‚¨ãƒ³ãƒ†ã‚£ã‚¹ãƒˆã®åŸºæœ¬çš„ãªæ´»å‹•ã®1ã¤ã§ã™ã€‚äºŒå€¤å€¤ã®åŸºæœ¬çš„ãªåˆ†é¡ï¼ˆã€Œã“ã®ãƒ¡ãƒ¼ãƒ«ã¯ã‚¹ãƒ‘ãƒ ã‹ã©ã†ã‹ã€ï¼‰ã‹ã‚‰ã€ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ“ã‚¸ãƒ§ãƒ³ã‚’ä½¿ç”¨ã—ãŸè¤‡é›‘ãªç”»åƒåˆ†é¡ã‚„ã‚»ã‚°ãƒ¡ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã¾ã§ã€ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¯ãƒ©ã‚¹ã«åˆ†é¡ã—ã€ãã‚Œã«è³ªå•ã™ã‚‹èƒ½åŠ›ã¯å¸¸ã«å½¹ç«‹ã¡ã¾ã™ã€‚

ãƒ—ãƒ­ã‚»ã‚¹ã‚’ã‚ˆã‚Šç§‘å­¦çš„ã«è¿°ã¹ã‚‹ã¨ã€åˆ†é¡æ³•ã¯å…¥åŠ›å¤‰æ•°ã¨å‡ºåŠ›å¤‰æ•°ã®é–¢ä¿‚ã‚’ãƒãƒƒãƒ”ãƒ³ã‚°ã™ã‚‹äºˆæ¸¬ãƒ¢ãƒ‡ãƒ«ã‚’ä½œæˆã—ã¾ã™ã€‚

![binary vs. multiclass classification](../../../../translated_images/binary-multiclass.b56d0c86c81105a697dddd82242c1d11e4d78b7afefea07a44627a0f1111c1a9.ja.png)

> åˆ†é¡ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ãŒå‡¦ç†ã™ã‚‹äºŒå€¤å•é¡Œã¨å¤šã‚¯ãƒ©ã‚¹å•é¡Œã€‚ã‚¤ãƒ³ãƒ•ã‚©ã‚°ãƒ©ãƒ•ã‚£ãƒƒã‚¯æä¾›ï¼š[Jen Looper](https://twitter.com/jenlooper)

ãƒ‡ãƒ¼ã‚¿ã®ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°ã€è¦–è¦šåŒ–ã€ãŠã‚ˆã³MLã‚¿ã‚¹ã‚¯ã®æº–å‚™ã‚’é–‹å§‹ã™ã‚‹å‰ã«ã€ãƒ‡ãƒ¼ã‚¿ã‚’åˆ†é¡ã™ã‚‹ãŸã‚ã«æ©Ÿæ¢°å­¦ç¿’ã‚’ä½¿ç”¨ã™ã‚‹ã•ã¾ã–ã¾ãªæ–¹æ³•ã«ã¤ã„ã¦å­¦ã³ã¾ã—ã‚‡ã†ã€‚

[çµ±è¨ˆå­¦](https://wikipedia.org/wiki/Statistical_classification)ã«ç”±æ¥ã™ã‚‹ã€ã‚¯ãƒ©ã‚·ãƒƒã‚¯ãªæ©Ÿæ¢°å­¦ç¿’ã‚’ä½¿ç”¨ã—ãŸåˆ†é¡ã¯ã€`smoker`ã€`weight`ã€ãŠã‚ˆã³`age`ãªã©ã®ç‰¹å¾´ã‚’ä½¿ç”¨ã—ã¦ã€_Xç—…ã‚’ç™ºç—‡ã™ã‚‹å¯èƒ½æ€§_ã‚’æ±ºå®šã—ã¾ã™ã€‚ä»¥å‰ã«è¡Œã£ãŸå›å¸°æ¼”ç¿’ã¨åŒæ§˜ã®æ•™å¸«ã‚ã‚Šå­¦ç¿’æŠ€è¡“ã¨ã—ã¦ã€ãƒ‡ãƒ¼ã‚¿ã¯ãƒ©ãƒ™ãƒ«ä»˜ã‘ã•ã‚Œã€MLã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã¯ã“ã‚Œã‚‰ã®ãƒ©ãƒ™ãƒ«ã‚’ä½¿ç”¨ã—ã¦ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®ã‚¯ãƒ©ã‚¹ï¼ˆã¾ãŸã¯ã€Œç‰¹å¾´ã€ï¼‰ã‚’åˆ†é¡ãŠã‚ˆã³äºˆæ¸¬ã—ã€ãã‚Œã‚‰ã‚’ã‚°ãƒ«ãƒ¼ãƒ—ã¾ãŸã¯çµæœã«å‰²ã‚Šå½“ã¦ã¾ã™ã€‚

âœ… æ–™ç†ã«é–¢ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’æƒ³åƒã—ã¦ã¿ã¦ãã ã•ã„ã€‚å¤šã‚¯ãƒ©ã‚¹ãƒ¢ãƒ‡ãƒ«ã§ã¯ä½•ãŒç­”ãˆã‚‰ã‚Œã‚‹ã§ã—ã‚‡ã†ã‹ï¼ŸäºŒå€¤ãƒ¢ãƒ‡ãƒ«ã§ã¯ä½•ãŒç­”ãˆã‚‰ã‚Œã‚‹ã§ã—ã‚‡ã†ã‹ï¼Ÿã‚ã‚‹æ–™ç†ãŒãƒ•ã‚§ãƒŒã‚°ãƒªãƒ¼ã‚¯ã‚’ä½¿ç”¨ã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ã‹ã©ã†ã‹ã‚’åˆ¤æ–­ã—ãŸã„å ´åˆã¯ã©ã†ã§ã—ã‚‡ã†ã‹ï¼Ÿæ˜Ÿã‚¢ãƒ‹ã‚¹ã€ã‚¢ãƒ¼ãƒ†ã‚£ãƒãƒ§ãƒ¼ã‚¯ã€ã‚«ãƒªãƒ•ãƒ©ãƒ¯ãƒ¼ã€ãƒ›ãƒ¼ã‚¹ãƒ©ãƒ‡ã‚£ãƒƒã‚·ãƒ¥ãŒå…¥ã£ãŸé£Ÿæ–™è¢‹ã‚’ãƒ—ãƒ¬ã‚¼ãƒ³ãƒˆã•ã‚ŒãŸå ´åˆã€å…¸å‹çš„ãªã‚¤ãƒ³ãƒ‰æ–™ç†ã‚’ä½œã‚Œã‚‹ã‹ã©ã†ã‹ã‚’ç¢ºèªã—ãŸã„å ´åˆã¯ã©ã†ã§ã—ã‚‡ã†ã‹ï¼Ÿ

[![Crazy mystery baskets](https://img.youtube.com/vi/GuTeDbaNoEU/0.jpg)](https://youtu.be/GuTeDbaNoEU "Crazy mystery baskets")

> ğŸ¥ ä¸Šã®ç”»åƒã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ãƒ“ãƒ‡ã‚ªã‚’è¦–è´ã€‚ã‚·ãƒ§ãƒ¼ã€ŒChoppedã€ã®å…¨ä½“ã®å‰æã¯ã€ã€ŒãƒŸã‚¹ãƒ†ãƒªãƒ¼ãƒã‚¹ã‚±ãƒƒãƒˆã€ã§ã€ã‚·ã‚§ãƒ•ãŒãƒ©ãƒ³ãƒ€ãƒ ãªææ–™ã®é¸æŠã‹ã‚‰æ–™ç†ã‚’ä½œã‚‰ãªã‘ã‚Œã°ãªã‚‰ãªã„ã¨ã„ã†ã‚‚ã®ã§ã™ã€‚ç¢ºã‹ã«MLãƒ¢ãƒ‡ãƒ«ãŒå½¹ç«‹ã£ãŸã§ã—ã‚‡ã†ï¼

## ã“ã‚“ã«ã¡ã¯ã€Œåˆ†é¡å™¨ã€

ã“ã®æ–™ç†ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã«é–¢ã—ã¦ç§ãŸã¡ãŒå°‹ã­ãŸã„è³ªå•ã¯ã€å®Ÿéš›ã«ã¯**å¤šã‚¯ãƒ©ã‚¹ã®è³ªå•**ã§ã™ã€‚ç§ãŸã¡ã«ã¯ã„ãã¤ã‹ã®æ½œåœ¨çš„ãªå›½ã®æ–™ç†ãŒã‚ã‚‹ãŸã‚ã§ã™ã€‚ä¸€é€£ã®ææ–™ãŒä¸ãˆã‚‰ã‚ŒãŸå ´åˆã€ãã®ãƒ‡ãƒ¼ã‚¿ã¯ã“ã‚Œã‚‰ã®å¤šãã®ã‚¯ãƒ©ã‚¹ã®ã©ã‚Œã«é©åˆã™ã‚‹ã§ã—ã‚‡ã†ã‹ï¼Ÿ

Scikit-learnã¯ã€è§£æ±ºã—ãŸã„å•é¡Œã®ç¨®é¡ã«å¿œã˜ã¦ã€ãƒ‡ãƒ¼ã‚¿ã‚’åˆ†é¡ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã§ãã‚‹ã•ã¾ã–ã¾ãªã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚’æä¾›ã—ã¦ã„ã¾ã™ã€‚æ¬¡ã®2ã¤ã®ãƒ¬ãƒƒã‚¹ãƒ³ã§ã¯ã€ã“ã‚Œã‚‰ã®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®ã„ãã¤ã‹ã«ã¤ã„ã¦å­¦ã³ã¾ã™ã€‚

## æ¼”ç¿’ - ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ã—ã¦ãƒãƒ©ãƒ³ã‚¹ã‚’å–ã‚‹

ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’é–‹å§‹ã™ã‚‹å‰ã®æœ€åˆã®ã‚¿ã‚¹ã‚¯ã¯ã€ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ã—ã¦**ãƒãƒ©ãƒ³ã‚¹ã‚’å–ã‚‹**ã“ã¨ã§ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ã‚ˆã‚Šè‰¯ã„çµæœãŒå¾—ã‚‰ã‚Œã¾ã™ã€‚ã“ã®ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã®ãƒ«ãƒ¼ãƒˆã«ã‚ã‚‹ç©ºã®_notebook.ipynb_ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰å§‹ã‚ã¾ã™ã€‚

æœ€åˆã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã‚‚ã®ã¯[imblearn](https://imbalanced-learn.org/stable/)ã§ã™ã€‚ã“ã‚Œã¯Scikit-learnãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã§ã€ãƒ‡ãƒ¼ã‚¿ã®ãƒãƒ©ãƒ³ã‚¹ã‚’ã‚ˆã‚Šè‰¯ãå–ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼ˆã“ã®ã‚¿ã‚¹ã‚¯ã«ã¤ã„ã¦ã¯å¾Œã§è©³ã—ãå­¦ã³ã¾ã™ï¼‰ã€‚

1. `imblearn`ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã«ã¯ã€æ¬¡ã®ã‚ˆã†ã«`pip install`ã‚’å®Ÿè¡Œã—ã¾ã™ï¼š

    ```python
    pip install imblearn
    ```

1. ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã¦è¦–è¦šåŒ–ã™ã‚‹ãŸã‚ã«å¿…è¦ãªãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã€`imblearn`ã‹ã‚‰`SMOTE`ã‚‚ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã¾ã™ã€‚

    ```python
    import pandas as pd
    import matplotlib.pyplot as plt
    import matplotlib as mpl
    import numpy as np
    from imblearn.over_sampling import SMOTE
    ```

    ã“ã‚Œã§ã€æ¬¡ã«ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã™ã‚‹æº–å‚™ãŒæ•´ã„ã¾ã—ãŸã€‚

1. æ¬¡ã®ã‚¿ã‚¹ã‚¯ã¯ãƒ‡ãƒ¼ã‚¿ã®ã‚¤ãƒ³ãƒãƒ¼ãƒˆã§ã™ï¼š

    ```python
    df  = pd.read_csv('../data/cuisines.csv')
    ```

   `read_csv()` will read the content of the csv file _cusines.csv_ and place it in the variable `df`ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

1. ãƒ‡ãƒ¼ã‚¿ã®å½¢çŠ¶ã‚’ç¢ºèªã—ã¾ã™ï¼š

    ```python
    df.head()
    ```

   æœ€åˆã®5è¡Œã¯æ¬¡ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ï¼š

    ```output
    |     | Unnamed: 0 | cuisine | almond | angelica | anise | anise_seed | apple | apple_brandy | apricot | armagnac | ... | whiskey | white_bread | white_wine | whole_grain_wheat_flour | wine | wood | yam | yeast | yogurt | zucchini |
    | --- | ---------- | ------- | ------ | -------- | ----- | ---------- | ----- | ------------ | ------- | -------- | --- | ------- | ----------- | ---------- | ----------------------- | ---- | ---- | --- | ----- | ------ | -------- |
    | 0   | 65         | indian  | 0      | 0        | 0     | 0          | 0     | 0            | 0       | 0        | ... | 0       | 0           | 0          | 0                       | 0    | 0    | 0   | 0     | 0      | 0        |
    | 1   | 66         | indian  | 1      | 0        | 0     | 0          | 0     | 0            | 0       | 0        | ... | 0       | 0           | 0          | 0                       | 0    | 0    | 0   | 0     | 0      | 0        |
    | 2   | 67         | indian  | 0      | 0        | 0     | 0          | 0     | 0            | 0       | 0        | ... | 0       | 0           | 0          | 0                       | 0    | 0    | 0   | 0     | 0      | 0        |
    | 3   | 68         | indian  | 0      | 0        | 0     | 0          | 0     | 0            | 0       | 0        | ... | 0       | 0           | 0          | 0                       | 0    | 0    | 0   | 0     | 0      | 0        |
    | 4   | 69         | indian  | 0      | 0        | 0     | 0          | 0     | 0            | 0       | 0        | ... | 0       | 0           | 0          | 0                       | 0    | 0    | 0   | 0     | 1      | 0        |
    ```

1. `info()`ã‚’å‘¼ã³å‡ºã—ã¦ã“ã®ãƒ‡ãƒ¼ã‚¿ã«é–¢ã™ã‚‹æƒ…å ±ã‚’å–å¾—ã—ã¾ã™ï¼š

    ```python
    df.info()
    ```

    å‡ºåŠ›ã¯æ¬¡ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ï¼š

    ```output
    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 2448 entries, 0 to 2447
    Columns: 385 entries, Unnamed: 0 to zucchini
    dtypes: int64(384), object(1)
    memory usage: 7.2+ MB
    ```

## æ¼”ç¿’ - æ–™ç†ã«ã¤ã„ã¦å­¦ã¶

ã“ã“ã‹ã‚‰ãŒé¢ç™½ããªã‚Šã¾ã™ã€‚æ–™ç†ã”ã¨ã®ãƒ‡ãƒ¼ã‚¿ã®åˆ†å¸ƒã‚’è¦‹ã¦ã¿ã¾ã—ã‚‡ã†ã€‚

1. `barh()`ã‚’å‘¼ã³å‡ºã—ã¦ãƒ‡ãƒ¼ã‚¿ã‚’ãƒãƒ¼ã¨ã—ã¦ãƒ—ãƒ­ãƒƒãƒˆã—ã¾ã™ï¼š

    ```python
    df.cuisine.value_counts().plot.barh()
    ```

    ![cuisine data distribution](../../../../translated_images/cuisine-dist.d0cc2d551abe5c25f83d73a5f560927e4a061e9a4560bac1e97d35682ef3ca6d.ja.png)

    æ–™ç†ã®æ•°ã¯é™ã‚‰ã‚Œã¦ã„ã¾ã™ãŒã€ãƒ‡ãƒ¼ã‚¿ã®åˆ†å¸ƒã¯ä¸å‡ä¸€ã§ã™ã€‚ã“ã‚Œã‚’ä¿®æ­£ã§ãã¾ã™ï¼ãã®å‰ã«ã€ã‚‚ã†å°‘ã—æ¢ã£ã¦ã¿ã¾ã—ã‚‡ã†ã€‚

1. æ–™ç†ã”ã¨ã«åˆ©ç”¨å¯èƒ½ãªãƒ‡ãƒ¼ã‚¿ã®é‡ã‚’èª¿ã¹ã¦å°åˆ·ã—ã¾ã™ï¼š

    ```python
    thai_df = df[(df.cuisine == "thai")]
    japanese_df = df[(df.cuisine == "japanese")]
    chinese_df = df[(df.cuisine == "chinese")]
    indian_df = df[(df.cuisine == "indian")]
    korean_df = df[(df.cuisine == "korean")]
    
    print(f'thai df: {thai_df.shape}')
    print(f'japanese df: {japanese_df.shape}')
    print(f'chinese df: {chinese_df.shape}')
    print(f'indian df: {indian_df.shape}')
    print(f'korean df: {korean_df.shape}')
    ```

    å‡ºåŠ›ã¯æ¬¡ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ï¼š

    ```output
    thai df: (289, 385)
    japanese df: (320, 385)
    chinese df: (442, 385)
    indian df: (598, 385)
    korean df: (799, 385)
    ```

## ææ–™ã®ç™ºè¦‹

æ¬¡ã«ã€ãƒ‡ãƒ¼ã‚¿ã‚’ã•ã‚‰ã«æ·±ãæ˜ã‚Šä¸‹ã’ã¦ã€å„æ–™ç†ã®å…¸å‹çš„ãªææ–™ã‚’å­¦ã³ã¾ã™ã€‚æ–™ç†é–“ã®æ··ä¹±ã‚’å¼•ãèµ·ã“ã™å†ç™ºãƒ‡ãƒ¼ã‚¿ã‚’ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã®ã§ã€ã“ã®å•é¡Œã«ã¤ã„ã¦å­¦ã³ã¾ã—ã‚‡ã†ã€‚

1. Pythonã§`create_ingredient()`é–¢æ•°ã‚’ä½œæˆã—ã¦ææ–™ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ã‚’ä½œæˆã—ã¾ã™ã€‚ã“ã®é–¢æ•°ã¯ã€å½¹ã«ç«‹ãŸãªã„åˆ—ã‚’å‰Šé™¤ã—ã€ã‚«ã‚¦ãƒ³ãƒˆã«ã‚ˆã£ã¦ææ–™ã‚’ã‚½ãƒ¼ãƒˆã™ã‚‹ã“ã¨ã‹ã‚‰å§‹ã‚ã¾ã™ï¼š

    ```python
    def create_ingredient_df(df):
        ingredient_df = df.T.drop(['cuisine','Unnamed: 0']).sum(axis=1).to_frame('value')
        ingredient_df = ingredient_df[(ingredient_df.T != 0).any()]
        ingredient_df = ingredient_df.sort_values(by='value', ascending=False,
        inplace=False)
        return ingredient_df
    ```

   ã“ã‚Œã§ã€ã“ã®é–¢æ•°ã‚’ä½¿ç”¨ã—ã¦ã€æ–™ç†ã”ã¨ã®ãƒˆãƒƒãƒ—10ã®äººæ°—ææ–™ã®ã‚¢ã‚¤ãƒ‡ã‚¢ã‚’å¾—ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

1. `create_ingredient()` and plot it calling `barh()`ã‚’å‘¼ã³å‡ºã—ã¾ã™ï¼š

    ```python
    thai_ingredient_df = create_ingredient_df(thai_df)
    thai_ingredient_df.head(10).plot.barh()
    ```

    ![thai](../../../../translated_images/thai.0269dbab2e78bd38a132067759fe980008bdb80b6d778e5313448dbe12bed846.ja.png)

1. æ—¥æœ¬ã®ãƒ‡ãƒ¼ã‚¿ã«ã¤ã„ã¦ã‚‚åŒã˜ã“ã¨ã‚’è¡Œã„ã¾ã™ï¼š

    ```python
    japanese_ingredient_df = create_ingredient_df(japanese_df)
    japanese_ingredient_df.head(10).plot.barh()
    ```

    ![japanese](../../../../translated_images/japanese.30260486f2a05c463c8faa62ebe7b38f0961ed293bd9a6db8eef5d3f0cf17155.ja.png)

1. æ¬¡ã«ã€ä¸­å›½ã®ææ–™ã«ã¤ã„ã¦ã‚‚åŒã˜ã“ã¨ã‚’è¡Œã„ã¾ã™ï¼š

    ```python
    chinese_ingredient_df = create_ingredient_df(chinese_df)
    chinese_ingredient_df.head(10).plot.barh()
    ```

    ![chinese](../../../../translated_images/chinese.e62cafa5309f111afd1b54490336daf4e927ce32bed837069a0b7ce481dfae8d.ja.png)

1. ã‚¤ãƒ³ãƒ‰ã®ææ–™ã‚’ãƒ—ãƒ­ãƒƒãƒˆã—ã¾ã™ï¼š

    ```python
    indian_ingredient_df = create_ingredient_df(indian_df)
    indian_ingredient_df.head(10).plot.barh()
    ```

    ![indian](../../../../translated_images/indian.2c4292002af1a1f97a4a24fec6b1459ee8ff616c3822ae56bb62b9903e192af6.ja.png)

1. æœ€å¾Œã«ã€éŸ“å›½ã®ææ–™ã‚’ãƒ—ãƒ­ãƒƒãƒˆã—ã¾ã™ï¼š

    ```python
    korean_ingredient_df = create_ingredient_df(korean_df)
    korean_ingredient_df.head(10).plot.barh()
    ```

    ![korean](../../../../translated_images/korean.4a4f0274f3d9805a65e61f05597eeaad8620b03be23a2c0a705c023f65fad2c0.ja.png)

1. `drop()`ã‚’å‘¼ã³å‡ºã—ã¦ã€ç•°ãªã‚‹æ–™ç†é–“ã§æ··ä¹±ã‚’å¼•ãèµ·ã“ã™æœ€ã‚‚ä¸€èˆ¬çš„ãªææ–™ã‚’å‰Šé™¤ã—ã¾ã™ï¼š

   ã¿ã‚“ãªãŠç±³ã€ã«ã‚“ã«ãã€ã—ã‚‡ã†ãŒãŒå¤§å¥½ãã§ã™ï¼

    ```python
    feature_df= df.drop(['cuisine','Unnamed: 0','rice','garlic','ginger'], axis=1)
    labels_df = df.cuisine #.unique()
    feature_df.head()
    ```

## ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®ãƒãƒ©ãƒ³ã‚¹ã‚’å–ã‚‹

ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ã—ãŸã®ã§ã€[SMOTE](https://imbalanced-learn.org/dev/references/generated/imblearn.over_sampling.SMOTE.html) - ã€Œåˆæˆå°‘æ•°ã‚ªãƒ¼ãƒãƒ¼ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°æŠ€è¡“ã€ - ã‚’ä½¿ç”¨ã—ã¦ãƒãƒ©ãƒ³ã‚¹ã‚’å–ã‚Šã¾ã™ã€‚

1. `fit_resample()`ã‚’å‘¼ã³å‡ºã—ã¾ã™ã€‚ã“ã®æˆ¦ç•¥ã¯ã€è£œé–“ã«ã‚ˆã£ã¦æ–°ã—ã„ã‚µãƒ³ãƒ—ãƒ«ã‚’ç”Ÿæˆã—ã¾ã™ã€‚

    ```python
    oversample = SMOTE()
    transformed_feature_df, transformed_label_df = oversample.fit_resample(feature_df, labels_df)
    ```

    ãƒ‡ãƒ¼ã‚¿ã®ãƒãƒ©ãƒ³ã‚¹ã‚’å–ã‚‹ã“ã¨ã§ã€åˆ†é¡æ™‚ã«ã‚ˆã‚Šè‰¯ã„çµæœãŒå¾—ã‚‰ã‚Œã¾ã™ã€‚äºŒå€¤åˆ†é¡ã‚’è€ƒãˆã¦ã¿ã¦ãã ã•ã„ã€‚ãƒ‡ãƒ¼ã‚¿ã®ã»ã¨ã‚“ã©ãŒ1ã¤ã®ã‚¯ãƒ©ã‚¹ã§ã‚ã‚‹å ´åˆã€MLãƒ¢ãƒ‡ãƒ«ã¯ãã®ã‚¯ãƒ©ã‚¹ã‚’ã‚ˆã‚Šé »ç¹ã«äºˆæ¸¬ã—ã¾ã™ã€‚ãªãœãªã‚‰ã€ãã®ã‚¯ãƒ©ã‚¹ã®ãƒ‡ãƒ¼ã‚¿ãŒå¤šã„ãŸã‚ã§ã™ã€‚ãƒ‡ãƒ¼ã‚¿ã®ãƒãƒ©ãƒ³ã‚¹ã‚’å–ã‚‹ã“ã¨ã§ã€åã£ãŸãƒ‡ãƒ¼ã‚¿ã‚’å–ã‚Šé™¤ãã€ã“ã®ä¸å‡è¡¡ã‚’è§£æ¶ˆã™ã‚‹ã®ã«å½¹ç«‹ã¡ã¾ã™ã€‚

1. æ¬¡ã«ã€ææ–™ã”ã¨ã®ãƒ©ãƒ™ãƒ«ã®æ•°ã‚’ç¢ºèªã—ã¾ã™ï¼š

    ```python
    print(f'new label count: {transformed_label_df.value_counts()}')
    print(f'old label count: {df.cuisine.value_counts()}')
    ```

    å‡ºåŠ›ã¯æ¬¡ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ï¼š

    ```output
    new label count: korean      799
    chinese     799
    indian      799
    japanese    799
    thai        799
    Name: cuisine, dtype: int64
    old label count: korean      799
    indian      598
    chinese     442
    japanese    320
    thai        289
    Name: cuisine, dtype: int64
    ```

    ãƒ‡ãƒ¼ã‚¿ã¯ãã‚Œã„ã§ãƒãƒ©ãƒ³ã‚¹ãŒå–ã‚Œã¦ãŠã‚Šã€ã¨ã¦ã‚‚ãŠã„ã—ãã†ã§ã™ï¼

1. æœ€å¾Œã®ã‚¹ãƒ†ãƒƒãƒ—ã¯ã€ãƒ©ãƒ™ãƒ«ã¨ç‰¹å¾´ã‚’å«ã‚€ãƒãƒ©ãƒ³ã‚¹ã®å–ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã‚’æ–°ã—ã„ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ã«ä¿å­˜ã—ã€ãƒ•ã‚¡ã‚¤ãƒ«ã«ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ã“ã¨ã§ã™ï¼š

    ```python
    transformed_df = pd.concat([transformed_label_df,transformed_feature_df],axis=1, join='outer')
    ```

1. `transformed_df.head()` and `transformed_df.info()`ã‚’ä½¿ç”¨ã—ã¦ãƒ‡ãƒ¼ã‚¿ã‚’ã‚‚ã†ä¸€åº¦ç¢ºèªã§ãã¾ã™ã€‚ä»Šå¾Œã®ãƒ¬ãƒƒã‚¹ãƒ³ã§ä½¿ç”¨ã™ã‚‹ãŸã‚ã«ã“ã®ãƒ‡ãƒ¼ã‚¿ã®ã‚³ãƒ”ãƒ¼ã‚’ä¿å­˜ã—ã¾ã™ï¼š

    ```python
    transformed_df.head()
    transformed_df.info()
    transformed_df.to_csv("../data/cleaned_cuisines.csv")
    ```

    ã“ã®æ–°ã—ã„CSVã¯ãƒ«ãƒ¼ãƒˆãƒ‡ãƒ¼ã‚¿ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã«ã‚ã‚Šã¾ã™ã€‚

---

## ğŸš€ãƒãƒ£ãƒ¬ãƒ³ã‚¸

ã“ã®ã‚«ãƒªã‚­ãƒ¥ãƒ©ãƒ ã«ã¯ã„ãã¤ã‹ã®èˆˆå‘³æ·±ã„ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆãŒå«ã¾ã‚Œã¦ã„ã¾ã™ã€‚`data`ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã‚’æ˜ã‚Šä¸‹ã’ã¦ã€äºŒå€¤ã¾ãŸã¯å¤šã‚¯ãƒ©ã‚¹åˆ†é¡ã«é©ã—ãŸãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆãŒå«ã¾ã‚Œã¦ã„ã‚‹ã‹ã©ã†ã‹ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚ã“ã®ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã«ã©ã®ã‚ˆã†ãªè³ªå•ã‚’ã—ã¾ã™ã‹ï¼Ÿ

## [äº‹å¾Œã‚¯ã‚¤ã‚º](https://gray-sand-07a10f403.1.azurestaticapps.net/quiz/20/)

## ãƒ¬ãƒ“ãƒ¥ãƒ¼ã¨è‡ªå·±å­¦ç¿’

SMOTEã®APIã‚’æ¢ã£ã¦ã¿ã¦ãã ã•ã„ã€‚ã©ã®ã‚ˆã†ãªãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ã«æœ€é©ã§ã™ã‹ï¼Ÿã©ã®ã‚ˆã†ãªå•é¡Œã‚’è§£æ±ºã—ã¾ã™ã‹ï¼Ÿ

## èª²é¡Œ

[åˆ†é¡æ–¹æ³•ã‚’æ¢ã‚‹](assignment.md)

**å…è²¬äº‹é …**:
ã“ã®æ–‡æ›¸ã¯ã€æ©Ÿæ¢°ãƒ™ãƒ¼ã‚¹ã®AIç¿»è¨³ã‚µãƒ¼ãƒ“ã‚¹ã‚’ä½¿ç”¨ã—ã¦ç¿»è¨³ã•ã‚Œã¦ã„ã¾ã™ã€‚æ­£ç¢ºã•ã‚’æœŸã—ã¦ã„ã¾ã™ãŒã€è‡ªå‹•ç¿»è¨³ã«ã¯ã‚¨ãƒ©ãƒ¼ã‚„ä¸æ­£ç¢ºã•ãŒå«ã¾ã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ã“ã¨ã‚’ã”äº†æ‰¿ãã ã•ã„ã€‚åŸæ–‡ã®è¨€èªã§æ›¸ã‹ã‚ŒãŸã‚ªãƒªã‚¸ãƒŠãƒ«æ–‡æ›¸ã‚’æ¨©å¨ã‚ã‚‹æƒ…å ±æºã¨ã¿ãªã—ã¦ãã ã•ã„ã€‚é‡è¦ãªæƒ…å ±ã«ã¤ã„ã¦ã¯ã€å°‚é–€ã®äººé–“ã«ã‚ˆã‚‹ç¿»è¨³ã‚’æ¨å¥¨ã—ã¾ã™ã€‚ã“ã®ç¿»è¨³ã®ä½¿ç”¨ã«èµ·å› ã™ã‚‹èª¤è§£ã‚„èª¤è¨³ã«ã¤ã„ã¦ã¯ã€ä¸€åˆ‡ã®è²¬ä»»ã‚’è² ã„ã‹ã­ã¾ã™ã€‚