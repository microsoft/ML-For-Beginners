<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "76438ce4e5d48982d48f1b55c981caac",
  "translation_date": "2025-09-04T00:01:30+00:00",
  "source_file": "4-Classification/1-Introduction/README.md",
  "language_code": "ja"
}
-->
# åˆ†é¡ã®ç´¹ä»‹

ã“ã®4ã¤ã®ãƒ¬ãƒƒã‚¹ãƒ³ã§ã¯ã€å¤å…¸çš„ãªæ©Ÿæ¢°å­¦ç¿’ã®åŸºæœ¬çš„ãªç„¦ç‚¹ã§ã‚ã‚‹_åˆ†é¡_ã«ã¤ã„ã¦æ¢æ±‚ã—ã¾ã™ã€‚ã‚¢ã‚¸ã‚¢ã¨ã‚¤ãƒ³ãƒ‰ã®ç´ æ™´ã‚‰ã—ã„æ–™ç†ã«é–¢ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’ä½¿ã„ã€ã•ã¾ã–ã¾ãªåˆ†é¡ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚’å®Ÿè·µã—ã¦ã„ãã¾ã™ã€‚ãŠè…¹ãŒç©ºã„ã¦ãã¾ã—ãŸã‹ï¼Ÿ

![ã»ã‚“ã®ã²ã¨ã¤ã¾ã¿ï¼](../../../../translated_images/pinch.1b035ec9ba7e0d408313b551b60c721c9c290b2dd2094115bc87e6ddacd114c9.ja.png)

> ã“ã®ãƒ¬ãƒƒã‚¹ãƒ³ã§ãƒ‘ãƒ³ã‚¢ã‚¸ã‚¢æ–™ç†ã‚’ç¥ãŠã†ï¼ç”»åƒæä¾›: [Jen Looper](https://twitter.com/jenlooper)

åˆ†é¡ã¯[æ•™å¸«ã‚ã‚Šå­¦ç¿’](https://wikipedia.org/wiki/Supervised_learning)ã®ä¸€å½¢æ…‹ã§ã€å›å¸°æ‰‹æ³•ã¨å¤šãã®å…±é€šç‚¹ã‚’æŒã£ã¦ã„ã¾ã™ã€‚æ©Ÿæ¢°å­¦ç¿’ãŒãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’ä½¿ã£ã¦å€¤ã‚„åå‰ã‚’äºˆæ¸¬ã™ã‚‹ã“ã¨ã ã¨ã™ã‚Œã°ã€åˆ†é¡ã¯ä¸€èˆ¬çš„ã«2ã¤ã®ã‚°ãƒ«ãƒ¼ãƒ—ã«åˆ†ã‘ã‚‰ã‚Œã¾ã™ï¼š_äºŒå€¤åˆ†é¡_ã¨_å¤šã‚¯ãƒ©ã‚¹åˆ†é¡_ã§ã™ã€‚

[![åˆ†é¡ã®ç´¹ä»‹](https://img.youtube.com/vi/eg8DJYwdMyg/0.jpg)](https://youtu.be/eg8DJYwdMyg "åˆ†é¡ã®ç´¹ä»‹")

> ğŸ¥ ä¸Šã®ç”»åƒã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦å‹•ç”»ã‚’è¦–è´: MITã®John GuttagãŒåˆ†é¡ã‚’ç´¹ä»‹

è¦šãˆã¦ãŠãã¾ã—ã‚‡ã†ï¼š

- **ç·šå½¢å›å¸°**ã§ã¯ã€å¤‰æ•°é–“ã®é–¢ä¿‚ã‚’äºˆæ¸¬ã—ã€æ–°ã—ã„ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒˆãŒãã®ç·šã«å¯¾ã—ã¦ã©ã“ã«ä½ç½®ã™ã‚‹ã‹ã‚’æ­£ç¢ºã«äºˆæ¸¬ã™ã‚‹ã®ã«å½¹ç«‹ã¡ã¾ã—ãŸã€‚ä¾‹ãˆã°ã€_9æœˆã¨12æœˆã®é–“ã§ã‚«ãƒœãƒãƒ£ã®ä¾¡æ ¼ãŒã©ã†ãªã‚‹ã‹_ã‚’äºˆæ¸¬ã§ãã¾ã—ãŸã€‚
- **ãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯å›å¸°**ã§ã¯ã€ã€ŒäºŒå€¤ã‚«ãƒ†ã‚´ãƒªã€ã‚’ç™ºè¦‹ã™ã‚‹ã®ã«å½¹ç«‹ã¡ã¾ã—ãŸã€‚ä¾‹ãˆã°ã€ã“ã®ä¾¡æ ¼å¸¯ã§_ã“ã®ã‚«ãƒœãƒãƒ£ã¯ã‚ªãƒ¬ãƒ³ã‚¸è‰²ã‹ã€ãã‚Œã¨ã‚‚ã‚ªãƒ¬ãƒ³ã‚¸è‰²ã§ã¯ãªã„ã‹_ã‚’åˆ¤æ–­ã—ã¾ã—ãŸã€‚

åˆ†é¡ã§ã¯ã€ã•ã¾ã–ã¾ãªã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚’ä½¿ç”¨ã—ã¦ã€ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒˆã®ãƒ©ãƒ™ãƒ«ã‚„ã‚¯ãƒ©ã‚¹ã‚’æ±ºå®šã™ã‚‹æ–¹æ³•ã‚’è¦‹ã¤ã‘ã¾ã™ã€‚ã“ã®æ–™ç†ãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ã£ã¦ã€ææ–™ã®ã‚°ãƒ«ãƒ¼ãƒ—ã‚’è¦³å¯Ÿã™ã‚‹ã“ã¨ã§ã€ãã®æ–™ç†ã®èµ·æºã‚’ç‰¹å®šã§ãã‚‹ã‹ã©ã†ã‹ã‚’è¦‹ã¦ã¿ã¾ã—ã‚‡ã†ã€‚

## [è¬›ç¾©å‰ã®ã‚¯ã‚¤ã‚º](https://gray-sand-07a10f403.1.azurestaticapps.net/quiz/19/)

> ### [ã“ã®ãƒ¬ãƒƒã‚¹ãƒ³ã¯Rã§ã‚‚åˆ©ç”¨å¯èƒ½ã§ã™ï¼](../../../../4-Classification/1-Introduction/solution/R/lesson_10.html)

### ã¯ã˜ã‚ã«

åˆ†é¡ã¯ã€æ©Ÿæ¢°å­¦ç¿’ç ”ç©¶è€…ã‚„ãƒ‡ãƒ¼ã‚¿ã‚µã‚¤ã‚¨ãƒ³ãƒ†ã‚£ã‚¹ãƒˆã«ã¨ã£ã¦åŸºæœ¬çš„ãªæ´»å‹•ã®1ã¤ã§ã™ã€‚ä¾‹ãˆã°ã€äºŒå€¤å€¤ã®åŸºæœ¬çš„ãªåˆ†é¡ï¼ˆã€Œã“ã®ãƒ¡ãƒ¼ãƒ«ã¯ã‚¹ãƒ‘ãƒ ã‹ã©ã†ã‹ï¼Ÿã€ï¼‰ã‹ã‚‰ã€ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ“ã‚¸ãƒ§ãƒ³ã‚’ä½¿ç”¨ã—ãŸè¤‡é›‘ãªç”»åƒåˆ†é¡ã‚„ã‚»ã‚°ãƒ¡ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã¾ã§ã€ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¯ãƒ©ã‚¹ã«åˆ†é¡ã—ã€ãã‚Œã«é–¢ã™ã‚‹è³ªå•ã‚’ã™ã‚‹èƒ½åŠ›ã¯å¸¸ã«å½¹ç«‹ã¡ã¾ã™ã€‚

ç§‘å­¦çš„ã«è¨€ã†ã¨ã€åˆ†é¡æ‰‹æ³•ã¯äºˆæ¸¬ãƒ¢ãƒ‡ãƒ«ã‚’ä½œæˆã—ã€å…¥åŠ›å¤‰æ•°ã¨å‡ºåŠ›å¤‰æ•°ã®é–¢ä¿‚ã‚’ãƒãƒƒãƒ”ãƒ³ã‚°ã§ãã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚

![äºŒå€¤åˆ†é¡ vs. å¤šã‚¯ãƒ©ã‚¹åˆ†é¡](../../../../translated_images/binary-multiclass.b56d0c86c81105a697dddd82242c1d11e4d78b7afefea07a44627a0f1111c1a9.ja.png)

> åˆ†é¡ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ãŒæ‰±ã†äºŒå€¤å•é¡Œã¨å¤šã‚¯ãƒ©ã‚¹å•é¡Œã€‚ã‚¤ãƒ³ãƒ•ã‚©ã‚°ãƒ©ãƒ•ã‚£ãƒƒã‚¯æä¾›: [Jen Looper](https://twitter.com/jenlooper)

ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°ã—ã€è¦–è¦šåŒ–ã—ã€æ©Ÿæ¢°å­¦ç¿’ã‚¿ã‚¹ã‚¯ã®æº–å‚™ã‚’å§‹ã‚ã‚‹å‰ã«ã€æ©Ÿæ¢°å­¦ç¿’ã‚’ä½¿ç”¨ã—ã¦ãƒ‡ãƒ¼ã‚¿ã‚’åˆ†é¡ã™ã‚‹ã•ã¾ã–ã¾ãªæ–¹æ³•ã«ã¤ã„ã¦å°‘ã—å­¦ã³ã¾ã—ã‚‡ã†ã€‚

[çµ±è¨ˆå­¦](https://wikipedia.org/wiki/Statistical_classification)ã«ç”±æ¥ã™ã‚‹å¤å…¸çš„ãªæ©Ÿæ¢°å­¦ç¿’ã‚’ä½¿ç”¨ã—ãŸåˆ†é¡ã§ã¯ã€`smoker`ã€`weight`ã€`age`ãªã©ã®ç‰¹å¾´ã‚’ä½¿ç”¨ã—ã¦ã€_Xç—…ã‚’ç™ºç—‡ã™ã‚‹å¯èƒ½æ€§_ã‚’åˆ¤æ–­ã—ã¾ã™ã€‚ä»¥å‰ã«è¡Œã£ãŸå›å¸°æ¼”ç¿’ã¨åŒæ§˜ã«ã€æ•™å¸«ã‚ã‚Šå­¦ç¿’æŠ€è¡“ã¨ã—ã¦ã€ãƒ‡ãƒ¼ã‚¿ã«ã¯ãƒ©ãƒ™ãƒ«ãŒä»˜ã‘ã‚‰ã‚Œã¦ãŠã‚Šã€æ©Ÿæ¢°å­¦ç¿’ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã¯ãã®ãƒ©ãƒ™ãƒ«ã‚’ä½¿ç”¨ã—ã¦ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®ã‚¯ãƒ©ã‚¹ï¼ˆã¾ãŸã¯ã€Œç‰¹å¾´ã€ï¼‰ã‚’åˆ†é¡ã—ã€ã‚°ãƒ«ãƒ¼ãƒ—ã‚„çµæœã«å‰²ã‚Šå½“ã¦ã¾ã™ã€‚

âœ… æ–™ç†ã«é–¢ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’æƒ³åƒã—ã¦ã¿ã¦ãã ã•ã„ã€‚å¤šã‚¯ãƒ©ã‚¹ãƒ¢ãƒ‡ãƒ«ã§ã¯ã©ã®ã‚ˆã†ãªè³ªå•ã«ç­”ãˆã‚‰ã‚Œã‚‹ã§ã—ã‚‡ã†ã‹ï¼ŸäºŒå€¤ãƒ¢ãƒ‡ãƒ«ã§ã¯ã©ã®ã‚ˆã†ãªè³ªå•ã«ç­”ãˆã‚‰ã‚Œã‚‹ã§ã—ã‚‡ã†ã‹ï¼Ÿä¾‹ãˆã°ã€ã‚ã‚‹æ–™ç†ãŒãƒ•ã‚§ãƒŒã‚°ãƒªãƒ¼ã‚¯ã‚’ä½¿ç”¨ã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ã‹ã©ã†ã‹ã‚’åˆ¤æ–­ã—ãŸã„å ´åˆã¯ã©ã†ã§ã—ã‚‡ã†ï¼Ÿã¾ãŸã€ã‚¹ã‚¿ãƒ¼ã‚¢ãƒ‹ã‚¹ã€ã‚¢ãƒ¼ãƒ†ã‚£ãƒãƒ§ãƒ¼ã‚¯ã€ã‚«ãƒªãƒ•ãƒ©ãƒ¯ãƒ¼ã€ãƒ›ãƒ¼ã‚¹ãƒ©ãƒ‡ã‚£ãƒƒã‚·ãƒ¥ãŒè©°ã¾ã£ãŸè²·ã„ç‰©è¢‹ã‚’æ¸¡ã•ã‚ŒãŸã¨ãã€ãã‚Œã§å…¸å‹çš„ãªã‚¤ãƒ³ãƒ‰æ–™ç†ã‚’ä½œã‚Œã‚‹ã‹ã©ã†ã‹ã‚’çŸ¥ã‚ŠãŸã„å ´åˆã¯ã©ã†ã§ã—ã‚‡ã†ï¼Ÿ

[![ã‚¯ãƒ¬ã‚¤ã‚¸ãƒ¼ãªãƒŸã‚¹ãƒ†ãƒªãƒ¼ãƒã‚¹ã‚±ãƒƒãƒˆ](https://img.youtube.com/vi/GuTeDbaNoEU/0.jpg)](https://youtu.be/GuTeDbaNoEU "ã‚¯ãƒ¬ã‚¤ã‚¸ãƒ¼ãªãƒŸã‚¹ãƒ†ãƒªãƒ¼ãƒã‚¹ã‚±ãƒƒãƒˆ")

> ğŸ¥ ä¸Šã®ç”»åƒã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦å‹•ç”»ã‚’è¦–è´ã€‚æ–™ç†ç•ªçµ„ã€Choppedã€ã®å…¨ä½“ã®ã‚³ãƒ³ã‚»ãƒ—ãƒˆã¯ã€ŒãƒŸã‚¹ãƒ†ãƒªãƒ¼ãƒã‚¹ã‚±ãƒƒãƒˆã€ã§ã€ã‚·ã‚§ãƒ•ãŸã¡ãŒãƒ©ãƒ³ãƒ€ãƒ ãªææ–™ã‹ã‚‰æ–™ç†ã‚’ä½œã‚‰ãªã‘ã‚Œã°ãªã‚Šã¾ã›ã‚“ã€‚ãã£ã¨æ©Ÿæ¢°å­¦ç¿’ãƒ¢ãƒ‡ãƒ«ãŒå½¹ç«‹ã¤ã§ã—ã‚‡ã†ï¼

## ã“ã‚“ã«ã¡ã¯ã€Œåˆ†é¡å™¨ã€

ã“ã®æ–™ç†ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã«é–¢ã—ã¦ç§ãŸã¡ãŒå°‹ã­ãŸã„è³ªå•ã¯ã€å®Ÿéš›ã«ã¯**å¤šã‚¯ãƒ©ã‚¹ã®è³ªå•**ã§ã™ã€‚ãªãœãªã‚‰ã€æ‰±ã†ã¹ãå›½åˆ¥ã®æ–™ç†ãŒã„ãã¤ã‚‚ã‚ã‚‹ã‹ã‚‰ã§ã™ã€‚ææ–™ã®ä¸€ç¾¤ãŒä¸ãˆã‚‰ã‚ŒãŸå ´åˆã€ãã‚Œã‚‰ã®å¤šãã®ã‚¯ãƒ©ã‚¹ã®ã†ã¡ã©ã‚Œã«ãƒ‡ãƒ¼ã‚¿ãŒé©åˆã™ã‚‹ã§ã—ã‚‡ã†ã‹ï¼Ÿ

Scikit-learnã¯ã€è§£æ±ºã—ãŸã„å•é¡Œã®ç¨®é¡ã«å¿œã˜ã¦ã€ãƒ‡ãƒ¼ã‚¿ã‚’åˆ†é¡ã™ã‚‹ãŸã‚ã®ã•ã¾ã–ã¾ãªã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚’æä¾›ã—ã¦ã„ã¾ã™ã€‚æ¬¡ã®2ã¤ã®ãƒ¬ãƒƒã‚¹ãƒ³ã§ã¯ã€ã“ã‚Œã‚‰ã®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®ã„ãã¤ã‹ã«ã¤ã„ã¦å­¦ã³ã¾ã™ã€‚

## æ¼”ç¿’ - ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°ã—ã¦ãƒãƒ©ãƒ³ã‚¹ã‚’å–ã‚‹

ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’é–‹å§‹ã™ã‚‹å‰ã®æœ€åˆã®ã‚¿ã‚¹ã‚¯ã¯ã€ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°ã—ã€**ãƒãƒ©ãƒ³ã‚¹ã‚’å–ã‚‹**ã“ã¨ã§ã€ã‚ˆã‚Šè‰¯ã„çµæœã‚’å¾—ã‚‹ã“ã¨ã§ã™ã€‚ã“ã®ãƒ•ã‚©ãƒ«ãƒ€ã®ãƒ«ãƒ¼ãƒˆã«ã‚ã‚‹ç©ºã®_notebook.ipynb_ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰å§‹ã‚ã¦ãã ã•ã„ã€‚

æœ€åˆã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã®ã¯[imblearn](https://imbalanced-learn.org/stable/)ã§ã™ã€‚ã“ã‚Œã¯ã€ãƒ‡ãƒ¼ã‚¿ã®ãƒãƒ©ãƒ³ã‚¹ã‚’ã‚ˆã‚Šè‰¯ãã™ã‚‹ãŸã‚ã®Scikit-learnãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã§ã™ï¼ˆã“ã®ã‚¿ã‚¹ã‚¯ã«ã¤ã„ã¦ã¯å¾Œã§è©³ã—ãå­¦ã³ã¾ã™ï¼‰ã€‚

1. `imblearn`ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã«ã¯ã€ä»¥ä¸‹ã®ã‚ˆã†ã«`pip install`ã‚’å®Ÿè¡Œã—ã¾ã™ï¼š

    ```python
    pip install imblearn
    ```

1. å¿…è¦ãªãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã¦ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã€è¦–è¦šåŒ–ã—ã¾ã™ã€‚ã¾ãŸã€`imblearn`ã‹ã‚‰`SMOTE`ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã¾ã™ã€‚

    ```python
    import pandas as pd
    import matplotlib.pyplot as plt
    import matplotlib as mpl
    import numpy as np
    from imblearn.over_sampling import SMOTE
    ```

    ã“ã‚Œã§ã€æ¬¡ã«ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã™ã‚‹æº–å‚™ãŒæ•´ã„ã¾ã—ãŸã€‚

1. æ¬¡ã®ã‚¿ã‚¹ã‚¯ã¯ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã™ã‚‹ã“ã¨ã§ã™ï¼š

    ```python
    df  = pd.read_csv('../data/cuisines.csv')
    ```

   `read_csv()`ã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€_cusines.csv_ãƒ•ã‚¡ã‚¤ãƒ«ã®å†…å®¹ã‚’èª­ã¿å–ã‚Šã€å¤‰æ•°`df`ã«é…ç½®ã—ã¾ã™ã€‚

1. ãƒ‡ãƒ¼ã‚¿ã®å½¢çŠ¶ã‚’ç¢ºèªã—ã¾ã™ï¼š

    ```python
    df.head()
    ```

   æœ€åˆã®5è¡Œã¯æ¬¡ã®ã‚ˆã†ã«è¦‹ãˆã¾ã™ï¼š

    ```output
    |     | Unnamed: 0 | cuisine | almond | angelica | anise | anise_seed | apple | apple_brandy | apricot | armagnac | ... | whiskey | white_bread | white_wine | whole_grain_wheat_flour | wine | wood | yam | yeast | yogurt | zucchini |
    | --- | ---------- | ------- | ------ | -------- | ----- | ---------- | ----- | ------------ | ------- | -------- | --- | ------- | ----------- | ---------- | ----------------------- | ---- | ---- | --- | ----- | ------ | -------- |
    | 0   | 65         | indian  | 0      | 0        | 0     | 0          | 0     | 0            | 0       | 0        | ... | 0       | 0           | 0          | 0                       | 0    | 0    | 0   | 0     | 0      | 0        |
    | 1   | 66         | indian  | 1      | 0        | 0     | 0          | 0     | 0            | 0       | 0        | ... | 0       | 0           | 0          | 0                       | 0    | 0    | 0   | 0     | 0      | 0        |
    | 2   | 67         | indian  | 0      | 0        | 0     | 0          | 0     | 0            | 0       | 0        | ... | 0       | 0           | 0          | 0                       | 0    | 0    | 0   | 0     | 0      | 0        |
    | 3   | 68         | indian  | 0      | 0        | 0     | 0          | 0     | 0            | 0       | 0        | ... | 0       | 0           | 0          | 0                       | 0    | 0    | 0   | 0     | 0      | 0        |
    | 4   | 69         | indian  | 0      | 0        | 0     | 0          | 0     | 0            | 0       | 0        | ... | 0       | 0           | 0          | 0                       | 0    | 0    | 0   | 0     | 1      | 0        |
    ```

1. ã“ã®ãƒ‡ãƒ¼ã‚¿ã«ã¤ã„ã¦ã®æƒ…å ±ã‚’`info()`ã‚’å‘¼ã³å‡ºã—ã¦å–å¾—ã—ã¾ã™ï¼š

    ```python
    df.info()
    ```

    å‡ºåŠ›ã¯æ¬¡ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ï¼š

    ```output
    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 2448 entries, 0 to 2447
    Columns: 385 entries, Unnamed: 0 to zucchini
    dtypes: int64(384), object(1)
    memory usage: 7.2+ MB
    ```

## æ¼”ç¿’ - æ–™ç†ã«ã¤ã„ã¦å­¦ã¶

ã“ã“ã‹ã‚‰ä½œæ¥­ãŒã‚ˆã‚Šèˆˆå‘³æ·±ããªã‚Šã¾ã™ã€‚æ–™ç†ã”ã¨ã®ãƒ‡ãƒ¼ã‚¿ã®åˆ†å¸ƒã‚’èª¿ã¹ã¦ã¿ã¾ã—ã‚‡ã†ã€‚

1. `barh()`ã‚’å‘¼ã³å‡ºã—ã¦ãƒ‡ãƒ¼ã‚¿ã‚’æ£’ã‚°ãƒ©ãƒ•ã¨ã—ã¦ãƒ—ãƒ­ãƒƒãƒˆã—ã¾ã™ï¼š

    ```python
    df.cuisine.value_counts().plot.barh()
    ```

    ![æ–™ç†ãƒ‡ãƒ¼ã‚¿ã®åˆ†å¸ƒ](../../../../translated_images/cuisine-dist.d0cc2d551abe5c25f83d73a5f560927e4a061e9a4560bac1e97d35682ef3ca6d.ja.png)

    æ–™ç†ã®æ•°ã¯æœ‰é™ã§ã™ãŒã€ãƒ‡ãƒ¼ã‚¿ã®åˆ†å¸ƒã¯ä¸å‡ä¸€ã§ã™ã€‚ã“ã‚Œã‚’ä¿®æ­£ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼ãã®å‰ã«ã€ã‚‚ã†å°‘ã—æ¢ç´¢ã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚

1. æ–™ç†ã”ã¨ã«åˆ©ç”¨å¯èƒ½ãªãƒ‡ãƒ¼ã‚¿é‡ã‚’èª¿ã¹ã¦å°åˆ·ã—ã¾ã™ï¼š

    ```python
    thai_df = df[(df.cuisine == "thai")]
    japanese_df = df[(df.cuisine == "japanese")]
    chinese_df = df[(df.cuisine == "chinese")]
    indian_df = df[(df.cuisine == "indian")]
    korean_df = df[(df.cuisine == "korean")]
    
    print(f'thai df: {thai_df.shape}')
    print(f'japanese df: {japanese_df.shape}')
    print(f'chinese df: {chinese_df.shape}')
    print(f'indian df: {indian_df.shape}')
    print(f'korean df: {korean_df.shape}')
    ```

    å‡ºåŠ›ã¯æ¬¡ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ï¼š

    ```output
    thai df: (289, 385)
    japanese df: (320, 385)
    chinese df: (442, 385)
    indian df: (598, 385)
    korean df: (799, 385)
    ```

## ææ–™ã‚’ç™ºè¦‹ã™ã‚‹

æ¬¡ã«ã€ãƒ‡ãƒ¼ã‚¿ã‚’ã•ã‚‰ã«æ˜ã‚Šä¸‹ã’ã¦ã€æ–™ç†ã”ã¨ã®å…¸å‹çš„ãªææ–™ã‚’å­¦ã³ã¾ã™ã€‚ç•°ãªã‚‹æ–™ç†é–“ã§æ··ä¹±ã‚’å¼•ãèµ·ã“ã™å†ç™ºãƒ‡ãƒ¼ã‚¿ã‚’ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ã“ã®å•é¡Œã«ã¤ã„ã¦å­¦ã³ã¾ã—ã‚‡ã†ã€‚

1. Pythonã§`create_ingredient()`é–¢æ•°ã‚’ä½œæˆã—ã¦ã€ææ–™ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ã‚’ä½œæˆã—ã¾ã™ã€‚ã“ã®é–¢æ•°ã¯ã€å½¹ã«ç«‹ãŸãªã„åˆ—ã‚’å‰Šé™¤ã—ã€ææ–™ã‚’ãã®ã‚«ã‚¦ãƒ³ãƒˆã§ã‚½ãƒ¼ãƒˆã™ã‚‹ã“ã¨ã‹ã‚‰å§‹ã‚ã¾ã™ï¼š

    ```python
    def create_ingredient_df(df):
        ingredient_df = df.T.drop(['cuisine','Unnamed: 0']).sum(axis=1).to_frame('value')
        ingredient_df = ingredient_df[(ingredient_df.T != 0).any()]
        ingredient_df = ingredient_df.sort_values(by='value', ascending=False,
        inplace=False)
        return ingredient_df
    ```

   ã“ã®é–¢æ•°ã‚’ä½¿ç”¨ã—ã¦ã€æ–™ç†ã”ã¨ã®ãƒˆãƒƒãƒ—10ã®äººæ°—ææ–™ã‚’æŠŠæ¡ã§ãã¾ã™ã€‚

1. `create_ingredient()`ã‚’å‘¼ã³å‡ºã—ã€`barh()`ã‚’å‘¼ã³å‡ºã—ã¦ãƒ—ãƒ­ãƒƒãƒˆã—ã¾ã™ï¼š

    ```python
    thai_ingredient_df = create_ingredient_df(thai_df)
    thai_ingredient_df.head(10).plot.barh()
    ```

    ![ã‚¿ã‚¤æ–™ç†](../../../../translated_images/thai.0269dbab2e78bd38a132067759fe980008bdb80b6d778e5313448dbe12bed846.ja.png)

1. æ—¥æœ¬æ–™ç†ã®ãƒ‡ãƒ¼ã‚¿ã«ã¤ã„ã¦ã‚‚åŒã˜ã“ã¨ã‚’è¡Œã„ã¾ã™ï¼š

    ```python
    japanese_ingredient_df = create_ingredient_df(japanese_df)
    japanese_ingredient_df.head(10).plot.barh()
    ```

    ![æ—¥æœ¬æ–™ç†](../../../../translated_images/japanese.30260486f2a05c463c8faa62ebe7b38f0961ed293bd9a6db8eef5d3f0cf17155.ja.png)

1. ä¸­å›½æ–™ç†ã®ææ–™ã«ã¤ã„ã¦ã‚‚åŒæ§˜ã§ã™ï¼š

    ```python
    chinese_ingredient_df = create_ingredient_df(chinese_df)
    chinese_ingredient_df.head(10).plot.barh()
    ```

    ![ä¸­å›½æ–™ç†](../../../../translated_images/chinese.e62cafa5309f111afd1b54490336daf4e927ce32bed837069a0b7ce481dfae8d.ja.png)

1. ã‚¤ãƒ³ãƒ‰æ–™ç†ã®ææ–™ã‚’ãƒ—ãƒ­ãƒƒãƒˆã—ã¾ã™ï¼š

    ```python
    indian_ingredient_df = create_ingredient_df(indian_df)
    indian_ingredient_df.head(10).plot.barh()
    ```

    ![ã‚¤ãƒ³ãƒ‰æ–™ç†](../../../../translated_images/indian.2c4292002af1a1f97a4a24fec6b1459ee8ff616c3822ae56bb62b9903e192af6.ja.png)

1. æœ€å¾Œã«ã€éŸ“å›½æ–™ç†ã®ææ–™ã‚’ãƒ—ãƒ­ãƒƒãƒˆã—ã¾ã™ï¼š

    ```python
    korean_ingredient_df = create_ingredient_df(korean_df)
    korean_ingredient_df.head(10).plot.barh()
    ```

    ![éŸ“å›½æ–™ç†](../../../../translated_images/korean.4a4f0274f3d9805a65e61f05597eeaad8620b03be23a2c0a705c023f65fad2c0.ja.png)

1. æ¬¡ã«ã€ç•°ãªã‚‹æ–™ç†é–“ã§æ··ä¹±ã‚’å¼•ãèµ·ã“ã™æœ€ã‚‚ä¸€èˆ¬çš„ãªææ–™ã‚’`drop()`ã‚’å‘¼ã³å‡ºã—ã¦å‰Šé™¤ã—ã¾ã™ï¼š

   ã¿ã‚“ãªãŒå¤§å¥½ããªç±³ã€ãƒ‹ãƒ³ãƒ‹ã‚¯ã€ç”Ÿå§œã‚’å‰Šé™¤ã—ã¾ã™ï¼

    ```python
    feature_df= df.drop(['cuisine','Unnamed: 0','rice','garlic','ginger'], axis=1)
    labels_df = df.cuisine #.unique()
    feature_df.head()
    ```

## ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®ãƒãƒ©ãƒ³ã‚¹ã‚’å–ã‚‹

ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°ã—ãŸã‚‰ã€[SMOTE](https://imbalanced-learn.org/dev/references/generated/imblearn.over_sampling.SMOTE.html)ï¼ˆSynthetic Minority Over-sampling Techniqueï¼‰ã‚’ä½¿ç”¨ã—ã¦ãƒãƒ©ãƒ³ã‚¹ã‚’å–ã‚Šã¾ã™ã€‚

1. `fit_resample()`ã‚’å‘¼ã³å‡ºã—ã¾ã™ã€‚ã“ã®æˆ¦ç•¥ã¯è£œé–“ã«ã‚ˆã£ã¦æ–°ã—ã„ã‚µãƒ³ãƒ—ãƒ«ã‚’ç”Ÿæˆã—ã¾ã™ã€‚

    ```python
    oversample = SMOTE()
    transformed_feature_df, transformed_label_df = oversample.fit_resample(feature_df, labels_df)
    ```

    ãƒ‡ãƒ¼ã‚¿ã‚’ãƒãƒ©ãƒ³ã‚¹ã•ã›ã‚‹ã“ã¨ã§ã€åˆ†é¡æ™‚ã«ã‚ˆã‚Šè‰¯ã„çµæœãŒå¾—ã‚‰ã‚Œã¾ã™ã€‚äºŒå€¤åˆ†é¡ã‚’è€ƒãˆã¦ã¿ã¦ãã ã•ã„ã€‚ãƒ‡ãƒ¼ã‚¿ã®å¤§éƒ¨åˆ†ãŒ1ã¤ã®ã‚¯ãƒ©ã‚¹ã§ã‚ã‚‹å ´åˆã€æ©Ÿæ¢°å­¦ç¿’ãƒ¢ãƒ‡ãƒ«ã¯ãã®ã‚¯ãƒ©ã‚¹ã‚’ã‚ˆã‚Šé »ç¹ã«äºˆæ¸¬ã™ã‚‹å‚¾å‘ãŒã‚ã‚Šã¾ã™ã€‚ãŸã ã—ã€ãƒ‡ãƒ¼ã‚¿ãŒå¤šã„ãŸã‚ã§ã™ã€‚ãƒ‡ãƒ¼ã‚¿ã®ãƒãƒ©ãƒ³ã‚¹ã‚’å–ã‚‹ã“ã¨ã§ã€ã“ã®ä¸å‡è¡¡ã‚’å–ã‚Šé™¤ãã®ã«å½¹ç«‹ã¡ã¾ã™ã€‚

1. æ¬¡ã«ã€ææ–™ã”ã¨ã®ãƒ©ãƒ™ãƒ«æ•°ã‚’ç¢ºèªã—ã¾ã™ï¼š

    ```python
    print(f'new label count: {transformed_label_df.value_counts()}')
    print(f'old label count: {df.cuisine.value_counts()}')
    ```

    å‡ºåŠ›ã¯æ¬¡ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ï¼š

    ```output
    new label count: korean      799
    chinese     799
    indian      799
    japanese    799
    thai        799
    Name: cuisine, dtype: int64
    old label count: korean      799
    indian      598
    chinese     442
    japanese    320
    thai        289
    Name: cuisine, dtype: int64
    ```

    ãƒ‡ãƒ¼ã‚¿ã¯ãã‚Œã„ã§ãƒãƒ©ãƒ³ã‚¹ãŒå–ã‚Œã¦ãŠã‚Šã€ã¨ã¦ã‚‚ç¾å‘³ã—ãã†ã§ã™ï¼

1. æœ€å¾Œã®ã‚¹ãƒ†ãƒƒãƒ—ã¯ã€ãƒ©ãƒ™ãƒ«ã¨ç‰¹å¾´ã‚’å«ã‚€ãƒãƒ©ãƒ³ã‚¹ã®å–ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã‚’æ–°ã—ã„ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ã«ä¿å­˜ã—ã€ãƒ•ã‚¡ã‚¤ãƒ«ã«ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã™ã‚‹ã“ã¨ã§ã™ï¼š

    ```python
    transformed_df = pd.concat([transformed_label_df,transformed_feature_df],axis=1, join='outer')
    ```

1. `transformed_df.head()`ã¨`transformed_df.info()`ã‚’ä½¿ç”¨ã—ã¦ãƒ‡ãƒ¼ã‚¿ã‚’ã‚‚ã†ä¸€åº¦ç¢ºèªã§ãã¾ã™ã€‚ã“ã®ãƒ‡ãƒ¼ã‚¿ã®ã‚³ãƒ”ãƒ¼ã‚’ä¿å­˜ã—ã¦ã€ä»Šå¾Œã®ãƒ¬ãƒƒã‚¹ãƒ³ã§ä½¿ç”¨ã—ã¦ãã ã•ã„ï¼š

    ```python
    transformed_df.head()
    transformed_df.info()
    transformed_df.to_csv("../data/cleaned_cuisines.csv")
    ```

    ã“ã®æ–°ã—ã„CSVã¯ã€ãƒ«ãƒ¼ãƒˆãƒ‡ãƒ¼ã‚¿ãƒ•ã‚©ãƒ«ãƒ€ã«ä¿å­˜ã•ã‚Œã¾ã™ã€‚

---

## ğŸš€ãƒãƒ£ãƒ¬ãƒ³ã‚¸

ã“ã®ã‚«ãƒªã‚­ãƒ¥ãƒ©ãƒ ã«ã¯ã€ã„ãã¤ã‹ã®èˆˆå‘³æ·±ã„ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆãŒå«ã¾ã‚Œã¦ã„ã¾ã™ã€‚`data`ãƒ•ã‚©ãƒ«ãƒ€ã‚’æ˜ã‚Šä¸‹ã’ã¦ã€äºŒå€¤ã¾ãŸã¯å¤šã‚¯ãƒ©ã‚¹åˆ†é¡ã«é©ã—ãŸãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆãŒå«ã¾ã‚Œã¦ã„ã‚‹ã‹ç¢ºèªã—ã¦ãã ã•ã„ã€‚ã“ã®ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã«ã©ã®ã‚ˆã†ãªè³ªå•ã‚’ã—ã¾ã™ã‹ï¼Ÿ

## [è¬›ç¾©å¾Œã®ã‚¯ã‚¤ã‚º](https://gray-sand-07a10f403.1.azurestaticapps.net/quiz/20/)

## å¾©ç¿’ã¨è‡ªå·±å­¦ç¿’

SMOTEã®APIã‚’èª¿ã¹ã¦ã¿ã¾ã—ã‚‡ã†ã€‚ã©ã®ã‚ˆã†ãªãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ã«æœ€é©ã§ã€ã©ã®ã‚ˆã†ãªå•é¡Œã‚’è§£æ±ºã™ã‚‹ã®ã§ã—ã‚‡ã†ã‹ï¼Ÿ

## èª²é¡Œ 

[åˆ†é¡æ‰‹æ³•ã‚’æ¢æ±‚ã™ã‚‹](assignment.md)

---

**å…è²¬äº‹é …**:  
ã“ã®æ–‡æ›¸ã¯ã€AIç¿»è¨³ã‚µãƒ¼ãƒ“ã‚¹ [Co-op Translator](https://github.com/Azure/co-op-translator) ã‚’ä½¿ç”¨ã—ã¦ç¿»è¨³ã•ã‚Œã¦ã„ã¾ã™ã€‚æ­£ç¢ºæ€§ã‚’è¿½æ±‚ã—ã¦ãŠã‚Šã¾ã™ãŒã€è‡ªå‹•ç¿»è¨³ã«ã¯èª¤ã‚Šã‚„ä¸æ­£ç¢ºãªéƒ¨åˆ†ãŒå«ã¾ã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ã“ã¨ã‚’ã”æ‰¿çŸ¥ãã ã•ã„ã€‚å…ƒã®è¨€èªã§è¨˜è¼‰ã•ã‚ŒãŸæ–‡æ›¸ãŒæ­£å¼ãªæƒ…å ±æºã¨ã¿ãªã•ã‚Œã‚‹ã¹ãã§ã™ã€‚é‡è¦ãªæƒ…å ±ã«ã¤ã„ã¦ã¯ã€å°‚é–€ã®äººé–“ã«ã‚ˆã‚‹ç¿»è¨³ã‚’æ¨å¥¨ã—ã¾ã™ã€‚ã“ã®ç¿»è¨³ã®ä½¿ç”¨ã«èµ·å› ã™ã‚‹èª¤è§£ã‚„èª¤ã£ãŸè§£é‡ˆã«ã¤ã„ã¦ã€å½“æ–¹ã¯ä¸€åˆ‡ã®è²¬ä»»ã‚’è² ã„ã¾ã›ã‚“ã€‚