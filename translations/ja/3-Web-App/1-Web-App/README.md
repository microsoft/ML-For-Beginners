# MLãƒ¢ãƒ‡ãƒ«ã‚’ä½¿ç”¨ã™ã‚‹Webã‚¢ãƒ—ãƒªã‚’æ§‹ç¯‰ã™ã‚‹

ã“ã®ãƒ¬ãƒƒã‚¹ãƒ³ã§ã¯ã€NUFORCã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‹ã‚‰å–å¾—ã—ãŸã€Œéå»1ä¸–ç´€ã®UFOç›®æ’ƒæƒ…å ±ã€ã¨ã„ã†ã€ã¾ã•ã«éç¾å®Ÿçš„ãªãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã§MLãƒ¢ãƒ‡ãƒ«ã‚’è¨“ç·´ã—ã¾ã™ã€‚

ã‚ãªãŸãŒå­¦ã¶ã“ã¨:

- è¨“ç·´ã•ã‚ŒãŸãƒ¢ãƒ‡ãƒ«ã‚’ã€Œãƒ”ã‚¯ãƒ«ã€ã™ã‚‹æ–¹æ³•
- Flaskã‚¢ãƒ—ãƒªã§ãã®ãƒ¢ãƒ‡ãƒ«ã‚’ä½¿ç”¨ã™ã‚‹æ–¹æ³•

ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ã—ã€ãƒ¢ãƒ‡ãƒ«ã‚’è¨“ç·´ã™ã‚‹ãŸã‚ã«ãƒãƒ¼ãƒˆãƒ–ãƒƒã‚¯ã‚’å¼•ãç¶šãä½¿ç”¨ã—ã¾ã™ãŒã€ãƒ—ãƒ­ã‚»ã‚¹ã‚’ä¸€æ­©é€²ã‚ã¦ã€ã„ã‚ã°ã€Œé‡ç”Ÿã§ã€ãƒ¢ãƒ‡ãƒ«ã‚’ä½¿ç”¨ã™ã‚‹æ–¹æ³•ã‚’æ¢æ±‚ã—ã¾ã™ï¼šãã‚Œã¯Webã‚¢ãƒ—ãƒªã®ä¸­ã§ã®ã“ã¨ã§ã™ã€‚

ã“ã‚Œã‚’å®Ÿç¾ã™ã‚‹ãŸã‚ã«ã€Flaskã‚’ä½¿ç”¨ã—ã¦Webã‚¢ãƒ—ãƒªã‚’æ§‹ç¯‰ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

## [è¬›ç¾©å‰ã‚¯ã‚¤ã‚º](https://gray-sand-07a10f403.1.azurestaticapps.net/quiz/17/)

## ã‚¢ãƒ—ãƒªã®æ§‹ç¯‰

æ©Ÿæ¢°å­¦ç¿’ãƒ¢ãƒ‡ãƒ«ã‚’æ¶ˆè²»ã™ã‚‹ãŸã‚ã®Webã‚¢ãƒ—ãƒªã‚’æ§‹ç¯‰ã™ã‚‹æ–¹æ³•ã¯ã„ãã¤ã‹ã‚ã‚Šã¾ã™ã€‚ã‚ãªãŸã®Webã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã¯ã€ãƒ¢ãƒ‡ãƒ«ãŒã©ã®ã‚ˆã†ã«è¨“ç·´ã•ã‚Œã‚‹ã‹ã«å½±éŸ¿ã‚’ä¸ãˆã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚ãƒ‡ãƒ¼ã‚¿ã‚µã‚¤ã‚¨ãƒ³ã‚¹ã‚°ãƒ«ãƒ¼ãƒ—ãŒè¨“ç·´ã—ãŸãƒ¢ãƒ‡ãƒ«ã‚’ã‚¢ãƒ—ãƒªã§ä½¿ç”¨ã—ãŸã„ãƒ“ã‚¸ãƒã‚¹ã§åƒã„ã¦ã„ã‚‹ã¨æƒ³åƒã—ã¦ãã ã•ã„ã€‚

### è€ƒæ…®äº‹é …

è€ƒæ…®ã™ã¹ãå¤šãã®è³ªå•ãŒã‚ã‚Šã¾ã™ï¼š

- **Webã‚¢ãƒ—ãƒªã§ã™ã‹ã€ãã‚Œã¨ã‚‚ãƒ¢ãƒã‚¤ãƒ«ã‚¢ãƒ—ãƒªã§ã™ã‹ï¼Ÿ** ãƒ¢ãƒã‚¤ãƒ«ã‚¢ãƒ—ãƒªã‚’æ§‹ç¯‰ã—ã¦ã„ã‚‹å ´åˆã‚„ã€IoTã®ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã§ãƒ¢ãƒ‡ãƒ«ã‚’ä½¿ç”¨ã™ã‚‹å¿…è¦ãŒã‚ã‚‹å ´åˆã¯ã€[TensorFlow Lite](https://www.tensorflow.org/lite/)ã‚’ä½¿ç”¨ã—ã¦ã€Androidã¾ãŸã¯iOSã‚¢ãƒ—ãƒªã§ãƒ¢ãƒ‡ãƒ«ã‚’ä½¿ç”¨ã§ãã¾ã™ã€‚
- **ãƒ¢ãƒ‡ãƒ«ã¯ã©ã“ã«é…ç½®ã•ã‚Œã¾ã™ã‹ï¼Ÿ** ã‚¯ãƒ©ã‚¦ãƒ‰ä¸Šã‹ãƒ­ãƒ¼ã‚«ãƒ«ã‹ï¼Ÿ
- **ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ã‚µãƒãƒ¼ãƒˆã€‚** ã‚¢ãƒ—ãƒªã¯ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ã§å‹•ä½œã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã‹ï¼Ÿ
- **ãƒ¢ãƒ‡ãƒ«ã‚’è¨“ç·´ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚ŒãŸæŠ€è¡“ã¯ä½•ã§ã™ã‹ï¼Ÿ** é¸æŠã—ãŸæŠ€è¡“ã¯ã€ä½¿ç”¨ã™ã‚‹ãƒ„ãƒ¼ãƒ«ã«å½±éŸ¿ã‚’ä¸ãˆã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚
    - **TensorFlowã‚’ä½¿ç”¨ã™ã‚‹ã€‚** ä¾‹ãˆã°ã€TensorFlowã‚’ä½¿ç”¨ã—ã¦ãƒ¢ãƒ‡ãƒ«ã‚’è¨“ç·´ã—ã¦ã„ã‚‹å ´åˆã€ãã®ã‚¨ã‚³ã‚·ã‚¹ãƒ†ãƒ ã¯[TensorFlow.js](https://www.tensorflow.org/js/)ã‚’ä½¿ç”¨ã—ã¦Webã‚¢ãƒ—ãƒªã§åˆ©ç”¨ã™ã‚‹ãŸã‚ã«TensorFlowãƒ¢ãƒ‡ãƒ«ã‚’å¤‰æ›ã™ã‚‹æ©Ÿèƒ½ã‚’æä¾›ã—ã¾ã™ã€‚
    - **PyTorchã‚’ä½¿ç”¨ã™ã‚‹ã€‚** [PyTorch](https://pytorch.org/)ã®ã‚ˆã†ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ç”¨ã—ã¦ãƒ¢ãƒ‡ãƒ«ã‚’æ§‹ç¯‰ã—ã¦ã„ã‚‹å ´åˆã€JavaScriptã®Webã‚¢ãƒ—ãƒªã§ä½¿ç”¨ã§ãã‚‹[ONNX](https://onnx.ai/)ï¼ˆOpen Neural Network Exchangeï¼‰å½¢å¼ã§ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã™ã‚‹ã‚ªãƒ—ã‚·ãƒ§ãƒ³ãŒã‚ã‚Šã¾ã™ã€‚ã“ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¯ã€Scikit-learnã§è¨“ç·´ã•ã‚ŒãŸãƒ¢ãƒ‡ãƒ«ã®å°†æ¥ã®ãƒ¬ãƒƒã‚¹ãƒ³ã§æ¢æ±‚ã•ã‚Œã¾ã™ã€‚
    - **Lobe.aiã¾ãŸã¯Azure Custom Visionã‚’ä½¿ç”¨ã™ã‚‹ã€‚** [Lobe.ai](https://lobe.ai/)ã‚„[Azure Custom Vision](https://azure.microsoft.com/services/cognitive-services/custom-vision-service/?WT.mc_id=academic-77952-leestott)ã®ã‚ˆã†ãªML SaaSï¼ˆSoftware as a Serviceï¼‰ã‚·ã‚¹ãƒ†ãƒ ã‚’ä½¿ç”¨ã—ã¦ãƒ¢ãƒ‡ãƒ«ã‚’è¨“ç·´ã—ã¦ã„ã‚‹å ´åˆã€ã“ã®ç¨®ã®ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã¯ã€ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‹ã‚‰ã‚¯ãƒ©ã‚¦ãƒ‰ã§ã‚¯ã‚¨ãƒªã•ã‚Œã‚‹ã‚«ã‚¹ã‚¿ãƒ APIã‚’æ§‹ç¯‰ã™ã‚‹ãªã©ã€å¤šãã®ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ å‘ã‘ã«ãƒ¢ãƒ‡ãƒ«ã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã™ã‚‹æ–¹æ³•ã‚’æä¾›ã—ã¾ã™ã€‚

ã¾ãŸã€ãƒ–ãƒ©ã‚¦ã‚¶ã§ãƒ¢ãƒ‡ãƒ«ã‚’è‡ªã‚‰è¨“ç·´ã§ãã‚‹å®Œå…¨ãªFlask Webã‚¢ãƒ—ãƒªã‚’æ§‹ç¯‰ã™ã‚‹æ©Ÿä¼šã‚‚ã‚ã‚Šã¾ã™ã€‚ã“ã‚Œã‚‚JavaScriptã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã§TensorFlow.jsã‚’ä½¿ç”¨ã—ã¦å®Ÿç¾ã§ãã¾ã™ã€‚

ç§ãŸã¡ã®ç›®çš„ã®ãŸã‚ã«ã€Pythonãƒ™ãƒ¼ã‚¹ã®ãƒãƒ¼ãƒˆãƒ–ãƒƒã‚¯ã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹ã®ã§ã€ãã®ã‚ˆã†ãªãƒãƒ¼ãƒˆãƒ–ãƒƒã‚¯ã‹ã‚‰è¨“ç·´ã•ã‚ŒãŸãƒ¢ãƒ‡ãƒ«ã‚’Pythonã§æ§‹ç¯‰ã•ã‚ŒãŸWebã‚¢ãƒ—ãƒªãŒèª­ã¿å–ã‚Œã‚‹å½¢å¼ã«ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã™ã‚‹æ‰‹é †ã‚’æ¢ã£ã¦ã¿ã¾ã—ã‚‡ã†ã€‚

## ãƒ„ãƒ¼ãƒ«

ã“ã®ã‚¿ã‚¹ã‚¯ã«ã¯2ã¤ã®ãƒ„ãƒ¼ãƒ«ãŒå¿…è¦ã§ã™ï¼šFlaskã¨Pickleã€ã©ã¡ã‚‰ã‚‚Pythonã§å‹•ä½œã—ã¾ã™ã€‚

âœ… [Flask](https://palletsprojects.com/p/flask/)ã¨ã¯ä½•ã§ã™ã‹ï¼Ÿ Flaskã¯ãã®ä½œæˆè€…ã«ã‚ˆã£ã¦ã€Œãƒã‚¤ã‚¯ãƒ­ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã€ã¨å®šç¾©ã•ã‚Œã¦ãŠã‚Šã€Pythonã‚’ä½¿ç”¨ã—ã¦Webãƒšãƒ¼ã‚¸ã‚’æ§‹ç¯‰ã™ã‚‹ãŸã‚ã®åŸºæœ¬æ©Ÿèƒ½ã‚’æä¾›ã—ã¾ã™ã€‚Flaskã§ã®æ§‹ç¯‰ã‚’ç·´ç¿’ã™ã‚‹ãŸã‚ã«ã€[ã“ã®Learnãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«](https://docs.microsoft.com/learn/modules/python-flask-build-ai-web-app?WT.mc_id=academic-77952-leestott)ã‚’è¦‹ã¦ã¿ã¦ãã ã•ã„ã€‚

âœ… [Pickle](https://docs.python.org/3/library/pickle.html)ã¨ã¯ä½•ã§ã™ã‹ï¼Ÿ Pickle ğŸ¥’ã¯Pythonã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæ§‹é€ ã‚’ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚ºãŠã‚ˆã³ãƒ‡ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚ºã™ã‚‹Pythonãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã§ã™ã€‚ãƒ¢ãƒ‡ãƒ«ã‚’ã€Œãƒ”ã‚¯ãƒ«ã€ã™ã‚‹ã¨ã€Webã§ä½¿ç”¨ã™ã‚‹ãŸã‚ã«ãã®æ§‹é€ ã‚’ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚ºã¾ãŸã¯ãƒ•ãƒ©ãƒƒãƒˆåŒ–ã—ã¾ã™ã€‚æ³¨æ„ã—ã¦ãã ã•ã„ï¼špickleã¯æœ¬è³ªçš„ã«å®‰å…¨ã§ã¯ãªã„ãŸã‚ã€ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã€Œã‚¢ãƒ³ãƒ”ã‚¯ãƒ«ã€ã™ã‚‹ã‚ˆã†ã«æ±‚ã‚ã‚‰ã‚ŒãŸå ´åˆã¯æ³¨æ„ã—ã¦ãã ã•ã„ã€‚ãƒ”ã‚¯ãƒ«ã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã«ã¯æ¥å°¾è¾`.pkl`ãŒã‚ã‚Šã¾ã™ã€‚

## æ¼”ç¿’ - ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ã™ã‚‹

ã“ã®ãƒ¬ãƒƒã‚¹ãƒ³ã§ã¯ã€[NUFORC](https://nuforc.org)ï¼ˆå…¨ç±³UFOå ±å‘Šã‚»ãƒ³ã‚¿ãƒ¼ï¼‰ãŒåé›†ã—ãŸ80,000ä»¶ã®UFOç›®æ’ƒãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚ã“ã®ãƒ‡ãƒ¼ã‚¿ã«ã¯ã€UFOç›®æ’ƒã®èˆˆå‘³æ·±ã„èª¬æ˜ãŒå«ã¾ã‚Œã¦ã„ã¾ã™ã€‚ä¾‹ãˆã°ï¼š

- **é•·ã„ä¾‹ã®èª¬æ˜ã€‚** ã€Œå…‰ã®ãƒ“ãƒ¼ãƒ ã‹ã‚‰ç”·ãŒç¾ã‚Œã€å¤œã®è‰åŸã«ç…§ã‚‰ã•ã‚Œã€ãƒ†ã‚­ã‚µã‚¹ãƒ»ã‚¤ãƒ³ã‚¹ãƒ„ãƒ«ãƒ¡ãƒ³ãƒ„ã®é§è»Šå ´ã«å‘ã‹ã£ã¦èµ°ã‚‹ã€ã€‚
- **çŸ­ã„ä¾‹ã®èª¬æ˜ã€‚** ã€Œå…‰ãŒç§ãŸã¡ã‚’è¿½ã„ã‹ã‘ã¦ããŸã€ã€‚

[ufos.csv](../../../../3-Web-App/1-Web-App/data/ufos.csv)ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã«ã¯ã€ç›®æ’ƒãŒç™ºç”Ÿã—ãŸ`city`ã€`state`ã€`country`ã«é–¢ã™ã‚‹åˆ—ã€ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®`shape`ã€ãŠã‚ˆã³ãã®`latitude`ã¨`longitude`ãŒå«ã¾ã‚Œã¦ã„ã¾ã™ã€‚

ã“ã®ãƒ¬ãƒƒã‚¹ãƒ³ã«å«ã¾ã‚Œã‚‹ç©ºã®[ãƒãƒ¼ãƒˆãƒ–ãƒƒã‚¯](../../../../3-Web-App/1-Web-App/notebook.ipynb)ã§ï¼š

1. å‰ã®ãƒ¬ãƒƒã‚¹ãƒ³ã§è¡Œã£ãŸã‚ˆã†ã«`pandas`ã€`matplotlib`ã€`numpy`ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã€ufosã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã¾ã™ã€‚ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’ç¢ºèªã§ãã¾ã™ï¼š

    ```python
    import pandas as pd
    import numpy as np
    
    ufos = pd.read_csv('./data/ufos.csv')
    ufos.head()
    ```

1. ufosãƒ‡ãƒ¼ã‚¿ã‚’æ–°ã—ã„ã‚¿ã‚¤ãƒˆãƒ«ã®å°ã•ãªãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ã«å¤‰æ›ã—ã¾ã™ã€‚`Country`ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®ãƒ¦ãƒ‹ãƒ¼ã‚¯ãªå€¤ã‚’ç¢ºèªã—ã¾ã™ã€‚

    ```python
    ufos = pd.DataFrame({'Seconds': ufos['duration (seconds)'], 'Country': ufos['country'],'Latitude': ufos['latitude'],'Longitude': ufos['longitude']})
    
    ufos.Country.unique()
    ```

1. æ¬¡ã«ã€nullå€¤ã‚’å‰Šé™¤ã—ã€1ã€œ60ç§’ã®é–“ã®ç›®æ’ƒæƒ…å ±ã®ã¿ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã™ã‚‹ã“ã¨ã§ã€å‡¦ç†ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ã®é‡ã‚’æ¸›ã‚‰ã™ã“ã¨ãŒã§ãã¾ã™ï¼š

    ```python
    ufos.dropna(inplace=True)
    
    ufos = ufos[(ufos['Seconds'] >= 1) & (ufos['Seconds'] <= 60)]
    
    ufos.info()
    ```

1. Scikit-learnã®`LabelEncoder`ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã¦ã€å›½ã®ãƒ†ã‚­ã‚¹ãƒˆå€¤ã‚’æ•°å€¤ã«å¤‰æ›ã—ã¾ã™ï¼š

    âœ… LabelEncoderã¯ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¢ãƒ«ãƒ•ã‚¡ãƒ™ãƒƒãƒˆé †ã«ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã—ã¾ã™

    ```python
    from sklearn.preprocessing import LabelEncoder
    
    ufos['Country'] = LabelEncoder().fit_transform(ufos['Country'])
    
    ufos.head()
    ```

    ã‚ãªãŸã®ãƒ‡ãƒ¼ã‚¿ã¯æ¬¡ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ï¼š

    ```output
    	Seconds	Country	Latitude	Longitude
    2	20.0	3		53.200000	-2.916667
    3	20.0	4		28.978333	-96.645833
    14	30.0	4		35.823889	-80.253611
    23	60.0	4		45.582778	-122.352222
    24	3.0		3		51.783333	-0.783333
    ```

## æ¼”ç¿’ - ãƒ¢ãƒ‡ãƒ«ã‚’æ§‹ç¯‰ã™ã‚‹

ãƒ‡ãƒ¼ã‚¿ã‚’è¨“ç·´ã‚°ãƒ«ãƒ¼ãƒ—ã¨ãƒ†ã‚¹ãƒˆã‚°ãƒ«ãƒ¼ãƒ—ã«åˆ†å‰²ã—ã¦ã€ãƒ¢ãƒ‡ãƒ«ã‚’è¨“ç·´ã™ã‚‹æº–å‚™ãŒæ•´ã„ã¾ã—ãŸã€‚

1. è¨“ç·´ã«ä½¿ç”¨ã™ã‚‹3ã¤ã®ç‰¹å¾´ã‚’Xãƒ™ã‚¯ãƒˆãƒ«ã¨ã—ã¦é¸æŠã—ã€yãƒ™ã‚¯ãƒˆãƒ«ã¯`Country`. You want to be able to input `Seconds`, `Latitude` and `Longitude`ã§ã€å›½ã®IDã‚’è¿”ã—ã¾ã™ã€‚

    ```python
    from sklearn.model_selection import train_test_split
    
    Selected_features = ['Seconds','Latitude','Longitude']
    
    X = ufos[Selected_features]
    y = ufos['Country']
    
    X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=0)
    ```

1. ãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯å›å¸°ã‚’ä½¿ç”¨ã—ã¦ãƒ¢ãƒ‡ãƒ«ã‚’è¨“ç·´ã—ã¾ã™ï¼š

    ```python
    from sklearn.metrics import accuracy_score, classification_report
    from sklearn.linear_model import LogisticRegression
    model = LogisticRegression()
    model.fit(X_train, y_train)
    predictions = model.predict(X_test)
    
    print(classification_report(y_test, predictions))
    print('Predicted labels: ', predictions)
    print('Accuracy: ', accuracy_score(y_test, predictions))
    ```

ç²¾åº¦ã¯æ‚ªãã‚ã‚Šã¾ã›ã‚“ **ï¼ˆç´„95%ï¼‰**ã€äºˆæƒ³é€šã‚Šã€`Country` and `Latitude/Longitude` correlate.

The model you created isn't very revolutionary as you should be able to infer a `Country` from its `Latitude` and `Longitude`ã§ã™ãŒã€ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ã—ã€ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã—ãŸç”Ÿãƒ‡ãƒ¼ã‚¿ã‹ã‚‰è¨“ç·´ã—ã€ã“ã®ãƒ¢ãƒ‡ãƒ«ã‚’Webã‚¢ãƒ—ãƒªã§ä½¿ç”¨ã™ã‚‹ã“ã¨ã‚’è©¦ã¿ã‚‹ã®ã¯è‰¯ã„ç·´ç¿’ã§ã™ã€‚

## æ¼”ç¿’ - ãƒ¢ãƒ‡ãƒ«ã‚’ã€Œãƒ”ã‚¯ãƒ«ã€ã™ã‚‹

ã•ã¦ã€ãƒ¢ãƒ‡ãƒ«ã‚’_ãƒ”ã‚¯ãƒ«_ã™ã‚‹æ™‚ãŒæ¥ã¾ã—ãŸï¼ ã„ãã¤ã‹ã®è¡Œã®ã‚³ãƒ¼ãƒ‰ã§ãã‚Œã‚’è¡Œã†ã“ã¨ãŒã§ãã¾ã™ã€‚ä¸€åº¦_ãƒ”ã‚¯ãƒ«_ã—ãŸã‚‰ã€ãƒ”ã‚¯ãƒ«ã•ã‚ŒãŸãƒ¢ãƒ‡ãƒ«ã‚’èª­ã¿è¾¼ã¿ã€ç§’ã€ç·¯åº¦ã€çµŒåº¦ã®å€¤ã‚’å«ã‚€ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿é…åˆ—ã«å¯¾ã—ã¦ãƒ†ã‚¹ãƒˆã—ã¾ã™ã€‚

```python
import pickle
model_filename = 'ufo-model.pkl'
pickle.dump(model, open(model_filename,'wb'))

model = pickle.load(open('ufo-model.pkl','rb'))
print(model.predict([[50,44,-12]]))
```

ãƒ¢ãƒ‡ãƒ«ã¯**ã€Œ3ã€**ã‚’è¿”ã—ã¾ã™ã€‚ã“ã‚Œã¯ã€ã‚¤ã‚®ãƒªã‚¹ã®å›½ã‚³ãƒ¼ãƒ‰ã§ã™ã€‚ã™ã”ã„ï¼ ğŸ‘½

## æ¼”ç¿’ - Flaskã‚¢ãƒ—ãƒªã‚’æ§‹ç¯‰ã™ã‚‹

æ¬¡ã«ã€ãƒ¢ãƒ‡ãƒ«ã‚’å‘¼ã³å‡ºã—ã¦ä¼¼ãŸã‚ˆã†ãªçµæœã‚’è¿”ã™Flaskã‚¢ãƒ—ãƒªã‚’æ§‹ç¯‰ã§ãã¾ã™ãŒã€ã‚ˆã‚Šè¦–è¦šçš„ã«é­…åŠ›çš„ãªæ–¹æ³•ã§ã€‚

1. _ufo-model.pkl_ãƒ•ã‚¡ã‚¤ãƒ«ãŒå­˜åœ¨ã™ã‚‹_notebook.ipynb_ãƒ•ã‚¡ã‚¤ãƒ«ã®éš£ã«**web-app**ã¨ã„ã†åå‰ã®ãƒ•ã‚©ãƒ«ãƒ€ã‚’ä½œæˆã—ã¾ã™ã€‚

1. ãã®ãƒ•ã‚©ãƒ«ãƒ€å†…ã«ã€**static**ã¨ã„ã†ãƒ•ã‚©ãƒ«ãƒ€ã¨ãã®ä¸­ã«**css**ãƒ•ã‚©ãƒ«ãƒ€ã€ã•ã‚‰ã«**templates**ã¨ã„ã†ãƒ•ã‚©ãƒ«ãƒ€ã‚’ä½œæˆã—ã¾ã™ã€‚ã“ã‚Œã§ã€æ¬¡ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¨ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãŒæƒã£ã¦ã„ã‚‹ã¯ãšã§ã™ï¼š

    ```output
    web-app/
      static/
        css/
      templates/
    notebook.ipynb
    ufo-model.pkl
    ```

    âœ… å®Œæˆã—ãŸã‚¢ãƒ—ãƒªã®ãƒ“ãƒ¥ãƒ¼ã«ã¤ã„ã¦ã¯ã€ã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚©ãƒ«ãƒ€ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

1. _web-app_ãƒ•ã‚©ãƒ«ãƒ€ã§æœ€åˆã«ä½œæˆã™ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã¯**requirements.txt**ãƒ•ã‚¡ã‚¤ãƒ«ã§ã™ã€‚JavaScriptã‚¢ãƒ—ãƒªã®_package.json_ã®ã‚ˆã†ã«ã€ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã«ã¯ã‚¢ãƒ—ãƒªã«å¿…è¦ãªä¾å­˜é–¢ä¿‚ãŒãƒªã‚¹ãƒˆã•ã‚Œã¦ã„ã¾ã™ã€‚**requirements.txt**ã«æ¬¡ã®è¡Œã‚’è¿½åŠ ã—ã¾ã™ï¼š

    ```text
    scikit-learn
    pandas
    numpy
    flask
    ```

1. æ¬¡ã«ã€ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å®Ÿè¡Œã™ã‚‹ãŸã‚ã«_web-app_ã«ç§»å‹•ã—ã¾ã™ï¼š

    ```bash
    cd web-app
    ```

1. ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã«`pip install`ã¨å…¥åŠ›ã—ã€_requirements.txt_ã«ãƒªã‚¹ãƒˆã•ã‚ŒãŸãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ï¼š

    ```bash
    pip install -r requirements.txt
    ```

1. ã“ã‚Œã§ã€ã‚¢ãƒ—ãƒªã‚’å®Œæˆã•ã›ã‚‹ãŸã‚ã«ã•ã‚‰ã«3ã¤ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã™ã‚‹æº–å‚™ãŒæ•´ã„ã¾ã—ãŸï¼š

    1. ãƒ«ãƒ¼ãƒˆã«**app.py**ã‚’ä½œæˆã—ã¾ã™ã€‚
    2. _templates_ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«**index.html**ã‚’ä½œæˆã—ã¾ã™ã€‚
    3. _static/css_ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«**styles.css**ã‚’ä½œæˆã—ã¾ã™ã€‚

1. _styles.css_ãƒ•ã‚¡ã‚¤ãƒ«ã«ã„ãã¤ã‹ã®ã‚¹ã‚¿ã‚¤ãƒ«ã‚’è¿½åŠ ã—ã¾ã™ï¼š

    ```css
    body {
    	width: 100%;
    	height: 100%;
    	font-family: 'Helvetica';
    	background: black;
    	color: #fff;
    	text-align: center;
    	letter-spacing: 1.4px;
    	font-size: 30px;
    }
    
    input {
    	min-width: 150px;
    }
    
    .grid {
    	width: 300px;
    	border: 1px solid #2d2d2d;
    	display: grid;
    	justify-content: center;
    	margin: 20px auto;
    }
    
    .box {
    	color: #fff;
    	background: #2d2d2d;
    	padding: 12px;
    	display: inline-block;
    }
    ```

1. æ¬¡ã«ã€_index.html_ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ§‹ç¯‰ã—ã¾ã™ï¼š

    ```html
    <!DOCTYPE html>
    <html>
      <head>
        <meta charset="UTF-8">
        <title>ğŸ›¸ UFO Appearance Prediction! ğŸ‘½</title>
        <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
      </head>
    
      <body>
        <div class="grid">
    
          <div class="box">
    
            <p>According to the number of seconds, latitude and longitude, which country is likely to have reported seeing a UFO?</p>
    
            <form action="{{ url_for('predict')}}" method="post">
              <input type="number" name="seconds" placeholder="Seconds" required="required" min="0" max="60" />
              <input type="text" name="latitude" placeholder="Latitude" required="required" />
              <input type="text" name="longitude" placeholder="Longitude" required="required" />
              <button type="submit" class="btn">Predict country where the UFO is seen</button>
            </form>
    
            <p>{{ prediction_text }}</p>
    
          </div>
    
        </div>
    
      </body>
    </html>
    ```

    ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã«ç›®ã‚’é€šã—ã¦ãã ã•ã„ã€‚ã‚¢ãƒ—ãƒªã«ã‚ˆã£ã¦æä¾›ã•ã‚Œã‚‹å¤‰æ•°ã®å‘¨ã‚Šã®ã€Œãƒã‚¹ã‚¿ãƒƒã‚·ãƒ¥ã€æ§‹æ–‡ã€ä¾‹ãˆã°äºˆæ¸¬ãƒ†ã‚­ã‚¹ãƒˆï¼š`{{}}`. There's also a form that posts a prediction to the `/predict` route.

    Finally, you're ready to build the python file that drives the consumption of the model and the display of predictions:

1. In `app.py`ã‚’è¿½åŠ ã—ã¾ã™ï¼š

    ```python
    import numpy as np
    from flask import Flask, request, render_template
    import pickle
    
    app = Flask(__name__)
    
    model = pickle.load(open("./ufo-model.pkl", "rb"))
    
    
    @app.route("/")
    def home():
        return render_template("index.html")
    
    
    @app.route("/predict", methods=["POST"])
    def predict():
    
        int_features = [int(x) for x in request.form.values()]
        final_features = [np.array(int_features)]
        prediction = model.predict(final_features)
    
        output = prediction[0]
    
        countries = ["Australia", "Canada", "Germany", "UK", "US"]
    
        return render_template(
            "index.html", prediction_text="Likely country: {}".format(countries[output])
        )
    
    
    if __name__ == "__main__":
        app.run(debug=True)
    ```

    > ğŸ’¡ ãƒ’ãƒ³ãƒˆï¼š[`debug=True`](https://www.askpython.com/python-modules/flask/flask-debug-mode) while running the web app using Flask, any changes you make to your application will be reflected immediately without the need to restart the server. Beware! Don't enable this mode in a production app.

If you run `python app.py` or `python3 app.py` - your web server starts up, locally, and you can fill out a short form to get an answer to your burning question about where UFOs have been sighted!

Before doing that, take a look at the parts of `app.py`:

1. First, dependencies are loaded and the app starts.
1. Then, the model is imported.
1. Then, index.html is rendered on the home route.

On the `/predict` route, several things happen when the form is posted:

1. The form variables are gathered and converted to a numpy array. They are then sent to the model and a prediction is returned.
2. The Countries that we want displayed are re-rendered as readable text from their predicted country code, and that value is sent back to index.html to be rendered in the template.

Using a model this way, with Flask and a pickled model, is relatively straightforward. The hardest thing is to understand what shape the data is that must be sent to the model to get a prediction. That all depends on how the model was trained. This one has three data points to be input in order to get a prediction.

In a professional setting, you can see how good communication is necessary between the folks who train the model and those who consume it in a web or mobile app. In our case, it's only one person, you!

---

## ğŸš€ Challenge

Instead of working in a notebook and importing the model to the Flask app, you could train the model right within the Flask app! Try converting your Python code in the notebook, perhaps after your data is cleaned, to train the model from within the app on a route called `train`ã‚’è¿½åŠ ã—ãŸã¨ãã«ã€ã‚¢ãƒ—ãƒªã®ã‚¨ãƒ©ãƒ¼ã‚’ç‰¹å®šã™ã‚‹ã®ãŒç°¡å˜ã«ãªã‚Šã¾ã™ã€‚ã“ã®æ–¹æ³•ã®åˆ©ç‚¹ã¨æ¬ ç‚¹ã¯ä½•ã§ã™ã‹ï¼Ÿ

## [è¬›ç¾©å¾Œã‚¯ã‚¤ã‚º](https://gray-sand-07a10f403.1.azurestaticapps.net/quiz/18/)

## ã¾ã¨ã‚ã¨è‡ªå·±å­¦ç¿’

MLãƒ¢ãƒ‡ãƒ«ã‚’æ¶ˆè²»ã™ã‚‹ãŸã‚ã®Webã‚¢ãƒ—ãƒªã‚’æ§‹ç¯‰ã™ã‚‹æ–¹æ³•ã¯ã„ãã¤ã‹ã‚ã‚Šã¾ã™ã€‚JavaScriptã¾ãŸã¯Pythonã‚’ä½¿ç”¨ã—ã¦æ©Ÿæ¢°å­¦ç¿’ã‚’æ´»ç”¨ã™ã‚‹Webã‚¢ãƒ—ãƒªã‚’æ§‹ç¯‰ã™ã‚‹æ–¹æ³•ã®ãƒªã‚¹ãƒˆã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã‚’è€ƒæ…®ã—ã¦ãã ã•ã„ï¼šãƒ¢ãƒ‡ãƒ«ã¯ã‚¢ãƒ—ãƒªå†…ã«ç•™ã¾ã‚‹ã¹ãã‹ã€ãã‚Œã¨ã‚‚ã‚¯ãƒ©ã‚¦ãƒ‰ã«å­˜åœ¨ã™ã‚‹ã¹ãã‹ï¼Ÿ å¾Œè€…ã®å ´åˆã€ã©ã®ã‚ˆã†ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¾ã™ã‹ï¼Ÿ å®Ÿç”¨çš„ãªML Webã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã®ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ãƒ¢ãƒ‡ãƒ«ã‚’æã„ã¦ã¿ã¦ãã ã•ã„ã€‚

## èª²é¡Œ

[åˆ¥ã®ãƒ¢ãƒ‡ãƒ«ã‚’è©¦ã™](assignment.md)

**å…è²¬äº‹é …**:  
ã“ã®æ–‡æ›¸ã¯ã€æ©Ÿæ¢°ãƒ™ãƒ¼ã‚¹ã®AIç¿»è¨³ã‚µãƒ¼ãƒ“ã‚¹ã‚’ä½¿ç”¨ã—ã¦ç¿»è¨³ã•ã‚Œã¦ã„ã¾ã™ã€‚æ­£ç¢ºæ€§ã‚’è¿½æ±‚ã—ã¦ã„ã¾ã™ãŒã€è‡ªå‹•ç¿»è¨³ã«ã¯èª¤ã‚Šã‚„ä¸æ­£ç¢ºã•ãŒå«ã¾ã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ã“ã¨ã‚’ã”ç†è§£ãã ã•ã„ã€‚å…ƒã®æ–‡æ›¸ã¯ã€ãã®åŸèªã§ã®æ¨©å¨ã‚ã‚‹æƒ…å ±æºã¨è¦‹ãªã•ã‚Œã‚‹ã¹ãã§ã™ã€‚é‡è¦ãªæƒ…å ±ã«ã¤ã„ã¦ã¯ã€å°‚é–€ã®äººé–“ç¿»è¨³ã‚’æ¨å¥¨ã—ã¾ã™ã€‚ã“ã®ç¿»è¨³ã®ä½¿ç”¨ã‹ã‚‰ç”Ÿã˜ã‚‹èª¤è§£ã‚„èª¤è¨³ã«ã¤ã„ã¦ã€å½“ç¤¾ã¯ä¸€åˆ‡ã®è²¬ä»»ã‚’è² ã„ã¾ã›ã‚“ã€‚