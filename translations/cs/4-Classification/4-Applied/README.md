<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "61bdec27ed2da8b098cd9065405d9bb0",
  "translation_date": "2025-09-05T00:46:49+00:00",
  "source_file": "4-Classification/4-Applied/README.md",
  "language_code": "cs"
}
-->
# Vytvo≈ôte webovou aplikaci pro doporuƒçov√°n√≠ kuchyn√≠

V t√©to lekci vytvo≈ô√≠te klasifikaƒçn√≠ model pomoc√≠ nƒõkter√Ωch technik, kter√© jste se nauƒçili v p≈ôedchoz√≠ch lekc√≠ch, a s vyu≈æit√≠m datasetu lahodn√Ωch kuchyn√≠, kter√Ω byl pou≈æit v cel√©m tomto seri√°lu. Nav√≠c vytvo≈ô√≠te malou webovou aplikaci, kter√° bude pou≈æ√≠vat ulo≈æen√Ω model, vyu≈æ√≠vaj√≠c√≠ webov√Ω runtime Onnx.

Jedn√≠m z nejpraktiƒçtƒõj≈°√≠ch vyu≈æit√≠ strojov√©ho uƒçen√≠ je vytv√°≈ôen√≠ doporuƒçovac√≠ch syst√©m≈Ø, a dnes m≈Ø≈æete udƒõlat prvn√≠ krok t√≠mto smƒõrem!

[![Prezentace t√©to webov√© aplikace](https://img.youtube.com/vi/17wdM9AHMfg/0.jpg)](https://youtu.be/17wdM9AHMfg "Applied ML")

> üé• Kliknƒõte na obr√°zek v√Ω≈°e pro video: Jen Looper vytv√°≈ô√≠ webovou aplikaci s klasifikovan√Ωmi daty o kuchyn√≠ch

## [Kv√≠z p≈ôed lekc√≠](https://ff-quizzes.netlify.app/en/ml/)

V t√©to lekci se nauƒç√≠te:

- Jak vytvo≈ôit model a ulo≈æit ho jako Onnx model
- Jak pou≈æ√≠t Netron k inspekci modelu
- Jak pou≈æ√≠t v√°≈° model ve webov√© aplikaci pro inference

## Vytvo≈ôte sv≈Øj model

Vytv√°≈ôen√≠ aplikovan√Ωch syst√©m≈Ø strojov√©ho uƒçen√≠ je d≈Øle≈æitou souƒç√°st√≠ vyu≈æ√≠v√°n√≠ tƒõchto technologi√≠ pro va≈°e obchodn√≠ syst√©my. Modely m≈Ø≈æete pou≈æ√≠t ve sv√Ωch webov√Ωch aplikac√≠ch (a t√≠m je pou≈æ√≠t v offline re≈æimu, pokud je to pot≈ôeba) pomoc√≠ Onnx.

V [p≈ôedchoz√≠ lekci](../../3-Web-App/1-Web-App/README.md) jste vytvo≈ôili regresn√≠ model o pozorov√°n√≠ UFO, "picklovali" ho a pou≈æili ho v aplikaci Flask. Zat√≠mco tato architektura je velmi u≈æiteƒçn√°, jedn√° se o full-stack Python aplikaci, a va≈°e po≈æadavky mohou zahrnovat pou≈æit√≠ JavaScriptov√© aplikace.

V t√©to lekci m≈Ø≈æete vytvo≈ôit z√°kladn√≠ syst√©m zalo≈æen√Ω na JavaScriptu pro inference. Nejprve v≈°ak mus√≠te natr√©novat model a p≈ôev√©st ho pro pou≈æit√≠ s Onnx.

## Cviƒçen√≠ - natr√©nujte klasifikaƒçn√≠ model

Nejprve natr√©nujte klasifikaƒçn√≠ model pomoc√≠ vyƒçi≈°tƒõn√©ho datasetu kuchyn√≠, kter√Ω jsme pou≈æili.

1. Zaƒçnƒõte importem u≈æiteƒçn√Ωch knihoven:

    ```python
    !pip install skl2onnx
    import pandas as pd 
    ```

    Pot≈ôebujete '[skl2onnx](https://onnx.ai/sklearn-onnx/)', aby v√°m pomohl p≈ôev√©st v√°≈° Scikit-learn model do form√°tu Onnx.

1. Pot√© pracujte s daty stejn√Ωm zp≈Øsobem jako v p≈ôedchoz√≠ch lekc√≠ch, naƒçten√≠m CSV souboru pomoc√≠ `read_csv()`:

    ```python
    data = pd.read_csv('../data/cleaned_cuisines.csv')
    data.head()
    ```

1. Odstra≈àte prvn√≠ dva nepot≈ôebn√© sloupce a ulo≈æte zb√Ωvaj√≠c√≠ data jako 'X':

    ```python
    X = data.iloc[:,2:]
    X.head()
    ```

1. Ulo≈æte ≈°t√≠tky jako 'y':

    ```python
    y = data[['cuisine']]
    y.head()
    
    ```

### Zahajte tr√©ninkovou rutinu

Pou≈æijeme knihovnu 'SVC', kter√° m√° dobrou p≈ôesnost.

1. Importujte p≈ô√≠slu≈°n√© knihovny ze Scikit-learn:

    ```python
    from sklearn.model_selection import train_test_split
    from sklearn.svm import SVC
    from sklearn.model_selection import cross_val_score
    from sklearn.metrics import accuracy_score,precision_score,confusion_matrix,classification_report
    ```

1. Oddƒõlte tr√©novac√≠ a testovac√≠ sady:

    ```python
    X_train, X_test, y_train, y_test = train_test_split(X,y,test_size=0.3)
    ```

1. Vytvo≈ôte klasifikaƒçn√≠ model SVC, jak jste to udƒõlali v p≈ôedchoz√≠ lekci:

    ```python
    model = SVC(kernel='linear', C=10, probability=True,random_state=0)
    model.fit(X_train,y_train.values.ravel())
    ```

1. Nyn√≠ otestujte sv≈Øj model, zavolejte `predict()`:

    ```python
    y_pred = model.predict(X_test)
    ```

1. Vytisknƒõte klasifikaƒçn√≠ zpr√°vu, abyste zkontrolovali kvalitu modelu:

    ```python
    print(classification_report(y_test,y_pred))
    ```

    Jak jsme vidƒõli d≈ô√≠ve, p≈ôesnost je dobr√°:

    ```output
                    precision    recall  f1-score   support
    
         chinese       0.72      0.69      0.70       257
          indian       0.91      0.87      0.89       243
        japanese       0.79      0.77      0.78       239
          korean       0.83      0.79      0.81       236
            thai       0.72      0.84      0.78       224
    
        accuracy                           0.79      1199
       macro avg       0.79      0.79      0.79      1199
    weighted avg       0.79      0.79      0.79      1199
    ```

### P≈ôevod modelu na Onnx

Ujistƒõte se, ≈æe p≈ôevod prov√°d√≠te s odpov√≠daj√≠c√≠m poƒçtem tensor≈Ø. Tento dataset m√° 380 uveden√Ωch ingredienc√≠, tak≈æe mus√≠te tento poƒçet uv√©st v `FloatTensorType`:

1. Proveƒète p≈ôevod s tensorov√Ωm ƒç√≠slem 380.

    ```python
    from skl2onnx import convert_sklearn
    from skl2onnx.common.data_types import FloatTensorType
    
    initial_type = [('float_input', FloatTensorType([None, 380]))]
    options = {id(model): {'nocl': True, 'zipmap': False}}
    ```

1. Vytvo≈ôte onx a ulo≈æte jako soubor **model.onnx**:

    ```python
    onx = convert_sklearn(model, initial_types=initial_type, options=options)
    with open("./model.onnx", "wb") as f:
        f.write(onx.SerializeToString())
    ```

    > Pozn√°mka: M≈Ø≈æete p≈ôedat [mo≈ænosti](https://onnx.ai/sklearn-onnx/parameterized.html) ve va≈°em skriptu pro p≈ôevod. V tomto p≈ô√≠padƒõ jsme nastavili 'nocl' na True a 'zipmap' na False. Proto≈æe se jedn√° o klasifikaƒçn√≠ model, m√°te mo≈ænost odstranit ZipMap, kter√Ω produkuje seznam slovn√≠k≈Ø (nen√≠ nutn√©). `nocl` se t√Ωk√° informac√≠ o t≈ô√≠d√°ch zahrnut√Ωch v modelu. Zmen≈°ete velikost sv√©ho modelu nastaven√≠m `nocl` na 'True'.

Spu≈°tƒõn√≠m cel√©ho notebooku nyn√≠ vytvo≈ô√≠te Onnx model a ulo≈æ√≠te ho do t√©to slo≈æky.

## Zobrazte sv≈Øj model

Onnx modely nejsou p≈ô√≠li≈° viditeln√© ve Visual Studio Code, ale existuje velmi dobr√Ω bezplatn√Ω software, kter√Ω mnoho v√Ωzkumn√≠k≈Ø pou≈æ√≠v√° k vizualizaci modelu, aby se ujistili, ≈æe je spr√°vnƒõ vytvo≈ôen. St√°hnƒõte si [Netron](https://github.com/lutzroeder/Netron) a otev≈ôete sv≈Øj soubor model.onnx. M≈Ø≈æete vidƒõt sv≈Øj jednoduch√Ω model vizualizovan√Ω, s jeho 380 vstupy a klasifik√°torem uveden√Ωm:

![Netron vizualizace](../../../../4-Classification/4-Applied/images/netron.png)

Netron je u≈æiteƒçn√Ω n√°stroj pro zobrazen√≠ va≈°ich model≈Ø.

Nyn√≠ jste p≈ôipraveni pou≈æ√≠t tento ≈°ikovn√Ω model ve webov√© aplikaci. Vytvo≈ôme aplikaci, kter√° se bude hodit, kdy≈æ se pod√≠v√°te do sv√© lednice a sna≈æ√≠te se zjistit, jakou kombinaci zbyl√Ωch ingredienc√≠ m≈Ø≈æete pou≈æ√≠t k p≈ô√≠pravƒõ dan√© kuchynƒõ, jak urƒç√≠ v√°≈° model.

## Vytvo≈ôte webovou aplikaci pro doporuƒçov√°n√≠

Sv≈Øj model m≈Ø≈æete pou≈æ√≠t p≈ô√≠mo ve webov√© aplikaci. Tato architektura tak√© umo≈æ≈àuje jej√≠ lok√°ln√≠ provoz a dokonce i offline, pokud je to pot≈ôeba. Zaƒçnƒõte vytvo≈ôen√≠m souboru `index.html` ve stejn√© slo≈æce, kde jste ulo≈æili sv≈Øj soubor `model.onnx`.

1. V tomto souboru _index.html_ p≈ôidejte n√°sleduj√≠c√≠ znaƒçky:

    ```html
    <!DOCTYPE html>
    <html>
        <header>
            <title>Cuisine Matcher</title>
        </header>
        <body>
            ...
        </body>
    </html>
    ```

1. Nyn√≠, v r√°mci znaƒçek `body`, p≈ôidejte trochu znaƒçek pro zobrazen√≠ seznamu za≈°krt√°vac√≠ch pol√≠ƒçek odr√°≈æej√≠c√≠ch nƒõkter√© ingredience:

    ```html
    <h1>Check your refrigerator. What can you create?</h1>
            <div id="wrapper">
                <div class="boxCont">
                    <input type="checkbox" value="4" class="checkbox">
                    <label>apple</label>
                </div>
            
                <div class="boxCont">
                    <input type="checkbox" value="247" class="checkbox">
                    <label>pear</label>
                </div>
            
                <div class="boxCont">
                    <input type="checkbox" value="77" class="checkbox">
                    <label>cherry</label>
                </div>
    
                <div class="boxCont">
                    <input type="checkbox" value="126" class="checkbox">
                    <label>fenugreek</label>
                </div>
    
                <div class="boxCont">
                    <input type="checkbox" value="302" class="checkbox">
                    <label>sake</label>
                </div>
    
                <div class="boxCont">
                    <input type="checkbox" value="327" class="checkbox">
                    <label>soy sauce</label>
                </div>
    
                <div class="boxCont">
                    <input type="checkbox" value="112" class="checkbox">
                    <label>cumin</label>
                </div>
            </div>
            <div style="padding-top:10px">
                <button onClick="startInference()">What kind of cuisine can you make?</button>
            </div> 
    ```

    V≈°imnƒõte si, ≈æe ka≈æd√© za≈°krt√°vac√≠ pol√≠ƒçko m√° hodnotu. To odr√°≈æ√≠ index, kde se ingredience nach√°z√≠ podle datasetu. Jablko, nap≈ô√≠klad, v tomto abecedn√≠m seznamu, zab√≠r√° p√°t√Ω sloupec, tak≈æe jeho hodnota je '4', proto≈æe zaƒç√≠n√°me poƒç√≠tat od 0. M≈Ø≈æete se pod√≠vat na [tabulku ingredienc√≠](../../../../4-Classification/data/ingredient_indexes.csv), abyste zjistili index dan√© ingredience.

    Pokraƒçujte v pr√°ci v souboru index.html, p≈ôidejte blok skriptu, kde je model vol√°n po z√°vƒõreƒçn√©m uzav√≠rac√≠m `</div>`.

1. Nejprve importujte [Onnx Runtime](https://www.onnxruntime.ai/):

    ```html
    <script src="https://cdn.jsdelivr.net/npm/onnxruntime-web@1.9.0/dist/ort.min.js"></script> 
    ```

    > Onnx Runtime se pou≈æ√≠v√° k umo≈ænƒõn√≠ spu≈°tƒõn√≠ va≈°ich Onnx model≈Ø na ≈°irok√© ≈°k√°le hardwarov√Ωch platforem, vƒçetnƒõ optimalizac√≠ a API pro pou≈æit√≠.

1. Jakmile je Runtime na m√≠stƒõ, m≈Ø≈æete ho zavolat:

    ```html
    <script>
        const ingredients = Array(380).fill(0);
        
        const checks = [...document.querySelectorAll('.checkbox')];
        
        checks.forEach(check => {
            check.addEventListener('change', function() {
                // toggle the state of the ingredient
                // based on the checkbox's value (1 or 0)
                ingredients[check.value] = check.checked ? 1 : 0;
            });
        });

        function testCheckboxes() {
            // validate if at least one checkbox is checked
            return checks.some(check => check.checked);
        }

        async function startInference() {

            let atLeastOneChecked = testCheckboxes()

            if (!atLeastOneChecked) {
                alert('Please select at least one ingredient.');
                return;
            }
            try {
                // create a new session and load the model.
                
                const session = await ort.InferenceSession.create('./model.onnx');

                const input = new ort.Tensor(new Float32Array(ingredients), [1, 380]);
                const feeds = { float_input: input };

                // feed inputs and run
                const results = await session.run(feeds);

                // read from results
                alert('You can enjoy ' + results.label.data[0] + ' cuisine today!')

            } catch (e) {
                console.log(`failed to inference ONNX model`);
                console.error(e);
            }
        }
               
    </script>
    ```

V tomto k√≥du se dƒõje nƒõkolik vƒõc√≠:

1. Vytvo≈ôili jste pole 380 mo≈æn√Ωch hodnot (1 nebo 0), kter√© budou nastaveny a odesl√°ny modelu pro inference, v z√°vislosti na tom, zda je za≈°krt√°vac√≠ pol√≠ƒçko za≈°krtnuto.
2. Vytvo≈ôili jste pole za≈°krt√°vac√≠ch pol√≠ƒçek a zp≈Øsob, jak zjistit, zda byla za≈°krtnuta, ve funkci `init`, kter√° je vol√°na p≈ôi spu≈°tƒõn√≠ aplikace. Kdy≈æ je za≈°krt√°vac√≠ pol√≠ƒçko za≈°krtnuto, pole `ingredients` se zmƒõn√≠ tak, aby odr√°≈æelo vybranou ingredienci.
3. Vytvo≈ôili jste funkci `testCheckboxes`, kter√° kontroluje, zda bylo za≈°krtnuto nƒõjak√© za≈°krt√°vac√≠ pol√≠ƒçko.
4. Pou≈æ√≠v√°te funkci `startInference`, kdy≈æ je stisknuto tlaƒç√≠tko, a pokud je za≈°krtnuto nƒõjak√© za≈°krt√°vac√≠ pol√≠ƒçko, zah√°j√≠te inference.
5. Rutina inference zahrnuje:
   1. Nastaven√≠ asynchronn√≠ho naƒç√≠t√°n√≠ modelu
   2. Vytvo≈ôen√≠ struktury Tensor pro odesl√°n√≠ modelu
   3. Vytvo≈ôen√≠ 'feeds', kter√© odr√°≈æ√≠ vstup `float_input`, kter√Ω jste vytvo≈ôili p≈ôi tr√©nov√°n√≠ modelu (m≈Ø≈æete pou≈æ√≠t Netron k ovƒõ≈ôen√≠ tohoto n√°zvu)
   4. Odesl√°n√≠ tƒõchto 'feeds' modelu a ƒçek√°n√≠ na odpovƒõƒè

## Otestujte svou aplikaci

Otev≈ôete termin√°lovou relaci ve Visual Studio Code ve slo≈æce, kde se nach√°z√≠ v√°≈° soubor index.html. Ujistƒõte se, ≈æe m√°te [http-server](https://www.npmjs.com/package/http-server) nainstalovan√Ω glob√°lnƒõ, a napi≈°te `http-server` na v√Ωzvu. Mƒõl by se otev≈ô√≠t localhost a m≈Ø≈æete si prohl√©dnout svou webovou aplikaci. Zkontrolujte, jak√° kuchynƒõ je doporuƒçena na z√°kladƒõ r≈Øzn√Ωch ingredienc√≠:

![webov√° aplikace s ingrediencemi](../../../../4-Classification/4-Applied/images/web-app.png)

Gratulujeme, vytvo≈ôili jste webovou aplikaci pro 'doporuƒçov√°n√≠' s nƒõkolika poli. Vƒõnujte nƒõjak√Ω ƒças roz≈°√≠≈ôen√≠ tohoto syst√©mu!

## üöÄV√Ωzva

Va≈°e webov√° aplikace je velmi jednoduch√°, tak≈æe ji pokraƒçujte roz≈°i≈ôovat pomoc√≠ ingredienc√≠ a jejich index≈Ø z dat [ingredient_indexes](../../../../4-Classification/data/ingredient_indexes.csv). Jak√© kombinace chut√≠ funguj√≠ pro vytvo≈ôen√≠ dan√©ho n√°rodn√≠ho j√≠dla?

## [Kv√≠z po lekci](https://ff-quizzes.netlify.app/en/ml/)

## P≈ôehled & Samostudium

Zat√≠mco tato lekce se jen dotkla u≈æiteƒçnosti vytv√°≈ôen√≠ doporuƒçovac√≠ho syst√©mu pro ingredience, tato oblast aplikac√≠ strojov√©ho uƒçen√≠ je velmi bohat√° na p≈ô√≠klady. P≈ôeƒçtƒõte si v√≠ce o tom, jak jsou tyto syst√©my vytv√°≈ôeny:

- https://www.sciencedirect.com/topics/computer-science/recommendation-engine
- https://www.technologyreview.com/2014/08/25/171547/the-ultimate-challenge-for-recommendation-engines/
- https://www.technologyreview.com/2015/03/23/168831/everything-is-a-recommendation/

## √ökol 

[Vytvo≈ôte nov√Ω doporuƒçovac√≠ syst√©m](assignment.md)

---

**Prohl√°≈°en√≠**:  
Tento dokument byl p≈ôelo≈æen pomoc√≠ slu≈æby pro automatick√Ω p≈ôeklad [Co-op Translator](https://github.com/Azure/co-op-translator). I kdy≈æ se sna≈æ√≠me o p≈ôesnost, mƒõjte pros√≠m na pamƒõti, ≈æe automatick√© p≈ôeklady mohou obsahovat chyby nebo nep≈ôesnosti. P≈Øvodn√≠ dokument v jeho p≈Øvodn√≠m jazyce by mƒõl b√Ωt pova≈æov√°n za autoritativn√≠ zdroj. Pro d≈Øle≈æit√© informace se doporuƒçuje profesion√°ln√≠ lidsk√Ω p≈ôeklad. Neodpov√≠d√°me za ≈æ√°dn√© nedorozumƒõn√≠ nebo nespr√°vn√© interpretace vypl√Ωvaj√≠c√≠ z pou≈æit√≠ tohoto p≈ôekladu.