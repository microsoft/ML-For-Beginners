# ä½¿ç”¨ Scikit-learn æ„å»ºå›å½’æ¨¡å‹ï¼šä¸¤ç§æ–¹å¼çš„å›å½’

![çº¿æ€§ä¸å¤šé¡¹å¼å›å½’ä¿¡æ¯å›¾](../images/linear-polynomial.png)
> ä½œè€… [Dasani Madipalli](https://twitter.com/dasani_decoded)

## [è¯¾å‰æµ‹](https://white-water-09ec41f0f.azurestaticapps.net/quiz/13/)

### ä»‹ç»

åˆ°ç›®å‰ä¸ºæ­¢ï¼Œä½ å·²ç»é€šè¿‡ä»æˆ‘ä»¬å°†åœ¨æœ¬è¯¾ç¨‹ä¸­ä½¿ç”¨çš„å—ç“œå®šä»·æ•°æ®é›†æ”¶é›†çš„æ ·æœ¬æ•°æ®æ¢ç´¢äº†ä»€ä¹ˆæ˜¯å›å½’ã€‚ä½ è¿˜ä½¿ç”¨ Matplotlib å¯¹å…¶è¿›è¡Œäº†å¯è§†åŒ–ã€‚

ç°åœ¨ä½ å·²å‡†å¤‡å¥½æ·±å…¥ç ”ç©¶ ML çš„å›å½’ã€‚ åœ¨æœ¬è¯¾ä¸­ï¼Œä½ å°†è¯¦ç»†äº†è§£ä¸¤ç§ç±»å‹çš„å›å½’ï¼š_åŸºæœ¬çº¿æ€§å›å½’_ å’Œ _å¤šé¡¹å¼å›å½’_ï¼Œä»¥åŠè¿™äº›æŠ€æœ¯èƒŒåçš„ä¸€äº›æ•°å­¦çŸ¥è¯†ã€‚

> åœ¨æ•´ä¸ªè¯¾ç¨‹ä¸­ï¼Œæˆ‘ä»¬å‡è®¾æ•°å­¦çŸ¥è¯†æœ€å°‘ï¼Œå¹¶è¯•å›¾è®©æ¥è‡ªå…¶ä»–é¢†åŸŸçš„å­¦ç”Ÿä¹Ÿèƒ½æ¥è§¦åˆ°å®ƒï¼Œå› æ­¤è¯·ä½¿ç”¨ç¬”è®°ã€ğŸ§®æ ‡æ³¨ã€å›¾è¡¨å’Œå…¶ä»–å­¦ä¹ å·¥å…·ä»¥å¸®åŠ©ç†è§£ã€‚

### å‰æ

ä½ ç°åœ¨åº”è¯¥ç†Ÿæ‚‰æˆ‘ä»¬æ­£åœ¨æ£€æŸ¥çš„å—ç“œæ•°æ®çš„ç»“æ„ã€‚ä½ å¯ä»¥åœ¨æœ¬è¯¾çš„ _notebook.ipynb_ æ–‡ä»¶ä¸­æ‰¾åˆ°å®ƒã€‚ åœ¨è¿™ä¸ªæ–‡ä»¶ä¸­ï¼Œå—ç“œçš„ä»·æ ¼æ˜¾ç¤ºåœ¨ä¸€ä¸ªæ–°çš„ dataframe ä¸­ã€‚ç¡®ä¿å¯ä»¥åœ¨ Visual Studio Code ä»£ç çš„å†…æ ¸ä¸­è¿è¡Œè¿™äº› notebooksã€‚

### å‡†å¤‡

æé†’ä¸€ä¸‹ï¼Œä½ æ­£åœ¨åŠ è½½æ­¤æ•°æ®ä»¥æå‡ºé—®é¢˜ã€‚

- ä»€ä¹ˆæ—¶å€™ä¹°å—ç“œæœ€å¥½ï¼Ÿ
- ä¸€ç®±å¾®å‹å—ç“œçš„ä»·æ ¼æ˜¯å¤šå°‘ï¼Ÿ
- æˆ‘åº”è¯¥ä¹°åŠè’²å¼è€³è¿˜æ˜¯ 1 1/9 è’²å¼è€³ï¼Ÿ

è®©æˆ‘ä»¬ç»§ç»­æ·±å…¥ç ”ç©¶è¿™äº›æ•°æ®ã€‚

åœ¨ä¸Šä¸€è¯¾ä¸­ï¼Œä½ åˆ›å»ºäº†ä¸€ä¸ª Pandas dataframe å¹¶ç”¨åŸå§‹æ•°æ®é›†çš„ä¸€éƒ¨åˆ†å¡«å……å®ƒï¼ŒæŒ‰è’²å¼è€³æ ‡å‡†åŒ–å®šä»·ã€‚ä½†æ˜¯ï¼Œé€šè¿‡è¿™æ ·åšï¼Œä½ åªèƒ½æ”¶é›†å¤§çº¦ 400 ä¸ªæ•°æ®ç‚¹ï¼Œè€Œä¸”åªèƒ½æ”¶é›†ç§‹å­£æœˆä»½çš„æ•°æ®ã€‚

çœ‹çœ‹æˆ‘ä»¬åœ¨æœ¬è¯¾éšé™„çš„ notebook ä¸­é¢„åŠ è½½çš„æ•°æ®ã€‚æ•°æ®å·²é¢„åŠ è½½ï¼Œå¹¶ç»˜åˆ¶äº†åˆå§‹æ•£ç‚¹å›¾ä»¥æ˜¾ç¤ºæœˆä»½æ•°æ®ã€‚ä¹Ÿè®¸æˆ‘ä»¬å¯ä»¥é€šè¿‡æ›´å¤šåœ°æ¸…ç†æ•°æ®æ¥è·å¾—æ›´å¤šå…³äºæ•°æ®æ€§è´¨çš„ç»†èŠ‚ã€‚

## çº¿æ€§å›å½’çº¿

æ­£å¦‚ä½ åœ¨ç¬¬ 1 è¯¾ä¸­å­¦åˆ°çš„ï¼Œçº¿æ€§å›å½’ç»ƒä¹ çš„ç›®æ ‡æ˜¯èƒ½å¤Ÿç»˜åˆ¶ä¸€æ¡çº¿ä»¥ä¾¿ï¼š

- **æ˜¾ç¤ºå˜é‡å…³ç³»**ã€‚ æ˜¾ç¤ºå˜é‡ä¹‹é—´çš„å…³ç³»
- **ä½œå‡ºé¢„æµ‹**ã€‚ å‡†ç¡®é¢„æµ‹æ–°æ•°æ®ç‚¹ä¸è¯¥çº¿çš„å…³ç³»ã€‚

ç»˜åˆ¶è¿™ç§ç±»å‹çš„çº¿æ˜¯**æœ€å°äºŒä¹˜å›å½’**çš„å…¸å‹åšæ³•ã€‚æœ¯è¯­â€œæœ€å°äºŒä¹˜æ³•â€æ„å‘³ç€å°†å›å½’çº¿å‘¨å›´çš„æ‰€æœ‰æ•°æ®ç‚¹å¹³æ–¹ï¼Œç„¶åç›¸åŠ ã€‚ç†æƒ³æƒ…å†µä¸‹ï¼Œæœ€ç»ˆå’Œå°½å¯èƒ½å°ï¼Œå› ä¸ºæˆ‘ä»¬å¸Œæœ›é”™è¯¯æ•°é‡è¾ƒå°‘ï¼Œæˆ–â€œæœ€å°äºŒä¹˜æ³•â€ã€‚

æˆ‘ä»¬è¿™æ ·åšæ˜¯å› ä¸ºæˆ‘ä»¬æƒ³è¦å¯¹ä¸€æ¡ä¸æ‰€æœ‰æ•°æ®ç‚¹çš„ç´¯ç§¯è·ç¦»æœ€å°çš„çº¿è¿›è¡Œå»ºæ¨¡ã€‚æˆ‘ä»¬è¿˜åœ¨æ·»åŠ å®ƒä»¬ä¹‹å‰å¯¹è¿™äº›é¡¹è¿›è¡Œå¹³æ–¹ï¼Œå› ä¸ºæˆ‘ä»¬å…³å¿ƒçš„æ˜¯å®ƒçš„å¤§å°è€Œä¸æ˜¯å®ƒçš„æ–¹å‘ã€‚

> **ğŸ§® æ•°å­¦çŸ¥è¯†**
>
> è¿™æ¡çº¿ç§°ä¸º _æœ€ä½³æ‹Ÿåˆçº¿_ï¼Œå¯ä»¥ç”¨[ä¸€ä¸ªç­‰å¼](https://en.wikipedia.org/wiki/Simple_linear_regression)è¡¨ç¤ºï¼š
>
> ```
> Y = a + bX
> ```
>
> `X` æ˜¯â€œè§£é‡Šå˜é‡â€ã€‚`Y` æ˜¯â€œå› å˜é‡â€ã€‚ç›´çº¿çš„æ–œç‡æ˜¯ `b`ï¼Œ`a` æ˜¯ y è½´æˆªè·ï¼ŒæŒ‡çš„æ˜¯ `X = 0` æ—¶ `Y` çš„å€¼ã€‚
>
>![è®¡ç®—æ–œç‡](../images/slope.png)
>
> é¦–å…ˆï¼Œè®¡ç®—æ–œç‡ `b`ã€‚ä½œè€… [Jen Looper](https://twitter.com/jenlooper)
>
> æ¢å¥è¯è¯´ï¼Œå‚è€ƒæˆ‘ä»¬çš„å—ç“œæ•°æ®çš„åŸå§‹é—®é¢˜ï¼šâ€œæŒ‰æœˆé¢„æµ‹æ¯è’²å¼è€³å—ç“œçš„ä»·æ ¼â€ï¼Œ`X` æŒ‡çš„æ˜¯ä»·æ ¼ï¼Œ`Y` æŒ‡çš„æ˜¯é”€å”®æœˆä»½ã€‚
>
> ![å®Œæˆç­‰å¼](../images/calculation.png)
>
> è®¡ç®— Y çš„å€¼ã€‚å¦‚æœä½ æ”¯ä»˜å¤§çº¦ 4 ç¾å…ƒï¼Œé‚£ä¸€å®šæ˜¯å››æœˆï¼ä½œè€… [Jen Looper](https://twitter.com/jenlooper)
>
> è®¡ç®—ç›´çº¿çš„æ•°å­¦å¿…é¡»è¯æ˜ç›´çº¿çš„æ–œç‡ï¼Œè¿™ä¹Ÿå–å†³äºæˆªè·ï¼Œæˆ–è€…å½“ `X = 0` æ—¶ `Y` æ‰€åœ¨çš„ä½ç½®ã€‚
>
> ä½ å¯ä»¥åœ¨ [Math is Fun](https://www.mathsisfun.com/data/least-squares-regression.html) ç½‘ç«™ä¸Šè§‚å¯Ÿè¿™äº›å€¼çš„è®¡ç®—æ–¹æ³•ã€‚å¦è¯·è®¿é—®[è¿™ä¸ªæœ€å°äºŒä¹˜è®¡ç®—å™¨](https://www.mathsisfun.com/data/least-squares-calculator.html)ä»¥è§‚å¯Ÿæ•°å­—çš„å€¼å¦‚ä½•å½±å“ç›´çº¿ã€‚

## ç›¸å…³æ€§

å¦ä¸€ä¸ªéœ€è¦ç†è§£çš„æœ¯è¯­æ˜¯ç»™å®š X å’Œ Y å˜é‡ä¹‹é—´çš„**ç›¸å…³ç³»æ•°**ã€‚ä½¿ç”¨æ•£ç‚¹å›¾ï¼Œä½ å¯ä»¥å¿«é€Ÿå¯è§†åŒ–è¯¥ç³»æ•°ã€‚æ•°æ®ç‚¹æ•£å¸ƒåœ¨ä¸€æ¡ç›´çº¿ä¸Šçš„å›¾å…·æœ‰é«˜ç›¸å…³æ€§ï¼Œä½†æ•°æ®ç‚¹æ•£å¸ƒåœ¨ X å’Œ Y ä¹‹é—´çš„å›¾å…·æœ‰ä½ç›¸å…³æ€§ã€‚

ä¸€ä¸ªå¥½çš„çº¿æ€§å›å½’æ¨¡å‹å°†æ˜¯ä¸€ä¸ªç”¨æœ€å°äºŒä¹˜å›å½’æ³•ä¸ç›´çº¿å›å½’å¾—åˆ°çš„é«˜ï¼ˆæ›´æ¥è¿‘äº 1ï¼‰ç›¸å…³ç³»æ•°çš„æ¨¡å‹ã€‚

âœ… è¿è¡Œæœ¬è¯¾éšé™„çš„ notebook å¹¶æŸ¥çœ‹ City to Price æ•£ç‚¹å›¾ã€‚æ ¹æ®ä½ å¯¹æ•£ç‚¹å›¾çš„è§†è§‰è§£é‡Šï¼Œå°†å—ç“œé”€å”®çš„åŸå¸‚ä¸ä»·æ ¼ç›¸å…³è”çš„æ•°æ®ä¼¼ä¹å…·æœ‰é«˜ç›¸å…³æ€§æˆ–ä½ç›¸å…³æ€§ï¼Ÿ

## ä¸ºå›å½’å‡†å¤‡æ•°æ®

ç°åœ¨ä½ å·²ç»äº†è§£äº†æœ¬ç»ƒä¹ èƒŒåçš„æ•°å­¦åŸç†ï¼Œå¯ä»¥åˆ›å»ºä¸€ä¸ªå›å½’æ¨¡å‹ï¼Œçœ‹çœ‹ä½ æ˜¯å¦å¯ä»¥é¢„æµ‹å“ªä¸ªå—ç“œåŒ…è£…çš„å—ç“œä»·æ ¼æœ€ä¼˜æƒ ã€‚ä¸ºèŠ‚æ—¥è´­ä¹°å—ç“œçš„äººå¯èƒ½å¸Œæœ›æ­¤ä¿¡æ¯èƒ½å¤Ÿä¼˜åŒ–ä»–ä»¬å¦‚ä½•è´­ä¹°å—ç“œåŒ…è£…ã€‚

ç”±äºä½ å°†ä½¿ç”¨ Scikit-learnï¼Œå› æ­¤æ²¡æœ‰ç†ç”±æ‰‹åŠ¨æ‰§è¡Œæ­¤æ“ä½œï¼ˆå°½ç®¡ä½ å¯ä»¥ï¼ï¼‰ã€‚åœ¨è¯¾ç¨‹ notebook çš„ä¸»è¦æ•°æ®å¤„ç†å—ä¸­ï¼Œä» Scikit-learn æ·»åŠ ä¸€ä¸ªåº“ä»¥è‡ªåŠ¨å°†æ‰€æœ‰å­—ç¬¦ä¸²æ•°æ®è½¬æ¢ä¸ºæ•°å­—ï¼š

```python
from sklearn.preprocessing import LabelEncoder

new_pumpkins.iloc[:, 0:-1] = new_pumpkins.iloc[:, 0:-1].apply(LabelEncoder().fit_transform)
```

å¦‚æœä½ ç°åœ¨æŸ¥çœ‹ new_pumpkins dataframeï¼Œä½ ä¼šçœ‹åˆ°æ‰€æœ‰å­—ç¬¦ä¸²ç°åœ¨éƒ½æ˜¯æ•°å­—ã€‚è¿™è®©ä½ æ›´éš¾é˜…è¯»ï¼Œä½†å¯¹ Scikit-learn æ¥è¯´æ›´å®¹æ˜“ç†è§£ï¼

ç°åœ¨ï¼Œä½ å¯ä»¥å¯¹æœ€é€‚åˆå›å½’çš„æ•°æ®åšå‡ºæ›´æœ‰æ ¹æ®çš„å†³ç­–ï¼ˆä¸ä»…ä»…æ˜¯åŸºäºè§‚å¯Ÿæ•£ç‚¹å›¾ï¼‰ã€‚

å°è¯•åœ¨æ•°æ®çš„ä¸¤ç‚¹ä¹‹é—´æ‰¾åˆ°è‰¯å¥½çš„ç›¸å…³æ€§ï¼Œä»¥æ„å»ºè‰¯å¥½çš„é¢„æµ‹æ¨¡å‹ã€‚äº‹å®è¯æ˜ï¼ŒåŸå¸‚å’Œä»·æ ¼ä¹‹é—´åªæœ‰å¾®å¼±çš„ç›¸å…³æ€§ï¼š

```python
print(new_pumpkins['City'].corr(new_pumpkins['Price']))
0.32363971816089226
```

ç„¶è€Œï¼ŒåŒ…è£…å’Œå®ƒçš„ä»·æ ¼ä¹‹é—´æœ‰æ›´å¥½çš„ç›¸å…³æ€§ã€‚è¿™æ˜¯æœ‰é“ç†çš„ï¼Œå¯¹å§ï¼Ÿé€šå¸¸ï¼Œå†œäº§å“ç®±è¶Šå¤§ï¼Œä»·æ ¼è¶Šé«˜ã€‚

```python
print(new_pumpkins['Package'].corr(new_pumpkins['Price']))
0.6061712937226021
```

å¯¹è¿™äº›æ•°æ®æå‡ºçš„ä¸€ä¸ªå¾ˆå¥½çš„é—®é¢˜æ˜¯ï¼šâ€œæˆ‘å¯ä»¥æœŸæœ›ç»™å®šçš„å—ç“œåŒ…è£…çš„ä»·æ ¼æ˜¯å¤šå°‘ï¼Ÿâ€

è®©æˆ‘ä»¬å»ºç«‹è¿™ä¸ªå›å½’æ¨¡å‹

## å»ºç«‹çº¿æ€§æ¨¡å‹

åœ¨æ„å»ºæ¨¡å‹ä¹‹å‰ï¼Œå†å¯¹æ•°æ®è¿›è¡Œä¸€æ¬¡æ•´ç†ã€‚åˆ é™¤ä»»ä½•ç©ºæ•°æ®å¹¶å†æ¬¡æ£€æŸ¥æ•°æ®çš„æ ·å­ã€‚

```python
new_pumpkins.dropna(inplace=True)
new_pumpkins.info()
```

ç„¶åï¼Œä»è¿™ä¸ªæœ€å°é›†åˆåˆ›å»ºä¸€ä¸ªæ–°çš„ dataframe å¹¶å°†å…¶æ‰“å°å‡ºæ¥ï¼š

```python
new_columns = ['Package', 'Price']
lin_pumpkins = new_pumpkins.drop([c for c in new_pumpkins.columns if c not in new_columns], axis='columns')

lin_pumpkins
```

```output
	Package	Price
70	0	13.636364
71	0	16.363636
72	0	16.363636
73	0	15.454545
74	0	13.636364
...	...	...
1738	2	30.000000
1739	2	28.750000
1740	2	25.750000
1741	2	24.000000
1742	2	24.000000
415 rows Ã— 2 columns
```

1. ç°åœ¨ä½ å¯ä»¥åˆ†é… X å’Œ y åæ ‡æ•°æ®ï¼š

   ```python
   X = lin_pumpkins.values[:, :1]
   y = lin_pumpkins.values[:, 1:2]
   ```

âœ… è¿™é‡Œå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿä½ æ­£åœ¨ä½¿ç”¨ [Python slice notation](https://stackoverflow.com/questions/509211/understanding-slice-notation/509295#509295) æ¥åˆ›å»ºæ•°ç»„æ¥å¡«å…… `X` å’Œ `y`ã€‚

2. æ¥ä¸‹æ¥ï¼Œå¼€å§‹å›å½’æ¨¡å‹æ„å»ºä¾‹ç¨‹ï¼š

   ```python
   from sklearn.linear_model import LinearRegression
   from sklearn.metrics import r2_score, mean_squared_error, mean_absolute_error
   from sklearn.model_selection import train_test_split

   X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=0)
   lin_reg = LinearRegression()
   lin_reg.fit(X_train,y_train)

   pred = lin_reg.predict(X_test)

   accuracy_score = lin_reg.score(X_train,y_train)
   print('Model Accuracy: ', accuracy_score)
   ```

   å› ä¸ºç›¸å…³æ€§ä¸æ˜¯ç‰¹åˆ«å¥½ï¼Œæ‰€ä»¥ç”Ÿæˆçš„æ¨¡å‹ä¸æ˜¯éå¸¸å‡†ç¡®ã€‚

   ```output
   Model Accuracy:  0.3315342327998987
   ```

3. ä½ å¯ä»¥å°†è¿‡ç¨‹ä¸­ç»˜åˆ¶çš„çº¿æ¡å¯è§†åŒ–ï¼š

   ```python
   plt.scatter(X_test, y_test,  color='black')
   plt.plot(X_test, pred, color='blue', linewidth=3)

   plt.xlabel('Package')
   plt.ylabel('Price')

   plt.show()
   ```

   ![æ•£ç‚¹å›¾æ˜¾ç¤ºåŒ…è£…ä¸ä»·æ ¼çš„å…³ç³»](../images/linear.png)

4. é’ˆå¯¹å‡è®¾çš„å“ç§æµ‹è¯•æ¨¡å‹ï¼š

   ```python
   lin_reg.predict( np.array([ [2.75] ]) )
   ```

   è¿™ä¸ªç¥è¯èˆ¬çš„å“ç§çš„ä»·æ ¼æ˜¯ï¼š

   ```output
   array([[33.15655975]])
   ```

å¦‚æœå›å½’çº¿çš„é€»è¾‘æˆç«‹ï¼Œè¿™ä¸ªæ•°å­—æ˜¯æœ‰æ„ä¹‰çš„ã€‚

ğŸƒ æ­å–œä½ ï¼Œä½ åˆšåˆšåˆ›å»ºäº†ä¸€ä¸ªæ¨¡å‹ï¼Œå¯ä»¥å¸®åŠ©é¢„æµ‹å‡ ä¸ªå—ç“œå“ç§çš„ä»·æ ¼ã€‚ä½ çš„èŠ‚æ—¥å—ç“œåœ°ä¼šå¾ˆæ¼‚äº®çš„ã€‚ä½†æ˜¯ä½ å¯ä»¥åˆ›é€ ä¸€ä¸ªæ›´å¥½çš„æ¨¡å‹ï¼

## å¤šé¡¹å¼å›å½’

å¦ä¸€ç§çº¿æ€§å›å½’æ˜¯å¤šé¡¹å¼å›å½’ã€‚è™½ç„¶æœ‰æ—¶å˜é‡ä¹‹é—´å­˜åœ¨çº¿æ€§å…³ç³»â€”â€”å—ç“œçš„ä½“ç§¯è¶Šå¤§ï¼Œä»·æ ¼å°±è¶Šé«˜â€”â€”ä½†æœ‰æ—¶è¿™äº›å…³ç³»ä¸èƒ½ç»˜åˆ¶æˆå¹³é¢æˆ–ç›´çº¿ã€‚

âœ… è¿™é‡Œæœ‰å¯ä»¥ä½¿ç”¨å¤šé¡¹å¼å›å½’æ•°æ®çš„[æ›´å¤šç¤ºä¾‹](https://online.stat.psu.edu/stat501/lesson/9/9.8)

å†çœ‹ä¸€ä¸‹ä¸Šå›¾ä¸­å“ç§ä¸ä»·æ ¼ä¹‹é—´çš„å…³ç³»ã€‚è¿™ä¸ªæ•£ç‚¹å›¾çœ‹èµ·æ¥æ˜¯å¦åº”è¯¥ç”¨ä¸€æ¡ç›´çº¿æ¥åˆ†æï¼Ÿä¹Ÿè®¸ä¸æ˜¯ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½ å¯ä»¥å°è¯•å¤šé¡¹å¼å›å½’ã€‚

âœ… å¤šé¡¹å¼æ˜¯å¯èƒ½ç”±ä¸€ä¸ªæˆ–å¤šä¸ªå˜é‡å’Œç³»æ•°ç»„æˆçš„æ•°å­¦è¡¨è¾¾å¼

å¤šé¡¹å¼å›å½’åˆ›å»ºä¸€æ¡æ›²çº¿ä»¥æ›´å¥½åœ°æ‹Ÿåˆéçº¿æ€§æ•°æ®ã€‚

1. è®©æˆ‘ä»¬é‡æ–°åˆ›å»ºä¸€ä¸ªå¡«å……äº†åŸå§‹å—ç“œæ•°æ®ç‰‡æ®µçš„ dataframeï¼š

   ```python
   new_columns = ['Variety', 'Package', 'City', 'Month', 'Price']
   poly_pumpkins = new_pumpkins.drop([c for c in new_pumpkins.columns if c not in new_columns], axis='columns')

   poly_pumpkins
   ```

å¯è§†åŒ– dataframe ä¸­æ•°æ®ä¹‹é—´ç›¸å…³æ€§çš„ä¸€ç§å¥½æ–¹æ³•æ˜¯å°†å…¶æ˜¾ç¤ºåœ¨â€œcoolwarmâ€å›¾è¡¨ä¸­ï¼š

2. ä½¿ç”¨ `Background_gradient()` æ–¹æ³•å’Œ `coolwarm` ä½œä¸ºå…¶å‚æ•°å€¼ï¼š

   ```python
   corr = poly_pumpkins.corr()
   corr.style.background_gradient(cmap='coolwarm')
   ```

   è¿™æ®µä»£ç åˆ›å»ºäº†ä¸€ä¸ªçƒ­å›¾:
   ![æ˜¾ç¤ºæ•°æ®ç›¸å…³æ€§çš„çƒ­å›¾](../images/heatmap.png)

æŸ¥çœ‹æ­¤å›¾è¡¨ï¼Œä½ å¯ä»¥ç›´è§‚åœ°çœ‹åˆ° Package å’Œ Price ä¹‹é—´çš„è‰¯å¥½ç›¸å…³æ€§ã€‚æ‰€ä»¥ä½ åº”è¯¥èƒ½å¤Ÿåˆ›å»ºä¸€ä¸ªæ¯”ä¸Šä¸€ä¸ªæ›´å¥½çš„æ¨¡å‹ã€‚

### åˆ›å»ºç®¡é“

Scikit-learn åŒ…å«ä¸€ä¸ªç”¨äºæ„å»ºå¤šé¡¹å¼å›å½’æ¨¡å‹çš„æœ‰ç”¨ API - `make_pipeline` [API](https://scikit-learn.org/stable/modules/generated/sklearn.pipeline.make_pipeline.html?highlight=pipeline#sklearn.pipeline.make_pipeline)ã€‚ åˆ›å»ºäº†ä¸€ä¸ªâ€œç®¡é“â€ï¼Œå®ƒæ˜¯ä¸€ä¸ªä¼°è®¡å™¨é“¾ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œç®¡é“åŒ…æ‹¬å¤šé¡¹å¼ç‰¹å¾æˆ–å½¢æˆéçº¿æ€§è·¯å¾„çš„é¢„æµ‹ã€‚

1. æ„å»º X å’Œ y åˆ—ï¼š

   ```python
   X=poly_pumpkins.iloc[:,3:4].values
   y=poly_pumpkins.iloc[:,4:5].values
   ```

2. é€šè¿‡è°ƒç”¨ `make_pipeline()` æ–¹æ³•åˆ›å»ºç®¡é“ï¼š

   ```python
   from sklearn.preprocessing import PolynomialFeatures
   from sklearn.pipeline import make_pipeline

   pipeline = make_pipeline(PolynomialFeatures(4), LinearRegression())

   X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=0)

   pipeline.fit(np.array(X_train), y_train)

   y_pred=pipeline.predict(X_test)
   ```

### åˆ›å»ºåºåˆ—

æ­¤æ—¶ï¼Œä½ éœ€è¦ä½¿ç”¨_æ’åºå¥½çš„_æ•°æ®åˆ›å»ºä¸€ä¸ªæ–°çš„ dataframe ï¼Œä»¥ä¾¿ç®¡é“å¯ä»¥åˆ›å»ºåºåˆ—ã€‚

æ·»åŠ ä»¥ä¸‹ä»£ç ï¼š

   ```python
   df = pd.DataFrame({'x': X_test[:,0], 'y': y_pred[:,0]})
   df.sort_values(by='x',inplace = True)
   points = pd.DataFrame(df).to_numpy()

   plt.plot(points[:, 0], points[:, 1],color="blue", linewidth=3)
   plt.xlabel('Package')
   plt.ylabel('Price')
   plt.scatter(X,y, color="black")
   plt.show()
   ```

ä½ é€šè¿‡è°ƒç”¨ `pd.DataFrame` åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„ dataframeã€‚ç„¶åé€šè¿‡è°ƒç”¨ `sort_values()` å¯¹å€¼è¿›è¡Œæ’åºã€‚æœ€åä½ åˆ›å»ºäº†ä¸€ä¸ªå¤šé¡¹å¼å›¾ï¼š

![æ˜¾ç¤ºåŒ…è£…ä¸ä»·æ ¼å…³ç³»çš„å¤šé¡¹å¼å›¾](../images/polynomial.png)

ä½ å¯ä»¥çœ‹åˆ°æ›´é€‚åˆä½ çš„æ•°æ®çš„æ›²çº¿ã€‚

è®©æˆ‘ä»¬æ£€æŸ¥æ¨¡å‹çš„å‡†ç¡®æ€§ï¼š

   ```python
   accuracy_score = pipeline.score(X_train,y_train)
   print('Model Accuracy: ', accuracy_score)
   ```

   ç§ï¼

   ```output
   Model Accuracy:  0.8537946517073784
   ```

è¿™æ ·å¥½å¤šäº†ï¼è¯•ç€é¢„æµ‹ä¸€ä¸ªä»·æ ¼ï¼š

### åšä¸ªé¢„æµ‹

æˆ‘ä»¬å¯ä»¥è¾“å…¥ä¸€ä¸ªæ–°å€¼å¹¶å¾—åˆ°ä¸€ä¸ªé¢„æµ‹å—ï¼Ÿ

è°ƒç”¨ `predict()` è¿›è¡Œé¢„æµ‹ï¼š

   ```python
   pipeline.predict( np.array([ [2.75] ]) )
   ```

   ä½ ä¼šå¾—åˆ°è¿™æ ·çš„é¢„æµ‹ï¼š

   ```output
   array([[46.34509342]])
   ```

å‚ç…§å›¾åƒï¼Œè¿™ç¡®å®æœ‰é“ç†ï¼è€Œä¸”ï¼Œå¦‚æœè¿™æ˜¯ä¸€ä¸ªæ¯”å‰ä¸€ä¸ªæ›´å¥½çš„æ¨¡å‹ï¼Œçœ‹åŒæ ·çš„æ•°æ®ï¼Œä½ éœ€è¦ä¸ºè¿™äº›æ›´æ˜‚è´µçš„å—ç“œåšå¥½é¢„ç®—ï¼

ğŸ† å¹²å¾—ä¸é”™ï¼ä½ åœ¨ä¸€èŠ‚è¯¾ä¸­åˆ›å»ºäº†ä¸¤ä¸ªå›å½’æ¨¡å‹ã€‚åœ¨å›å½’çš„æœ€åä¸€èŠ‚ä¸­ï¼Œä½ å°†äº†è§£é€»è¾‘å›å½’ä»¥ç¡®å®šç±»åˆ«ã€‚

---

## ğŸš€æŒ‘æˆ˜

åœ¨æ­¤ notebook ä¸­æµ‹è¯•å‡ ä¸ªä¸åŒçš„å˜é‡ï¼Œä»¥æŸ¥çœ‹ç›¸å…³æ€§ä¸æ¨¡å‹å‡†ç¡®æ€§çš„å¯¹åº”å…³ç³»ã€‚

## [è¯¾åæµ‹](https://white-water-09ec41f0f.azurestaticapps.net/quiz/14/)

## å¤ä¹ ä¸è‡ªå­¦

åœ¨æœ¬è¯¾ä¸­ï¼Œæˆ‘ä»¬å­¦ä¹ äº†çº¿æ€§å›å½’ã€‚è¿˜æœ‰å…¶ä»–é‡è¦çš„å›å½’ç±»å‹ã€‚äº†è§£ Stepwiseã€Ridgeã€Lasso å’Œ Elasticnet æŠ€æœ¯ã€‚å­¦ä¹ æ›´å¤šä¿¡æ¯çš„å¥½è¯¾ç¨‹æ˜¯ [æ–¯å¦ç¦ç»Ÿè®¡å­¦ä¹ è¯¾ç¨‹](https://online.stanford.edu/courses/sohs-ystatslearning-statistical-learning)

## ä»»åŠ¡

[æ„å»ºæ¨¡å‹](./assignment.zh-cn.md)
