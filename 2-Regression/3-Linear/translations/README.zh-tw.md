# ä½¿ç”¨ Scikit-learn æ§‹å»ºå›æ­¸æ¨¡å‹ï¼šå…©ç¨®æ–¹å¼çš„å›æ­¸

![ç·šæ€§èˆ‡å¤šé …å¼å›æ­¸ä¿¡æ¯åœ–](../images/linear-polynomial.png)

> ä½œè€… [Dasani Madipalli](https://twitter.com/dasani_decoded)

## [èª²å‰æ¸¬](https://gray-sand-07a10f403.1.azurestaticapps.net/quiz/13/)

### ä»‹ç´¹

åˆ°ç›®å‰ç‚ºæ­¢ï¼Œä½ å·²ç¶“é€šéå¾æˆ‘å€‘å°‡åœ¨æœ¬èª²ç¨‹ä¸­ä½¿ç”¨çš„å—ç“œå®šåƒ¹æ•¸æ“šé›†æ”¶é›†çš„æ¨£æœ¬æ•¸æ“šæ¢ç´¢äº†ä»€éº½æ˜¯å›æ­¸ã€‚ä½ é‚„ä½¿ç”¨ Matplotlib å°å…¶é€²è¡Œäº†å¯è¦–åŒ–ã€‚

ç¾åœ¨ä½ å·²æº–å‚™å¥½æ·±å…¥ç ”ç©¶ ML çš„å›æ­¸ã€‚ åœ¨æœ¬èª²ä¸­ï¼Œä½ å°‡è©³ç´°äº†è§£å…©ç¨®é¡å‹çš„å›æ­¸ï¼š_åŸºæœ¬ç·šæ€§å›æ­¸_ å’Œ _å¤šé …å¼å›æ­¸_ï¼Œä»¥åŠé€™äº›æŠ€è¡“èƒŒå¾Œçš„ä¸€äº›æ•¸å­¸çŸ¥è­˜ã€‚

> åœ¨æ•´å€‹èª²ç¨‹ä¸­ï¼Œæˆ‘å€‘å‡è¨­æ•¸å­¸çŸ¥è­˜æœ€å°‘ï¼Œä¸¦è©¦åœ–è®“ä¾†è‡ªå…¶ä»–é ˜åŸŸçš„å­¸ç”Ÿä¹Ÿèƒ½æ¥è§¸åˆ°å®ƒï¼Œå› æ­¤è«‹ä½¿ç”¨ç­†è¨˜ã€ğŸ§®æ¨™è¨»ã€åœ–è¡¨å’Œå…¶ä»–å­¸ç¿’å·¥å…·ä»¥å¹«åŠ©ç†è§£ã€‚

### å‰æ

ä½ ç¾åœ¨æ‡‰è©²ç†Ÿæ‚‰æˆ‘å€‘æ­£åœ¨æª¢æŸ¥çš„å—ç“œæ•¸æ“šçš„çµæ§‹ã€‚ä½ å¯ä»¥åœ¨æœ¬èª²çš„ _notebook.ipynb_ æ–‡ä»¶ä¸­æ‰¾åˆ°å®ƒã€‚ åœ¨é€™å€‹æ–‡ä»¶ä¸­ï¼Œå—ç“œçš„åƒ¹æ ¼é¡¯ç¤ºåœ¨ä¸€å€‹æ–°çš„ dataframe ä¸­ã€‚ç¢ºä¿å¯ä»¥åœ¨ Visual Studio Code ä»£ç¢¼çš„å…§æ ¸ä¸­é‹è¡Œé€™äº› notebooksã€‚

### æº–å‚™

æé†’ä¸€ä¸‹ï¼Œä½ æ­£åœ¨åŠ è¼‰æ­¤æ•¸æ“šä»¥æå‡ºå•é¡Œã€‚

- ä»€éº½æ™‚å€™è²·å—ç“œæœ€å¥½ï¼Ÿ
- ä¸€ç®±å¾®å‹å—ç“œçš„åƒ¹æ ¼æ˜¯å¤šå°‘ï¼Ÿ
- æˆ‘æ‡‰è©²è²·åŠè’²å¼è€³é‚„æ˜¯ 1 1/9 è’²å¼è€³ï¼Ÿ

è®“æˆ‘å€‘ç¹¼çºŒæ·±å…¥ç ”ç©¶é€™äº›æ•¸æ“šã€‚

åœ¨ä¸Šä¸€èª²ä¸­ï¼Œä½ å‰µå»ºäº†ä¸€å€‹ Pandas dataframe ä¸¦ç”¨åŸå§‹æ•¸æ“šé›†çš„ä¸€éƒ¨åˆ†å¡«å……å®ƒï¼ŒæŒ‰è’²å¼è€³æ¨™æº–åŒ–å®šåƒ¹ã€‚ä½†æ˜¯ï¼Œé€šéé€™æ¨£åšï¼Œä½ åªèƒ½æ”¶é›†å¤§ç´„ 400 å€‹æ•¸æ“šé»ï¼Œè€Œä¸”åªèƒ½æ”¶é›†ç§‹å­£æœˆä»½çš„æ•¸æ“šã€‚

çœ‹çœ‹æˆ‘å€‘åœ¨æœ¬èª²éš¨é™„çš„ notebook ä¸­é åŠ è¼‰çš„æ•¸æ“šã€‚æ•¸æ“šå·²é åŠ è¼‰ï¼Œä¸¦ç¹ªè£½äº†åˆå§‹æ•£é»åœ–ä»¥é¡¯ç¤ºæœˆä»½æ•¸æ“šã€‚ä¹Ÿè¨±æˆ‘å€‘å¯ä»¥é€šéæ›´å¤šåœ°æ¸…ç†æ•¸æ“šä¾†ç²å¾—æ›´å¤šé—œæ–¼æ•¸æ“šæ€§è³ªçš„ç´°ç¯€ã€‚

## ç·šæ€§å›æ­¸ç·š

æ­£å¦‚ä½ åœ¨ç¬¬ 1 èª²ä¸­å­¸åˆ°çš„ï¼Œç·šæ€§å›æ­¸ç·´ç¿’çš„ç›®æ¨™æ˜¯èƒ½å¤ ç¹ªè£½ä¸€æ¢ç·šä»¥ä¾¿ï¼š

- **é¡¯ç¤ºè®Šé‡é—œç³»**ã€‚ é¡¯ç¤ºè®Šé‡ä¹‹é–“çš„é—œç³»
- **ä½œå‡ºé æ¸¬**ã€‚ æº–ç¢ºé æ¸¬æ–°æ•¸æ“šé»èˆ‡è©²ç·šçš„é—œç³»ã€‚

ç¹ªè£½é€™ç¨®é¡å‹çš„ç·šæ˜¯**æœ€å°äºŒä¹˜å›æ­¸**çš„å…¸å‹åšæ³•ã€‚è¡“èªã€Œæœ€å°äºŒä¹˜æ³•ã€æ„å‘³è‘—å°‡å›æ­¸ç·šå‘¨åœçš„æ‰€æœ‰æ•¸æ“šé»å¹³æ–¹ï¼Œç„¶å¾Œç›¸åŠ ã€‚ç†æƒ³æƒ…æ³ä¸‹ï¼Œæœ€çµ‚å’Œç›¡å¯èƒ½å°ï¼Œå› ç‚ºæˆ‘å€‘å¸Œæœ›éŒ¯èª¤æ•¸é‡è¼ƒå°‘ï¼Œæˆ–ã€Œæœ€å°äºŒä¹˜æ³•ã€ã€‚

æˆ‘å€‘é€™æ¨£åšæ˜¯å› ç‚ºæˆ‘å€‘æƒ³è¦å°ä¸€æ¢èˆ‡æ‰€æœ‰æ•¸æ“šé»çš„ç´¯ç©è·é›¢æœ€å°çš„ç·šé€²è¡Œå»ºæ¨¡ã€‚æˆ‘å€‘é‚„åœ¨æ·»åŠ å®ƒå€‘ä¹‹å‰å°é€™äº›é …é€²è¡Œå¹³æ–¹ï¼Œå› ç‚ºæˆ‘å€‘é—œå¿ƒçš„æ˜¯å®ƒçš„å¤§å°è€Œä¸æ˜¯å®ƒçš„æ–¹å‘ã€‚

> **ğŸ§® æ•¸å­¸çŸ¥è­˜**
>
> é€™æ¢ç·šç¨±ç‚º _æœ€ä½³æ“¬åˆç·š_ï¼Œå¯ä»¥ç”¨[ä¸€å€‹ç­‰å¼](https://en.wikipedia.org/wiki/Simple_linear_regression)è¡¨ç¤ºï¼š
>
> ```
> Y = a + bX
> ```
>
> `X` æ˜¯ã€Œè§£é‡‹è®Šé‡ã€ã€‚`Y` æ˜¯ã€Œå› è®Šé‡ã€ã€‚ç›´ç·šçš„æ–œç‡æ˜¯ `b`ï¼Œ`a` æ˜¯ y è»¸æˆªè·ï¼ŒæŒ‡çš„æ˜¯ `X = 0` æ™‚ `Y` çš„å€¼ã€‚
>
>![è¨ˆç®—æ–œç‡](../images/slope.png)
>
> é¦–å…ˆï¼Œè¨ˆç®—æ–œç‡ `b`ã€‚ä½œè€… [Jen Looper](https://twitter.com/jenlooper)
>
> æ›å¥è©±èªªï¼Œåƒè€ƒæˆ‘å€‘çš„å—ç“œæ•¸æ“šçš„åŸå§‹å•é¡Œï¼šã€ŒæŒ‰æœˆé æ¸¬æ¯è’²å¼è€³å—ç“œçš„åƒ¹æ ¼ã€ï¼Œ`X` æŒ‡çš„æ˜¯åƒ¹æ ¼ï¼Œ`Y` æŒ‡çš„æ˜¯éŠ·å”®æœˆä»½ã€‚
>
> ![å®Œæˆç­‰å¼](../images/calculation.png)
>
> è¨ˆç®— Y çš„å€¼ã€‚å¦‚æœä½ æ”¯ä»˜å¤§ç´„ 4 ç¾å…ƒï¼Œé‚£ä¸€å®šæ˜¯å››æœˆï¼ä½œè€… [Jen Looper](https://twitter.com/jenlooper)
>
> è¨ˆç®—ç›´ç·šçš„æ•¸å­¸å¿…é ˆè­‰æ˜ç›´ç·šçš„æ–œç‡ï¼Œé€™ä¹Ÿå–æ±ºæ–¼æˆªè·ï¼Œæˆ–è€…ç•¶ `X = 0` æ™‚ `Y` æ‰€åœ¨çš„ä½ç½®ã€‚
>
> ä½ å¯ä»¥åœ¨ [Math is Fun](https://www.mathsisfun.com/data/least-squares-regression.html) ç¶²ç«™ä¸Šè§€å¯Ÿé€™äº›å€¼çš„è¨ˆç®—æ–¹æ³•ã€‚å¦è«‹è¨ªå•[é€™å€‹æœ€å°äºŒä¹˜è¨ˆç®—å™¨](https://www.mathsisfun.com/data/least-squares-calculator.html)ä»¥è§€å¯Ÿæ•¸å­—çš„å€¼å¦‚ä½•å½±éŸ¿ç›´ç·šã€‚

## ç›¸é—œæ€§

å¦ä¸€å€‹éœ€è¦ç†è§£çš„è¡“èªæ˜¯çµ¦å®š X å’Œ Y è®Šé‡ä¹‹é–“çš„**ç›¸é—œç³»æ•¸**ã€‚ä½¿ç”¨æ•£é»åœ–ï¼Œä½ å¯ä»¥å¿«é€Ÿå¯è¦–åŒ–è©²ç³»æ•¸ã€‚æ•¸æ“šé»æ•£å¸ƒåœ¨ä¸€æ¢ç›´ç·šä¸Šçš„åœ–å…·æœ‰é«˜ç›¸é—œæ€§ï¼Œä½†æ•¸æ“šé»æ•£å¸ƒåœ¨ X å’Œ Y ä¹‹é–“çš„åœ–å…·æœ‰ä½ç›¸é—œæ€§ã€‚

ä¸€å€‹å¥½çš„ç·šæ€§å›æ­¸æ¨¡å‹å°‡æ˜¯ä¸€å€‹ç”¨æœ€å°äºŒä¹˜å›æ­¸æ³•èˆ‡ç›´ç·šå›æ­¸å¾—åˆ°çš„é«˜ï¼ˆæ›´æ¥è¿‘æ–¼ 1ï¼‰ç›¸é—œç³»æ•¸çš„æ¨¡å‹ã€‚

âœ… é‹è¡Œæœ¬èª²éš¨é™„çš„ notebook ä¸¦æŸ¥çœ‹ City to Price æ•£é»åœ–ã€‚æ ¹æ“šä½ å°æ•£é»åœ–çš„è¦–è¦ºè§£é‡‹ï¼Œå°‡å—ç“œéŠ·å”®çš„åŸå¸‚èˆ‡åƒ¹æ ¼ç›¸é—œè¯çš„æ•¸æ“šä¼¼ä¹å…·æœ‰é«˜ç›¸é—œæ€§æˆ–ä½ç›¸é—œæ€§ï¼Ÿ

## ç‚ºå›æ­¸æº–å‚™æ•¸æ“š

ç¾åœ¨ä½ å·²ç¶“äº†è§£äº†æœ¬ç·´ç¿’èƒŒå¾Œçš„æ•¸å­¸åŸç†ï¼Œå¯ä»¥å‰µå»ºä¸€å€‹å›æ­¸æ¨¡å‹ï¼Œçœ‹çœ‹ä½ æ˜¯å¦å¯ä»¥é æ¸¬å“ªå€‹å—ç“œåŒ…è£çš„å—ç“œåƒ¹æ ¼æœ€å„ªæƒ ã€‚ç‚ºç¯€æ—¥è³¼è²·å—ç“œçš„äººå¯èƒ½å¸Œæœ›æ­¤ä¿¡æ¯èƒ½å¤ å„ªåŒ–ä»–å€‘å¦‚ä½•è³¼è²·å—ç“œåŒ…è£ã€‚

ç”±æ–¼ä½ å°‡ä½¿ç”¨ Scikit-learnï¼Œå› æ­¤æ²’æœ‰ç†ç”±æ‰‹å‹•åŸ·è¡Œæ­¤æ“ä½œï¼ˆç›¡ç®¡ä½ å¯ä»¥ï¼ï¼‰ã€‚åœ¨èª²ç¨‹ notebook çš„ä¸»è¦æ•¸æ“šè™•ç†å¡Šä¸­ï¼Œå¾ Scikit-learn æ·»åŠ ä¸€å€‹åº«ä»¥è‡ªå‹•å°‡æ‰€æœ‰å­—ç¬¦ä¸²æ•¸æ“šè½‰æ›ç‚ºæ•¸å­—ï¼š

```python
from sklearn.preprocessing import LabelEncoder

new_pumpkins.iloc[:, 0:-1] = new_pumpkins.iloc[:, 0:-1].apply(LabelEncoder().fit_transform)
```

å¦‚æœä½ ç¾åœ¨æŸ¥çœ‹ new_pumpkins dataframeï¼Œä½ æœƒçœ‹åˆ°æ‰€æœ‰å­—ç¬¦ä¸²ç¾åœ¨éƒ½æ˜¯æ•¸å­—ã€‚é€™è®“ä½ æ›´é›£é–±è®€ï¼Œä½†å° Scikit-learn ä¾†èªªæ›´å®¹æ˜“ç†è§£ï¼

ç¾åœ¨ï¼Œä½ å¯ä»¥å°æœ€é©åˆå›æ­¸çš„æ•¸æ“šåšå‡ºæ›´æœ‰æ ¹æ“šçš„æ±ºç­–ï¼ˆä¸åƒ…åƒ…æ˜¯åŸºæ–¼è§€å¯Ÿæ•£é»åœ–ï¼‰ã€‚

å˜—è©¦åœ¨æ•¸æ“šçš„å…©é»ä¹‹é–“æ‰¾åˆ°è‰¯å¥½çš„ç›¸é—œæ€§ï¼Œä»¥æ§‹å»ºè‰¯å¥½çš„é æ¸¬æ¨¡å‹ã€‚äº‹å¯¦è­‰æ˜ï¼ŒåŸå¸‚å’Œåƒ¹æ ¼ä¹‹é–“åªæœ‰å¾®å¼±çš„ç›¸é—œæ€§ï¼š

```python
print(new_pumpkins['City'].corr(new_pumpkins['Price']))
0.32363971816089226
```

ç„¶è€Œï¼ŒåŒ…è£å’Œå®ƒçš„åƒ¹æ ¼ä¹‹é–“æœ‰æ›´å¥½çš„ç›¸é—œæ€§ã€‚é€™æ˜¯æœ‰é“ç†çš„ï¼Œå°å§ï¼Ÿé€šå¸¸ï¼Œè¾²ç”¢å“ç®±è¶Šå¤§ï¼Œåƒ¹æ ¼è¶Šé«˜ã€‚

```python
print(new_pumpkins['Package'].corr(new_pumpkins['Price']))
0.6061712937226021
```

å°é€™äº›æ•¸æ“šæå‡ºçš„ä¸€å€‹å¾ˆå¥½çš„å•é¡Œæ˜¯ï¼šã€Œæˆ‘å¯ä»¥æœŸæœ›çµ¦å®šçš„å—ç“œåŒ…è£çš„åƒ¹æ ¼æ˜¯å¤šå°‘ï¼Ÿã€

è®“æˆ‘å€‘å»ºç«‹é€™å€‹å›æ­¸æ¨¡å‹

## å»ºç«‹ç·šæ€§æ¨¡å‹

åœ¨æ§‹å»ºæ¨¡å‹ä¹‹å‰ï¼Œå†å°æ•¸æ“šé€²è¡Œä¸€æ¬¡æ•´ç†ã€‚åˆªé™¤ä»»ä½•ç©ºæ•¸æ“šä¸¦å†æ¬¡æª¢æŸ¥æ•¸æ“šçš„æ¨£å­ã€‚

```python
new_pumpkins.dropna(inplace=True)
new_pumpkins.info()
```

ç„¶å¾Œï¼Œå¾é€™å€‹æœ€å°é›†åˆå‰µå»ºä¸€å€‹æ–°çš„ dataframe ä¸¦å°‡å…¶æ‰“å°å‡ºä¾†ï¼š

```python
new_columns = ['Package', 'Price']
lin_pumpkins = new_pumpkins.drop([c for c in new_pumpkins.columns if c not in new_columns], axis='columns')

lin_pumpkins
```

```output
	Package	Price
70	0	13.636364
71	0	16.363636
72	0	16.363636
73	0	15.454545
74	0	13.636364
...	...	...
1738	2	30.000000
1739	2	28.750000
1740	2	25.750000
1741	2	24.000000
1742	2	24.000000
415 rows Ã— 2 columns
```

1. ç¾åœ¨ä½ å¯ä»¥åˆ†é… X å’Œ y åæ¨™æ•¸æ“šï¼š

   ```python
   X = lin_pumpkins.values[:, :1]
   y = lin_pumpkins.values[:, 1:2]
   ```

âœ… é€™è£ç™¼ç”Ÿäº†ä»€éº½ï¼Ÿä½ æ­£åœ¨ä½¿ç”¨ [Python slice notation](https://stackoverflow.com/questions/509211/understanding-slice-notation/509295#509295) ä¾†å‰µå»ºæ•¸çµ„ä¾†å¡«å…… `X` å’Œ `y`ã€‚

2. æ¥ä¸‹ä¾†ï¼Œé–‹å§‹å›æ­¸æ¨¡å‹æ§‹å»ºä¾‹ç¨‹ï¼š

   ```python
   from sklearn.linear_model import LinearRegression
   from sklearn.metrics import r2_score, mean_squared_error, mean_absolute_error
   from sklearn.model_selection import train_test_split

   X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=0)
   lin_reg = LinearRegression()
   lin_reg.fit(X_train,y_train)

   pred = lin_reg.predict(X_test)

   accuracy_score = lin_reg.score(X_train,y_train)
   print('Model Accuracy: ', accuracy_score)
   ```

   å› ç‚ºç›¸é—œæ€§ä¸æ˜¯ç‰¹åˆ¥å¥½ï¼Œæ‰€ä»¥ç”Ÿæˆçš„æ¨¡å‹ä¸æ˜¯éå¸¸æº–ç¢ºã€‚

   ```output
   Model Accuracy:  0.3315342327998987
   ```

3. ä½ å¯ä»¥å°‡éç¨‹ä¸­ç¹ªè£½çš„ç·šæ¢å¯è¦–åŒ–ï¼š

   ```python
   plt.scatter(X_test, y_test,  color='black')
   plt.plot(X_test, pred, color='blue', linewidth=3)

   plt.xlabel('Package')
   plt.ylabel('Price')

   plt.show()
   ```

   ![æ•£é»åœ–é¡¯ç¤ºåŒ…è£èˆ‡åƒ¹æ ¼çš„é—œç³»](../images/linear.png)

4. é‡å°å‡è¨­çš„å“ç¨®æ¸¬è©¦æ¨¡å‹ï¼š

   ```python
   lin_reg.predict( np.array([ [2.75] ]) )
   ```

   é€™å€‹ç¥è©±èˆ¬çš„å“ç¨®çš„åƒ¹æ ¼æ˜¯ï¼š

   ```output
   array([[33.15655975]])
   ```

å¦‚æœå›æ­¸ç·šçš„é‚è¼¯æˆç«‹ï¼Œé€™å€‹æ•¸å­—æ˜¯æœ‰æ„ç¾©çš„ã€‚

ğŸƒ æ­å–œä½ ï¼Œä½ å‰›å‰›å‰µå»ºäº†ä¸€å€‹æ¨¡å‹ï¼Œå¯ä»¥å¹«åŠ©é æ¸¬å¹¾å€‹å—ç“œå“ç¨®çš„åƒ¹æ ¼ã€‚ä½ çš„ç¯€æ—¥å—ç“œåœ°æœƒå¾ˆæ¼‚äº®çš„ã€‚ä½†æ˜¯ä½ å¯ä»¥å‰µé€ ä¸€å€‹æ›´å¥½çš„æ¨¡å‹ï¼

## å¤šé …å¼å›æ­¸

å¦ä¸€ç¨®ç·šæ€§å›æ­¸æ˜¯å¤šé …å¼å›æ­¸ã€‚é›–ç„¶æœ‰æ™‚è®Šé‡ä¹‹é–“å­˜åœ¨ç·šæ€§é—œç³»â€”â€”å—ç“œçš„é«”ç©è¶Šå¤§ï¼Œåƒ¹æ ¼å°±è¶Šé«˜â€”â€”ä½†æœ‰æ™‚é€™äº›é—œç³»ä¸èƒ½ç¹ªè£½æˆå¹³é¢æˆ–ç›´ç·šã€‚

âœ… é€™è£æœ‰å¯ä»¥ä½¿ç”¨å¤šé …å¼å›æ­¸æ•¸æ“šçš„[æ›´å¤šç¤ºä¾‹](https://online.stat.psu.edu/stat501/lesson/9/9.8)

å†çœ‹ä¸€ä¸‹ä¸Šåœ–ä¸­å“ç¨®èˆ‡åƒ¹æ ¼ä¹‹é–“çš„é—œç³»ã€‚é€™å€‹æ•£é»åœ–çœ‹èµ·ä¾†æ˜¯å¦æ‡‰è©²ç”¨ä¸€æ¢ç›´ç·šä¾†åˆ†æï¼Ÿä¹Ÿè¨±ä¸æ˜¯ã€‚åœ¨é€™ç¨®æƒ…æ³ä¸‹ï¼Œä½ å¯ä»¥å˜—è©¦å¤šé …å¼å›æ­¸ã€‚

âœ… å¤šé …å¼æ˜¯å¯èƒ½ç”±ä¸€å€‹æˆ–å¤šå€‹è®Šé‡å’Œç³»æ•¸çµ„æˆçš„æ•¸å­¸è¡¨é”å¼

å¤šé …å¼å›æ­¸å‰µå»ºä¸€æ¢æ›²ç·šä»¥æ›´å¥½åœ°æ“¬åˆéç·šæ€§æ•¸æ“šã€‚

1. è®“æˆ‘å€‘é‡æ–°å‰µå»ºä¸€å€‹å¡«å……äº†åŸå§‹å—ç“œæ•¸æ“šç‰‡æ®µçš„ dataframeï¼š

   ```python
   new_columns = ['Variety', 'Package', 'City', 'Month', 'Price']
   poly_pumpkins = new_pumpkins.drop([c for c in new_pumpkins.columns if c not in new_columns], axis='columns')

   poly_pumpkins
   ```

å¯è¦–åŒ– dataframe ä¸­æ•¸æ“šä¹‹é–“ç›¸é—œæ€§çš„ä¸€ç¨®å¥½æ–¹æ³•æ˜¯å°‡å…¶é¡¯ç¤ºåœ¨ã€Œcoolwarmã€åœ–è¡¨ä¸­ï¼š

2. ä½¿ç”¨ `Background_gradient()` æ–¹æ³•å’Œ `coolwarm` ä½œç‚ºå…¶åƒæ•¸å€¼ï¼š

   ```python
   corr = poly_pumpkins.corr()
   corr.style.background_gradient(cmap='coolwarm')
   ```

   é€™æ®µä»£ç¢¼å‰µå»ºäº†ä¸€å€‹ç†±åœ–:
   ![é¡¯ç¤ºæ•¸æ“šç›¸é—œæ€§çš„ç†±åœ–](../images/heatmap.png)

æŸ¥çœ‹æ­¤åœ–è¡¨ï¼Œä½ å¯ä»¥ç›´è§€åœ°çœ‹åˆ° Package å’Œ Price ä¹‹é–“çš„è‰¯å¥½ç›¸é—œæ€§ã€‚æ‰€ä»¥ä½ æ‡‰è©²èƒ½å¤ å‰µå»ºä¸€å€‹æ¯”ä¸Šä¸€å€‹æ›´å¥½çš„æ¨¡å‹ã€‚

### å‰µå»ºç®¡é“

Scikit-learn åŒ…å«ä¸€å€‹ç”¨æ–¼æ§‹å»ºå¤šé …å¼å›æ­¸æ¨¡å‹çš„æœ‰ç”¨ API - `make_pipeline` [API](https://scikit-learn.org/stable/modules/generated/sklearn.pipeline.make_pipeline.html?highlight=pipeline#sklearn.pipeline.make_pipeline)ã€‚ å‰µå»ºäº†ä¸€å€‹ã€Œç®¡é“ã€ï¼Œå®ƒæ˜¯ä¸€å€‹ä¼°è¨ˆå™¨éˆã€‚åœ¨é€™ç¨®æƒ…æ³ä¸‹ï¼Œç®¡é“åŒ…æ‹¬å¤šé …å¼ç‰¹å¾æˆ–å½¢æˆéç·šæ€§è·¯å¾‘çš„é æ¸¬ã€‚

1. æ§‹å»º X å’Œ y åˆ—ï¼š

   ```python
   X=poly_pumpkins.iloc[:,3:4].values
   y=poly_pumpkins.iloc[:,4:5].values
   ```

2. é€šéèª¿ç”¨ `make_pipeline()` æ–¹æ³•å‰µå»ºç®¡é“ï¼š

   ```python
   from sklearn.preprocessing import PolynomialFeatures
   from sklearn.pipeline import make_pipeline

   pipeline = make_pipeline(PolynomialFeatures(4), LinearRegression())

   X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=0)

   pipeline.fit(np.array(X_train), y_train)

   y_pred=pipeline.predict(X_test)
   ```

### å‰µå»ºåºåˆ—

æ­¤æ™‚ï¼Œä½ éœ€è¦ä½¿ç”¨_æ’åºå¥½çš„_æ•¸æ“šå‰µå»ºä¸€å€‹æ–°çš„ dataframe ï¼Œä»¥ä¾¿ç®¡é“å¯ä»¥å‰µå»ºåºåˆ—ã€‚

æ·»åŠ ä»¥ä¸‹ä»£ç¢¼ï¼š

   ```python
   df = pd.DataFrame({'x': X_test[:,0], 'y': y_pred[:,0]})
   df.sort_values(by='x',inplace = True)
   points = pd.DataFrame(df).to_numpy()

   plt.plot(points[:, 0], points[:, 1],color="blue", linewidth=3)
   plt.xlabel('Package')
   plt.ylabel('Price')
   plt.scatter(X,y, color="black")
   plt.show()
   ```

ä½ é€šéèª¿ç”¨ `pd.DataFrame` å‰µå»ºäº†ä¸€å€‹æ–°çš„ dataframeã€‚ç„¶å¾Œé€šéèª¿ç”¨ `sort_values()` å°å€¼é€²è¡Œæ’åºã€‚æœ€å¾Œä½ å‰µå»ºäº†ä¸€å€‹å¤šé …å¼åœ–ï¼š

![é¡¯ç¤ºåŒ…è£èˆ‡åƒ¹æ ¼é—œç³»çš„å¤šé …å¼åœ–](../images/polynomial.png)

ä½ å¯ä»¥çœ‹åˆ°æ›´é©åˆä½ çš„æ•¸æ“šçš„æ›²ç·šã€‚

è®“æˆ‘å€‘æª¢æŸ¥æ¨¡å‹çš„æº–ç¢ºæ€§ï¼š

   ```python
   accuracy_score = pipeline.score(X_train,y_train)
   print('Model Accuracy: ', accuracy_score)
   ```

   ç§ï¼

   ```output
   Model Accuracy:  0.8537946517073784
   ```

é€™æ¨£å¥½å¤šäº†ï¼è©¦è‘—é æ¸¬ä¸€å€‹åƒ¹æ ¼ï¼š

### åšå€‹é æ¸¬

æˆ‘å€‘å¯ä»¥è¼¸å…¥ä¸€å€‹æ–°å€¼ä¸¦å¾—åˆ°ä¸€å€‹é æ¸¬å—ï¼Ÿ

èª¿ç”¨ `predict()` é€²è¡Œé æ¸¬ï¼š

   ```python
   pipeline.predict( np.array([ [2.75] ]) )
   ```

   ä½ æœƒå¾—åˆ°é€™æ¨£çš„é æ¸¬ï¼š

   ```output
   array([[46.34509342]])
   ```

åƒç…§åœ–åƒï¼Œé€™ç¢ºå¯¦æœ‰é“ç†ï¼è€Œä¸”ï¼Œå¦‚æœé€™æ˜¯ä¸€å€‹æ¯”å‰ä¸€å€‹æ›´å¥½çš„æ¨¡å‹ï¼Œçœ‹åŒæ¨£çš„æ•¸æ“šï¼Œä½ éœ€è¦ç‚ºé€™äº›æ›´æ˜‚è²´çš„å—ç“œåšå¥½é ç®—ï¼

ğŸ† å¹¹å¾—ä¸éŒ¯ï¼ä½ åœ¨ä¸€ç¯€èª²ä¸­å‰µå»ºäº†å…©å€‹å›æ­¸æ¨¡å‹ã€‚åœ¨å›æ­¸çš„æœ€å¾Œä¸€ç¯€ä¸­ï¼Œä½ å°‡äº†è§£é‚è¼¯å›æ­¸ä»¥ç¢ºå®šé¡åˆ¥ã€‚

---

## ğŸš€æŒ‘æˆ°

åœ¨æ­¤ notebook ä¸­æ¸¬è©¦å¹¾å€‹ä¸åŒçš„è®Šé‡ï¼Œä»¥æŸ¥çœ‹ç›¸é—œæ€§èˆ‡æ¨¡å‹æº–ç¢ºæ€§çš„å°æ‡‰é—œç³»ã€‚

## [èª²å¾Œæ¸¬](https://gray-sand-07a10f403.1.azurestaticapps.net/quiz/14/)

## å¾©ç¿’èˆ‡è‡ªå­¸

åœ¨æœ¬èª²ä¸­ï¼Œæˆ‘å€‘å­¸ç¿’äº†ç·šæ€§å›æ­¸ã€‚é‚„æœ‰å…¶ä»–é‡è¦çš„å›æ­¸é¡å‹ã€‚äº†è§£ Stepwiseã€Ridgeã€Lasso å’Œ Elasticnet æŠ€è¡“ã€‚å­¸ç¿’æ›´å¤šä¿¡æ¯çš„å¥½èª²ç¨‹æ˜¯ [æ–¯å¦ç¦çµ±è¨ˆå­¸ç¿’èª²ç¨‹](https://online.stanford.edu/courses/sohs-ystatslearning-statistical-learning)

## ä»»å‹™

[æ§‹å»ºæ¨¡å‹](./assignment.zh-tw.md)
